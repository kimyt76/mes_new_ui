import{_ as Z,r as v,a as j,u as ee,p as te,y as ne,k as ae,m as le,c as oe,f as N,g as e,d as r,w as a,F as ie,e as se,o as L,i as U,h as re,C as $,D as P,b as de,z as ue,H as me}from"./index-WOYElqRf.js";import{A as D}from"./apiLab-BqEJ0S91.js";import{i as ce,p as pe,f as ve}from"./common-DT3ZdnD0.js";import{_ as fe}from"./IngredientListPop-C-uEjS5F.js";import{C as _e}from"./CustomerListPop-DY0fIeo2.js";import{_ as ge}from"./ItemListSinglePop-BfGnE-1I.js";import"./format-DWu4U6B8.js";import"./apiBase-BxtsCvh9.js";import"./apiItem-CodyMnFg.js";const Ce=["id"],we=["onUpdate:modelValue"],ye=["onUpdate:modelValue"],xe={__name:"NewMaterialDetail",setup(Ne){const f=v(!1),u=v({x:300,y:200}),_=v(!1);let V=0,I=0;function E(t){_.value=!0,V=t.clientX-u.value.x,I=t.clientY-u.value.y,window.addEventListener("mousemove",b),window.addEventListener("mouseup",k)}function b(t){_.value&&(u.value.x=t.clientX-V,u.value.y=t.clientY-I)}function k(){_.value=!1,window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",k)}const{userId:M}=j(),{vError:A,vSuccess:S,vInfo:Ve}=ee(),B=te(),R=se(),h=B.params.id,g=v(""),C=ne(null),s=v([]),o=ae({newMaterialCd:"",itemCd:"",itemName:"",materialName:"",inPrice:"",customerCd:"",customerName:"",mtrName:"",userId:M}),z=[{title:"성분코드",key:"ingredientCode",align:"center",width:"90px"},{title:"국문성분명",key:"krIngredientName",align:"start",width:"230px"},{title:"영어성분명",key:"enIngredientName",align:"start",width:"230px"},{title:"국내함량",key:"inContent",align:"center",width:"100px"},{title:"수출용함량",key:"outContent",align:"center",width:"100px"},{title:"CAS No",key:"casNo",align:"center",width:"90px"},{title:"function",key:"functionNm",align:"center",width:"90px"},{title:"한도 국가",key:"limitCountry",align:"center",width:"90px"},{title:"금지 국가",key:"banCountry",align:"center",width:"90px"},{title:"-",key:"actions",align:"center",width:"10px"}],X=async()=>{o.userId=M;try{const t={newMaterialInfo:o,materialMappingList:s.value},n=await D.saveNewMaterialInfo(t);o.newMaterialCd=n.data.newMaterialCd,S("저장되었습니다.")}catch{A("저장에 실패했습니다.")}},w=t=>{g.value=t,t==="I"?C.value=fe:t==="C"?C.value=_e:t==="P"&&(C.value=ge),f.value=!0},Y=t=>{g.value==="C"?(o.customerCd=t.customerCd,o.customerName=t.customerName):g.value==="P"?(o.itemCd=t.itemCd,o.itemName=t.itemName):g.value==="I"&&F(t)},F=t=>{if(!Array.isArray(t))return;let n=s.value.length;const m=t.map((i,d)=>({id:n++,ingredientCode:i.ingredientCode,krIngredientName:i.krIngredientName,enIngredientName:i.enIngredientName,inContent:"",outContent:"",casNo:i.casNo,functionNm:i.functionNm,limitCountry:i.limitCountry,banCountry:i.banCountry}));s.value.length>0?s.value.push(...m):s.value=[...m]},T=t=>{const n=s.value.findIndex(m=>m.ingredientCode===t);s.value.splice(n,1)};le(async()=>{if(!ce(h)){const t=await D.getNewMaterialInfo(h);Object.assign(o,t.newMaterialInfo),s.value=t.materialMappingList}});const H=()=>{R.push({name:"NewMaterialList"})};return(t,n)=>{const m=r("v-breadcrumbs"),i=r("v-text-field"),d=r("v-col"),p=r("v-row"),O=r("v-card-subtitle"),y=r("v-btn"),q=r("v-icon"),G=r("v-data-table-virtual"),J=r("v-form"),K=r("v-card-text"),Q=r("v-card"),W=r("v-dialog");return L(),oe(ie,null,[N("div",{id:t.$attrs.id},null,8,Ce),e(m,{items:["MES","연구관리","신 원료상세"]}),e(Q,null,{default:a(()=>[e(K,null,{default:a(()=>[e(J,null,{default:a(()=>[e(p,null,{default:a(()=>[e(d,null,{default:a(()=>[e(i,{modelValue:o.newMaterialCd,"onUpdate:modelValue":n[0]||(n[0]=l=>o.newMaterialCd=l),label:"임시코드",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(i,{modelValue:o.materialName,"onUpdate:modelValue":n[1]||(n[1]=l=>o.materialName=l),label:"원료명",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(i,{"model-value":U(ve)(o.inPrice),label:"입고단가",variant:"underlined",density:"compact","onUpdate:modelValue":n[2]||(n[2]=l=>o.inPrice=U(pe)(l))},null,8,["model-value"])]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(d,null,{default:a(()=>[e(i,{modelValue:o.mtrName,"onUpdate:modelValue":n[3]||(n[3]=l=>o.mtrName=l),label:"제조원",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(i,{modelValue:o.customerName,"onUpdate:modelValue":n[4]||(n[4]=l=>o.customerName=l),label:"거래처",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":n[5]||(n[5]=l=>w("C"))},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(i,{modelValue:o.itemCd,"onUpdate:modelValue":n[6]||(n[6]=l=>o.itemCd=l),label:"품목코드",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":n[7]||(n[7]=l=>w("P"))},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{class:"mt-4"},{default:a(()=>[e(d,{class:"mt-3"},{default:a(()=>[e(O,null,{default:a(()=>n[11]||(n[11]=[re(" - 성분코드 ")])),_:1})]),_:1}),e(d,{class:"d-flex justify-end"},{default:a(()=>[e(y,{color:"brown-lighten-4",class:"mt-3",text:"추가+",density:"compact",onClick:n[8]||(n[8]=l=>w("I"))})]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(G,{headers:z,items:s.value,class:"custom-table"},{"item.inContent":a(({item:l,index:c})=>[$(N("input",{"onUpdate:modelValue":x=>s.value[c].inContent=x,style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,8,we),[[P,s.value[c].inContent]])]),"item.outContent":a(({item:l,index:c})=>[$(N("input",{"onUpdate:modelValue":x=>s.value[c].outContent=x,style:{"text-align":"right",width:"90%",height:"30px"},class:"custom-line"},null,8,ye),[[P,s.value[c].outContent]])]),"item.actions":a(({item:l})=>[e(q,{color:"medium-emphasis",icon:"mdi-delete",size:"small",onClick:c=>T(l.ingredientCode)},null,8,["onClick"])]),_:1},8,["items"])]),_:1}),e(p,null,{default:a(()=>[e(d,{class:"d-flex justify-end mt-3 ga-3"},{default:a(()=>[e(y,{text:"저장",color:"brown-lighten-4",onClick:X}),e(y,{text:"목록",onClick:H})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(W,{modelValue:f.value,"onUpdate:modelValue":n[10]||(n[10]=l=>f.value=l),width:"800px",height:"800px",persistent:"",location:"center"},{default:a(()=>[(L(),de(ue(C.value),{id:t.id,style:me({position:"absolute",top:`${u.value.y}px`,left:`${u.value.x}px`,cursor:_.value?"grabbing":"grab"}),onMousedown:E,onSelected:Y,onCloseDialog:n[9]||(n[9]=l=>f.value=!1)},null,40,["id","style"]))]),_:1},8,["modelValue"])],64)}}},De=Z(xe,[["__scopeId","data-v-8031c592"]]);export{De as default};
