import{b as ce,s as W,a as J}from"./index-Z2YNGKhZ.js";import{s as fe}from"./index-D49h5Cbk.js";import{K as Z,L as ye,U as X,A as m,V as ve,M as be,Z as ge,W as ee,J as B,H as te,e as le,o as oe,p as e,h as a,l as i,a2 as f,G as ae,a0 as V,a7 as Ve,F as ne,P as Ce,t as H,y as E}from"./index-BCdxernO.js";import{s as g}from"./index-WWuz9eST.js";import{s as ie,a as we,b as xe}from"./index-CKfU0QJd.js";import{s as se}from"./index-DhHuXiFi.js";import{s as de}from"./index-Dsa_8OmY.js";import{s as _e}from"./index-BE87lW_G.js";import{A as N}from"./apiCommon-DQdCmI3G.js";import{d as G,i as q,j as K,m as Ne}from"./common-Ctgf_4Dl.js";import{e as he}from"./exportToExcel-BIsrPQTg.js";import{s as Ue}from"./index-CEOpAmiF.js";import{C as Pe}from"./CustomerListPop-CR8s3FNg.js";import{I as De}from"./ItemListMultiPop-BS5GtrW8.js";import{_ as Se}from"./StorageListPop-DUQWZ2vL.js";import{C as je}from"./ContractListPop-DP1BRr28.js";import{U as $e}from"./UserListPop-40qvmJxy.js";import{s as S}from"./index-BGn1OEmN.js";import"./apiBase-DJzL_JWR.js";import"./apiItem-B0JHHkd5.js";import"./apiOrders-LBbh7QBG.js";import"./apiSystem-BBpYMteA.js";const Le={class:"grid mb-1"},ke={class:"col-3 flex align-items-center gap-2"},He={class:"col-3"},Ie={class:"col-3"},Te={class:"col-3"},Ye={class:"grid mb-1"},Me={class:"col-3"},Ae={class:"col-3"},Fe={class:"col-3"},Re={class:"col-3"},Oe={class:"w-full flex gap-2 ml-2 mt-4"},Qe={class:"flex items-center gap-2"},Ee={class:"w-full mt-2"},Ge=["onClick"],qe={class:"w-full flex gap-2 justify-end mt-2"},ze={__name:"PurchaseOrderPPop",emits:["selected","close"],setup(re,{emit:z}){const{vError:I,vSuccess:T,vWarning:Y}=ye(),M=X(),_=m(!1);m(!1);const r=ve("dialogRef"),{userId:h,memberNm:A}=be(),U=m([]),j=m([]),y=m([]),$=m(!1),C=ge(null),F=["D000004","M60038","M60040","M60041","M60043"],s=ee({orderDate:"",seq:1,itemTypeCd:"",srcStorageName:"",srcStorageCd:"",managerName:A,managerId:h,deliveryDate:"",customerName:"",customerCd:"",customerManager:"",userId:h}),v=async()=>{y.value},o=d=>{Array.isArray(d)&&P(d)},P=d=>{const t=d.map((u,n)=>({itemCd:u.itemCd,itemName:u.itemName,spec:u.spec,inPrice:u.inPrice,supplyPrice:u.supplyPrice,vatPrice:u.vatPrice,etc:u.etc}));y.value,y.value.length>0?y.value.push(...t):y.value=[...t]},L=()=>{_.value=!0},p=d=>{let t="창고 목록";d==="C"?(C.value=Pe,t="거래처 목록"):d==="U"?(C.value=$e,t="사용자 목록"):d==="S"?C.value=Se:d==="O"&&(t="주문서 목록",C.value=je),M.open(C.value,{props:{header:t,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},onClose:u=>{u.data&&(d==="C"?(s.customerCd=u.data.customerCd,s.customerName=u.data.customerName):d==="U"?(s.managerId=u.data.userId,s.managerName=u.data.memberNm):d==="S"?(s.srcStorageCd=u.data.storageCd,s.srcStorageName=u.data.storageName):d==="O"&&P(u.data))}})};B(()=>s.orderDate,async(d,t)=>{q(t)||t!==d&&(s.seq=await N.getNextSeq("tb_mat_order","order_date",d))});const w=d=>{const t=Number(d.orderQty)||0,u=Number(d.inPrice)||0;d.supplyPrice=t*u,!q(s.vatYn)&&s.vatYn==="VRY"?d.vatPrice=K(d.supplyPrice):d.vatPrice=0};B(()=>s.vatYn,async d=>{s.vatType==="VRN"?y.value.map(t=>{t.vatPrice=0}):y.value.map(t=>{t.vatPrice=K(t.supplyPrice)})});const D=d=>{y.value.splice(d,1)};te(async()=>{U.value=await N.getCodeList("item_type_cd"),j.value=await N.getCodeList("vat_type"),s.orderDate=G(),s.deliveryDate=G()});const x=()=>{r.value.close()};return(d,t)=>{const u=de,n=se,R=ie,O=xe,Q=we,ue=Ue,k=ae,b=W,me=J,pe=Ve;return oe(),le(ne,null,[e(ue,{style:{width:"90rem",height:"8rem"}},{content:i(()=>[a("div",Le,[a("div",ke,[e(n,{variant:"on"},{default:i(()=>[e(u,{modelValue:s.orderDate,"onUpdate:modelValue":t[0]||(t[0]=l=>s.orderDate=l),fluid:"",style:{width:"120px"}},null,8,["modelValue"]),t[16]||(t[16]=a("label",null,"발주일",-1))]),_:1}),t[18]||(t[18]=a("span",{class:"center-dash"},"-",-1)),e(n,{variant:"on"},{default:i(()=>[e(f(S),{modelValue:s.seq,"onUpdate:modelValue":t[1]||(t[1]=l=>s.seq=l),inputStyle:{width:"50px","text-align":"center"}},null,8,["modelValue"]),t[17]||(t[17]=a("label",null,"연번",-1))]),_:1})]),a("div",He,[e(n,{variant:"on"},{default:i(()=>[e(R,{modelValue:s.itemTypeCd,"onUpdate:modelValue":t[2]||(t[2]=l=>s.itemTypeCd=l),options:U.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[19]||(t[19]=a("label",null,"품목구분",-1))]),_:1})]),a("div",Ie,[e(n,{variant:"on"},{default:i(()=>[e(Q,{iconPosition:"left"},{default:i(()=>[e(f(g),{modelValue:s.srcStorageName,"onUpdate:modelValue":t[3]||(t[3]=l=>s.srcStorageName=l),class:"w-full"},null,8,["modelValue"]),e(O,{class:"pi pi-search",onClick:t[4]||(t[4]=l=>p("S"))})]),_:1}),t[20]||(t[20]=a("label",null,"입고창고",-1))]),_:1})]),a("div",Te,[e(n,{variant:"on"},{default:i(()=>[e(Q,{iconPosition:"left"},{default:i(()=>[e(f(g),{modelValue:s.managerName,"onUpdate:modelValue":t[5]||(t[5]=l=>s.managerName=l),class:"w-full"},null,8,["modelValue"]),e(O,{class:"pi pi-search",onClick:t[6]||(t[6]=l=>p("U"))})]),_:1}),t[21]||(t[21]=a("label",null,"담당자",-1))]),_:1})])]),a("div",Ye,[a("div",Me,[e(n,{variant:"on"},{default:i(()=>[e(u,{modelValue:s.deliveryDate,"onUpdate:modelValue":t[7]||(t[7]=l=>s.deliveryDate=l),"show-icon":"",fluid:""},null,8,["modelValue"]),t[22]||(t[22]=a("label",null,"납기일",-1))]),_:1})]),a("div",Ae,[e(n,{variant:"on"},{default:i(()=>[e(Q,{iconPosition:"left"},{default:i(()=>[e(f(g),{modelValue:s.customerName,"onUpdate:modelValue":t[8]||(t[8]=l=>s.customerName=l),class:"w-full"},null,8,["modelValue"]),e(O,{class:"pi pi-search",onClick:t[9]||(t[9]=l=>p("C"))})]),_:1}),t[23]||(t[23]=a("label",null,"거래처",-1))]),_:1})]),a("div",Fe,[e(n,{variant:"on"},{default:i(()=>[e(f(g),{modelValue:s.customerManager,"onUpdate:modelValue":t[10]||(t[10]=l=>s.customerManager=l),class:"w-full"},null,8,["modelValue"]),t[24]||(t[24]=a("label",null,"거래처담당자",-1))]),_:1})]),a("div",Re,[e(n,{variant:"on"},{default:i(()=>[e(R,{modelValue:s.vatYn,"onUpdate:modelValue":t[11]||(t[11]=l=>s.vatYn=l),options:j.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[25]||(t[25]=a("label",null,"부가세율적용",-1))]),_:1})])])]),_:1}),a("div",Oe,[a("div",Qe,[e(f(ce),{modelValue:$.value,"onUpdate:modelValue":t[12]||(t[12]=l=>$.value=l),name:"전체",value:"A"},null,8,["modelValue"]),t[26]||(t[26]=a("label",{for:"ingredient1"},"전체 ",-1))]),a("div",null,[e(k,{label:"주문서",onClick:t[13]||(t[13]=l=>p("O"))})]),a("div",null,[e(k,{label:"품목+",onClick:L})])]),a("div",Ee,[e(me,{value:y.value,selectionMode:"single",class:"my-table","show-gridlines":""},{default:i(()=>[e(b,{selectionMode:"multiple",headerStyle:"width: 3rem"}),e(b,{field:"itemCd",header:"품목코드",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(b,{field:"itemName",header:"품목명",style:V([{width:"350px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(g),{modelValue:l.data.itemName,"onUpdate:modelValue":c=>l.data.itemName=c,class:"w-full",readonly:!F.includes(l.data.itemCd)},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:1}),e(b,{field:"spec",header:"규격",style:V([{width:"110px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(g),{modelValue:l.data.spec,"onUpdate:modelValue":c=>l.data.spec=c,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"orderQty",header:"수량",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(S),{modelValue:l.data.orderQty,"onUpdate:modelValue":[c=>l.data.orderQty=c,()=>w(l.data)],class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"inPrice",header:"단가",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(S),{modelValue:l.data.inPrice,"onUpdate:modelValue":[c=>l.data.inPrice=c,()=>w(l.data)],class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"supplyPrice",header:"공급가액",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(S),{modelValue:l.data.supplyPrice,"onUpdate:modelValue":c=>l.data.supplyPrice=c,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"vatPrice",header:"부가세",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(S),{modelValue:l.data.vatPrice,"onUpdate:modelValue":c=>l.data.vatPrice=c,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"etc",header:"비고",style:V([{width:"200px"},{"text-align":"right"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[e(f(g),{modelValue:l.data.etc,"onUpdate:modelValue":c=>l.data.etc=c,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"actions",header:"-",style:V([{width:"20px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(l=>[a("i",{class:"pi pi-trash cursor-pointer",onClick:c=>D(l.index)},null,8,Ge)]),_:1})]),_:1},8,["value"])]),a("div",qe,[e(k,{label:"저장",severity:"secondary",onClick:v}),e(k,{label:"닫기",onClick:x})]),e(pe,{visible:_.value,"onUpdate:visible":t[15]||(t[15]=l=>_.value=l),header:"품목 조회",modal:"",draggable:!1,resizable:!1},{default:i(()=>[e(De,{onSelected:o,onClose:t[14]||(t[14]=l=>_.value=!1)})]),_:1},8,["visible"])],64)}}},Be=Z(ze,[["__scopeId","data-v-4c8e6856"]]),Ke={class:"flex flex-wrap items-center gap-2 w-full"},We={class:"flex items-center justify-end gap-2 mb-2"},Je=["onClick"],Ze={__name:"PurchaseOrderPList",setup(re){m(!1);const z=X(),I=m(null),T=m([]),Y=m([]),M=m([{codeNm:"미입고",code:"N"},{codeNm:"입고",code:"Y"}]),_=m([{codeNm:"진행중",code:"N"},{codeNm:"종결",code:"Y"}]),r=ee({strDate:"",toDate:"",itemTypeCd:"",itemCd:"",itemName:"",customerName:"",customerCd:"",regYn:"",endYn:"",selectedCity:""}),h=m();m([]);const A=m([]),U=v=>{let o="발주서 등록";q(v)||(o="발주서 상세"),z.open(Be,{props:{header:o,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},data:v,onClose:P=>{}})},j=async()=>{const v={...r};list.value=await N.getCodeList(v)},y=()=>{},$=()=>{};te(async()=>{T.value=await N.getCodeList("AREA"),Y.value=await N.getCodeList("ITEM_TYPE_CD"),r.toDate=G(),r.strDate=Ne(r.toDate)});const C=m({icon:"pi pi-home"}),F=m([{label:"발주관리"},{label:"발주등록(구매)"},{label:"발주등록(구매)목록"}]),s=()=>{var o;const v=((o=I.value)==null?void 0:o.columns)??[];if(!v.length){console.warn("No Columns Found");return}he(A.value,"발주 리스트",v)};return(v,o)=>{const P=_e,L=de,p=se,w=ie,D=g,x=ae,d=fe,t=W,u=J;return oe(),le(ne,null,[e(P,{home:C.value,model:F.value},null,8,["home","model"]),a("form",{onSubmit:Ce(j,["prevent"]),class:"space-y-4"},[e(d,{class:"flex flex-wrap mt-2 mb-2 gap-1 w-full"},{start:i(()=>[a("div",Ke,[e(p,{variant:"on"},{default:i(()=>[e(L,{modelValue:r.strDate,"onUpdate:modelValue":o[0]||(o[0]=n=>r.strDate=n),inputId:"on_label",showIcon:"",iconDisplay:"input"},null,8,["modelValue"]),o[11]||(o[11]=a("label",{for:"on_label"},"시작",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(L,{modelValue:r.toDate,"onUpdate:modelValue":o[1]||(o[1]=n=>r.toDate=n),inputId:"on_label",showIcon:"",iconDisplay:"input"},null,8,["modelValue"]),o[12]||(o[12]=a("label",{for:"on_label"},"종료",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(w,{modelValue:r.areaCd,"onUpdate:modelValue":o[2]||(o[2]=n=>r.areaCd=n),options:T.value,optionLabel:"codeNm",optionValue:"code",style:{width:"120px"}},null,8,["modelValue","options"]),o[13]||(o[13]=a("label",{for:"on_label"},"구역(공장)",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(w,{modelValue:r.itemTypeCd,"onUpdate:modelValue":o[3]||(o[3]=n=>r.itemTypeCd=n),options:Y.value,optionLabel:"codeNm",optionValue:"code",style:{width:"120px"}},null,8,["modelValue","options"]),o[14]||(o[14]=a("label",{for:"on_label"},"품목구분",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(D,{id:"on_label",modelValue:r.itemName,"onUpdate:modelValue":o[4]||(o[4]=n=>r.itemName=n),style:{width:"180px"}},null,8,["modelValue"]),o[15]||(o[15]=a("label",{for:"on_label"},"품목명",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(D,{id:"on_label1",modelValue:r.itemCd,"onUpdate:modelValue":o[5]||(o[5]=n=>r.itemCd=n),style:{width:"120px"}},null,8,["modelValue"]),o[16]||(o[16]=a("label",{for:"on_label1"},"품목코드",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(D,{id:"on_label1",modelValue:r.customerName,"onUpdate:modelValue":o[6]||(o[6]=n=>r.customerName=n),style:{width:"180px"}},null,8,["modelValue"]),o[17]||(o[17]=a("label",{for:"on_label1"},"거래처명",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(w,{modelValue:r.regYn,"onUpdate:modelValue":o[7]||(o[7]=n=>r.regYn=n),options:M.value,optionLabel:"codeNm",optionValue:"code",style:{width:"90px"}},null,8,["modelValue","options"]),o[18]||(o[18]=a("label",{for:"on_label"},"입고상태",-1))]),_:1}),e(p,{variant:"on"},{default:i(()=>[e(w,{modelValue:r.endYn,"onUpdate:modelValue":o[8]||(o[8]=n=>r.endYn=n),options:_.value,optionLabel:"codeNm",optionValue:"code",style:{width:"90px"}},null,8,["modelValue","options"]),o[19]||(o[19]=a("label",{for:"on_label"},"진행상태",-1))]),_:1}),e(x,{label:"검색",icon:"pi pi-search",type:"submit",class:"bg-blue-500 text-white hover:bg-blue-600"})])]),_:1})],32),a("div",We,[e(x,{label:"신규",icon:"pi pi-plus",severity:"secondary",onClick:o[9]||(o[9]=n=>U(""))}),e(x,{label:"엑셀",icon:"pi pi-file-excel",severity:"success",onClick:s}),e(x,{label:"복사",icon:"pi pi-file-excel",onClick:$}),e(x,{label:"인쇄",icon:"pi pi-file-excel",onClick:y})]),a("div",null,[e(u,{ref_key:"dt",ref:I,selection:h.value,"onUpdate:selection":o[10]||(o[10]=n=>h.value=n),paginator:"",rows:20,rowsPerPageOptions:[20,30,40],scrollHeight:"700px",scrollable:"",showGridlines:"",selectionMode:"single",tableStyle:"min-width:120rem; table-layout: fixed;",class:"my-table"},{default:i(()=>[e(t,{selectionMode:"multiple",headerStyle:"width: 3rem",style:{"text-align":"center"}}),e(t,{field:"orderDateSeq",header:"일자",frozen:"",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"orderDate",header:"발주일",frozen:"",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"deliveryDate",header:"납기일",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"customerName",header:"거래처명",style:{width:"250px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"itemCd",header:"품목코드",style:{width:"120px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"itemName",header:"품목명",style:V([{width:"400px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:i(n=>[a("div",{onClick:R=>U(n.data.itemCd),class:"clickable-cell"},H(n.data.itemName),9,Je)]),_:1}),e(t,{field:"srcStorageName",header:"입고창고",style:{width:"110px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"orderQty",header:"발주수량",pt:{columnHeaderContent:"justify-center"},style:V([{width:"90px"},{"text-align":"right"}])},{body:i(n=>[E(H(Number(n.data.orderQty).toLocaleString()),1)]),_:1}),e(t,{field:"inQty",header:"입고수량",pt:{columnHeaderContent:"justify-center"},style:V([{width:"90px"},{"text-align":"right"}])},{body:i(n=>[E(H(Number(n.data.inQty).toLocaleString()),1)]),_:1}),e(t,{field:"supplyPrice",header:"공급가액",pt:{columnHeaderContent:"justify-center"},style:V([{width:"90px"},{"text-align":"right"}])},{body:i(n=>[E(H(Number(n.data.supplyPrice).toLocaleString()),1)]),_:1}),e(t,{field:"regYn",header:"입고상태",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"endYn",header:"진행상태",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"mailYn",header:"발주서발송",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(t,{field:"managerName",header:"담당자",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["selection"])])],64)}}},wt=Z(Ze,[["__scopeId","data-v-9d37837d"]]);export{wt as default};
