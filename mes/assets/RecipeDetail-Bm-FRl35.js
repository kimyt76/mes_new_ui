import{M as qD,N as sB,c as KD,o as mp,O as aB,r as Fl,b as XD,E as lB,i as ZD,u as uB,a as cB,x as hB,p as dB,k as fB,z as Pv,m as gB,A as mB,f as yh,g as Oe,d as Li,w as wt,F as pB,e as wB,j as vB,t as Iv,y as CB}from"./index-4poL43z0.js";import{i as Ov,d as yB,e as AP}from"./common-BYhKLuQs.js";import{A as xv}from"./apiLab-C0Mu3n3o.js";import{A as HP}from"./apiItem-DPmHF27b.js";import{c as NP}from"./_commonjsHelpers-CZnAS8i4.js";import{_ as SB}from"./UserListPop-CdidCHTm.js";import{_ as bB}from"./ClientListPop-Dbr0azN9.js";import"./format-CBpsKyOP.js";import"./apiBase-BtVBM6oO.js";var DP={},Sh,kP;function sn(){if(kP)return Sh;kP=1;var t=function(e){return e&&e.Math===Math&&e};return Sh=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof NP=="object"&&NP)||t(typeof Sh=="object"&&Sh)||function(){return this}()||Function("return this")(),Sh}var Av={},Hv,LP;function fn(){return LP||(LP=1,Hv=function(t){try{return!!t()}catch{return!0}}),Hv}var Nv,$P;function Ii(){if($P)return Nv;$P=1;var t=fn();return Nv=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Nv}var Dv,FP;function bw(){if(FP)return Dv;FP=1;var t=fn();return Dv=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Dv}var kv,VP;function gn(){if(VP)return kv;VP=1;var t=bw(),e=Function.prototype.call;return kv=t?e.bind(e):function(){return e.apply(e,arguments)},kv}var Lv={},WP;function RB(){if(WP)return Lv;WP=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return Lv.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Lv}var $v,BP;function Rw(){return BP||(BP=1,$v=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),$v}var Fv,jP;function an(){if(jP)return Fv;jP=1;var t=bw(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return Fv=t?r:function(i){return function(){return n.apply(i,arguments)}},Fv}var Vv,UP;function pu(){if(UP)return Vv;UP=1;var t=an(),e=t({}.toString),n=t("".slice);return Vv=function(r){return n(e(r),8,-1)},Vv}var Wv,zP;function EB(){if(zP)return Wv;zP=1;var t=an(),e=fn(),n=pu(),r=Object,i=t("".split);return Wv=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,Wv}var Bv,YP;function e0(){return YP||(YP=1,Bv=function(t){return t==null}),Bv}var jv,GP;function Pf(){if(GP)return jv;GP=1;var t=e0(),e=TypeError;return jv=function(n){if(t(n))throw new e("Can't call method on "+n);return n},jv}var Uv,qP;function If(){if(qP)return Uv;qP=1;var t=EB(),e=Pf();return Uv=function(n){return t(e(n))},Uv}var zv,KP;function mn(){if(KP)return zv;KP=1;var t=typeof document=="object"&&document.all;return zv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},zv}var Yv,XP;function Oi(){if(XP)return Yv;XP=1;var t=mn();return Yv=function(e){return typeof e=="object"?e!==null:t(e)},Yv}var Gv,ZP;function rh(){if(ZP)return Gv;ZP=1;var t=sn(),e=mn(),n=function(r){return e(r)?r:void 0};return Gv=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Gv}var qv,QP;function Of(){if(QP)return qv;QP=1;var t=an();return qv=t({}.isPrototypeOf),qv}var Kv,JP;function Ew(){if(JP)return Kv;JP=1;var t=sn(),e=t.navigator,n=e&&e.userAgent;return Kv=n?String(n):"",Kv}var Xv,eI;function TB(){if(eI)return Xv;eI=1;var t=sn(),e=Ew(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Xv=a,Xv}var Zv,tI;function t0(){if(tI)return Zv;tI=1;var t=TB(),e=fn(),n=sn(),r=n.String;return Zv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Zv}var Qv,nI;function QD(){if(nI)return Qv;nI=1;var t=t0();return Qv=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Qv}var Jv,rI;function n0(){if(rI)return Jv;rI=1;var t=rh(),e=mn(),n=Of(),r=QD(),i=Object;return Jv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},Jv}var eC,iI;function Tw(){if(iI)return eC;iI=1;var t=String;return eC=function(e){try{return t(e)}catch{return"Object"}},eC}var tC,oI;function Hr(){if(oI)return tC;oI=1;var t=mn(),e=Tw(),n=TypeError;return tC=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},tC}var nC,sI;function xf(){if(sI)return nC;sI=1;var t=Hr(),e=e0();return nC=function(n,r){var i=n[r];return e(i)?void 0:t(i)},nC}var rC,aI;function _B(){if(aI)return rC;aI=1;var t=gn(),e=mn(),n=Oi(),r=TypeError;return rC=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},rC}var iC={exports:{}},oC,lI;function Ya(){return lI||(lI=1,oC=!1),oC}var sC,uI;function r0(){if(uI)return sC;uI=1;var t=sn(),e=Object.defineProperty;return sC=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},sC}var cI;function i0(){if(cI)return iC.exports;cI=1;var t=Ya(),e=sn(),n=r0(),r="__core-js_shared__",i=iC.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.46.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),iC.exports}var aC,hI;function JD(){if(hI)return aC;hI=1;var t=i0();return aC=function(e,n){return t[e]||(t[e]=n||{})},aC}var lC,dI;function ih(){if(dI)return lC;dI=1;var t=Pf(),e=Object;return lC=function(n){return e(t(n))},lC}var uC,fI;function xi(){if(fI)return uC;fI=1;var t=an(),e=ih(),n=t({}.hasOwnProperty);return uC=Object.hasOwn||function(i,o){return n(e(i),o)},uC}var cC,gI;function ek(){if(gI)return cC;gI=1;var t=an(),e=0,n=Math.random(),r=t(1.1.toString);return cC=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},cC}var hC,mI;function lo(){if(mI)return hC;mI=1;var t=sn(),e=JD(),n=xi(),r=ek(),i=t0(),o=QD(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return hC=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},hC}var dC,pI;function MB(){if(pI)return dC;pI=1;var t=gn(),e=Oi(),n=n0(),r=xf(),i=_B(),o=lo(),s=TypeError,a=o("toPrimitive");return dC=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},dC}var fC,wI;function tk(){if(wI)return fC;wI=1;var t=MB(),e=n0();return fC=function(n){var r=t(n,"string");return e(r)?r:r+""},fC}var gC,vI;function o0(){if(vI)return gC;vI=1;var t=sn(),e=Oi(),n=t.document,r=e(n)&&e(n.createElement);return gC=function(i){return r?n.createElement(i):{}},gC}var mC,CI;function nk(){if(CI)return mC;CI=1;var t=Ii(),e=fn(),n=o0();return mC=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),mC}var yI;function rk(){if(yI)return Av;yI=1;var t=Ii(),e=gn(),n=RB(),r=Rw(),i=If(),o=tk(),s=xi(),a=nk(),l=Object.getOwnPropertyDescriptor;return Av.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},Av}var pC={},wC,SI;function ik(){if(SI)return wC;SI=1;var t=Ii(),e=fn();return wC=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),wC}var vC,bI;function pn(){if(bI)return vC;bI=1;var t=Oi(),e=String,n=TypeError;return vC=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},vC}var RI;function Ga(){if(RI)return pC;RI=1;var t=Ii(),e=nk(),n=ik(),r=pn(),i=tk(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return pC.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var p=a(d,f);p&&p[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:p[u],enumerable:l in m?m[l]:p[l],writable:!1})}return s(d,f,m)}:s:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return s(d,f,m)}catch{}if("get"in m||"set"in m)throw new o("Accessors not supported");return"value"in m&&(d[f]=m.value),d},pC}var CC,EI;function oh(){if(EI)return CC;EI=1;var t=Ii(),e=Ga(),n=Rw();return CC=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},CC}var yC={exports:{}},SC,TI;function PB(){if(TI)return SC;TI=1;var t=Ii(),e=xi(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return SC={EXISTS:i,PROPER:o,CONFIGURABLE:s},SC}var bC,_I;function IB(){if(_I)return bC;_I=1;var t=an(),e=mn(),n=i0(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),bC=n.inspectSource,bC}var RC,MI;function OB(){if(MI)return RC;MI=1;var t=sn(),e=mn(),n=t.WeakMap;return RC=e(n)&&/native code/.test(String(n)),RC}var EC,PI;function s0(){if(PI)return EC;PI=1;var t=JD(),e=ek(),n=t("keys");return EC=function(r){return n[r]||(n[r]=e(r))},EC}var TC,II;function a0(){return II||(II=1,TC={}),TC}var _C,OI;function ok(){if(OI)return _C;OI=1;var t=OB(),e=sn(),n=Oi(),r=oh(),i=xi(),o=i0(),s=s0(),a=a0(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(b){return f(b)?d(b):h(b,{})},p=function(b){return function(M){var R;if(!n(M)||(R=d(M)).type!==b)throw new u("Incompatible receiver, "+b+" required");return R}};if(t||o.state){var y=o.state||(o.state=new c);y.get=y.get,y.has=y.has,y.set=y.set,h=function(b,M){if(y.has(b))throw new u(l);return M.facade=b,y.set(b,M),M},d=function(b){return y.get(b)||{}},f=function(b){return y.has(b)}}else{var T=s("state");a[T]=!0,h=function(b,M){if(i(b,T))throw new u(l);return M.facade=b,r(b,T,M),M},d=function(b){return i(b,T)?b[T]:{}},f=function(b){return i(b,T)}}return _C={set:h,get:d,has:f,enforce:m,getterFor:p},_C}var xI;function sk(){if(xI)return yC.exports;xI=1;var t=an(),e=fn(),n=mn(),r=xi(),i=Ii(),o=PB().CONFIGURABLE,s=IB(),a=ok(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),p=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),T=yC.exports=function(b,M,R){d(c(M),0,7)==="Symbol("&&(M="["+f(c(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),R&&R.getter&&(M="get "+M),R&&R.setter&&(M="set "+M),(!r(b,"name")||o&&b.name!==M)&&(i?h(b,"name",{value:M,configurable:!0}):b.name=M),p&&R&&r(R,"arity")&&b.length!==R.arity&&h(b,"length",{value:R.arity});try{R&&r(R,"constructor")&&R.constructor?i&&h(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var k=l(b);return r(k,"source")||(k.source=m(y,typeof M=="string"?M:"")),b};return Function.prototype.toString=T(function(){return n(this)&&u(this).source||s(this)},"toString"),yC.exports}var MC,AI;function l0(){if(AI)return MC;AI=1;var t=mn(),e=Ga(),n=sk(),r=r0();return MC=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},MC}var PC={},IC,HI;function xB(){if(HI)return IC;HI=1;var t=Math.ceil,e=Math.floor;return IC=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},IC}var OC,NI;function Af(){if(NI)return OC;NI=1;var t=xB();return OC=function(e){var n=+e;return n!==n||n===0?0:t(n)},OC}var xC,DI;function AB(){if(DI)return xC;DI=1;var t=Af(),e=Math.max,n=Math.min;return xC=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},xC}var AC,kI;function HB(){if(kI)return AC;kI=1;var t=Af(),e=Math.min;return AC=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},AC}var HC,LI;function sh(){if(LI)return HC;LI=1;var t=HB();return HC=function(e){return t(e.length)},HC}var NC,$I;function NB(){if($I)return NC;$I=1;var t=If(),e=AB(),n=sh(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return NC={includes:r(!0),indexOf:r(!1)},NC}var DC,FI;function ak(){if(FI)return DC;FI=1;var t=an(),e=xi(),n=If(),r=NB().indexOf,i=a0(),o=t([].push);return DC=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},DC}var kC,VI;function u0(){return VI||(VI=1,kC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),kC}var WI;function DB(){if(WI)return PC;WI=1;var t=ak(),e=u0(),n=e.concat("length","prototype");return PC.f=Object.getOwnPropertyNames||function(i){return t(i,n)},PC}var LC={},BI;function kB(){return BI||(BI=1,LC.f=Object.getOwnPropertySymbols),LC}var $C,jI;function LB(){if(jI)return $C;jI=1;var t=rh(),e=an(),n=DB(),r=kB(),i=pn(),o=e([].concat);return $C=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},$C}var FC,UI;function lk(){if(UI)return FC;UI=1;var t=xi(),e=LB(),n=rk(),r=Ga();return FC=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},FC}var VC,zI;function $B(){if(zI)return VC;zI=1;var t=fn(),e=mn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return VC=r,VC}var WC,YI;function Et(){if(YI)return WC;YI=1;var t=sn(),e=rk().f,n=oh(),r=l0(),i=r0(),o=lk(),s=$B();return WC=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,p,y,T;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(y=l[m],a.dontCallGetSet?(T=e(f,m),p=T&&T.value):p=f[m],d=s(c?m:u+(h?".":"#")+m,a.forced),!d&&p!==void 0){if(typeof y==typeof p)continue;o(y,p)}(a.sham||p&&p.sham)&&n(y,"sham",!0),r(f,m,y,a)}},WC}var BC,GI;function Hf(){if(GI)return BC;GI=1;var t=bw(),e=Function.prototype,n=e.apply,r=e.call;return BC=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),BC}var jC,qI;function uk(){if(qI)return jC;qI=1;var t=an(),e=Hr();return jC=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},jC}var UC,KI;function FB(){if(KI)return UC;KI=1;var t=Oi();return UC=function(e){return t(e)||e===null},UC}var zC,XI;function VB(){if(XI)return zC;XI=1;var t=FB(),e=String,n=TypeError;return zC=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},zC}var YC,ZI;function ck(){if(ZI)return YC;ZI=1;var t=uk(),e=Oi(),n=Pf(),r=VB();return YC=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),YC}var GC,QI;function WB(){if(QI)return GC;QI=1;var t=Ga().f;return GC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},GC}var qC,JI;function BB(){if(JI)return qC;JI=1;var t=mn(),e=Oi(),n=ck();return qC=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},qC}var KC,eO;function jB(){if(eO)return KC;eO=1;var t=lo(),e=t("toStringTag"),n={};return n[e]="z",KC=String(n)==="[object z]",KC}var XC,tO;function hk(){if(tO)return XC;tO=1;var t=jB(),e=mn(),n=pu(),r=lo(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return XC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},XC}var ZC,nO;function _w(){if(nO)return ZC;nO=1;var t=hk(),e=String;return ZC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},ZC}var QC,rO;function UB(){if(rO)return QC;rO=1;var t=_w();return QC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},QC}var JC,iO;function zB(){if(iO)return JC;iO=1;var t=Oi(),e=oh();return JC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},JC}var ey,oO;function YB(){if(oO)return ey;oO=1;var t=an(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return ey=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},ey}var ty,sO;function GB(){if(sO)return ty;sO=1;var t=fn(),e=Rw();return ty=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),ty}var ny,aO;function qB(){if(aO)return ny;aO=1;var t=oh(),e=YB(),n=GB(),r=Error.captureStackTrace;return ny=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},ny}var ry,lO;function KB(){if(lO)return ry;lO=1;var t=rh(),e=xi(),n=oh(),r=Of(),i=ck(),o=lk(),s=WB(),a=BB(),l=UB(),u=zB(),c=qB(),h=Ii(),d=Ya();return ry=function(f,m,p,y){var T="stackTraceLimit",b=y?2:1,M=f.split("."),R=M[M.length-1],k=t.apply(null,M);if(k){var P=k.prototype;if(!d&&e(P,"cause")&&delete P.cause,!p)return k;var O=t("Error"),U=m(function(G,V){var Z=l(y?V:G,void 0),z=y?new k(G):new k;return Z!==void 0&&n(z,"message",Z),c(z,U,z.stack,2),this&&r(P,this)&&a(z,this,U),arguments.length>b&&u(z,arguments[b]),z});if(U.prototype=P,R!=="Error"?i?i(U,O):o(U,O,{name:!0}):h&&T in k&&(s(U,k,T),s(U,k,"prepareStackTrace")),o(U,k),!d)try{P.name!==R&&n(P,"name",R),P.constructor=U}catch{}return U}},ry}var uO;function XB(){if(uO)return DP;uO=1;var t=Et(),e=sn(),n=Hf(),r=KB(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),DP}XB();var cO={},iy,hO;function dk(){if(hO)return iy;hO=1;var t=pu();return iy=Array.isArray||function(n){return t(n)==="Array"},iy}var oy,dO;function fk(){if(dO)return oy;dO=1;var t=Ii(),e=dk(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return oy=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},oy}var sy,fO;function gk(){if(fO)return sy;fO=1;var t=TypeError,e=9007199254740991;return sy=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},sy}var gO;function ZB(){if(gO)return cO;gO=1;var t=Et(),e=ih(),n=sh(),r=fk(),i=gk(),o=fn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),cO}ZB();var mO={},ay,pO;function QB(){if(pO)return ay;pO=1;var t=pu(),e=an();return ay=function(n){if(t(n)==="Function")return e(n)},ay}var ly,wO;function mk(){if(wO)return ly;wO=1;var t=QB(),e=Hr(),n=bw(),r=t(t.bind);return ly=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},ly}var uy,vO;function pk(){return vO||(vO=1,uy={}),uy}var cy,CO;function JB(){if(CO)return cy;CO=1;var t=lo(),e=pk(),n=t("iterator"),r=Array.prototype;return cy=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},cy}var hy,yO;function c0(){if(yO)return hy;yO=1;var t=hk(),e=xf(),n=e0(),r=pk(),i=lo(),o=i("iterator");return hy=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},hy}var dy,SO;function ej(){if(SO)return dy;SO=1;var t=gn(),e=Hr(),n=pn(),r=Tw(),i=c0(),o=TypeError;return dy=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},dy}var fy,bO;function Nr(){if(bO)return fy;bO=1;var t=gn(),e=pn(),n=xf();return fy=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},fy}var gy,RO;function ah(){if(RO)return gy;RO=1;var t=mk(),e=gn(),n=pn(),r=Tw(),i=JB(),o=sh(),s=Of(),a=ej(),l=c0(),u=Nr(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return gy=function(f,m,p){var y=p&&p.that,T=!!(p&&p.AS_ENTRIES),b=!!(p&&p.IS_RECORD),M=!!(p&&p.IS_ITERATOR),R=!!(p&&p.INTERRUPTED),k=t(m,y),P,O,U,G,V,Z,z,ue=function(K){return P&&u(P,"normal"),new h(!0,K)},ee=function(K){return T?(n(K),R?k(K[0],K[1],ue):k(K[0],K[1])):R?k(K,ue):k(K)};if(b)P=f.iterator;else if(M)P=f;else{if(O=l(f),!O)throw new c(r(f)+" is not iterable");if(i(O)){for(U=0,G=o(f);G>U;U++)if(V=ee(f[U]),V&&s(d,V))return V;return new h(!1)}P=a(f,O)}for(Z=b?f.next:P.next;!(z=e(Z,P)).done;){try{V=ee(z.value)}catch(K){u(P,"throw",K)}if(typeof V=="object"&&V&&s(d,V))return V}return new h(!1)},gy}var my,EO;function wk(){if(EO)return my;EO=1;var t=Ii(),e=Ga(),n=Rw();return my=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},my}var TO;function tj(){if(TO)return mO;TO=1;var t=Et(),e=ah(),n=wk();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),mO}tj();var _O={},py,MO;function Ko(){if(MO)return py;MO=1;var t=an(),e=Set.prototype;return py={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},py}var wy,PO;function wu(){if(PO)return wy;PO=1;var t=Ko().has;return wy=function(e){return t(e),e},wy}var vy,IO;function vu(){if(IO)return vy;IO=1;var t=gn();return vy=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},vy}var Cy,OO;function Nf(){if(OO)return Cy;OO=1;var t=an(),e=vu(),n=Ko(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return Cy=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Cy}var yy,xO;function h0(){if(xO)return yy;xO=1;var t=Ko(),e=Nf(),n=t.Set,r=t.add;return yy=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},yy}var Sy,AO;function Df(){if(AO)return Sy;AO=1;var t=uk(),e=Ko();return Sy=t(e.proto,"size","get")||function(n){return n.size},Sy}var by,HO;function Xo(){return HO||(HO=1,by=function(t){return{iterator:t,next:t.next,done:!1}}),by}var Ry,NO;function Cu(){if(NO)return Ry;NO=1;var t=Hr(),e=pn(),n=gn(),r=Af(),i=Xo(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},Ry=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},Ry}var Ey,DO;function nj(){if(DO)return Ey;DO=1;var t=wu(),e=Ko(),n=h0(),r=Df(),i=Cu(),o=Nf(),s=vu(),a=e.has,l=e.remove;return Ey=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(m){d.includes(m)&&l(f,m)}):s(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},Ey}var Ty,kO;function yu(){if(kO)return Ty;kO=1;var t=rh(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return Ty=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},Ty}var LO;function rj(){if(LO)return _O;LO=1;var t=Et(),e=nj(),n=fn(),r=yu(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),_O}rj();var $O={},_y,FO;function ij(){if(FO)return _y;FO=1;var t=wu(),e=Ko(),n=Df(),r=Cu(),i=Nf(),o=vu(),s=e.Set,a=e.add,l=e.has;return _y=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},_y}var VO;function oj(){if(VO)return $O;VO=1;var t=Et(),e=fn(),n=ij(),r=yu(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),$O}oj();var WO={},My,BO;function sj(){if(BO)return My;BO=1;var t=wu(),e=Ko().has,n=Df(),r=Cu(),i=Nf(),o=vu(),s=Nr();return My=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},My}var jO;function aj(){if(jO)return WO;jO=1;var t=Et(),e=sj(),n=yu(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),WO}aj();var UO={},Py,zO;function lj(){if(zO)return Py;zO=1;var t=wu(),e=Df(),n=Nf(),r=Cu();return Py=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Py}var YO;function uj(){if(YO)return UO;YO=1;var t=Et(),e=lj(),n=yu(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),UO}uj();var GO={},Iy,qO;function cj(){if(qO)return Iy;qO=1;var t=wu(),e=Ko().has,n=Df(),r=Cu(),i=vu(),o=Nr();return Iy=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Iy}var KO;function hj(){if(KO)return GO;KO=1;var t=Et(),e=cj(),n=yu(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),GO}hj();var XO={},Oy,ZO;function dj(){if(ZO)return Oy;ZO=1;var t=wu(),e=Ko(),n=h0(),r=Cu(),i=vu(),o=e.add,s=e.has,a=e.remove;return Oy=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},Oy}var xy,QO;function vk(){return QO||(QO=1,xy=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),xy}var JO;function fj(){if(JO)return XO;JO=1;var t=Et(),e=dj(),n=vk(),r=yu(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),XO}fj();var ex={},Ay,tx;function gj(){if(tx)return Ay;tx=1;var t=wu(),e=Ko().add,n=h0(),r=Cu(),i=vu();return Ay=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},Ay}var nx;function mj(){if(nx)return ex;nx=1;var t=Et(),e=gj(),n=vk(),r=yu(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),ex}mj();var rx={},ix={},Hy,ox;function pj(){if(ox)return Hy;ox=1;var t=Of(),e=TypeError;return Hy=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},Hy}var Ny,sx;function wj(){if(sx)return Ny;sx=1;var t=fn();return Ny=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Ny}var Dy,ax;function Ck(){if(ax)return Dy;ax=1;var t=xi(),e=mn(),n=ih(),r=s0(),i=wj(),o=r("IE_PROTO"),s=Object,a=s.prototype;return Dy=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Dy}var ky,lx;function vj(){if(lx)return ky;lx=1;var t=sk(),e=Ga();return ky=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},ky}var Ly={},$y,ux;function Cj(){if(ux)return $y;ux=1;var t=ak(),e=u0();return $y=Object.keys||function(r){return t(r,e)},$y}var cx;function yj(){if(cx)return Ly;cx=1;var t=Ii(),e=ik(),n=Ga(),r=pn(),i=If(),o=Cj();return Ly.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},Ly}var Fy,hx;function yk(){if(hx)return Fy;hx=1;var t=rh();return Fy=t("document","documentElement"),Fy}var Vy,dx;function d0(){if(dx)return Vy;dx=1;var t=pn(),e=yj(),n=u0(),r=a0(),i=yk(),o=o0(),s=s0(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(b){return l+c+a+b+l+"/"+c+a},m=function(b){b.write(f("")),b.close();var M=b.parentWindow.Object;return b=null,M},p=function(){var b=o("iframe"),M="java"+c+":",R;return b.style.display="none",i.appendChild(b),b.src=String(M),R=b.contentWindow.document,R.open(),R.write(f("document.F=Object")),R.close(),R.F},y,T=function(){try{y=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&y?m(y):p():m(y);for(var b=n.length;b--;)delete T[u][n[b]];return T()};return r[h]=!0,Vy=Object.create||function(M,R){var k;return M!==null?(d[u]=t(M),k=new d,d[u]=null,k[h]=M):k=T(),R===void 0?k:e.f(k,R)},Vy}var Wy,fx;function Sk(){if(fx)return Wy;fx=1;var t=fn(),e=mn(),n=Oi(),r=d0(),i=Ck(),o=l0(),s=lo(),a=Ya(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),Wy={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Wy}var gx;function Sj(){if(gx)return ix;gx=1;var t=Et(),e=sn(),n=pj(),r=pn(),i=mn(),o=Ck(),s=vj(),a=wk(),l=fn(),u=xi(),c=lo(),h=Sk().IteratorPrototype,d=Ii(),f=Ya(),m="constructor",p="Iterator",y=c("toStringTag"),T=TypeError,b=e[p],M=f||!i(b)||b.prototype!==h||!l(function(){b({})}),R=function(){if(n(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},k=function(P,O){d?s(h,P,{configurable:!0,get:function(){return O},set:function(U){if(r(this),this===h)throw new T("You can't redefine this property");u(this,P)?this[P]=U:a(this,P,U)}}):h[P]=O};return u(h,y)||k(y,p),(M||!u(h,m)||h[m]===Object)&&k(m,R),R.prototype=h,t({global:!0,constructor:!0,forced:M},{Iterator:R}),ix}var mx;function bj(){return mx||(mx=1,Sj()),rx}bj();var px={},wx={},By,vx;function Rj(){if(vx)return By;vx=1;var t=l0();return By=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},By}var jy,Cx;function Ej(){return Cx||(Cx=1,jy=function(t,e){return{value:t,done:e}}),jy}var Uy,yx;function Tj(){if(yx)return Uy;yx=1;var t=Nr();return Uy=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},Uy}var zy,Sx;function f0(){if(Sx)return zy;Sx=1;var t=gn(),e=d0(),n=oh(),r=Rj(),i=lo(),o=ok(),s=xf(),a=Sk().IteratorPrototype,l=Ej(),u=Nr(),c=Tj(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",m="normal",p="throw",y=o.set,T=function(R){var k=o.getterFor(R?f:d);return r(e(a),{next:function(){var O=k(this);if(R)return O.nextHandler();if(O.done)return l(void 0,!0);try{var U=O.nextHandler();return O.returnHandlerResult?U:l(U,O.done)}catch(G){throw O.done=!0,G}},return:function(){var P=k(this),O=P.iterator;if(P.done=!0,R){var U=s(O,"return");return U?t(U,O):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,m)}catch(G){return u(O,p,G)}if(P.openIters)try{c(P.openIters,m)}catch(G){return u(O,p,G)}return O&&u(O,m),l(void 0,!0)}})},b=T(!0),M=T(!1);return n(M,h,"Iterator Helper"),zy=function(R,k,P){var O=function(G,V){V?(V.iterator=G.iterator,V.next=G.next):V=G,V.type=k?f:d,V.returnHandlerResult=!!P,V.nextHandler=R,V.counter=0,V.done=!1,y(this,V)};return O.prototype=k?b:M,O},zy}var Yy,bx;function bk(){if(bx)return Yy;bx=1;var t=pn(),e=Nr();return Yy=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},Yy}var Gy,Rx;function g0(){return Rx||(Rx=1,Gy=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),Gy}var qy,Ex;function qa(){if(Ex)return qy;Ex=1;var t=sn();return qy=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},qy}var Tx;function _j(){if(Tx)return wx;Tx=1;var t=Et(),e=gn(),n=Hr(),r=pn(),i=Xo(),o=f0(),s=bk(),a=Ya(),l=Nr(),u=g0(),c=qa(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,m=o(function(){for(var p=this.iterator,y=this.predicate,T=this.next,b,M,R;;){if(b=r(e(T,p)),M=this.done=!!b.done,M)return;if(R=b.value,s(p,y,[R,this.counter++],!0))return R}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(y){r(this);try{n(y)}catch(T){l(this,"throw",T)}return d?e(d,this,y):new m(i(this),{predicate:y})}}),wx}var _x;function Mj(){return _x||(_x=1,_j()),px}Mj();var Mx={},Px={},Ix;function Pj(){if(Ix)return Px;Ix=1;var t=Et(),e=gn(),n=ah(),r=Hr(),i=pn(),o=Xo(),s=Nr(),a=qa(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),Px}var Ox;function Ij(){return Ox||(Ox=1,Pj()),Mx}Ij();var xx={},Ax={},Hx;function Oj(){if(Hx)return Ax;Hx=1;var t=Et(),e=gn(),n=Hr(),r=pn(),i=Xo(),o=f0(),s=bk(),a=Nr(),l=g0(),u=qa(),c=Ya(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,m=o(function(){var p=this.iterator,y=r(e(this.next,p)),T=this.done=!!y.done;if(!T)return s(p,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(y){r(this);try{n(y)}catch(T){a(this,"throw",T)}return d?e(d,this,y):new m(i(this),{mapper:y})}}),Ax}var Nx;function xj(){return Nx||(Nx=1,Oj()),xx}xj();var Dx={},kx={},Ky,Lx;function m0(){if(Lx)return Ky;Lx=1;var t=an();return Ky=t([].slice),Ky}var Xy,$x;function Rk(){if($x)return Xy;$x=1;var t=TypeError;return Xy=function(e,n){if(e<n)throw new t("Not enough arguments");return e},Xy}var Zy,Fx;function Aj(){if(Fx)return Zy;Fx=1;var t=Ew();return Zy=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Zy}var Qy,Vx;function Ek(){if(Vx)return Qy;Vx=1;var t=sn(),e=Ew(),n=pu(),r=function(i){return e.slice(0,i.length)===i};return Qy=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Qy}var Jy,Wx;function Hj(){if(Wx)return Jy;Wx=1;var t=Ek();return Jy=t==="NODE",Jy}var eS,Bx;function Tk(){if(Bx)return eS;Bx=1;var t=sn(),e=Hf(),n=mk(),r=mn(),i=xi(),o=fn(),s=yk(),a=m0(),l=o0(),u=Rk(),c=Aj(),h=Hj(),d=t.setImmediate,f=t.clearImmediate,m=t.process,p=t.Dispatch,y=t.Function,T=t.MessageChannel,b=t.String,M=0,R={},k="onreadystatechange",P,O,U,G;o(function(){P=t.location});var V=function(ee){if(i(R,ee)){var K=R[ee];delete R[ee],K()}},Z=function(ee){return function(){V(ee)}},z=function(ee){V(ee.data)},ue=function(ee){t.postMessage(b(ee),P.protocol+"//"+P.host)};return(!d||!f)&&(d=function(K){u(arguments.length,1);var ne=r(K)?K:y(K),ge=a(arguments,1);return R[++M]=function(){e(ne,void 0,ge)},O(M),M},f=function(K){delete R[K]},h?O=function(ee){m.nextTick(Z(ee))}:p&&p.now?O=function(ee){p.now(Z(ee))}:T&&!c?(U=new T,G=U.port2,U.port1.onmessage=z,O=n(G.postMessage,G)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(ue)?(O=ue,t.addEventListener("message",z,!1)):k in l("script")?O=function(ee){s.appendChild(l("script"))[k]=function(){s.removeChild(this),V(ee)}}:O=function(ee){setTimeout(Z(ee),0)}),eS={set:d,clear:f},eS}var jx;function Nj(){if(jx)return kx;jx=1;var t=Et(),e=sn(),n=Tk().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),kx}var Ux={},tS,zx;function Dj(){if(zx)return tS;zx=1;var t=sn(),e=Hf(),n=mn(),r=Ek(),i=Ew(),o=m0(),s=Rk(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return tS=function(u,c){var h=c?2:1;return l?function(d,f){var m=s(arguments.length,1)>h,p=n(d)?d:a(d),y=m?o(arguments,h):[],T=m?function(){e(p,this,y)}:p;return c?u(T,f):u(T)}:u},tS}var Yx;function kj(){if(Yx)return Ux;Yx=1;var t=Et(),e=sn(),n=Tk().set,r=Dj(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Ux}var Gx;function Lj(){return Gx||(Gx=1,Nj(),kj()),Dx}Lj();/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:_k,setPrototypeOf:qx,isFrozen:$j,getPrototypeOf:Fj,getOwnPropertyDescriptor:Vj}=Object;let{freeze:hr,seal:Mi,create:GR}=Object,{apply:qR,construct:KR}=typeof Reflect<"u"&&Reflect;hr||(hr=function(e){return e});Mi||(Mi=function(e){return e});qR||(qR=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return e.apply(n,i)});KR||(KR=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new e(...r)});const ag=dr(Array.prototype.forEach),Wj=dr(Array.prototype.lastIndexOf),Kx=dr(Array.prototype.pop),bh=dr(Array.prototype.push),Bj=dr(Array.prototype.splice),jm=dr(String.prototype.toLowerCase),nS=dr(String.prototype.toString),rS=dr(String.prototype.match),Rh=dr(String.prototype.replace),jj=dr(String.prototype.indexOf),Uj=dr(String.prototype.trim),Gi=dr(Object.prototype.hasOwnProperty),er=dr(RegExp.prototype.test),Eh=zj(TypeError);function dr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return qR(t,e,r)}}function zj(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return KR(t,n)}}function Ze(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jm;qx&&qx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&($j(e)||(e[r]=o),i=o)}t[i]=!0}return t}function Yj(t){for(let e=0;e<t.length;e++)Gi(t,e)||(t[e]=null);return t}function ws(t){const e=GR(null);for(const[n,r]of _k(t))Gi(t,n)&&(Array.isArray(r)?e[n]=Yj(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ws(r):e[n]=r);return e}function Th(t,e){for(;t!==null;){const r=Vj(t,e);if(r){if(r.get)return dr(r.get);if(typeof r.value=="function")return dr(r.value)}t=Fj(t)}function n(){return null}return n}const Xx=hr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),iS=hr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),oS=hr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Gj=hr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),sS=hr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),qj=hr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Zx=hr(["#text"]),Qx=hr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),aS=hr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Jx=hr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lg=hr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Kj=Mi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Xj=Mi(/<%[\w\W]*|[\w\W]*%>/gm),Zj=Mi(/\$\{[\w\W]*/gm),Qj=Mi(/^data-[\-\w.\u00B7-\uFFFF]+$/),Jj=Mi(/^aria-[\-\w]+$/),Mk=Mi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),eU=Mi(/^(?:\w+script|data):/i),tU=Mi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Pk=Mi(/^html$/i),nU=Mi(/^[a-z][.\w]*(-[.\w]+)+$/i);var eA=Object.freeze({__proto__:null,ARIA_ATTR:Jj,ATTR_WHITESPACE:tU,CUSTOM_ELEMENT:nU,DATA_ATTR:Qj,DOCTYPE_NAME:Pk,ERB_EXPR:Xj,IS_ALLOWED_URI:Mk,IS_SCRIPT_OR_DATA:eU,MUSTACHE_EXPR:Kj,TMPLIT_EXPR:Zj});const _h={element:1,text:3,progressingInstruction:7,comment:8,document:9},rU=function(){return typeof window>"u"?null:window},iU=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},tA=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ik(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rU();const e=Se=>Ik(Se);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==_h.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,p=Th(m,"cloneNode"),y=Th(m,"remove"),T=Th(m,"nextSibling"),b=Th(m,"childNodes"),M=Th(m,"parentNode");if(typeof s=="function"){const Se=n.createElement("template");Se.content&&Se.content.ownerDocument&&(n=Se.content.ownerDocument)}let R,k="";const{implementation:P,createNodeIterator:O,createDocumentFragment:U,getElementsByTagName:G}=n,{importNode:V}=r;let Z=tA();e.isSupported=typeof _k=="function"&&typeof M=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:ue,TMPLIT_EXPR:ee,DATA_ATTR:K,ARIA_ATTR:ne,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:Ce,CUSTOM_ELEMENT:ye}=eA;let{IS_ALLOWED_URI:Me}=eA,We=null;const Tt=Ze({},[...Xx,...iS,...oS,...sS,...Zx]);let _e=null;const g=Ze({},[...Qx,...aS,...Jx,...lg]);let w=Object.seal(GR(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,L=null;const D=Object.seal(GR(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let j=!0,v=!0,S=!1,_=!0,x=!1,E=!0,H=!1,F=!1,A=!1,$=!1,B=!1,W=!1,q=!0,te=!1;const le="user-content-";let Pe=!0,Xe=!1,nt={},Ie=null;const Ae=Ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let et=null;const Nn=Ze({},["audio","video","img","source","image","track"]);let Dr=null;const kr=Ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_n="http://www.w3.org/1998/Math/MathML",Lr="http://www.w3.org/2000/svg",_t="http://www.w3.org/1999/xhtml";let ot=_t,ct=!1,co=null;const Qa=Ze({},[_n,Lr,_t],nS);let Ys=Ze({},["mi","mo","mn","ms","mtext"]),Jn=Ze({},["annotation-xml"]);const $r=Ze({},["title","style","font","a","script"]);let Gs=null;const sg=["application/xhtml+xml","text/html"],nB="text/html";let Mn=null,Tu=null;const rB=n.createElement("form"),yP=function(N){return N instanceof RegExp||N instanceof Function},Tv=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Tu&&Tu===N)){if((!N||typeof N!="object")&&(N={}),N=ws(N),Gs=sg.indexOf(N.PARSER_MEDIA_TYPE)===-1?nB:N.PARSER_MEDIA_TYPE,Mn=Gs==="application/xhtml+xml"?nS:jm,We=Gi(N,"ALLOWED_TAGS")?Ze({},N.ALLOWED_TAGS,Mn):Tt,_e=Gi(N,"ALLOWED_ATTR")?Ze({},N.ALLOWED_ATTR,Mn):g,co=Gi(N,"ALLOWED_NAMESPACES")?Ze({},N.ALLOWED_NAMESPACES,nS):Qa,Dr=Gi(N,"ADD_URI_SAFE_ATTR")?Ze(ws(kr),N.ADD_URI_SAFE_ATTR,Mn):kr,et=Gi(N,"ADD_DATA_URI_TAGS")?Ze(ws(Nn),N.ADD_DATA_URI_TAGS,Mn):Nn,Ie=Gi(N,"FORBID_CONTENTS")?Ze({},N.FORBID_CONTENTS,Mn):Ae,C=Gi(N,"FORBID_TAGS")?Ze({},N.FORBID_TAGS,Mn):ws({}),L=Gi(N,"FORBID_ATTR")?Ze({},N.FORBID_ATTR,Mn):ws({}),nt=Gi(N,"USE_PROFILES")?N.USE_PROFILES:!1,j=N.ALLOW_ARIA_ATTR!==!1,v=N.ALLOW_DATA_ATTR!==!1,S=N.ALLOW_UNKNOWN_PROTOCOLS||!1,_=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=N.SAFE_FOR_TEMPLATES||!1,E=N.SAFE_FOR_XML!==!1,H=N.WHOLE_DOCUMENT||!1,$=N.RETURN_DOM||!1,B=N.RETURN_DOM_FRAGMENT||!1,W=N.RETURN_TRUSTED_TYPE||!1,A=N.FORCE_BODY||!1,q=N.SANITIZE_DOM!==!1,te=N.SANITIZE_NAMED_PROPS||!1,Pe=N.KEEP_CONTENT!==!1,Xe=N.IN_PLACE||!1,Me=N.ALLOWED_URI_REGEXP||Mk,ot=N.NAMESPACE||_t,Ys=N.MATHML_TEXT_INTEGRATION_POINTS||Ys,Jn=N.HTML_INTEGRATION_POINTS||Jn,w=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&yP(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(w.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&yP(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(w.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(w.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(v=!1),B&&($=!0),nt&&(We=Ze({},Zx),_e=[],nt.html===!0&&(Ze(We,Xx),Ze(_e,Qx)),nt.svg===!0&&(Ze(We,iS),Ze(_e,aS),Ze(_e,lg)),nt.svgFilters===!0&&(Ze(We,oS),Ze(_e,aS),Ze(_e,lg)),nt.mathMl===!0&&(Ze(We,sS),Ze(_e,Jx),Ze(_e,lg))),N.ADD_TAGS&&(typeof N.ADD_TAGS=="function"?D.tagCheck=N.ADD_TAGS:(We===Tt&&(We=ws(We)),Ze(We,N.ADD_TAGS,Mn))),N.ADD_ATTR&&(typeof N.ADD_ATTR=="function"?D.attributeCheck=N.ADD_ATTR:(_e===g&&(_e=ws(_e)),Ze(_e,N.ADD_ATTR,Mn))),N.ADD_URI_SAFE_ATTR&&Ze(Dr,N.ADD_URI_SAFE_ATTR,Mn),N.FORBID_CONTENTS&&(Ie===Ae&&(Ie=ws(Ie)),Ze(Ie,N.FORBID_CONTENTS,Mn)),Pe&&(We["#text"]=!0),H&&Ze(We,["html","head","body"]),We.table&&(Ze(We,["tbody"]),delete C.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw Eh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Eh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=N.TRUSTED_TYPES_POLICY,k=R.createHTML("")}else R===void 0&&(R=iU(f,i)),R!==null&&typeof k=="string"&&(k=R.createHTML(""));hr&&hr(N),Tu=N}},SP=Ze({},[...iS,...oS,...Gj]),bP=Ze({},[...sS,...qj]),iB=function(N){let J=M(N);(!J||!J.tagName)&&(J={namespaceURI:ot,tagName:"template"});const pe=jm(N.tagName),At=jm(J.tagName);return co[N.namespaceURI]?N.namespaceURI===Lr?J.namespaceURI===_t?pe==="svg":J.namespaceURI===_n?pe==="svg"&&(At==="annotation-xml"||Ys[At]):!!SP[pe]:N.namespaceURI===_n?J.namespaceURI===_t?pe==="math":J.namespaceURI===Lr?pe==="math"&&Jn[At]:!!bP[pe]:N.namespaceURI===_t?J.namespaceURI===Lr&&!Jn[At]||J.namespaceURI===_n&&!Ys[At]?!1:!bP[pe]&&($r[pe]||!SP[pe]):!!(Gs==="application/xhtml+xml"&&co[N.namespaceURI]):!1},ho=function(N){bh(e.removed,{element:N});try{M(N).removeChild(N)}catch{y(N)}},Ja=function(N,J){try{bh(e.removed,{attribute:J.getAttributeNode(N),from:J})}catch{bh(e.removed,{attribute:null,from:J})}if(J.removeAttribute(N),N==="is")if($||B)try{ho(J)}catch{}else try{J.setAttribute(N,"")}catch{}},RP=function(N){let J=null,pe=null;if(A)N="<remove></remove>"+N;else{const un=rS(N,/^[\r\n\t ]+/);pe=un&&un[0]}Gs==="application/xhtml+xml"&&ot===_t&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const At=R?R.createHTML(N):N;if(ot===_t)try{J=new d().parseFromString(At,Gs)}catch{}if(!J||!J.documentElement){J=P.createDocument(ot,"template",null);try{J.documentElement.innerHTML=ct?k:At}catch{}}const Fn=J.body||J.documentElement;return N&&pe&&Fn.insertBefore(n.createTextNode(pe),Fn.childNodes[0]||null),ot===_t?G.call(J,H?"html":"body")[0]:H?J.documentElement:Fn},EP=function(N){return O.call(N.ownerDocument||N,N,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},_v=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},TP=function(N){return typeof a=="function"&&N instanceof a};function ns(Se,N,J){ag(Se,pe=>{pe.call(e,N,J,Tu)})}const _P=function(N){let J=null;if(ns(Z.beforeSanitizeElements,N,null),_v(N))return ho(N),!0;const pe=Mn(N.nodeName);if(ns(Z.uponSanitizeElement,N,{tagName:pe,allowedTags:We}),E&&N.hasChildNodes()&&!TP(N.firstElementChild)&&er(/<[/\w!]/g,N.innerHTML)&&er(/<[/\w!]/g,N.textContent)||N.nodeType===_h.progressingInstruction||E&&N.nodeType===_h.comment&&er(/<[/\w]/g,N.data))return ho(N),!0;if(!(D.tagCheck instanceof Function&&D.tagCheck(pe))&&(!We[pe]||C[pe])){if(!C[pe]&&PP(pe)&&(w.tagNameCheck instanceof RegExp&&er(w.tagNameCheck,pe)||w.tagNameCheck instanceof Function&&w.tagNameCheck(pe)))return!1;if(Pe&&!Ie[pe]){const At=M(N)||N.parentNode,Fn=b(N)||N.childNodes;if(Fn&&At){const un=Fn.length;for(let gr=un-1;gr>=0;--gr){const rs=p(Fn[gr],!0);rs.__removalCount=(N.__removalCount||0)+1,At.insertBefore(rs,T(N))}}}return ho(N),!0}return N instanceof l&&!iB(N)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&er(/<\/no(script|embed|frames)/i,N.innerHTML)?(ho(N),!0):(x&&N.nodeType===_h.text&&(J=N.textContent,ag([z,ue,ee],At=>{J=Rh(J,At," ")}),N.textContent!==J&&(bh(e.removed,{element:N.cloneNode()}),N.textContent=J)),ns(Z.afterSanitizeElements,N,null),!1)},MP=function(N,J,pe){if(q&&(J==="id"||J==="name")&&(pe in n||pe in rB))return!1;if(!(v&&!L[J]&&er(K,J))){if(!(j&&er(ne,J))){if(!(D.attributeCheck instanceof Function&&D.attributeCheck(J,N))){if(!_e[J]||L[J]){if(!(PP(N)&&(w.tagNameCheck instanceof RegExp&&er(w.tagNameCheck,N)||w.tagNameCheck instanceof Function&&w.tagNameCheck(N))&&(w.attributeNameCheck instanceof RegExp&&er(w.attributeNameCheck,J)||w.attributeNameCheck instanceof Function&&w.attributeNameCheck(J,N))||J==="is"&&w.allowCustomizedBuiltInElements&&(w.tagNameCheck instanceof RegExp&&er(w.tagNameCheck,pe)||w.tagNameCheck instanceof Function&&w.tagNameCheck(pe))))return!1}else if(!Dr[J]){if(!er(Me,Rh(pe,Ce,""))){if(!((J==="src"||J==="xlink:href"||J==="href")&&N!=="script"&&jj(pe,"data:")===0&&et[N])){if(!(S&&!er(ge,Rh(pe,Ce,"")))){if(pe)return!1}}}}}}}return!0},PP=function(N){return N!=="annotation-xml"&&rS(N,ye)},IP=function(N){ns(Z.beforeSanitizeAttributes,N,null);const{attributes:J}=N;if(!J||_v(N))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_e,forceKeepAttr:void 0};let At=J.length;for(;At--;){const Fn=J[At],{name:un,namespaceURI:gr,value:rs}=Fn,_u=Mn(un),Mv=rs;let Dn=un==="value"?Mv:Uj(Mv);if(pe.attrName=_u,pe.attrValue=Dn,pe.keepAttr=!0,pe.forceKeepAttr=void 0,ns(Z.uponSanitizeAttribute,N,pe),Dn=pe.attrValue,te&&(_u==="id"||_u==="name")&&(Ja(un,N),Dn=le+Dn),E&&er(/((--!?|])>)|<\/(style|title|textarea)/i,Dn)){Ja(un,N);continue}if(_u==="attributename"&&rS(Dn,"href")){Ja(un,N);continue}if(pe.forceKeepAttr)continue;if(!pe.keepAttr){Ja(un,N);continue}if(!_&&er(/\/>/i,Dn)){Ja(un,N);continue}x&&ag([z,ue,ee],xP=>{Dn=Rh(Dn,xP," ")});const OP=Mn(N.nodeName);if(!MP(OP,_u,Dn)){Ja(un,N);continue}if(R&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!gr)switch(f.getAttributeType(OP,_u)){case"TrustedHTML":{Dn=R.createHTML(Dn);break}case"TrustedScriptURL":{Dn=R.createScriptURL(Dn);break}}if(Dn!==Mv)try{gr?N.setAttributeNS(gr,un,Dn):N.setAttribute(un,Dn),_v(N)?ho(N):Kx(e.removed)}catch{Ja(un,N)}}ns(Z.afterSanitizeAttributes,N,null)},oB=function Se(N){let J=null;const pe=EP(N);for(ns(Z.beforeSanitizeShadowDOM,N,null);J=pe.nextNode();)ns(Z.uponSanitizeShadowNode,J,null),_P(J),IP(J),J.content instanceof o&&Se(J.content);ns(Z.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(Se){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},J=null,pe=null,At=null,Fn=null;if(ct=!Se,ct&&(Se="<!-->"),typeof Se!="string"&&!TP(Se))if(typeof Se.toString=="function"){if(Se=Se.toString(),typeof Se!="string")throw Eh("dirty is not a string, aborting")}else throw Eh("toString is not a function");if(!e.isSupported)return Se;if(F||Tv(N),e.removed=[],typeof Se=="string"&&(Xe=!1),Xe){if(Se.nodeName){const rs=Mn(Se.nodeName);if(!We[rs]||C[rs])throw Eh("root node is forbidden and cannot be sanitized in-place")}}else if(Se instanceof a)J=RP("<!---->"),pe=J.ownerDocument.importNode(Se,!0),pe.nodeType===_h.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?J=pe:J.appendChild(pe);else{if(!$&&!x&&!H&&Se.indexOf("<")===-1)return R&&W?R.createHTML(Se):Se;if(J=RP(Se),!J)return $?null:W?k:""}J&&A&&ho(J.firstChild);const un=EP(Xe?Se:J);for(;At=un.nextNode();)_P(At),IP(At),At.content instanceof o&&oB(At.content);if(Xe)return Se;if($){if(B)for(Fn=U.call(J.ownerDocument);J.firstChild;)Fn.appendChild(J.firstChild);else Fn=J;return(_e.shadowroot||_e.shadowrootmode)&&(Fn=V.call(r,Fn,!0)),Fn}let gr=H?J.outerHTML:J.innerHTML;return H&&We["!doctype"]&&J.ownerDocument&&J.ownerDocument.doctype&&J.ownerDocument.doctype.name&&er(Pk,J.ownerDocument.doctype.name)&&(gr="<!DOCTYPE "+J.ownerDocument.doctype.name+`>
`+gr),x&&ag([z,ue,ee],rs=>{gr=Rh(gr,rs," ")}),R&&W?R.createHTML(gr):gr},e.setConfig=function(){let Se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Tv(Se),F=!0},e.clearConfig=function(){Tu=null,F=!1},e.isValidAttribute=function(Se,N,J){Tu||Tv({});const pe=Mn(Se),At=Mn(N);return MP(pe,At,J)},e.addHook=function(Se,N){typeof N=="function"&&bh(Z[Se],N)},e.removeHook=function(Se,N){if(N!==void 0){const J=Wj(Z[Se],N);return J===-1?void 0:Bj(Z[Se],J,1)[0]}return Kx(Z[Se])},e.removeHooks=function(Se){Z[Se]=[]},e.removeAllHooks=function(){Z=tA()},e}var oU=Ik();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var Ok;function X(){return Ok.apply(null,arguments)}function sU(t){Ok=t}function oo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ou(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function Er(t){return t===void 0}function Ls(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function kf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function xk(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ia(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Zo(t,e,n,r){return eL(t,e,n,r,!0).utc()}function aU(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Fe(t){return t._pf==null&&(t._pf=aU()),t._pf}var XR;Array.prototype.some?XR=Array.prototype.some:XR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function w0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Fe(t),n=XR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Mw(t){var e=Zo(NaN);return t!=null?Ia(Fe(e),t):Fe(e).userInvalidated=!0,e}var nA=X.momentProperties=[],lS=!1;function v0(t,e){var n,r,i,o=nA.length;if(Er(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Er(e._i)||(t._i=e._i),Er(e._f)||(t._f=e._f),Er(e._l)||(t._l=e._l),Er(e._strict)||(t._strict=e._strict),Er(e._tzm)||(t._tzm=e._tzm),Er(e._isUTC)||(t._isUTC=e._isUTC),Er(e._offset)||(t._offset=e._offset),Er(e._pf)||(t._pf=Fe(e)),Er(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=nA[n],i=e[r],Er(i)||(t[r]=i);return t}function Lf(t){v0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),lS===!1&&(lS=!0,X.updateOffset(this),lS=!1)}function so(t){return t instanceof Lf||t!=null&&t._isAMomentObject!=null}function Ak(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ai(t,e){var n=!0;return Ia(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}Ak(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var rA={};function Hk(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),rA[t]||(Ak(e),rA[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function Qo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function lU(t){var e,n;for(n in t)at(t,n)&&(e=t[n],Qo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ZR(t,e){var n=Ia({},t),r;for(r in e)at(e,r)&&(ou(t[r])&&ou(e[r])?(n[r]={},Ia(n[r],t[r]),Ia(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&ou(t[r])&&(n[r]=Ia({},n[r]));return n}function C0(t){t!=null&&this.set(t)}var QR;Object.keys?QR=Object.keys:QR=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var uU={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function cU(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Qo(r)?r.call(e,n):r}function Go(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var y0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ug=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,uS={},kc={};function Ee(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(kc[t]=i),e&&(kc[e[0]]=function(){return Go(i.apply(this,arguments),e[1],e[2])}),n&&(kc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function hU(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function dU(t){var e=t.match(y0),n,r;for(n=0,r=e.length;n<r;n++)kc[e[n]]?e[n]=kc[e[n]]:e[n]=hU(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Qo(e[s])?e[s].call(i,t):e[s];return o}}function Um(t,e){return t.isValid()?(e=Nk(e,t.localeData()),uS[e]=uS[e]||dU(e),uS[e](t)):t.localeData().invalidDate()}function Nk(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(ug.lastIndex=0;n>=0&&ug.test(t);)t=t.replace(ug,r),ug.lastIndex=0,n-=1;return t}var fU={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function gU(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(y0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var mU="Invalid date";function pU(){return this._invalidDate}var wU="%d",vU=/\d{1,2}/;function CU(t){return this._ordinal.replace("%d",t)}var yU={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function SU(t,e,n,r){var i=this._relativeTime[n];return Qo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function bU(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qo(n)?n(e):n.replace(/%s/i,e)}var iA={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Hi(t){return typeof t=="string"?iA[t]||iA[t.toLowerCase()]:void 0}function S0(t){var e={},n,r;for(r in t)at(t,r)&&(n=Hi(r),n&&(e[n]=t[r]));return e}var RU={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function EU(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:RU[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Dk=/\d/,si=/\d\d/,kk=/\d{3}/,b0=/\d{4}/,Pw=/[+-]?\d{6}/,xt=/\d\d?/,Lk=/\d\d\d\d?/,$k=/\d\d\d\d\d\d?/,Iw=/\d{1,3}/,R0=/\d{1,4}/,Ow=/[+-]?\d{1,6}/,lh=/\d+/,xw=/[+-]?\d+/,TU=/Z|[+-]\d\d:?\d\d/gi,Aw=/Z|[+-]\d\d(?::?\d\d)?/gi,_U=/[+-]?\d+(\.\d{1,3})?/,$f=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,uh=/^[1-9]\d?/,E0=/^([1-9]\d|\d)/,pp;pp={};function he(t,e,n){pp[t]=Qo(e)?e:function(r,i){return r&&n?n:e}}function MU(t,e){return at(pp,t)?pp[t](e._strict,e._locale):new RegExp(PU(t))}function PU(t){return Ds(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Ds(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ri(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Ri(e)),n}var JR={};function St(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ls(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)JR[t[n]]=r}function Ff(t,e){St(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function IU(t,e,n){e!=null&&at(JR,t)&&JR[t](e,n._a,n,t)}function Hw(t){return t%4===0&&t%100!==0||t%400===0}var Xn=0,Ps=1,Fo=2,En=3,no=4,Is=5,Xl=6,OU=7,xU=8;Ee("Y",0,0,function(){var t=this.year();return t<=9999?Go(t,4):"+"+t});Ee(0,["YY",2],0,function(){return this.year()%100});Ee(0,["YYYY",4],0,"year");Ee(0,["YYYYY",5],0,"year");Ee(0,["YYYYYY",6,!0],0,"year");he("Y",xw);he("YY",xt,si);he("YYYY",R0,b0);he("YYYYY",Ow,Pw);he("YYYYYY",Ow,Pw);St(["YYYYY","YYYYYY"],Xn);St("YYYY",function(t,e){e[Xn]=t.length===2?X.parseTwoDigitYear(t):Qe(t)});St("YY",function(t,e){e[Xn]=X.parseTwoDigitYear(t)});St("Y",function(t,e){e[Xn]=parseInt(t,10)});function Hd(t){return Hw(t)?366:365}X.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var Fk=ch("FullYear",!0);function AU(){return Hw(this.year())}function ch(t,e){return function(n){return n!=null?(Vk(this,t,n),X.updateOffset(this,e),this):sf(this,t)}}function sf(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Vk(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Hw(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function HU(t){return t=Hi(t),Qo(this[t])?this[t]():this}function NU(t,e){if(typeof t=="object"){t=S0(t);var n=EU(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Hi(t),Qo(this[t]))return this[t](e);return this}function DU(t,e){return(t%e+e)%e}var tn;Array.prototype.indexOf?tn=Array.prototype.indexOf:tn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function T0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=DU(e,12);return t+=(e-n)/12,n===1?Hw(t)?29:28:31-n%7%2}Ee("M",["MM",2],"Mo",function(){return this.month()+1});Ee("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ee("MMMM",0,0,function(t){return this.localeData().months(this,t)});he("M",xt,uh);he("MM",xt,si);he("MMM",function(t,e){return e.monthsShortRegex(t)});he("MMMM",function(t,e){return e.monthsRegex(t)});St(["M","MM"],function(t,e){e[Ps]=Qe(t)-1});St(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Ps]=i:Fe(n).invalidMonth=t});var kU="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Wk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Bk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,LU=$f,$U=$f;function FU(t,e){return t?oo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Bk).test(e)?"format":"standalone"][t.month()]:oo(this._months)?this._months:this._months.standalone}function VU(t,e){return t?oo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Bk.test(e)?"format":"standalone"][t.month()]:oo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function WU(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Zo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=tn.call(this._shortMonthsParse,s),i!==-1?i:null):(i=tn.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=tn.call(this._shortMonthsParse,s),i!==-1?i:(i=tn.call(this._longMonthsParse,s),i!==-1?i:null)):(i=tn.call(this._longMonthsParse,s),i!==-1?i:(i=tn.call(this._shortMonthsParse,s),i!==-1?i:null))}function BU(t,e,n){var r,i,o;if(this._monthsParseExact)return WU.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Zo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function jk(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ls(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,T0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function Uk(t){return t!=null?(jk(this,t),X.updateOffset(this,!0),this):sf(this,"Month")}function jU(){return T0(this.year(),this.month())}function UU(t){return this._monthsParseExact?(at(this,"_monthsRegex")||zk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=LU),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function zU(t){return this._monthsParseExact?(at(this,"_monthsRegex")||zk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=$U),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function zk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=Zo([2e3,i]),s=Ds(this.monthsShort(o,"")),a=Ds(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function YU(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function af(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function wp(t,e,n){var r=7+e-n,i=(7+af(t,0,r).getUTCDay()-e)%7;return-i+r-1}function Yk(t,e,n,r,i){var o=(7+n-r)%7,s=wp(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Hd(l)+a):a>Hd(t)?(l=t+1,u=a-Hd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function lf(t,e,n){var r=wp(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ks(s,e,n)):i>ks(t.year(),e,n)?(o=i-ks(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ks(t,e,n){var r=wp(t,e,n),i=wp(t+1,e,n);return(Hd(t)-r+i)/7}Ee("w",["ww",2],"wo","week");Ee("W",["WW",2],"Wo","isoWeek");he("w",xt,uh);he("ww",xt,si);he("W",xt,uh);he("WW",xt,si);Ff(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function GU(t){return lf(t,this._week.dow,this._week.doy).week}var qU={dow:0,doy:6};function KU(){return this._week.dow}function XU(){return this._week.doy}function ZU(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function QU(t){var e=lf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ee("d",0,"do","day");Ee("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ee("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ee("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ee("e",0,0,"weekday");Ee("E",0,0,"isoWeekday");he("d",xt);he("e",xt);he("E",xt);he("dd",function(t,e){return e.weekdaysMinRegex(t)});he("ddd",function(t,e){return e.weekdaysShortRegex(t)});he("dddd",function(t,e){return e.weekdaysRegex(t)});Ff(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Fe(n).invalidWeekday=t});Ff(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function JU(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function ez(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function _0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var tz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Gk="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),nz="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),rz=$f,iz=$f,oz=$f;function sz(t,e){var n=oo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?_0(n,this._week.dow):t?n[t.day()]:n}function az(t){return t===!0?_0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function lz(t){return t===!0?_0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function uz(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Zo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=tn.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=tn.call(this._weekdaysParse,s),i!==-1||(i=tn.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=tn.call(this._shortWeekdaysParse,s),i!==-1||(i=tn.call(this._weekdaysParse,s),i!==-1)?i:(i=tn.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=tn.call(this._minWeekdaysParse,s),i!==-1||(i=tn.call(this._weekdaysParse,s),i!==-1)?i:(i=tn.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function cz(t,e,n){var r,i,o;if(this._weekdaysParseExact)return uz.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Zo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function hz(t){if(!this.isValid())return t!=null?this:NaN;var e=sf(this,"Day");return t!=null?(t=JU(t,this.localeData()),this.add(t-e,"d")):e}function dz(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function fz(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=ez(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function gz(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||M0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=rz),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function mz(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||M0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=iz),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function pz(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||M0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=oz),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function M0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Zo([2e3,1]).day(o),a=Ds(this.weekdaysMin(s,"")),l=Ds(this.weekdaysShort(s,"")),u=Ds(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function P0(){return this.hours()%12||12}function wz(){return this.hours()||24}Ee("H",["HH",2],0,"hour");Ee("h",["hh",2],0,P0);Ee("k",["kk",2],0,wz);Ee("hmm",0,0,function(){return""+P0.apply(this)+Go(this.minutes(),2)});Ee("hmmss",0,0,function(){return""+P0.apply(this)+Go(this.minutes(),2)+Go(this.seconds(),2)});Ee("Hmm",0,0,function(){return""+this.hours()+Go(this.minutes(),2)});Ee("Hmmss",0,0,function(){return""+this.hours()+Go(this.minutes(),2)+Go(this.seconds(),2)});function qk(t,e){Ee(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}qk("a",!0);qk("A",!1);function Kk(t,e){return e._meridiemParse}he("a",Kk);he("A",Kk);he("H",xt,E0);he("h",xt,uh);he("k",xt,uh);he("HH",xt,si);he("hh",xt,si);he("kk",xt,si);he("hmm",Lk);he("hmmss",$k);he("Hmm",Lk);he("Hmmss",$k);St(["H","HH"],En);St(["k","kk"],function(t,e,n){var r=Qe(t);e[En]=r===24?0:r});St(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});St(["h","hh"],function(t,e,n){e[En]=Qe(t),Fe(n).bigHour=!0});St("hmm",function(t,e,n){var r=t.length-2;e[En]=Qe(t.substr(0,r)),e[no]=Qe(t.substr(r)),Fe(n).bigHour=!0});St("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[En]=Qe(t.substr(0,r)),e[no]=Qe(t.substr(r,2)),e[Is]=Qe(t.substr(i)),Fe(n).bigHour=!0});St("Hmm",function(t,e,n){var r=t.length-2;e[En]=Qe(t.substr(0,r)),e[no]=Qe(t.substr(r))});St("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[En]=Qe(t.substr(0,r)),e[no]=Qe(t.substr(r,2)),e[Is]=Qe(t.substr(i))});function vz(t){return(t+"").toLowerCase().charAt(0)==="p"}var Cz=/[ap]\.?m?\.?/i,yz=ch("Hours",!0);function Sz(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Xk={calendar:uU,longDateFormat:fU,invalidDate:mU,ordinal:wU,dayOfMonthOrdinalParse:vU,relativeTime:yU,months:kU,monthsShort:Wk,week:qU,weekdays:tz,weekdaysMin:nz,weekdaysShort:Gk,meridiemParse:Cz},kt={},Mh={},uf;function bz(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function oA(t){return t&&t.toLowerCase().replace("_","-")}function Rz(t){for(var e=0,n,r,i,o;e<t.length;){for(o=oA(t[e]).split("-"),n=o.length,r=oA(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Nw(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&bz(o,r)>=n-1)break;n--}e++}return uf}function Ez(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Nw(t){var e=null,n;if(kt[t]===void 0&&typeof module<"u"&&module&&module.exports&&Ez(t))try{e=uf._abbr,n=require,n("./locale/"+t),Da(e)}catch{kt[t]=null}return kt[t]}function Da(t,e){var n;return t&&(Er(e)?n=Ws(t):n=I0(t,e),n?uf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),uf._abbr}function I0(t,e){if(e!==null){var n,r=Xk;if(e.abbr=t,kt[t]!=null)Hk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=kt[t]._config;else if(e.parentLocale!=null)if(kt[e.parentLocale]!=null)r=kt[e.parentLocale]._config;else if(n=Nw(e.parentLocale),n!=null)r=n._config;else return Mh[e.parentLocale]||(Mh[e.parentLocale]=[]),Mh[e.parentLocale].push({name:t,config:e}),null;return kt[t]=new C0(ZR(r,e)),Mh[t]&&Mh[t].forEach(function(i){I0(i.name,i.config)}),Da(t),kt[t]}else return delete kt[t],null}function Tz(t,e){if(e!=null){var n,r,i=Xk;kt[t]!=null&&kt[t].parentLocale!=null?kt[t].set(ZR(kt[t]._config,e)):(r=Nw(t),r!=null&&(i=r._config),e=ZR(i,e),r==null&&(e.abbr=t),n=new C0(e),n.parentLocale=kt[t],kt[t]=n),Da(t)}else kt[t]!=null&&(kt[t].parentLocale!=null?(kt[t]=kt[t].parentLocale,t===Da()&&Da(t)):kt[t]!=null&&delete kt[t]);return kt[t]}function Ws(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return uf;if(!oo(t)){if(e=Nw(t),e)return e;t=[t]}return Rz(t)}function _z(){return QR(kt)}function O0(t){var e,n=t._a;return n&&Fe(t).overflow===-2&&(e=n[Ps]<0||n[Ps]>11?Ps:n[Fo]<1||n[Fo]>T0(n[Xn],n[Ps])?Fo:n[En]<0||n[En]>24||n[En]===24&&(n[no]!==0||n[Is]!==0||n[Xl]!==0)?En:n[no]<0||n[no]>59?no:n[Is]<0||n[Is]>59?Is:n[Xl]<0||n[Xl]>999?Xl:-1,Fe(t)._overflowDayOfYear&&(e<Xn||e>Fo)&&(e=Fo),Fe(t)._overflowWeeks&&e===-1&&(e=OU),Fe(t)._overflowWeekday&&e===-1&&(e=xU),Fe(t).overflow=e),t}var Mz=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Pz=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Iz=/Z|[+-]\d\d(?::?\d\d)?/,cg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],cS=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Oz=/^\/?Date\((-?\d+)/i,xz=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Az={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Zk(t){var e,n,r=t._i,i=Mz.exec(r)||Pz.exec(r),o,s,a,l,u=cg.length,c=cS.length;if(i){for(Fe(t).iso=!0,e=0,n=u;e<n;e++)if(cg[e][1].exec(i[1])){s=cg[e][0],o=cg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(cS[e][1].exec(i[3])){a=(i[2]||" ")+cS[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Iz.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),A0(t)}else t._isValid=!1}function Hz(t,e,n,r,i,o){var s=[Nz(t),Wk.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Nz(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Dz(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function kz(t,e,n){if(t){var r=Gk.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Fe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Lz(t,e,n){if(t)return Az[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function Qk(t){var e=xz.exec(Dz(t._i)),n;if(e){if(n=Hz(e[4],e[3],e[2],e[5],e[6],e[7]),!kz(e[1],n,t))return;t._a=n,t._tzm=Lz(e[8],e[9],e[10]),t._d=af.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Fe(t).rfc2822=!0}else t._isValid=!1}function $z(t){var e=Oz.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Zk(t),t._isValid===!1)delete t._isValid;else return;if(Qk(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=Ai("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function mc(t,e,n){return t??e??n}function Fz(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function x0(t){var e,n,r=[],i,o,s;if(!t._d){for(i=Fz(t),t._w&&t._a[Fo]==null&&t._a[Ps]==null&&Vz(t),t._dayOfYear!=null&&(s=mc(t._a[Xn],i[Xn]),(t._dayOfYear>Hd(s)||t._dayOfYear===0)&&(Fe(t)._overflowDayOfYear=!0),n=af(s,0,t._dayOfYear),t._a[Ps]=n.getUTCMonth(),t._a[Fo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[En]===24&&t._a[no]===0&&t._a[Is]===0&&t._a[Xl]===0&&(t._nextDay=!0,t._a[En]=0),t._d=(t._useUTC?af:YU).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[En]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Fe(t).weekdayMismatch=!0)}}function Vz(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=mc(e.GG,t._a[Xn],lf(Ot(),1,4).year),r=mc(e.W,1),i=mc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=lf(Ot(),o,s),n=mc(e.gg,t._a[Xn],u.year),r=mc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>ks(n,o,s)?Fe(t)._overflowWeeks=!0:l!=null?Fe(t)._overflowWeekday=!0:(a=Yk(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function A0(t){if(t._f===X.ISO_8601){Zk(t);return}if(t._f===X.RFC_2822){Qk(t);return}t._a=[],Fe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=Nk(t._f,t._locale).match(y0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(MU(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Fe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),kc[o]?(r?Fe(t).empty=!1:Fe(t).unusedTokens.push(o),IU(o,r,t)):t._strict&&!r&&Fe(t).unusedTokens.push(o);Fe(t).charsLeftOver=a-l,e.length>0&&Fe(t).unusedInput.push(e),t._a[En]<=12&&Fe(t).bigHour===!0&&t._a[En]>0&&(Fe(t).bigHour=void 0),Fe(t).parsedDateParts=t._a.slice(0),Fe(t).meridiem=t._meridiem,t._a[En]=Wz(t._locale,t._a[En],t._meridiem),u=Fe(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),x0(t),O0(t)}function Wz(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Bz(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Fe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=v0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],A0(e),w0(e)&&(s=!0),o+=Fe(e).charsLeftOver,o+=Fe(e).unusedTokens.length*10,Fe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ia(t,n||e)}function jz(t){if(!t._d){var e=S0(t._i),n=e.day===void 0?e.date:e.day;t._a=xk([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),x0(t)}}function Uz(t){var e=new Lf(O0(Jk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Jk(t){var e=t._i,n=t._f;return t._locale=t._locale||Ws(t._l),e===null||n===void 0&&e===""?Mw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),so(e)?new Lf(O0(e)):(kf(e)?t._d=e:oo(n)?Bz(t):n?A0(t):zz(t),w0(t)||(t._d=null),t))}function zz(t){var e=t._i;Er(e)?t._d=new Date(X.now()):kf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?$z(t):oo(e)?(t._a=xk(e.slice(0),function(n){return parseInt(n,10)}),x0(t)):ou(e)?jz(t):Ls(e)?t._d=new Date(e):X.createFromInputFallback(t)}function eL(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ou(t)&&p0(t)||oo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,Uz(o)}function Ot(t,e,n,r){return eL(t,e,n,r,!1)}var Yz=Ai("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Mw()}),Gz=Ai("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Mw()});function tL(t,e){var n,r;if(e.length===1&&oo(e[0])&&(e=e[0]),!e.length)return Ot();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function qz(){var t=[].slice.call(arguments,0);return tL("isBefore",t)}function Kz(){var t=[].slice.call(arguments,0);return tL("isAfter",t)}var Xz=function(){return Date.now?Date.now():+new Date},Ph=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Zz(t){var e,n=!1,r,i=Ph.length;for(e in t)if(at(t,e)&&!(tn.call(Ph,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Ph[r]]){if(n)return!1;parseFloat(t[Ph[r]])!==Qe(t[Ph[r]])&&(n=!0)}return!0}function Qz(){return this._isValid}function Jz(){return uo(NaN)}function Dw(t){var e=S0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Zz(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ws(),this._bubble()}function zm(t){return t instanceof Dw}function eE(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function eY(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Qe(t[s])!==Qe(e[s])&&o++;return o+i}function nL(t,e){Ee(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Go(~~(n/60),2)+e+Go(~~n%60,2)})}nL("Z",":");nL("ZZ","");he("Z",Aw);he("ZZ",Aw);St(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=H0(Aw,t)});var tY=/([\+\-]|\d\d)/gi;function H0(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(tY)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function N0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(so(t)||kf(t)?t.valueOf():Ot(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),X.updateOffset(n,!1),n):Ot(t).local()}function tE(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function nY(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=H0(Aw,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=tE(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?oL(this,uo(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:tE(this)}function rY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function iY(t){return this.utcOffset(0,t)}function oY(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(tE(this),"m")),this}function sY(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=H0(TU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function aY(t){return this.isValid()?(t=t?Ot(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function lY(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function uY(){if(!Er(this._isDSTShifted))return this._isDSTShifted;var t={},e;return v0(t,this),t=Jk(t),t._a?(e=t._isUTC?Zo(t._a):Ot(t._a),this._isDSTShifted=this.isValid()&&eY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function cY(){return this.isValid()?!this._isUTC:!1}function hY(){return this.isValid()?this._isUTC:!1}function rL(){return this.isValid()?this._isUTC&&this._offset===0:!1}var dY=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,fY=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function uo(t,e){var n=t,r=null,i,o,s;return zm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ls(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=dY.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[Fo])*i,h:Qe(r[En])*i,m:Qe(r[no])*i,s:Qe(r[Is])*i,ms:Qe(eE(r[Xl]*1e3))*i}):(r=fY.exec(t))?(i=r[1]==="-"?-1:1,n={y:el(r[2],i),M:el(r[3],i),w:el(r[4],i),d:el(r[5],i),h:el(r[6],i),m:el(r[7],i),s:el(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=gY(Ot(n.from),Ot(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Dw(n),zm(t)&&at(t,"_locale")&&(o._locale=t._locale),zm(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}uo.fn=Dw.prototype;uo.invalid=Jz;function el(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function sA(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function gY(t,e){var n;return t.isValid()&&e.isValid()?(e=N0(e,t),t.isBefore(e)?n=sA(t,e):(n=sA(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function iL(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(Hk(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=uo(n,r),oL(this,i,t),this}}function oL(t,e,n,r){var i=e._milliseconds,o=eE(e._days),s=eE(e._months);t.isValid()&&(r=r??!0,s&&jk(t,sf(t,"Month")+s*n),o&&Vk(t,"Date",sf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&X.updateOffset(t,o||s))}var mY=iL(1,"add"),pY=iL(-1,"subtract");function sL(t){return typeof t=="string"||t instanceof String}function wY(t){return so(t)||kf(t)||sL(t)||Ls(t)||CY(t)||vY(t)||t===null||t===void 0}function vY(t){var e=ou(t)&&!p0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||at(t,o);return e&&n}function CY(t){var e=oo(t),n=!1;return e&&(n=t.filter(function(r){return!Ls(r)&&sL(t)}).length===0),e&&n}function yY(t){var e=ou(t)&&!p0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||at(t,o);return e&&n}function SY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function bY(t,e){arguments.length===1&&(arguments[0]?wY(arguments[0])?(t=arguments[0],e=void 0):yY(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ot(),r=N0(n,this).startOf("day"),i=X.calendarFormat(this,r)||"sameElse",o=e&&(Qo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Ot(n)))}function RY(){return new Lf(this)}function EY(t,e){var n=so(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function TY(t,e){var n=so(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function _Y(t,e,n,r){var i=so(t)?t:Ot(t),o=so(e)?e:Ot(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function MY(t,e){var n=so(t)?t:Ot(t),r;return this.isValid()&&n.isValid()?(e=Hi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function PY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function IY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function OY(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=N0(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Hi(e),e){case"year":o=Ym(this,r)/12;break;case"month":o=Ym(this,r);break;case"quarter":o=Ym(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ri(o)}function Ym(t,e){if(t.date()<e.date())return-Ym(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function xY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function AY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Um(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Um(n,"Z")):Um(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function HY(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function NY(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=Um(this,t);return this.localeData().postformat(e)}function DY(t,e){return this.isValid()&&(so(t)&&t.isValid()||Ot(t).isValid())?uo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function kY(t){return this.from(Ot(),t)}function LY(t,e){return this.isValid()&&(so(t)&&t.isValid()||Ot(t).isValid())?uo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function $Y(t){return this.to(Ot(),t)}function aL(t){var e;return t===void 0?this._locale._abbr:(e=Ws(t),e!=null&&(this._locale=e),this)}var lL=Ai("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function uL(){return this._locale}var vp=1e3,Lc=60*vp,Cp=60*Lc,cL=(365*400+97)*24*Cp;function $c(t,e){return(t%e+e)%e}function hL(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-cL:new Date(t,e,n).valueOf()}function dL(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-cL:Date.UTC(t,e,n)}function FY(t){var e,n;if(t=Hi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?dL:hL,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=$c(e+(this._isUTC?0:this.utcOffset()*Lc),Cp);break;case"minute":e=this._d.valueOf(),e-=$c(e,Lc);break;case"second":e=this._d.valueOf(),e-=$c(e,vp);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function VY(t){var e,n;if(t=Hi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?dL:hL,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Cp-$c(e+(this._isUTC?0:this.utcOffset()*Lc),Cp)-1;break;case"minute":e=this._d.valueOf(),e+=Lc-$c(e,Lc)-1;break;case"second":e=this._d.valueOf(),e+=vp-$c(e,vp)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function WY(){return this._d.valueOf()-(this._offset||0)*6e4}function BY(){return Math.floor(this.valueOf()/1e3)}function jY(){return new Date(this.valueOf())}function UY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function zY(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function YY(){return this.isValid()?this.toISOString():null}function GY(){return w0(this)}function qY(){return Ia({},Fe(this))}function KY(){return Fe(this).overflow}function XY(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ee("N",0,0,"eraAbbr");Ee("NN",0,0,"eraAbbr");Ee("NNN",0,0,"eraAbbr");Ee("NNNN",0,0,"eraName");Ee("NNNNN",0,0,"eraNarrow");Ee("y",["y",1],"yo","eraYear");Ee("y",["yy",2],0,"eraYear");Ee("y",["yyy",3],0,"eraYear");Ee("y",["yyyy",4],0,"eraYear");he("N",D0);he("NN",D0);he("NNN",D0);he("NNNN",aG);he("NNNNN",lG);St(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Fe(n).era=i:Fe(n).invalidEra=t});he("y",lh);he("yy",lh);he("yyy",lh);he("yyyy",lh);he("yo",uG);St(["y","yy","yyy","yyyy"],Xn);St(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function ZY(t,e){var n,r,i,o=this._eras||Ws("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=X(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=X(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function QY(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function JY(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function eG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function tG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function nG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function rG(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-X(i[t].since).year())*n+i[t].offset;return this.year()}function iG(t){return at(this,"_erasNameRegex")||k0.call(this),t?this._erasNameRegex:this._erasRegex}function oG(t){return at(this,"_erasAbbrRegex")||k0.call(this),t?this._erasAbbrRegex:this._erasRegex}function sG(t){return at(this,"_erasNarrowRegex")||k0.call(this),t?this._erasNarrowRegex:this._erasRegex}function D0(t,e){return e.erasAbbrRegex(t)}function aG(t,e){return e.erasNameRegex(t)}function lG(t,e){return e.erasNarrowRegex(t)}function uG(t,e){return e._eraYearOrdinalRegex||lh}function k0(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Ds(u[i].name),a=Ds(u[i].abbr),l=Ds(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ee(0,["gg",2],0,function(){return this.weekYear()%100});Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100});function kw(t,e){Ee(0,[t,t.length],0,e)}kw("gggg","weekYear");kw("ggggg","weekYear");kw("GGGG","isoWeekYear");kw("GGGGG","isoWeekYear");he("G",xw);he("g",xw);he("GG",xt,si);he("gg",xt,si);he("GGGG",R0,b0);he("gggg",R0,b0);he("GGGGG",Ow,Pw);he("ggggg",Ow,Pw);Ff(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});Ff(["gg","GG"],function(t,e,n,r){e[r]=X.parseTwoDigitYear(t)});function cG(t){return fL.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function hG(t){return fL.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function dG(){return ks(this.year(),1,4)}function fG(){return ks(this.isoWeekYear(),1,4)}function gG(){var t=this.localeData()._week;return ks(this.year(),t.dow,t.doy)}function mG(){var t=this.localeData()._week;return ks(this.weekYear(),t.dow,t.doy)}function fL(t,e,n,r,i){var o;return t==null?lf(this,r,i).year:(o=ks(t,r,i),e>o&&(e=o),pG.call(this,t,e,n,r,i))}function pG(t,e,n,r,i){var o=Yk(t,e,n,r,i),s=af(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ee("Q",0,"Qo","quarter");he("Q",Dk);St("Q",function(t,e){e[Ps]=(Qe(t)-1)*3});function wG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ee("D",["DD",2],"Do","date");he("D",xt,uh);he("DD",xt,si);he("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});St(["D","DD"],Fo);St("Do",function(t,e){e[Fo]=Qe(t.match(xt)[0])});var gL=ch("Date",!0);Ee("DDD",["DDDD",3],"DDDo","dayOfYear");he("DDD",Iw);he("DDDD",kk);St(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function vG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ee("m",["mm",2],0,"minute");he("m",xt,E0);he("mm",xt,si);St(["m","mm"],no);var CG=ch("Minutes",!1);Ee("s",["ss",2],0,"second");he("s",xt,E0);he("ss",xt,si);St(["s","ss"],Is);var yG=ch("Seconds",!1);Ee("S",0,0,function(){return~~(this.millisecond()/100)});Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ee(0,["SSS",3],0,"millisecond");Ee(0,["SSSS",4],0,function(){return this.millisecond()*10});Ee(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ee(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ee(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ee(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ee(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});he("S",Iw,Dk);he("SS",Iw,si);he("SSS",Iw,kk);var Oa,mL;for(Oa="SSSS";Oa.length<=9;Oa+="S")he(Oa,lh);function SG(t,e){e[Xl]=Qe(("0."+t)*1e3)}for(Oa="S";Oa.length<=9;Oa+="S")St(Oa,SG);mL=ch("Milliseconds",!1);Ee("z",0,0,"zoneAbbr");Ee("zz",0,0,"zoneName");function bG(){return this._isUTC?"UTC":""}function RG(){return this._isUTC?"Coordinated Universal Time":""}var Q=Lf.prototype;Q.add=mY;Q.calendar=bY;Q.clone=RY;Q.diff=OY;Q.endOf=VY;Q.format=NY;Q.from=DY;Q.fromNow=kY;Q.to=LY;Q.toNow=$Y;Q.get=HU;Q.invalidAt=KY;Q.isAfter=EY;Q.isBefore=TY;Q.isBetween=_Y;Q.isSame=MY;Q.isSameOrAfter=PY;Q.isSameOrBefore=IY;Q.isValid=GY;Q.lang=lL;Q.locale=aL;Q.localeData=uL;Q.max=Gz;Q.min=Yz;Q.parsingFlags=qY;Q.set=NU;Q.startOf=FY;Q.subtract=pY;Q.toArray=UY;Q.toObject=zY;Q.toDate=jY;Q.toISOString=AY;Q.inspect=HY;typeof Symbol<"u"&&Symbol.for!=null&&(Q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Q.toJSON=YY;Q.toString=xY;Q.unix=BY;Q.valueOf=WY;Q.creationData=XY;Q.eraName=eG;Q.eraNarrow=tG;Q.eraAbbr=nG;Q.eraYear=rG;Q.year=Fk;Q.isLeapYear=AU;Q.weekYear=cG;Q.isoWeekYear=hG;Q.quarter=Q.quarters=wG;Q.month=Uk;Q.daysInMonth=jU;Q.week=Q.weeks=ZU;Q.isoWeek=Q.isoWeeks=QU;Q.weeksInYear=gG;Q.weeksInWeekYear=mG;Q.isoWeeksInYear=dG;Q.isoWeeksInISOWeekYear=fG;Q.date=gL;Q.day=Q.days=hz;Q.weekday=dz;Q.isoWeekday=fz;Q.dayOfYear=vG;Q.hour=Q.hours=yz;Q.minute=Q.minutes=CG;Q.second=Q.seconds=yG;Q.millisecond=Q.milliseconds=mL;Q.utcOffset=nY;Q.utc=iY;Q.local=oY;Q.parseZone=sY;Q.hasAlignedHourOffset=aY;Q.isDST=lY;Q.isLocal=cY;Q.isUtcOffset=hY;Q.isUtc=rL;Q.isUTC=rL;Q.zoneAbbr=bG;Q.zoneName=RG;Q.dates=Ai("dates accessor is deprecated. Use date instead.",gL);Q.months=Ai("months accessor is deprecated. Use month instead",Uk);Q.years=Ai("years accessor is deprecated. Use year instead",Fk);Q.zone=Ai("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",rY);Q.isDSTShifted=Ai("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",uY);function EG(t){return Ot(t*1e3)}function TG(){return Ot.apply(null,arguments).parseZone()}function pL(t){return t}var lt=C0.prototype;lt.calendar=cU;lt.longDateFormat=gU;lt.invalidDate=pU;lt.ordinal=CU;lt.preparse=pL;lt.postformat=pL;lt.relativeTime=SU;lt.pastFuture=bU;lt.set=lU;lt.eras=ZY;lt.erasParse=QY;lt.erasConvertYear=JY;lt.erasAbbrRegex=oG;lt.erasNameRegex=iG;lt.erasNarrowRegex=sG;lt.months=FU;lt.monthsShort=VU;lt.monthsParse=BU;lt.monthsRegex=zU;lt.monthsShortRegex=UU;lt.week=GU;lt.firstDayOfYear=XU;lt.firstDayOfWeek=KU;lt.weekdays=sz;lt.weekdaysMin=lz;lt.weekdaysShort=az;lt.weekdaysParse=cz;lt.weekdaysRegex=gz;lt.weekdaysShortRegex=mz;lt.weekdaysMinRegex=pz;lt.isPM=vz;lt.meridiem=Sz;function yp(t,e,n,r){var i=Ws(),o=Zo().set(r,e);return i[n](o,t)}function wL(t,e,n){if(Ls(t)&&(e=t,t=void 0),t=t||"",e!=null)return yp(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=yp(t,r,n,"month");return i}function L0(t,e,n,r){typeof t=="boolean"?(Ls(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ls(e)&&(n=e,e=void 0),e=e||"");var i=Ws(),o=t?i._week.dow:0,s,a=[];if(n!=null)return yp(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=yp(e,(s+o)%7,r,"day");return a}function _G(t,e){return wL(t,e,"months")}function MG(t,e){return wL(t,e,"monthsShort")}function PG(t,e,n){return L0(t,e,n,"weekdays")}function IG(t,e,n){return L0(t,e,n,"weekdaysShort")}function OG(t,e,n){return L0(t,e,n,"weekdaysMin")}Da("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=Ai("moment.lang is deprecated. Use moment.locale instead.",Da);X.langData=Ai("moment.langData is deprecated. Use moment.localeData instead.",Ws);var is=Math.abs;function xG(){var t=this._data;return this._milliseconds=is(this._milliseconds),this._days=is(this._days),this._months=is(this._months),t.milliseconds=is(t.milliseconds),t.seconds=is(t.seconds),t.minutes=is(t.minutes),t.hours=is(t.hours),t.months=is(t.months),t.years=is(t.years),this}function vL(t,e,n,r){var i=uo(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function AG(t,e){return vL(this,t,e,1)}function HG(t,e){return vL(this,t,e,-1)}function aA(t){return t<0?Math.floor(t):Math.ceil(t)}function NG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=aA(nE(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Ri(t/1e3),r.seconds=i%60,o=Ri(i/60),r.minutes=o%60,s=Ri(o/60),r.hours=s%24,e+=Ri(s/24),l=Ri(CL(e)),n+=l,e-=aA(nE(l)),a=Ri(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function CL(t){return t*4800/146097}function nE(t){return t*146097/4800}function DG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Hi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+CL(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(nE(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Bs(t){return function(){return this.as(t)}}var yL=Bs("ms"),kG=Bs("s"),LG=Bs("m"),$G=Bs("h"),FG=Bs("d"),VG=Bs("w"),WG=Bs("M"),BG=Bs("Q"),jG=Bs("y"),UG=yL;function zG(){return uo(this)}function YG(t){return t=Hi(t),this.isValid()?this[t+"s"]():NaN}function Su(t){return function(){return this.isValid()?this._data[t]:NaN}}var GG=Su("milliseconds"),qG=Su("seconds"),KG=Su("minutes"),XG=Su("hours"),ZG=Su("days"),QG=Su("months"),JG=Su("years");function e2(){return Ri(this.days()/7)}var Ss=Math.round,Tc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function t2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function n2(t,e,n,r){var i=uo(t).abs(),o=Ss(i.as("s")),s=Ss(i.as("m")),a=Ss(i.as("h")),l=Ss(i.as("d")),u=Ss(i.as("M")),c=Ss(i.as("w")),h=Ss(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,t2.apply(null,d)}function r2(t){return t===void 0?Ss:typeof t=="function"?(Ss=t,!0):!1}function i2(t,e){return Tc[t]===void 0?!1:e===void 0?Tc[t]:(Tc[t]=e,t==="s"&&(Tc.ss=e-1),!0)}function o2(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Tc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Tc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=n2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var hS=Math.abs;function Mu(t){return(t>0)-(t<0)||+t}function Lw(){if(!this.isValid())return this.localeData().invalidDate();var t=hS(this._milliseconds)/1e3,e=hS(this._days),n=hS(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Ri(t/60),i=Ri(r/60),t%=60,r%=60,o=Ri(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Mu(this._months)!==Mu(a)?"-":"",c=Mu(this._days)!==Mu(a)?"-":"",h=Mu(this._milliseconds)!==Mu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=Dw.prototype;tt.isValid=Qz;tt.abs=xG;tt.add=AG;tt.subtract=HG;tt.as=DG;tt.asMilliseconds=yL;tt.asSeconds=kG;tt.asMinutes=LG;tt.asHours=$G;tt.asDays=FG;tt.asWeeks=VG;tt.asMonths=WG;tt.asQuarters=BG;tt.asYears=jG;tt.valueOf=UG;tt._bubble=NG;tt.clone=zG;tt.get=YG;tt.milliseconds=GG;tt.seconds=qG;tt.minutes=KG;tt.hours=XG;tt.days=ZG;tt.weeks=e2;tt.months=QG;tt.years=JG;tt.humanize=o2;tt.toISOString=Lw;tt.toString=Lw;tt.toJSON=Lw;tt.locale=aL;tt.localeData=uL;tt.toIsoString=Ai("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Lw);tt.lang=lL;Ee("X",0,0,"unix");Ee("x",0,0,"valueOf");he("x",xw);he("X",_U);St("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});St("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
X.version="2.30.1";sU(Ot);X.fn=Q;X.min=qz;X.max=Kz;X.now=Xz;X.utc=Zo;X.unix=EG;X.months=_G;X.isDate=kf;X.locale=Da;X.invalid=Mw;X.duration=uo;X.isMoment=so;X.weekdays=PG;X.parseZone=TG;X.localeData=Ws;X.isDuration=zm;X.monthsShort=MG;X.weekdaysMin=OG;X.defineLocale=I0;X.updateLocale=Tz;X.locales=_z;X.weekdaysShort=IG;X.normalizeUnits=Hi;X.relativeTimeRounding=r2;X.relativeTimeThreshold=i2;X.calendarFormat=SY;X.prototype=Q;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var lA={},uA={},cA;function s2(){if(cA)return uA;cA=1;var t=Et(),e=ah(),n=Hr(),r=pn(),i=Xo(),o=Nr(),s=qa(),a=Hf(),l=fn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(b){o(this,"throw",b)}var m=arguments.length<2,p=m?void 0:arguments[1];if(h)return a(h,this,m?[f]:[f,p]);var y=i(this),T=0;if(e(y,function(b){m?(m=!1,p=b):p=f(p,b,T),T++},{IS_RECORD:!0}),m)throw new u("Reduce of empty iterator with no initial value");return p}}),uA}var hA;function a2(){return hA||(hA=1,s2()),lA}a2();function SL(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function rE(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Nd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function wn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Va(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Je(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function I(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function bL(t){return wn(t,(e,n)=>e+n,0)}function l2(t){return wn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function u2(t){return wn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function c2(t){return t.length?bL(t)/t.length:0}function RL(t){return wn(t,(e,n)=>e.concat(Array.isArray(n)?RL(n):n),[])}function EL(t){const e=[];return I(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function iE(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return I(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function h2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return I(i,s=>{o=o.filter(a=>s.includes(a))}),o}function d2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return I(i,s=>{I(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function oE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const f2=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:c2,arrayEach:I,arrayFilter:Va,arrayFlatten:RL,arrayMap:Je,arrayMax:l2,arrayMin:u2,arrayReduce:wn,arraySum:bL,arrayUnique:EL,extendArray:rE,getDifferenceOfArrays:iE,getIntersectionOfArrays:h2,getUnionOfArrays:d2,pivot:Nd,stringToArray:oE,to2dArray:SL},Symbol.toStringTag,{value:"Module"}));function it(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return wn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function TL(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=document.createElement("template");i.innerHTML=t.reduce((a,l,u)=>{var c;return a+l+((c=n[u])!==null&&c!==void 0?c:"")},"");const o=i.content.cloneNode(!0),s={};return o.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),s[l]=a}),{fragment:o,refs:s}}function Rt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ae(t){return typeof t<"u"}function It(t){return typeof t>"u"}function Ut(t){return t===null||t===""||It(t)}function _L(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Rd="length",Dd=t=>parseInt(t,16),dA=t=>parseInt(t,10),Sp=(t,e,n)=>t.substr(e,n),kd=t=>t.codePointAt(0)-65,sE=t=>`${t}`.replace(/\-/g,""),g2=t=>Dd(Sp(sE(t),Dd("12"),kd("F")))/(Dd(Sp(sE(t),kd("B"),~~![][Rd]))||9),m2=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let fA=!1;const gA={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},mA={invalid:()=>it`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return it`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>it`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ML(t,e){const n=!Ut(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.1";let o,s="invalid",a="invalid";t=sE(t||"");const l=p2(t);if(n||r||l)if(l){const u=X("23/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=g2(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(m2()&&(s="valid",a="valid"),!fA&&s!=="valid"&&(gA[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](gA[s]({keyValidityDate:o,hotVersion:i})),fA=!0),a!=="valid"&&e&&mA[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=mA[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function p2(t){let e=[][Rd],n=e;if(t[Rd]!==kd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=kd(i.shift());o;o=kd(i.shift()||"A"))--o<""[Rd]?n=n|(dA(`${dA(Dd(r)+(Dd(Sp(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Sp(t,o,o?i[Rd]===1?9:8:6);return n===e}function bp(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Rp(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const w2=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:ML,getMostBottomEndPosition:Rp,getMostTopStartPosition:bp,isDefined:ae,isEmpty:Ut,isRegExp:_L,isUndefined:It,stringify:Rt},Symbol.toStringTag,{value:"Module"}));function Zn(t){return t[0].toUpperCase()+t.substr(1)}function v2(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Rt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function $0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function PL(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function F0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function $w(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Gm(t){return Fw(`${t}`,{ALLOWED_TAGS:[]})}function Fw(t,e){return oU.sanitize(t,e)}const C2=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:v2,isJSON:PL,isPercentValue:F0,randomString:$0,sanitize:Fw,stripTags:Gm,substitute:$w,toUpperCaseFirst:Zn},Symbol.toStringTag,{value:"Module"})),xr=t=>["tabindex",t],y2=()=>["role","treegrid"],Os=()=>["role","presentation"],S2=()=>["role","gridcell"],b2=()=>["role","gridcell button"],R2=()=>["role","rowheader"],IL=()=>["role","rowgroup"],E2=()=>["role","columnheader"],OL=()=>["role","row"],T2=()=>["role","menu"],_2=()=>["role","menuitem"],M2=()=>["role","menuitemcheckbox"],P2=()=>["role","combobox"],xL=()=>["role","listbox"],I2=()=>["role","option"],O2=()=>["role","checkbox"],x2=()=>["role","dialog"],A2=()=>["role","alertdialog"],H2=()=>["scope","col"],N2=()=>["scope","row"],D2=()=>["type","text"],ri=t=>["aria-label",t],k2=t=>["aria-labelledby",t],L2=t=>["aria-describedby",t],bu=()=>["aria-hidden","true"],Ed=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},$2=()=>["aria-multiselectable","true"],AL=t=>["aria-haspopup",t],HL=t=>["aria-rowcount",t],Vw=t=>["aria-colcount",t],NL=t=>["aria-rowindex",t],V0=t=>["aria-colindex",t],_i=t=>["aria-expanded",t],F2=t=>["aria-sort",t],pA=()=>["aria-readonly","true"],wA=()=>["aria-invalid","true"],DL=t=>["aria-checked",t],W0=()=>["aria-selected","true"],V2=()=>["aria-autocomplete","list"],W2=t=>["aria-controls",t],B2=t=>["aria-activedescendant",t],j2=t=>["aria-live",t],U2=t=>["aria-relevant",t],z2=t=>["aria-setsize",t],Y2=t=>["aria-posinset",t],G2=()=>["aria-modal","true"];var vA={},dS,CA;function q2(){if(CA)return dS;CA=1;var t=an(),e=dk(),n=mn(),r=pu(),i=_w(),o=t([].push);return dS=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var p=0;p<h;p++)if(l[p]===f)return m}}},dS}var yA;function K2(){if(yA)return vA;yA=1;var t=Et(),e=rh(),n=Hf(),r=gn(),i=an(),o=fn(),s=mn(),a=n0(),l=m0(),u=q2(),c=t0(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),p=i("".charCodeAt),y=i("".replace),T=i(1.1.toString),b=/[\uD800-\uDFFF]/g,M=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,k=!c||o(function(){var G=e("Symbol")("stringify detection");return d([G])!=="[null]"||d({a:G})!=="{}"||d(Object(G))!=="{}"}),P=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),O=function(G,V){var Z=l(arguments),z=u(V);if(!(!s(z)&&(G===void 0||a(G))))return Z[1]=function(ue,ee){if(s(z)&&(ee=r(z,this,h(ue),ee)),!a(ee))return ee},n(d,null,Z)},U=function(G,V,Z){var z=m(Z,V-1),ue=m(Z,V+1);return f(M,G)&&!f(R,ue)||f(R,G)&&!f(M,z)?"\\u"+T(p(G,0),16):G};return d&&t({target:"JSON",stat:!0,arity:3,forced:k||P},{stringify:function(V,Z,z){var ue=l(arguments),ee=n(k?O:d,null,ue);return P&&typeof ee=="string"?y(ee,b,U):ee}}),vA}K2();function Gc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ve(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Gc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Gc(n[0])]:e[r]=[]:e[r]=null)})),e}function kL(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function on(t,e,n){const r=Array.isArray(n);return Ve(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Vf(t,e){Ve(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Vf(t[r],e[r])):t[r]=e[r]})}function Qn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ao(t){const e={};return Ve(t,(n,r)=>{e[r]=n}),e}function ut(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return I(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ve(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let p=m;return(Array.isArray(p)||Te(p))&&(p=Qn(p)),p};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Wf(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Te(t){return Object.prototype.toString.call(t)==="[object Object]"}function Jo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ve(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Ep(t,e){const n=e.split(".");let r=t;return Ve(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function qm(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(jt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Ww(t){if(!Te(t))return 0;const e=function(n){let r=0;return Te(n)?Ve(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Ar(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ld(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(r=>{typeof e[r]=="object"&&e[r]!==null&&!Array.isArray(e[r])?n[r]=Ld(t[r],e[r]):n[r]=jt(t,r)&&t[r]!==void 0?t[r]:e[r]}),Object.keys(t).forEach(r=>{jt(n,r)||(n[r]=t[r])}),n}const X2=Object.freeze(Object.defineProperty({__proto__:null,assignObjectDefaults:Ld,clone:ao,createObjectPropListener:Ar,deepClone:Qn,deepExtend:Vf,deepObjectSize:Ww,defineGetter:Jo,duckSchema:Gc,extend:on,getProperty:Ep,hasOwnProperty:jt,inherit:kL,isObject:Te,isObjectEqual:Wf,mixin:ut,objectEach:Ve,setProperty:qm},Symbol.toStringTag,{value:"Module"}));function cf(t){return window.requestAnimationFrame(t)}function hf(t){window.cancelAnimationFrame(t)}function B0(){return"ontouchstart"in window}function LL(){return typeof window<"u"}let Pu;function $L(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Pu||(typeof Intl=="object"?Pu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Pu=(n,r)=>`${n}`.localeCompare(r):Pu=(n,r)=>n===r?0:n>r?-1:1,Pu)}const Z2=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:hf,getComparisonFunction:$L,isCSR:LL,isTouchSupported:B0,requestAnimationFrame:cf},Symbol.toStringTag,{value:"Module"})),wi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},js={chrome:wi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:wi(t=>/CriOS/.test(t)),edge:wi(t=>/Edge/.test(t)),edgeWebKit:wi(t=>/EdgiOS/.test(t)),firefox:wi(t=>/Firefox/.test(t)),firefoxWebKit:wi(t=>/FxiOS/.test(t)),mobile:wi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:wi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},hh={mac:wi(t=>/^Mac/.test(t)),win:wi(t=>/^Win/.test(t)),linux:wi(t=>/^Linux/.test(t)),ios:wi(t=>/iPhone|iPad|iPod/i.test(t))};function FL(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ve(js,n=>{let{test:r}=n;return void r(t,e)})}function VL(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ve(hh,e=>{let{test:n}=e;return void n(t)})}LL()&&(FL(),VL());function j0(){return js.chrome.value}function WL(){return js.chromeWebKit.value}function Km(){return js.firefox.value}function BL(){return js.firefoxWebKit.value}function Bf(){return js.safari.value}function jL(){return js.edge.value}function Q2(){return js.edgeWebKit.value}function ro(){return js.mobile.value}function U0(){return hh.ios.value}function z0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&hh.mac.value}function Tp(){return hh.win.value}function _p(){return hh.mac.value}function J2(){return hh.linux.value}const eq=Object.freeze(Object.defineProperty({__proto__:null,isChrome:j0,isChromeWebKit:WL,isEdge:jL,isEdgeWebKit:Q2,isFirefox:Km,isFirefoxWebKit:BL,isIOS:U0,isIpadOS:z0,isLinuxOS:J2,isMacOS:_p,isMobileBrowser:ro,isSafari:Bf,isWindowsOS:Tp,setBrowserMeta:FL,setPlatformMeta:VL},Symbol.toStringTag,{value:"Module"}));function UL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function $d(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function zL(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function lu(t){return zL(t)&&t.parent}function tq(t){return!!Object.getPrototypeOf(t.parent)}function Wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Td(t,e,n){const r=[];let i=t;for(;i&&(i=Wa(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function YL(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function ka(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function GL(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function pa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function qL(t){return!t||!t.length?[]:t.filter(e=>!!e)}function KL(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function be(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Y(t,e){typeof e=="string"&&(e=e.split(" ")),e=qL(e),e.length>0&&t.classList.add(...e)}function ce(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=KL(e,!0);n=qL(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function fe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Uo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=KL(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Y0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Y0(e[n])}}function qo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const XL=/(<(.*)>|&(.*);)/;function Ka(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;XL.test(e)?t.innerHTML=n?Fw(e):e:Ba(t,e)}function Ba(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(qo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function uu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return uu(r.host.impl);if(r.host)return uu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function ZL(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function $n(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function G0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Bw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function jw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?G0(e):t.scrollTop}function q0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Bw(e):t.scrollLeft}function df(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function QL(t){return t.scrollHeight-t.clientHeight}function JL(t){return t.scrollWidth-t.clientWidth}function qc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function ff(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function nq(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Xt(t){return t.offsetWidth}function nn(t){return t.getBoundingClientRect().height}function Fc(t){return t.clientHeight||t.innerHeight}function K0(t){return t.clientWidth||t.innerWidth}function rq(t,e,n){t.addEventListener(e,n,!1)}function iq(t,e,n){t.removeEventListener(e,n,!1)}function X0(t){return t.selectionStart?t.selectionStart:0}function e$(t){return t.selectionEnd?t.selectionEnd:0}function oq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function aE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function jf(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let fS;function t$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Tp()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function sq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Bf()&&!ro()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.getBoundingClientRect().width;n.style.overflow="scroll";let i=e.getBoundingClientRect().width;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((r-i).toFixed(3))}function rn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return fS===void 0&&(fS=sq(t)),fS}function Z0(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function Q0(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Uw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function aq(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Uf(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Fd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function zw(t){return Fd(t)&&t.hasAttribute("data-hot-input")===!1}function lq(t){const e=t.ownerDocument.activeElement;zw(e)||t.select()}function J0(t){return!t.parentNode}function n$(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function eT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();fe(t,"contenteditable",!0),n&&fe(t,...bu()),e&&Y(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function tT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ce(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function r$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;eT(t,n),e(),tT(t,n)}function zo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const uq=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:XL,addClass:Y,addEvent:rq,clearTextSelection:aE,closest:Wa,closestDown:Td,empty:qo,fastInnerHTML:Ka,fastInnerText:Ba,findFirstParentWithClass:YL,getCaretPosition:X0,getCssTransform:aq,getFractionalScalingCompensation:t$,getFrameElement:zL,getMaximumScrollLeft:JL,getMaximumScrollTop:QL,getParent:UL,getParentWindow:lu,getScrollLeft:q0,getScrollTop:jw,getScrollableElement:df,getScrollbarWidth:rn,getSelectionEndPosition:e$,getSelectionText:oq,getStyle:ff,getTrimmingContainer:qc,getWindowScrollLeft:Bw,getWindowScrollTop:G0,hasAccessToParentWindow:tq,hasClass:be,hasHorizontalScrollbar:Q0,hasVerticalScrollbar:Z0,hasZeroHeight:ZL,index:GL,innerHeight:Fc,innerWidth:K0,isChildOf:ka,isDetached:J0,isHTMLElement:zo,isInput:Fd,isInternalElement:$d,isOutsideInput:zw,isVisible:uu,makeElementContentEditableAndSelectItsContent:eT,matchesCSSRules:nq,observeVisibilityChangeOnce:n$,offset:$n,outerHeight:nn,outerWidth:Xt,overlayContainsElement:pa,removeAttribute:Uo,removeClass:ce,removeContentEditableFromElementAndDeselect:tT,removeEvent:iq,removeTextNodes:Y0,resetCssTransform:Uf,runWithSelectedContendEditableElement:r$,selectElementIfAllowed:lq,setAttribute:fe,setCaretPosition:jf,setOverlayPosition:Uw},Symbol.toStringTag,{value:"Module"}));function rt(t){return typeof t=="function"}function i$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function cq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=i$(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function zf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function hq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return wn(i,(u,c)=>c(u),r.apply(this,a))}}function nT(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function o$(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function dq(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Mp(t,e,n,r,i,o,s,a){return ae(a)?t.call(e,n,r,i,o,s,a):ae(s)?t.call(e,n,r,i,o,s):ae(o)?t.call(e,n,r,i,o):ae(i)?t.call(e,n,r,i):ae(r)?t.call(e,n,r):ae(n)?t.call(e,n):t.call(e)}const fq=Object.freeze(Object.defineProperty({__proto__:null,curry:o$,curryRight:dq,debounce:zf,fastCall:Mp,isFunction:rt,partial:nT,pipe:hq,throttle:i$,throttleAfterHits:cq},Symbol.toStringTag,{value:"Module"})),ve={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Km()?182:174,AUDIO_MUTE:Km()?181:173,AUDIO_UP:Km()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},gq=[ve.ALT,ve.ARROW_DOWN,ve.ARROW_LEFT,ve.ARROW_RIGHT,ve.ARROW_UP,ve.AUDIO_DOWN,ve.AUDIO_MUTE,ve.AUDIO_UP,ve.BACKSPACE,ve.CAPS_LOCK,ve.DELETE,ve.END,ve.ENTER,ve.ESCAPE,ve.F1,ve.F2,ve.F3,ve.F4,ve.F5,ve.F6,ve.F7,ve.F8,ve.F9,ve.F10,ve.F11,ve.F12,ve.F13,ve.F14,ve.F15,ve.F16,ve.F17,ve.F18,ve.F19,ve.HOME,ve.INSERT,ve.MEDIA_NEXT,ve.MEDIA_PLAY_PAUSE,ve.MEDIA_PREV,ve.MEDIA_STOP,ve.NULL,ve.NUM_LOCK,ve.PAGE_DOWN,ve.PAGE_UP,ve.PAUSE,ve.SCROLL_LOCK,ve.SHIFT,ve.TAB];function s$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function rT(t){return gq.includes(t)}function mq(t){const e=[];return _p()?e.push(ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX):e.push(ve.CONTROL),e.includes(t)}function a$(t){return[ve.CONTROL,ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX].includes(t)}function dh(t,e){const n=e.split("|");let r=!1;return I(n,i=>{if(t===ve[i])return r=!0,!1}),r}const pq=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ve,isCtrlKey:mq,isCtrlMetaKey:a$,isFunctionKey:rT,isKey:dh,isPrintableChar:s$},Symbol.toStringTag,{value:"Module"}));function Ni(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ta(t){return t.isImmediatePropagationEnabled===!1}function ja(t){return t.button===2}function Yw(t){return t.button===0}function l$(t){return t instanceof TouchEvent}function u$(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!zo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const wq=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ta,isLeftClick:Yw,isRightClick:ja,isTouchEvent:l$,offsetRelativeTo:u$,stopImmediatePropagation:Ni},Symbol.toStringTag,{value:"Module"}));function qe(){ae(console)&&console.warn(...arguments)}function c$(t){ae(console)&&console.warn(`Deprecated: ${t}`)}function iT(){ae(console)&&console.error(...arguments)}const zl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],gS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),mS=new Map([[]]);var SA={},pS,bA;function vq(){if(bA)return pS;bA=1;var t=sh();return pS=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},pS}var wS,RA;function Cq(){if(RA)return wS;RA=1;var t=sn();return wS=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},wS}var vS,EA;function Gw(){if(EA)return vS;EA=1;var t=lo(),e=d0(),n=Ga().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),vS=function(o){i[r][o]=!0},vS}var TA;function yq(){if(TA)return SA;TA=1;var t=Et(),e=an(),n=Hr(),r=If(),i=vq(),o=Cq(),s=Gw(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),SA}yq();var _A={},MA={},PA;function Sq(){if(PA)return MA;PA=1;var t=Et(),e=gn(),n=ah(),r=Hr(),i=pn(),o=Xo(),s=Nr(),a=qa(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),MA}var IA;function bq(){return IA||(IA=1,Sq()),_A}bq();function Rq(t,e){h$(t,e),e.add(t)}function CS(t,e,n){h$(t,e),e.set(t,n)}function h$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OA(t,e,n){return t.set(Pp(t,e),n),n}function Ln(t,e){return t.get(Pp(t,e))}function Pp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Eq=100;var zr=new WeakMap,pc=new WeakMap,yS=new WeakMap,SS=new WeakSet;class xA{constructor(){Rq(this,SS),CS(this,zr,new Map),CS(this,pc,new Map),CS(this,yS,new Set),zl.forEach(e=>Pp(SS,this,AA).call(this,e))}getHooks(e){var n;return(n=Ln(zr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ln(zr,this).has(e)||(Pp(SS,this,AA).call(this,e),zl.push(e));const i=Ln(zr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Ln(yS,this).has(e);!u&&o!==0&&(u=!0,Ln(yS,this).add(e)),u&&i.length>1&&Ln(zr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Ln(zr,this).has(e)&&Ln(zr,this).get(e).length>0}remove(e,n){if(!Ln(zr,this).has(e))return!1;const r=Ln(zr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Ln(pc,this).get(e);return i.skip=!0,o+=1,o>Eq&&(Ln(zr,this).set(e,r.filter(s=>!s.skip)),o=0),Ln(pc,this).set(e,o),!0}return!1}destroy(){Ln(zr,this).clear(),Ln(pc,this).clear(),OA(zr,this,null),OA(pc,this,null)}}function AA(t){Ln(zr,this).set(t,[]),Ln(pc,this).set(t,0)}function Tq(t,e,n){return(e=_q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:e+""}function Mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Pq=it`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class oe{constructor(){Tq(this,"globalBucket",new xA)}static getSingleton(){return Oq()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new xA),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.add(e,o,r)):(gS.has(e)&&qe($w(Pq,{hookName:e,removedInVersion:gS.get(e)})),mS.has(e)&&qe(mS.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?I(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mp(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mp(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||zl.push(e)}deregister(e){this.isRegistered(e)&&zl.splice(zl.indexOf(e),1)}isDeprecated(e){return mS.has(e)||gS.has(e)}isRegistered(e){return zl.indexOf(e)>=0}getRegistered(){return zl}}const Iq=new oe;function Oq(){return Iq}const Zl=new Map;function Di(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Zl.has(t)||Zl.set(t,new Map);const e=Zl.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Zl.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function xq(t,e){var n;return Zl==null||(n=Zl.get(t.guid))===null||n===void 0?void 0:n.get(e)}const lE=new WeakMap,{register:Aq,getItem:d$,hasItem:f$,getNames:Hq,getValues:Mfe}=Di("editors");function Nq(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},oe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function g$(t,e){let n;if(typeof t=="function")lE.get(t)||Tr(null,t),n=lE.get(t);else if(typeof t=="string")n=d$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Ip(t){if(typeof t=="function")return t;if(!f$(t))throw Error(`No registered editor found under "${t}" name`);return d$(t).getConstructor()}function Tr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new Nq(e);typeof t=="string"&&Aq(t,n),lE.set(e,n)}function Dq(t,e,n){return(e=kq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kq(t){var e=Lq(t,"string");return typeof e=="symbol"?e:e+""}function Lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Xm=0;class Pi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Dq(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,$q(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Xm+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Xm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Xm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function $q(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ni(this)},t}function Fq(){return Xm}function Vq(t,e){Wq(t,e),e.add(t)}function Wq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return(e=Bq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bq(t){var e=jq(t,"string");return typeof e=="symbol"?e:e+""}function jq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hg=new WeakSet;class uE{constructor(e,n,r){Vq(this,hg),tl(this,"hot",void 0),tl(this,"tableMeta",void 0),tl(this,"selection",void 0),tl(this,"eventManager",void 0),tl(this,"destroyed",!1),tl(this,"activeEditor",void 0),tl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Pi(e),this.hot.addHook("afterDocumentKeyDown",i=>bS(hg,this,HA).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>bS(hg,this,HA).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>bS(hg,this,Uq).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=g$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function HA(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ta(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!rT(n)&&!a$(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function Uq(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const NA=new WeakMap;uE.getInstance=function(t,e,n){let r=NA.get(t);return r||(r=new uE(t,e,n),NA.set(t,r)),r};function zq(t,e){m$(t,e),e.add(t)}function Ih(t,e,n){m$(t,e),e.set(t,n)}function m$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(Ms(t,e))}function Oh(t,e,n){return t.set(Ms(t,e),n),n}function Ms(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vc=Object.freeze({CELL:"cell",MIXED:"mixed"});var hn=new WeakMap,dg=new WeakMap,fg=new WeakMap,gg=new WeakMap,mg=new WeakMap,ya=new WeakSet;class Yq{constructor(e){var n=this;zq(this,ya),Ih(this,hn,void 0),Ih(this,dg,void 0),Ih(this,fg,1),Ih(this,gg,null),Ih(this,mg,new Map);const r=e.getSettings();Oh(hn,this,e),Oh(dg,this,r.imeFastEdit?Vc.MIXED:Vc.CELL),Mt(hn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ms(ya,n,qq).call(n,...o)}),Mt(hn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ms(ya,n,DA).call(n,...o)}),Mt(hn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ms(ya,n,DA).call(n,...o)}),Mt(hn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ms(ya,n,Gq).call(n,...o)})}getFocusMode(){return Mt(dg,this)}setFocusMode(e){Object.values(Vc).includes(e)?Oh(dg,this,e):qe(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Mt(fg,this)}setRefocusDelay(e){Oh(fg,this,e)}setRefocusElementGetter(e){Oh(gg,this,e)}getRefocusElement(){var e;return typeof Mt(gg,this)=="function"?Mt(gg,this).call(this):(e=Mt(hn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Mt(hn,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Mt(hn,this).runHooks("modifyFocusedElement",s.row,s.col,r);zo(a)||(a=r),a&&!((o=Mt(hn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Ms(ya,this,oT).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Mt(fg,this);if(Mt(hn,this).getSettings().imeFastEdit&&!((e=Mt(hn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Mt(hn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Mt(mg,this).has(n)||Mt(mg,this).set(n,zf(()=>{if(!Mt(hn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Mt(mg,this).get(n)()}}}function oT(t){var e;const n=(e=Mt(hn,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!Mt(hn,this).selection.isCellVisible(n)){t(null);return}const r=Mt(hn,this).getCell(n.row,n.col,!0);r===null?Mt(hn,this).addHookOnce("afterScroll",()=>{t(Mt(hn,this).getCell(n.row,n.col,!0))}):t(r)}function DA(){Ms(ya,this,oT).call(this,t=>{const{activeElement:e}=Mt(hn,this).rootDocument;e&&zw(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Gq(){Ms(ya,this,oT).call(this,t=>{this.getFocusMode()===Vc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function qq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Vc.MIXED:Vc.CELL)}var kA={},RS,LA;function Kq(){if(LA)return RS;LA=1;var t=Oi(),e=pu(),n=lo(),r=n("match");return RS=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},RS}var ES,$A;function Xq(){if($A)return ES;$A=1;var t=sn(),e=fn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return ES={correct:r},ES}var TS,FA;function Zq(){if(FA)return TS;FA=1;var t=pn();return TS=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},TS}var _S,VA;function Qq(){if(VA)return _S;VA=1;var t=gn(),e=xi(),n=Of(),r=Xq(),i=Zq(),o=RegExp.prototype;return _S=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},_S}var MS,WA;function Jq(){if(WA)return MS;WA=1;var t=an(),e=ih(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return MS=function(l,u,c,h,d,f){var m=c+l.length,p=h.length,y=a;return d!==void 0&&(d=e(d),y=s),i(f,y,function(T,b){var M;switch(r(b,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,m);case"<":M=d[o(b,1,-1)];break;default:var R=+b;if(R===0)return T;if(R>p){var k=n(R/10);return k===0?T:k<=p?h[k-1]===void 0?r(b,1):h[k-1]+r(b,1):T}M=h[R-1]}return M===void 0?"":M})},MS}var BA;function eK(){if(BA)return kA;BA=1;var t=Et(),e=gn(),n=an(),r=Pf(),i=mn(),o=Oi(),s=Kq(),a=_w(),l=xf(),u=Qq(),c=Jq(),h=lo(),d=Ya(),f=h("replace"),m=TypeError,p=n("".indexOf),y=n("".replace),T=n("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(R,k){var P=r(this),O,U,G,V,Z,z,ue,ee,K,ne,ge=0,Ce="";if(o(R)){if(O=s(R),O&&(U=a(r(u(R))),!~p(U,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(G=l(R,f),G)return e(G,R,P,k);if(d&&O)return y(a(P),R,k)}for(V=a(P),Z=a(R),z=i(k),z||(k=a(k)),ue=Z.length,ee=b(1,ue),K=p(V,Z);K!==-1;)ne=z?a(k(Z,K,V)):c(Z,V,K,[],void 0,k),Ce+=T(V,ge,K)+ne,ge=K+ue,K=K+ee>V.length?-1:p(V,Z,K+ee);return ge<V.length&&(Ce+=T(V,ge)),Ce}}),kA}eK();const p$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},tK=new RegExp(Object.keys(p$).map(t=>`(${t})`).join("|"),"gi");function nK(t){return(t&&t.nodeName||"")==="TABLE"}function cE(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let y=0;y<s;y+=1){const T=!f&&n&&y===0;let b="";if(f)b=`<th>${t.getColHeader(y-c)}</th>`;else if(T)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][y],{hidden:R,rowspan:k,colspan:P}=t.getCellMeta(d-h,y-c);if(!R){const O=[];if(k&&O.push(`rowspan="${k}"`),P&&O.push(`colspan="${P}"`),Ut(M))b=`<td ${O.join(" ")}></td>`;else{const U=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${O.join(" ")}>${U}</td>`}}}m.push(b)}const p=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,p):u.splice(-1,0,p)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function hE(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Ut(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function dE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,R=>{const k=R.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,O=R.substring(k.length,R.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${k}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!nK(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,R)=>M+R.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(R=>{const k=R.querySelector("td")!==null;return k&&h.push(R),!k});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((R,k)=>{const P=Array.from(k.cells).reduce((O,U,G)=>{if(a&&G===0)return O;const{colSpan:V,innerHTML:Z}=U,z=V>1?{label:Z,colspan:V}:Z;return O.push(z),O},[]);return R.push(P),R},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((R,k,P)=>(a&&P===0||R.push(k.innerHTML),R),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const p=[...h,...Array.from(o.tBodies).reduce((M,R)=>(M.push(...Array.from(R.rows)),M),[]),...c];m=p.length;const y=new Array(m);for(let M=0;M<m;M++)y[M]=new Array(u);const T=[],b=[];for(let M=0;M<m;M++){const R=p[M],k=Array.from(R.cells),P=k.length;for(let O=0;O<P;O++){const U=k[O],{nodeName:G,innerHTML:V,rowSpan:Z,colSpan:z}=U,ue=y[M].findIndex(ee=>ee===void 0);if(G==="TD"){if(Z>1||z>1){for(let ge=M;ge<M+Z;ge++)if(ge<m)for(let Ce=ue;Ce<ue+z;Ce++)y[ge][Ce]=null;const K=U.getAttribute("style");K&&K.includes("mso-ignore:colspan")||T.push({col:ue,row:M,rowspan:Z,colspan:z})}let ee="";s&&/excel/gi.test(s.content)?ee=V.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=V.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[M][ue]=ee.replace(tK,K=>p$[K])}else b.push(V)}}return T.length&&(n.mergeCells=T),b.length&&(n.rowHeaders=b),y.length&&(n.data=y),n}const rK=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:hE,htmlToGridSettings:dE,instanceToHTML:cE},Symbol.toStringTag,{value:"Module"}));function qn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function w$(t){return qn(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function fE(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function sT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ue(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function v$(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function su(t){return Number.isInteger(t)&&t>=0}const iK=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ue,getParsedNumber:v$,isNumeric:qn,isNumericLike:w$,isUnsignedNumber:su,rangeEach:me,rangeEachReverse:fE,valueAccordingPercent:sT},Symbol.toStringTag,{value:"Module"})),gE="asc",oK="desc",jA=new Map([[gE,[-1,1]],[oK,[1,-1]]]),sK=t=>`The priority '${t}' is already declared in a map.`,aK=t=>`The priority '${t}' is not a number.`;function lK(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=rt(t)?t:sK,e=rt(e)?e:aK;function r(o,s){if(!qn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gE;const[s,a]=jA.get(o)||jA.get(gE);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const uK=t=>`The id '${t}' is already declared in a map.`;function qw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=rt(t)?t:uK;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const cK=t=>`'${t}' value is already declared in a unique set.`;function hK(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=rt(t)?t:cK;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const aT=t=>`There is already registered "${t}" plugin.`,dK=t=>`There is already registered plugin on priority "${t}".`,fK=t=>`The priority "${t}" is not a number.`,C$=lK({errorPriorityExists:dK,errorPriorityNaN:fK}),y$=hK({errorItemExists:aT}),mE=qw({errorIdExists:aT});function lT(){return[...C$.getItems(),...y$.getItems()]}function Yf(t){const e=Zn(t);return mE.getItem(e)}function gK(t){return!!Yf(t)}function Ye(t,e,n){[t,e,n]=pK(t,e,n),Yf(t)===void 0&&mK(t,e,n)}function mK(t,e,n){const r=Zn(t);if(mE.hasItem(r))throw new Error(aT(r));n===void 0?y$.addItem(r):C$.addItem(n,r),mE.addItem(r,e)}function pK(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:wK,getItem:vK,hasItem:S$,getNames:CK,getValues:Pfe}=Di("renderers");function Op(t){if(typeof t=="function")return t;if(!S$(t))throw Error(`No registered renderer found under "${t}" name`);return vK(t)}function qr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),wK(t,e)}const{register:yK,getItem:SK,hasItem:b$,getNames:bK,getValues:Ife}=Di("validators");function uT(t){if(typeof t=="function")return t;if(!b$(t))throw Error(`No registered validator found under "${t}" name`);return SK(t)}function Yl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),yK(t,e)}var UA={},zA;function RK(){if(zA)return UA;zA=1;var t=Et(),e=ih(),n=sh(),r=Af(),i=Gw();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),UA}RK();var YA={},GA;function EK(){if(GA)return YA;GA=1;var t=Et(),e=an(),n=Pf(),r=Af(),i=_w(),o=fn(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),YA}EK();function xh(t,e,n){return(e=TK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MK{constructor(){xh(this,"count",0),xh(this,"startColumn",null),xh(this,"endColumn",null),xh(this,"startPosition",null),xh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ah(t,e,n){return(e=PK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=IK(t,"string");return typeof e=="symbol"?e:e+""}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OK{constructor(){Ah(this,"count",0),Ah(this,"startRow",null),Ah(this,"endRow",null),Ah(this,"startPosition",null),Ah(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Hh(t,e,n){return(e=xK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xK(t){var e=AK(t,"string");return typeof e=="symbol"?e:e+""}function AK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R${constructor(){Hh(this,"count",0),Hh(this,"startColumn",null),Hh(this,"endColumn",null),Hh(this,"startPosition",null),Hh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Nh(t,e,n){return(e=HK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HK(t){var e=NK(t,"string");return typeof e=="symbol"?e:e+""}function NK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E${constructor(){Nh(this,"count",0),Nh(this,"startRow",null),Nh(this,"endRow",null),Nh(this,"startPosition",null),Nh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Dh(t,e,n){return(e=DK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=kK(t,"string");return typeof e=="symbol"?e:e+""}function kK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LK{constructor(){Dh(this,"count",0),Dh(this,"startColumn",0),Dh(this,"endColumn",0),Dh(this,"startPosition",0),Dh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function kh(t,e,n){return(e=$K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=FK(t,"string");return typeof e=="symbol"?e:e+""}function FK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VK{constructor(){kh(this,"count",0),kh(this,"startRow",0),kh(this,"endRow",0),kh(this,"startPosition",0),kh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function qA(t,e,n){return(e=WK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WK(t){var e=BK(t,"string");return typeof e=="symbol"?e:e+""}function BK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jK extends R${constructor(){super(...arguments),qA(this,"columnStartOffset",0),qA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function KA(t,e,n){return(e=UK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UK(t){var e=zK(t,"string");return typeof e=="symbol"?e:e+""}function zK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YK extends E${constructor(){super(...arguments),KA(this,"rowStartOffset",0),KA(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function XA(t,e,n){return(e=GK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=qK(t,"string");return typeof e=="symbol"?e:e+""}function qK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T${constructor(e){XA(this,"calculationTypes",[]),XA(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function $i(t,e,n){return(e=KK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KK(t){var e=XK(t,"string");return typeof e=="symbol"?e:e+""}function XK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kc=50;class ZK extends T${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),$i(this,"viewportWidth",0),$i(this,"scrollOffset",0),$i(this,"zeroBasedScrollOffset",0),$i(this,"totalColumns",0),$i(this,"columnWidthFn",null),$i(this,"columnWidth",0),$i(this,"overrideFn",null),$i(this,"inlineStartOffset",0),$i(this,"totalCalculatedWidth",0),$i(this,"startPositions",[]),$i(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Kc:n}}function ai(t,e,n){return(e=QK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QK(t){var e=JK(t,"string");return typeof e=="symbol"?e:e+""}function JK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e3 extends T${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),ai(this,"viewportHeight",0),ai(this,"scrollOffset",0),ai(this,"zeroBasedScrollOffset",0),ai(this,"totalRows",0),ai(this,"rowHeightFn",null),ai(this,"rowHeight",0),ai(this,"overrideFn",null),ai(this,"horizontalScrollbarHeight",0),ai(this,"innerViewportHeight",0),ai(this,"totalCalculatedHeight",0),ai(this,"startPositions",[]),ai(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function t3(t,e,n){n3(t,e),e.set(t,n)}function n3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZA(t,e,n){return(e=r3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r3(t){var e=i3(t,"string");return typeof e=="symbol"?e:e+""}function i3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iu(t,e){return t.get(_$(t,e))}function QA(t,e,n){return t.set(_$(t,e),n),n}function _$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var os=new WeakMap;class cu{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ZA(this,"row",null),ZA(this,"col",null),t3(this,os,!1),QA(os,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Iu(os,this)}isSouthEastOf(e){return this.row>=e.row&&(Iu(os,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Iu(os,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Iu(os,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Iu(os,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof cu&&QA(os,this,e.isRtl()),this}clone(){return new cu(this.row,this.col,Iu(os,this))}toObject(){return{row:this.row,col:this.col}}}function o3(t,e,n){s3(t,e),e.set(t,n)}function s3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return(e=a3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a3(t){var e=l3(t,"string");return typeof e=="symbol"?e:e+""}function l3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function li(t,e){return t.get(M$(t,e))}function u3(t,e,n){return t.set(M$(t,e),n),n}function M$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mr=new WeakMap;class fh{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;PS(this,"highlight",null),PS(this,"from",null),PS(this,"to",null),o3(this,mr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),u3(mr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return li(mr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return li(mr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return li(mr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return li(mr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return li(mr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return li(mr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return li(mr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return li(mr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof cu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(li(mr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(li(mr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new fh(this.highlight,this.from,this.to,li(mr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new cu(e,n,li(mr,this))}}function fo(t,e,n){c3(t,e),e.set(t,n)}function c3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(t,e){return t.get(P$(t,e))}function qs(t,e,n){return t.set(P$(t,e),n),n}function P$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ui=new WeakMap,IS=new WeakMap,Pn=new WeakMap,Ou=new WeakMap,pg=new WeakMap,Fi=new WeakMap,OS=new WeakMap,Lh=new WeakMap,nl=new WeakMap,go=new WeakMap;let I$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;fo(this,ui,void 0),fo(this,IS,void 0),fo(this,Pn,void 0),fo(this,Ou,void 0),fo(this,pg,void 0),fo(this,Fi,void 0),fo(this,OS,void 0),fo(this,Lh,void 0),fo(this,nl,[null,null]),fo(this,go,[null,null]),qs(ui,this,r),qs(IS,this,n),qs(Pn,this,o),qs(Ou,this,s),qs(pg,this,a),qs(Fi,this,i),qs(OS,this,e),this.registerEvents()}registerEvents(){we(Fi,this).addEventListener(we(Pn,this).holder,"contextmenu",r=>this.onContextMenu(r)),we(Fi,this).addEventListener(we(Pn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),we(Fi,this).addEventListener(we(Pn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{we(Fi,this).addEventListener(we(Pn,this).holder,"touchstart",r=>this.onTouchStart(r)),we(Fi,this).addEventListener(we(Pn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),we(Fi,this).addEventListener(we(Pn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||we(ui,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,we(ui,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{we(Fi,this).addEventListener(we(Pn,this).holder,"mouseup",r=>this.onMouseUp(r)),we(Fi,this).addEventListener(we(Pn,this).holder,"mousedown",r=>this.onMouseDown(r))};ro()?e():(B0()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(we(Lh,this)&&r){const[i,o]=[r.row,we(Lh,this).from.row],[s,a]=[r.col,we(Lh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=we(Pn,this).TABLE,i=Td(e,["TD","TH"],r);return i?(n.coords=we(Pn,this).getCoords(i),n.TD=i):be(e,"wtBorder")&&be(e,"current")?(n.coords=we(Ou,this).getFocusSelection().cellRange.highlight,n.TD=we(Pn,this).getCell(n.coords)):be(e,"wtBorder")&&be(e,"area")&&we(Ou,this).getAreaSelection().cellRange&&(n.coords=we(Ou,this).getAreaSelection().cellRange.to,n.TD=we(Pn,this).getCell(n.coords)),n}onMouseDown(e){const n=we(IS,this).rootDocument.activeElement,r=nT(UL,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);be(i,"corner")?we(ui,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&we(ui,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(we(go,this)[0]=o.TD,clearTimeout(we(nl,this)[0]),we(nl,this)[0]=setTimeout(()=>{we(go,this)[0]=null},1e3))}onContextMenu(e){if(we(ui,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!we(ui,this).has("onCellMouseOver"))return;const n=we(Pn,this).TABLE,r=Td(e.target,["TD","TH"],n),i=we(pg,this)||this;r&&r!==i.lastMouseOver&&ka(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,we(Pn,this).getCoords(r),r))}onMouseOut(e){if(!we(ui,this).has("onCellMouseOut"))return;const n=we(Pn,this).TABLE,r=Td(e.target,["TD","TH"],n),i=Td(e.relatedTarget,["TD","TH"],n),o=we(pg,this)||this;r&&r!==i&&ka(r,n)&&(this.callListener("onCellMouseOut",e,we(Pn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&we(ui,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===we(go,this)[0]&&n.TD===we(go,this)[1]?(be(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),we(go,this)[0]=null,we(go,this)[1]=null):n.TD===we(go,this)[0]&&(we(go,this)[1]=n.TD,clearTimeout(we(nl,this)[1]),we(nl,this)[1]=setTimeout(()=>{we(go,this)[1]=null},500)))}onTouchStart(e){qs(Lh,this,we(Ou,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ae(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&we(ui,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];U0()&&(WL()||BL())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=we(ui,this).getSettingPure(e);o&&o(n,r,i,we(OS,this).call(this))}destroy(){clearTimeout(we(nl,this)[0]),clearTimeout(we(nl,this)[1]),we(Fi,this).destroy()}};function xS(t,e,n){return(e=h3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h3(t){var e=d3(t,"string");return typeof e=="symbol"?e:e+""}function d3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f3{constructor(e,n,r){xS(this,"offset",void 0),xS(this,"total",void 0),xS(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function AS(t,e,n){return(e=g3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:e+""}function m3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p3{constructor(e,n,r){AS(this,"offset",void 0),AS(this,"total",void 0),AS(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function wg(t,e,n){return(e=w3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=v3(t,"string");return typeof e=="symbol"?e:e+""}function v3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C3{constructor(){wg(this,"currentSize",0),wg(this,"nextSize",0),wg(this,"currentOffset",0),wg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const y3=0,JA=1,pE=2;function HS(t,e,n){return(e=S3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=b3(t,"string");return typeof e=="symbol"?e:e+""}function b3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R3{constructor(){HS(this,"size",new C3),HS(this,"workingSpace",y3),HS(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=JA,e.workingSpace=pE,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=pE,e.workingSpace=JA,this.sharedSize=e.getViewSize()}}var eH={},NS,tH;function E3(){if(tH)return NS;tH=1;var t=Tw(),e=TypeError;return NS=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},NS}var nH;function T3(){if(nH)return eH;nH=1;var t=Et(),e=ih(),n=sh(),r=fk(),i=E3(),o=gk(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var m=d;m--;){var p=m+f;m in h?h[p]=h[m]:i(h,p)}for(var y=0;y<f;y++)h[y]=arguments[y]}return r(h,d+f)}}),eH}T3();function _3(t,e,n){return(e=M3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M3(t){var e=P3(t,"string");return typeof e=="symbol"?e:e+""}function P3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rH{constructor(e,n){_3(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function I3(t,e,n){return(e=O3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=x3(t,"string");return typeof e=="symbol"?e:e+""}function x3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3{constructor(e){I3(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new rH(o,n),l=new rH(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(pE)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function xu(t,e,n){return(e=H3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=N3(t,"string");return typeof e=="symbol"?e:e+""}function N3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O${constructor(e,n){xu(this,"rootNode",void 0),xu(this,"nodesPool",void 0),xu(this,"sizeSet",new R3),xu(this,"collectedNodes",[]),xu(this,"viewDiffer",new A3(this.sizeSet)),xu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class x$ extends O${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function iH(t,e,n){return(e=D3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D3(t){var e=k3(t,"string");return typeof e=="symbol"?e:e+""}function k3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L3{constructor(e){iH(this,"nodeType",void 0),iH(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function $h(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=F3(t,"string");return typeof e=="symbol"?e:e+""}function F3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gf{constructor(e,n){$h(this,"nodesPool",null),$h(this,"nodeType",void 0),$h(this,"rootNode",void 0),$h(this,"table",null),$h(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new L3(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function oH(t,e,n){return(e=V3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V3(t){var e=W3(t,"string");return typeof e=="symbol"?e:e+""}function W3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B3 extends Gf{constructor(){super("TH"),oH(this,"orderViews",new WeakMap),oH(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new x$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Uo(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(d,[R2(),N2(),V0(h+1),xr(-1)]),n[h](a,d,h)}u.end()}}}class j3 extends Gf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&qo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&fe(this.rootNode,[IL()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&fe(s,[OL(),NL(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Uo(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&fe(u,[V0(a+1+this.table.rowHeadersCount),xr(-1),E2(),...a>=0?[H2()]:[b2(),ri("Select whole grid")]]),r[n](l,u,n)}}}}let sH=!1;class U3 extends Gf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!sH&&e>1e3&&(sH=!0,qe(it`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Y(r,"rowHeader")}}function z3(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Au={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let aH=!1;class q3 extends Gf{constructor(e){super("TR",e),z3(this,"orderView",void 0),this.orderView=new O$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!aH&&e>1e3&&(aH=!0,qe(it`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&fe(this.rootNode,[IL()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;fe(o,[OL(),NL(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?be(o,Au.rowEven)||(ce(o,Au.rowOdd),Y(o,Au.rowEven)):be(o,Au.rowOdd)||(ce(o,Au.rowEven),Y(o,Au.rowOdd))}this.orderView.end()}}function lH(t,e,n){return(e=K3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:e+""}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z3 extends Gf{constructor(){super("TD"),lH(this,"orderViews",new WeakMap),lH(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new x$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(be(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Uo(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;fe(m,[...m.hasAttribute("role")?[]:[S2()],xr(-1),V0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function cn(t,e,n){return(e=Q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q3(t){var e=J3(t,"string");return typeof e=="symbol"?e:e+""}function J3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eX{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cn(this,"rootNode",void 0),cn(this,"rootDocument",void 0),cn(this,"rowHeaders",null),cn(this,"columnHeaders",null),cn(this,"colGroup",null),cn(this,"rows",null),cn(this,"cells",null),cn(this,"rowFilter",null),cn(this,"columnFilter",null),cn(this,"rowUtils",null),cn(this,"columnUtils",null),cn(this,"rowsToRender",0),cn(this,"columnsToRender",0),cn(this,"rowHeaderFunctions",[]),cn(this,"rowHeadersCount",0),cn(this,"columnHeaderFunctions",[]),cn(this,"columnHeadersCount",0),cn(this,"cellRenderer",void 0),cn(this,"activeOverlayName",void 0),cn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class tX{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new eX(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new B3,columnHeaders:new j3(n),colGroup:new U3(r),rows:new q3(i),cells:new Z3}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function DS(t,e,n){return(e=nX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=rX(t,"string");return typeof e=="symbol"?e:e+""}function rX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iX{constructor(e,n){DS(this,"dataAccessObject",void 0),DS(this,"wtSettings",void 0),DS(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function uH(t,e,n){return(e=oX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oX(t){var e=sX(t,"string");return typeof e=="symbol"?e:e+""}function sX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aX{constructor(e,n){uH(this,"dataAccessObject",void 0),uH(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function mo(t,e,n){return(e=lX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lX(t){var e=uX(t,"string");return typeof e=="symbol"?e:e+""}function uX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gh{constructor(e,n,r,i,o){mo(this,"wtSettings",null),mo(this,"domBindings",void 0),mo(this,"TBODY",null),mo(this,"THEAD",null),mo(this,"COLGROUP",null),mo(this,"hasTableHeight",!0),mo(this,"hasTableWidth",!0),mo(this,"isTableVisible",!1),mo(this,"tableOffset",0),mo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Y0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new aX(this.dataAccessObject,this.wtSettings),this.columnUtils=new iX(this.dataAccessObject,this.wtSettings),this.tableRenderer=new tX({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&fe(r,[Os()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&fe(r,[Os()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!be(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&fe(r,[xr(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&fe(r.parentNode,[Os()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&fe(r,[Os()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=$n(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=$n(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new p3(f,o,c),this.columnFilter=new f3(m,s,l);let p=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),p=y.skipRender!==!0}p&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Vo)||this.is(La))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Vo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Vo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Fc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Vo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Wa(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=GL(r),s=n.cellIndex;pa(fu,n,this.wtRootElement)||pa(hu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):pa(La,n,this.wtRootElement)||pa(Vo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),pa(fu,n,this.wtRootElement)||pa(du,n,this.wtRootElement)||pa(La,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Fc(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?nn:Fc,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-m||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Xt(this.TABLE)}getHeight(){return nn(this.TABLE)}getTotalWidth(){const e=Xt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=nn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return uu(this.TABLE)}_modifyRowHeaderWidth(e){let n=rt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const cX="stickyRowsBottom",cT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Jo(cT,"MIXIN_NAME",cX,{writable:!1,enumerable:!1});const hX="stickyColumnsStart",Kw={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jo(Kw,"MIXIN_NAME",hX,{writable:!1,enumerable:!1});class hT extends gh{constructor(e,n,r,i){super(e,n,r,i,La)}}ut(hT,cT);ut(hT,Kw);const hu="top",Vo="bottom",du="inline_start",fu="top_inline_start_corner",La="bottom_inline_start_corner",A$=[hu,Vo,du,fu,La],dX=new Map([[hu,`ht_clone_${hu}`],[Vo,`ht_clone_${Vo}`],[du,`ht_clone_${du} ht_clone_left`],[fu,`ht_clone_${fu} ht_clone_top_left_corner`],[La,`ht_clone_${La} ht_clone_bottom_left_corner`]]);function fX(t,e){gX(t,e),e.add(t)}function gX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mX(t,e,n){return(e=pX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:e+""}function wX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fh=new WeakSet;class vX{constructor(e){fX(this,Fh),mX(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Ar(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Ar(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return vg(Fh,this,hH).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return vg(Fh,this,hH).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return vg(Fh,this,cH).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return vg(Fh,this,cH).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function cH(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=$n(r.wtRootElement).left;const u=Math.abs(q0(s,s));if(l>u){const c=K0(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function hH(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=$n(n.wtRootElement),a=jw(o,o);if(s.top>a){const l=Fc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function ci(t,e,n){return(e=CX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dT{get eventManager(){return new Pi(this)}constructor(e,n){ci(this,"wtTable",void 0),ci(this,"wtScroll",void 0),ci(this,"wtViewport",void 0),ci(this,"wtOverlays",void 0),ci(this,"selectionManager",void 0),ci(this,"wtEvent",void 0),ci(this,"guid",`wt_${$0()}`),ci(this,"drawInterrupted",!1),ci(this,"drawn",!1),ci(this,"activeOverlayName","master"),ci(this,"domBindings",void 0),ci(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new vX(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ba(r,e[n])}])}}createCellCoords(e,n){return new cu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new fh(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||ZL(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function dH(t,e,n){return(e=SX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=bX(t,"string");return typeof e=="symbol"?e:e+""}function bX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RX extends dT{constructor(e,n,r){super(e,n),dH(this,"cloneSource",void 0),dH(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new I$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function EX(t,e,n){return(e=TX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TX(t){var e=_X(t,"string");return typeof e=="symbol"?e:e+""}function _X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qf{constructor(e,n,r,i,o){EX(this,"wtSettings",null),Jo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=qc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=qc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=df(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){qe(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+rn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(A$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${dX.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&fe(o,[Os()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===hu||u==="vertical"&&this.type===du?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=df(e.TABLE),new RX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class MX extends qf{constructor(e,n,r,i,o,s){super(e,n,La,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Uf(n),this.repositionOverlay();let r=nn(this.clone.wtTable.TABLE);const i=Xt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=rn(r)),i.style.bottom=`${o}px`}}const PX="calculatedColumns",Xw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Jo(Xw,"MIXIN_NAME",PX,{writable:!1,enumerable:!1});class fT extends gh{constructor(e,n,r,i){super(e,n,r,i,Vo)}}ut(fT,cT);ut(fT,Xw);function IX(t,e,n){return(e=OX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OX(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AX extends qf{constructor(e,n,r,i){super(e,n,Vo,r,i),IX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new fT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=rn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Bw(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=rn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=nn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=rn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=be(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(s,"innerBorderBottom"),o=!a):(ce(s,"innerBorderBottom"),o=a)}return o}}const HX="calculatedRows",gT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jo(gT,"MIXIN_NAME",HX,{writable:!1,enumerable:!1});class mT extends gh{constructor(e,n,r,i){super(e,n,r,i,du)}}ut(mT,gT);ut(mT,Kw);const NX="localHooks",Tn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Mp(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Jo(Tn,"MIXIN_NAME",NX,{writable:!1,enumerable:!1});let H$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ut(H$,Tn);const N$="active-header",pT="header",wT="area",xp="focus",DX="fill",kX="row",LX="column",$X="custom-selection",vT=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var fH={},gH;function FX(){if(gH)return fH;gH=1;var t=Gw();return t("flat"),fH}FX();function VX(t,e){D$(t,e),e.add(t)}function mH(t,e,n){D$(t,e),e.set(t,n)}function D$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(Vd(t,e))}function pH(t,e,n){return t.set(Vd(t,e),n),n}function Vd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zi=new WeakMap,Un=new WeakMap,Cg=new WeakSet;class WX{constructor(){VX(this,Cg),mH(this,zi,void 0),mH(this,Un,void 0)}setActiveOverlay(e){return pH(Un,this,e),this}setActiveSelection(e){return pH(zi,this,e),this}scan(){const e=Ft(zi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Ft(zi,this).getCorners(),{wtTable:s}=Ft(Un,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=s.getColumnHeader(h,f);const p=Ft(Un,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Ft(zi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});p!==null&&(p!==h&&(m=s.getColumnHeader(p,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Ft(zi,this).getCorners(),{wtTable:s}=Ft(Un,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const p=Ft(Un,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Ft(zi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});p!==null&&(p!==h&&(m=s.getRowHeader(p,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Ft(Un,this);Vd(Cg,this,BX).call(this,(r,i)=>{const o=n.getCell(Ft(Un,this).createCellCoords(r,i)),s=Ft(Un,this).getSetting("onAfterDrawSelection",r,i,Ft(zi,this).settings.layerLevel);typeof s=="string"&&Y(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Ft(zi,this).getCorners(),{wtTable:i}=Ft(Un,this);Vd(Cg,this,wH).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Ft(Un,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Ft(zi,this).getCorners(),{wtTable:i}=Ft(Un,this);Vd(Cg,this,wH).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Ft(Un,this).createCellCoords(o,s));e(a)}})}}function BX(t){let[e,n,r,i]=Ft(zi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Ft(Un,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Ft(Un,this).createCellCoords(e,n));if(!zo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function wH(t){const{wtTable:e}=Ft(Un,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class vH{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=vT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ni(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ro()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Ve(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Ve(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),p=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-p/4*3,10)}px`,c[l]=`${parseInt(i-p/4*3,10)}px`;const b=Math.min(parseInt(i+o,10),y-m-f*2),M=Math.min(parseInt(i+o-p/4,10),y-p-f*2);h[l]=`${b}px`,d[l]=`${M}px`;const R=Math.min(parseInt(r+s,10),T-m-f*2),k=Math.min(parseInt(r+s-p/4,10),T-p-f*2);h.top=`${R}px`,d.top=`${k}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),m=s.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let p;if(u){if(r=Math.max(r,f),o=Math.min(o,m),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}p=s.getCell(this.wot.createCellCoords(n,r))}else if(p=s.getCell(this.wot.createCellCoords(n,r)),!zo(p)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(i,o)):p,T=$n(p),b=u?$n(y):T,M=$n(s.TABLE),R=T.top,k=T.left,P=this.wot.wtSettings.getSetting("rtlMode");let O=0,U=0;if(P){const Ce=Xt(s.TABLE),ye=Xt(p),Me=l.innerWidth-M.left-Ce;U=k+ye-b.left,O=l.innerWidth-k-ye-Me-1}else U=b.left+Xt(y)-k,O=k-M.left-1;if(this.isEntireColumnSelected(n,i)){const Ce=n,ye=this.getDimensionsFromHeader("columns",r,o,Ce,M);let Me=null;ye&&([Me,O,U]=ye),Me&&(p=Me)}let G=R-M.top-1,V=b.top+nn(y)-R;if(this.isEntireRowSelected(r,o)){const Ce=r,ye=this.getDimensionsFromHeader("rows",n,i,Ce,M);let Me=null;ye&&([Me,G,V]=ye),Me&&(p=Me)}const Z=l.getComputedStyle(p);parseInt(Z.borderTopWidth,10)>0&&(G+=1,V=V>0?V-1:0),parseInt(Z[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(O+=1,U=U>0?U-1:0);const z=P?"right":"left",ue=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${G}px`,this.topStyle[z]=`${O}px`,this.topStyle.width=`${U+ue}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[z]=`${O}px`,this.startStyle.height=`${V+ue}px`,this.startStyle.display="block",this.bottomStyle.top=`${G+V-parseInt(this.bottomStyle.height,10)+ue}px`,this.bottomStyle[z]=`${O}px`,this.bottomStyle.width=`${U+ue}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[z]=`${O+U-parseInt(this.endStyle.width,10)+ue}px`,this.endStyle.height=`${V+ue}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const K=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[ne,ge]=[i,o];if(K&&Array.isArray(K)&&([,,ne,ge]=K),ro()||!ee||this.isPartRange(ne,ge))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+V+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[z]=`${O+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ce=qc(s.TABLE);const ye=Ce===l;ye&&(Ce=a.documentElement);const Me=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,We=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Tt=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const _e=ye?y.getBoundingClientRect().left:y.offsetLeft;let g=!1,w=0;if(P?(w=_e-parseInt(this.cornerDefaultStyle.width,10)/2,g=w<0):(w=_e+Xt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,g=w>=K0(Ce)),g){const C=Math.floor(O+U+this.cornerCenterPointOffset-We-Me);c?(this.cornerStyle[z]=`${C}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[z]=`${C-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(ye?y.getBoundingClientRect().top:y.offsetTop)+nn(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=Fc(Ce)){const C=Math.floor(G+V+this.cornerCenterPointOffset-Tt-Me);c?(this.cornerStyle.top=`${C}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${C-1}px`}this.cornerStyle.display="block"}ro()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,O,U,V)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,p=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return nn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Xt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(m=l(n,y-i),p=l(r,y-i),!m||!p)return!1;const T=$n(m),b=$n(p);return m&&p&&(h=T[f]-o[f]-1,d=b[f]+u(p)-T[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Y(this[e],"hidden"):(be(this[e],"hidden")&&ce(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Y(this[e],"hidden"):ce(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ro()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function jX(t,e){k$(t,e),e.add(t)}function Hu(t,e,n){k$(t,e),e.set(t,n)}function k$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function je(t,e){return t.get(CT(t,e))}function CH(t,e,n){return t.set(CT(t,e),n),n}function CT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,_r=new WeakMap,kS=new WeakMap,_d=new WeakMap,LS=new WeakMap,rl=new WeakMap,yH=new WeakSet;class UX{constructor(e){jX(this,yH),Hu(this,zn,void 0),Hu(this,_r,void 0),Hu(this,kS,new WX),Hu(this,_d,new WeakMap),Hu(this,LS,new WeakSet),Hu(this,rl,new Map),CH(_r,this,e)}setActiveOverlay(e){return CH(zn,this,e),je(kS,this).setActiveOverlay(je(zn,this)),je(_d,this).has(je(zn,this))||je(_d,this).set(je(zn,this),new Set),this}getFocusSelection(){return je(_r,this)!==null?je(_r,this).getFocus():null}getAreaSelection(){return je(_r,this)!==null?je(_r,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(je(rl,this).has(e)){const r=je(rl,this).get(e);if(r.has(je(zn,this)))return r.get(je(zn,this));const i=new vH(je(zn,this),e.settings);return r.set(je(zn,this),i),i}const n=new vH(je(zn,this),e.settings);return je(rl,this).set(e,new Map([[je(zn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=je(rl,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){je(rl,this).get(e).forEach(n=>n.destroy()),je(rl,this).delete(e)}render(e){if(je(_r,this)===null)return;e&&CT(yH,this,zX).call(this);const n=Array.from(je(_r,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;je(LS,this).has(s)||(je(LS,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&je(kS,this).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){const p=r.get(m);p.has(a)&&u===!0?p.set(a,p.get(a)+1):p.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=s.getCorners();je(zn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>je(_d,this).get(je(zn,this)).add(u)),Y(s,l),s.nodeName==="TD"&&Array.isArray((a=je(_r,this).options)===null||a===void 0?void 0:a.cellAttributes)&&fe(s,je(_r,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{fe(o,[...i.get(o)])})}}function zX(){const t=je(_d,this).get(je(zn,this)),e=je(zn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=je(zn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=je(_r,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=je(_r,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=je(_r,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...je(_r,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ce(o[a],n),Uo(o[a],s)}),t.clear()}class YX extends qf{constructor(e,n,r,i){super(e,n,du,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new mT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Uw(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Uf(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,G0(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=rn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Xt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=vT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!be(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=rn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,JL(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(q0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ce(r,"emptyRows"):Y(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Y(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=be(r,"innerBorderInlineStart");e?(Y(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(ce(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const GX="stickyRowsTop",yT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Jo(yT,"MIXIN_NAME",GX,{writable:!1,enumerable:!1});class ST extends gh{constructor(e,n,r,i){super(e,n,r,i,fu)}}ut(ST,yT);ut(ST,Kw);function SH(t,e,n){return(e=qX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=KX(t,"string");return typeof e=="symbol"?e:e+""}function KX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XX extends qf{constructor(e,n,r,i,o,s){super(e,n,fu,r,i),SH(this,"topOverlay",void 0),SH(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ST(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Uw(e,`${i}px`,`${o}px`)}else Uf(e);let n=nn(this.clone.wtTable.TABLE);const r=Xt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class bT extends gh{constructor(e,n,r,i){super(e,n,r,i,hu)}}ut(bT,yT);ut(bT,Xw);function ZX(t,e,n){return(e=QX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QX(t){var e=JX(t,"string");return typeof e=="symbol"?e:e+""}function JX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e4 extends qf{constructor(e,n,r,i){super(e,n,hu,r,i),ZX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new bT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Uw(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Uf(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Bw(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=rn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=nn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=vT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!be(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=rn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,QL(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?ce(i,"emptyColumns"):Y(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=be(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Y(i,"innerBorderTop"),a=!h):(ce(i,"innerBorderTop"),a=h)}}return a}}function yg(t,e,n){t4(t,e),e.set(t,n)}function t4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e,n){return(e=n4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n4(t){var e=r4(t,"string");return typeof e=="symbol"?e:e+""}function r4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function il(t,e,n){return t.set(L$(t,e),n),n}function as(t,e){return t.get(L$(t,e))}function L$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nu=new WeakMap,Sg=new WeakMap,Du=new WeakMap,bg=new WeakMap;class i4{constructor(e,n,r,i,o,s){ss(this,"wot",null),yg(this,Nu,[]),ss(this,"topOverlay",null),ss(this,"bottomOverlay",null),ss(this,"inlineStartOverlay",null),ss(this,"topInlineStartCornerOverlay",null),ss(this,"bottomInlineStartCornerOverlay",null),ss(this,"browserLineHeight",void 0),ss(this,"wtSettings",null),yg(this,Sg,!1),yg(this,Du,0),yg(this,bg,null),ss(this,"resizeObserver",new ResizeObserver(c=>{cf(()=>{!Array.isArray(c)||!c.length||(il(Du,this,as(Du,this)+1),as(Du,this)===300&&(qe("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),as(bg,this)!==null&&clearTimeout(as(bg,this)),il(bg,this,setTimeout(()=>{il(Du,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=rn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:df(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...as(Nu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new e4(...e),this.bottomOverlay=new AX(...e),this.inlineStartOverlay=new YX(...e),this.topInlineStartCornerOverlay=new XX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new MX(...e,this.bottomOverlay,this.inlineStartOverlay),il(Nu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){il(Sg,this,as(Nu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),as(Nu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),as(Nu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!j0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{cf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{il(Du,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=dh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!as(Sg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),il(Sg,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=df(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),f=n.hider.style,m=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-n.holder.clientHeight),p=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-n.holder.clientWidth),y=m()?1:0,T=p()?1:0;f.width=`${h+T}px`,f.height=`${c+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return I(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function bH(t,e,n){return(e=o4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o4(t){var e=s4(t,"string");return typeof e=="symbol"?e:e+""}function s4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a4{constructor(e){bH(this,"settings",{}),bH(this,"defaults",Object.freeze(this.getDefaults())),Ve(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ba(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Ve(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class RT extends gh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=qc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=ff(e,"height",n),o=ff(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=uu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ut(RT,gT);ut(RT,Xw);class l4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new VK:new YK],["fullyVisible",()=>new OK],["partiallyVisible",()=>new E$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new LK:new jK],["fullyVisible",()=>new MK],["partiallyVisible",()=>new R$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=nn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,r=this.hasVerticalScroll()?rn():0;return n>this.getWorkspaceWidth()-r}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return $n(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=nn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Xt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=rn(this.domBindings.rootDocument),new e3({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=rn(this.domBindings.rootDocument)),new ZK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible"),s=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;const{startRow:o,endRow:s}=n;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;r=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;const{startColumn:o,endColumn:s}=n;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;r=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){Ve(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class u4 extends dT{constructor(e,n){super(e,new a4(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new RT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new l4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new UX(this.wtSettings.getSetting("selections")),this.wtEvent=new I$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new i4(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ve(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),ce(this.wtTable.wtRootElement.parentNode,n),Y(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!A$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class ET{constructor(e){e instanceof dT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new ET(n);return()=>r},this._wot=new u4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function RH(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function c4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function EH(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const h4=new Map([["touchstart",RH],["touchend",EH],["mousedown",RH],["mouseover",c4],["mouseup",EH]]);function $S(t,e){h4.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:Yw(t)||t.type==="touchstart",isRightClick:ja(t),...e})}const $$=new WeakMap,TT=Symbol("rootInstance");function d4(t){$$.set(t,!0)}function f4(t){return t===TT}function Vl(t){return $$.has(t)}function g4(t,e){F$(t,e),e.add(t)}function Ks(t,e,n){F$(t,e),e.set(t,n)}function F$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){return(e=m4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m4(t){var e=p4(t,"string");return typeof e=="symbol"?e:e+""}function p4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qt(t,e){return t.get(Wc(t,e))}function pr(t,e,n){return t.set(Wc(t,e),n),n}function Wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var FS=new WeakMap,Rg=new WeakMap,Eg=new WeakMap,ls=new WeakMap,Vi=new WeakMap,VS=new WeakMap,WS=new WeakMap,ku=new WeakMap,Md=new WeakSet;class w4{constructor(e){g4(this,Md),Xs(this,"hot",void 0),Xs(this,"eventManager",void 0),Xs(this,"settings",void 0),Xs(this,"THEAD",void 0),Xs(this,"TBODY",void 0),Xs(this,"_wt",void 0),Xs(this,"activeWt",void 0),Ks(this,FS,0),Ks(this,Rg,0),Xs(this,"postponedAdjustElementsSize",!1),Ks(this,Eg,!1),Ks(this,ls,void 0),Ks(this,Vi,void 0),Ks(this,VS,0),Ks(this,WS,0),Ks(this,ku,null),this.hot=e,this.eventManager=new Pi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Wc(Md,this,C4).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Y(e,"handsontable"),pr(Vi,this,n.createElement("TABLE")),Y(Qt(Vi,this),"htCore"),this.hot.getSettings().tableClassName&&Y(Qt(Vi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(fe(Qt(Vi,this),[Os()]),fe(e,[y2(),HL(-1),Vw(this.hot.countCols()),$2()])),this.THEAD=n.createElement("THEAD"),Qt(Vi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Qt(Vi,this).appendChild(this.TBODY),this.hot.table=Qt(Vi,this),this.hot.container.insertBefore(Qt(Vi,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:r,selection:i,rootWindow:o}=this.hot,s=r.documentElement;this.eventManager.addEventListener(n,"mousedown",l=>{pr(Eg,this,!0),this.isTextSelectionAllowed(l.target)||(aE(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{pr(Eg,this,!1)}),this.eventManager.addEventListener(n,"mousemove",l=>{Qt(Eg,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&aE(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&Yw(l)&&i.finish(),pr(ls,this,!1);const c=zw(r.activeElement),h=(u=r.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(r.activeElement);Fd(r.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??n).contains(l.target)&&!ja(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&ja(l)&&(i.finish(),pr(ls,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),pr(ls,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(Qt(ls,this)||!n||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const p=rn(r);if(r.elementFromPoint(c+p,h)!==f||r.elementFromPoint(c,h+p)!==f)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===n)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=lu(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=lu(a);this.eventManager.addEventListener(Qt(Vi,this),"selectstart",l=>{this.settings.fragmentSelection||Fd(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Y(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&ce(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Qt(Vi,this),isDataViewInstance:()=>Vl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),pr(Rg,this,o.length),this.hot.getSettings().ariaTags&&Wc(Md,this,V$).call(this)===this.hot.countCols()&&Wc(Md,this,v4).call(this,Qt(Rg,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),pr(FS,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let p=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(p=this.hot.runHooks("beforeValueRender",p,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,p,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,p,f),this.hot.runHooks("afterRenderer",a,l,u,m,p,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&uu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,pr(ls,this,!0),pr(ku,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ta(o)&&($S(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,pr(ls,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ta(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ta(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ta(o)&&(Qt(ls,this)&&(!Qt(ku,this)||Qt(ku,this).x!==o.clientX||Qt(ku,this).y!==o.clientY)&&$S(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,pr(ku,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ta(o)||this.hot.isDestroyed)&&($S(o,{coords:u,selection:this.hot.selection,cellRangeMapper:xq(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,p,y,T]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new ET(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,r;if(Fd(e))return!0;const i=ka(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(n=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return Qt(ls,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!be(r,"relative")){qo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;be(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",Y(s,["relative",...o()])):(qo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(fe(a,...Os()),fe(l,...Os())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(be(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):be(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ka(e,r(n,i)):(Ba(e,"Â "),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){pr(VS,this,e),pr(WS,this,n)}getLastSize(){return{width:Qt(VS,this),height:Qt(WS,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Qt(FS,this)}getRowHeadersCount(){return Qt(Rg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function V$(){return parseInt(this.hot.rootElement.getAttribute(Vw()[0]),10)}function v4(t){const e=Wc(Md,this,V$).call(this)+t;fe(this.hot.rootElement,...Vw(e))}function C4(){const t=this.hot.rootElement;this.hasVerticalScroll()?Y(t,"htHasScrollY"):ce(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?Y(t,"htVerticallyScrollableByWindow"):ce(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?Y(t,"htHasScrollX"):ce(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?Y(t,"htHorizontallyScrollableByWindow"):ce(t,"htHorizontallyScrollableByWindow")}var TH={},_H={},MH;function y4(){if(MH)return _H;MH=1;var t=Et(),e=gn(),n=ah(),r=Hr(),i=pn(),o=Xo(),s=Nr(),a=qa(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,m){if(!c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),_H}var PH;function S4(){return PH||(PH=1,y4()),TH}S4();const W$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",wE=W$.length;function Zw(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%wE,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/wE,10);return n}function b4(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=wE**r*(W$.indexOf(t[n])+1);return e-=1,e}function R4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Zw(i)+(r+1));n.push(o)}return n}function E4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Zw(i)+(r+1);n.push(o)}return n}function T4(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function _T(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function MT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Te(t[0])&&(e=Ww(t[0]))),e}function B$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function j$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const _4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:MT,createEmptySpreadsheetData:T4,createSpreadsheetData:R4,createSpreadsheetObjectData:E4,dataRowToChangesArray:_T,isArrayOfArrays:B$,isArrayOfObjects:j$,spreadsheetColumnIndex:b4,spreadsheetColumnLabel:Zw},Symbol.toStringTag,{value:"Module"}));function Vh(t,e,n){return(e=M4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M4(t){var e=P4(t,"string");return typeof e=="symbol"?e:e+""}function P4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Vh(this,"hot",void 0),Vh(this,"data",void 0),Vh(this,"dataType","array"),Vh(this,"colToProp",()=>{}),Vh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return I(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):me(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Te(a)||rt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;me(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?qm(l,d,f):l[d]=f}})}else Ve(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?qm(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Ar(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:qm(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Ep(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Ar(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}getCopyable(e,n){const r=this.propToCol(n);return this.hot.getCellMeta(e,r).copyable?this.getAtCell(this.hot.toPhysicalRow(e),r):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return MT(this.data)}destroy(){this.data=null,this.hot=null}}var IH={},OH={},xH;function O4(){if(xH)return OH;xH=1;var t=Et(),e=gn(),n=ah(),r=Hr(),i=pn(),o=Xo(),s=Nr(),a=qa(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),OH}var AH;function x4(){return AH||(AH=1,O4()),IH}x4();function HH(t,e,n){return(e=A4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A4(t){var e=H4(t,"string");return typeof e=="symbol"?e:e+""}function H4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ru{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;HH(this,"indexedValues",[]),HH(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,rt(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ut(Ru,Tn);function PT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>rt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function IT(t,e){return Va(t,(n,r)=>e.includes(r)===!1)}class Xa extends Ru{insert(e,n){this.indexedValues=PT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=IT(this.indexedValues,e),super.remove(e)}}class Qw extends Xa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return wn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function OT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function gf(t,e){return Va(t,n=>e.includes(n)===!1)}function xT(t,e){return Je(t,n=>n-e.filter(r=>r<n).length)}function AT(t,e){const n=e[0],r=e.length;return Je(t,i=>i>=n?i+r:i)}function N4(t,e,n){return(e=D4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D4(t){var e=k4(t,"string");return typeof e=="symbol"?e:e+""}function k4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jw extends Ru{constructor(){super(...arguments),N4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=gf(this.orderOfIndexes,[e]),rt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=PT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=AT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=IT(this.indexedValues,e),this.orderOfIndexes=gf(this.orderOfIndexes,e),this.orderOfIndexes=xT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Kf extends Xa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return wn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const NH=new Map([["indexesSequence",{getListWithInsertedItems:OT,getListWithRemovedItems:gf}],["physicallyIndexed",{getListWithInsertedItems:PT,getListWithRemovedItems:IT}]]),U$=t=>{if(NH.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return NH.get(t)};class z$ extends Ru{constructor(){super(e=>e)}insert(e,n){const r=AT(this.indexedValues,n);this.indexedValues=OT(r,e,n),super.insert(e,n)}remove(e){const n=gf(this.indexedValues,e);this.indexedValues=xT(n,e),super.remove(e)}}const DH=new Map([["hiding",Qw],["index",Ru],["linkedPhysicalIndexToValue",Jw],["physicalIndexToValue",Xa],["trimming",Kf]]);function L4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!DH.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(DH.get(t))(e)}function $4(t,e,n){return(e=F4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F4(t){var e=V4(t,"string");return typeof e=="symbol"?e:e+""}function V4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let vE=0;class HT{constructor(){$4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),vE+=1)}unregister(e){const n=this.collection.get(e);ae(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),vE-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return It(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ut(HT,Tn);function W4(){return vE}function BS(t,e,n){return(e=B4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B4(t){var e=j4(t,"string");return typeof e=="symbol"?e:e+""}function j4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kH extends HT{constructor(e,n){super(),BS(this,"mergedValuesCache",[]),BS(this,"aggregationFunction",void 0),BS(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Je(this.get(),o=>o.getValues()),r=[],i=ae(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Je(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ae(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function U4(t,e,n){z4(t,e),e.set(t,n)}function z4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y4(t,e,n){return t.set(Y$(t,e),n),n}function G4(t,e){return t.get(Y$(t,e))}function Y$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jS=new WeakMap;class G${constructor(){U4(this,jS,[])}subscribe(e){return this.addLocalHook("change",e),this._write(G4(jS,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Y4(jS,this,e)}}ut(G$,Tn);function LH(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Wh(t,e,n){q4(t,e),e.set(t,n)}function q4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hi(t,e){return t.get(q$(t,e))}function Tg(t,e,n){return t.set(q$(t,e),n),n}function q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _g=new WeakMap,Bh=new WeakMap,Mg=new WeakMap,Pg=new WeakMap,Ig=new WeakMap;class K4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wh(this,_g,new Set),Wh(this,Bh,[]),Wh(this,Mg,[]),Wh(this,Pg,!1),Wh(this,Ig,!1),Tg(Ig,this,e??!1)}createObserver(){const e=new G$;return hi(_g,this).add(e),e.addLocalHook("unsubscribe",()=>{hi(_g,this).delete(e)}),e._writeInitialChanges(LH(hi(Bh,this),hi(Mg,this))),e}emit(e){let n=hi(Mg,this);(!hi(Pg,this)||hi(Bh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(hi(Ig,this)):Tg(Bh,this,new Array(e.length).fill(hi(Ig,this))),hi(Pg,this)||(Tg(Pg,this,!0),n=hi(Bh,this)));const r=LH(n,e);hi(_g,this).forEach(i=>i._write(r)),Tg(Mg,this,e)}}function tr(t,e,n){return(e=X4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X4(t){var e=Z4(t,"string");return typeof e=="symbol"?e:e+""}function Z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CE{constructor(){tr(this,"indexesSequence",new z$),tr(this,"trimmingMapsCollection",new kH(e=>e.some(n=>n===!0),!1)),tr(this,"hidingMapsCollection",new kH(e=>e.some(n=>n===!0),!1)),tr(this,"variousMapsCollection",new HT),tr(this,"hidingChangesObservable",new K4({initialIndexValue:!1})),tr(this,"notTrimmedIndexesCache",[]),tr(this,"notHiddenIndexesCache",[]),tr(this,"isBatched",!1),tr(this,"indexesSequenceChanged",!1),tr(this,"indexesChangeSource",void 0),tr(this,"trimmedIndexesChanged",!1),tr(this,"hiddenIndexesChanged",!1),tr(this,"renderablePhysicalIndexesCache",[]),tr(this,"fromPhysicalToVisualIndexesCache",new Map),tr(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,L4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Kf?this.trimmingMapsCollection.register(e,n):n instanceof Qw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ae(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ae(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ae(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ae(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Je(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=gf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(OT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ae(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Je(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ut(CE,Tn);function Q4(t,e){return Ve(e,(n,r)=>{It(t[r])&&(t[r]=n)}),t}function K$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function X$(t){ae(t)&&iT(it`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function J4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function Z$(t,e){return Array.isArray(t)?t.map(n=>Z$(n,e)):$w(t,e)}const{register:e6,getValues:t6}=Di("phraseFormatters");function Q$(t,e){e6(t,e)}function n6(){return t6()}Q$("pluralize",J4);Q$("substitute",Z$);const J$="ContextMenu:items",He=J$,NT=`${He}.noItems`,DT=`${He}.insertRowAbove`,kT=`${He}.insertRowBelow`,LT=`${He}.insertColumnOnTheLeft`,$T=`${He}.insertColumnOnTheRight`,FT=`${He}.removeRow`,VT=`${He}.removeColumn`,WT=`${He}.undo`,BT=`${He}.redo`,Ap=`${He}.readOnly`,jT=`${He}.clearColumn`,UT=`${He}.copy`,zT=`${He}.copyWithHeaders`,YT=`${He}.copyWithGroupHeaders`,GT=`${He}.copyHeadersOnly`,qT=`${He}.cut`,KT=`${He}.freezeColumn`,XT=`${He}.unfreezeColumn`,ZT=`${He}.mergeCells`,QT=`${He}.unmergeCells`,JT=`${He}.addComment`,e_=`${He}.editComment`,t_=`${He}.removeComment`,n_=`${He}.readOnlyComment`,r_=`${He}.align`,i_=`${He}.align.left`,o_=`${He}.align.center`,s_=`${He}.align.right`,a_=`${He}.align.justify`,l_=`${He}.align.top`,u_=`${He}.align.middle`,c_=`${He}.align.bottom`,h_=`${He}.borders`,d_=`${He}.borders.top`,f_=`${He}.borders.right`,g_=`${He}.borders.bottom`,m_=`${He}.borders.left`,p_=`${He}.borders.remove`,w_=`${He}.nestedHeaders.insertChildRow`,v_=`${He}.nestedHeaders.detachFromParent`,C_=`${He}.hideColumn`,y_=`${He}.showColumn`,S_=`${He}.hideRow`,b_=`${He}.showRow`,fr="Filters:",zt=`${fr}conditions`,ev=`${zt}.none`,R_=`${zt}.isEmpty`,E_=`${zt}.isNotEmpty`,T_=`${zt}.isEqualTo`,__=`${zt}.isNotEqualTo`,M_=`${zt}.beginsWith`,P_=`${zt}.endsWith`,I_=`${zt}.contains`,O_=`${zt}.doesNotContain`,r6=`${zt}.byValue`,x_=`${zt}.greaterThan`,A_=`${zt}.greaterThanOrEqualTo`,H_=`${zt}.lessThan`,N_=`${zt}.lessThanOrEqualTo`,D_=`${zt}.isBetween`,k_=`${zt}.isNotBetween`,L_=`${zt}.after`,$_=`${zt}.before`,F_=`${zt}.today`,V_=`${zt}.tomorrow`,W_=`${zt}.yesterday`,B_=`${fr}labels.filterByCondition`,j_=`${fr}labels.filterByValue`,U_=`${fr}labels.conjunction`,tv=`${fr}labels.disjunction`,Hp=`${fr}values.blankCells`,z_=`${fr}buttons.selectAll`,Y_=`${fr}buttons.clear`,G_=`${fr}buttons.ok`,q_=`${fr}buttons.cancel`,K_=`${fr}buttons.placeholder.search`,X_=`${fr}buttons.placeholder.value`,Z_=`${fr}buttons.placeholder.secondValue`,es="Pagination:",Q_=`${es}section.pagination`,J_=`${es}.pageSize.auto`,Np=`${es}section.pageSize`,eM=`${es}section.counter`,tM=`${es}section.navigation`,nM=`${es}firstPage`,rM=`${es}prevPage`,iM=`${es}nextPage`,oM=`${es}lastPage`,sM="CheckboxRenderer:",aM=`${sM}checked`,lM=`${sM}unchecked`,eF="Loading:",uM=`${eF}title`,i6=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:aM,CHECKBOX_RENDERER_NAMESPACE:sM,CHECKBOX_UNCHECKED:lM,CONTEXTMENU_ITEMS_ADD_COMMENT:JT,CONTEXTMENU_ITEMS_ALIGNMENT:r_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:c_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:o_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:a_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:i_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:u_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:s_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:l_,CONTEXTMENU_ITEMS_BORDERS:h_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:g_,CONTEXTMENU_ITEMS_BORDERS_LEFT:m_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:f_,CONTEXTMENU_ITEMS_BORDERS_TOP:d_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:jT,CONTEXTMENU_ITEMS_COPY:UT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:GT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:YT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:zT,CONTEXTMENU_ITEMS_CUT:qT,CONTEXTMENU_ITEMS_EDIT_COMMENT:e_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:KT,CONTEXTMENU_ITEMS_HIDE_COLUMN:C_,CONTEXTMENU_ITEMS_HIDE_ROW:S_,CONTEXTMENU_ITEMS_INSERT_LEFT:LT,CONTEXTMENU_ITEMS_INSERT_RIGHT:$T,CONTEXTMENU_ITEMS_MERGE_CELLS:ZT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:v_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:w_,CONTEXTMENU_ITEMS_NO_ITEMS:NT,CONTEXTMENU_ITEMS_READ_ONLY:Ap,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:n_,CONTEXTMENU_ITEMS_REDO:BT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:p_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:VT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:t_,CONTEXTMENU_ITEMS_REMOVE_ROW:FT,CONTEXTMENU_ITEMS_ROW_ABOVE:DT,CONTEXTMENU_ITEMS_ROW_BELOW:kT,CONTEXTMENU_ITEMS_SHOW_COLUMN:y_,CONTEXTMENU_ITEMS_SHOW_ROW:b_,CONTEXTMENU_ITEMS_UNDO:WT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:XT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:QT,CONTEXT_MENU_ITEMS_NAMESPACE:J$,FILTERS_BUTTONS_CANCEL:q_,FILTERS_BUTTONS_CLEAR:Y_,FILTERS_BUTTONS_OK:G_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:K_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Z_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:X_,FILTERS_BUTTONS_SELECT_ALL:z_,FILTERS_CONDITIONS_AFTER:L_,FILTERS_CONDITIONS_BEFORE:$_,FILTERS_CONDITIONS_BEGINS_WITH:M_,FILTERS_CONDITIONS_BETWEEN:D_,FILTERS_CONDITIONS_BY_VALUE:r6,FILTERS_CONDITIONS_CONTAINS:I_,FILTERS_CONDITIONS_EMPTY:R_,FILTERS_CONDITIONS_ENDS_WITH:P_,FILTERS_CONDITIONS_EQUAL:T_,FILTERS_CONDITIONS_GREATER_THAN:x_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:A_,FILTERS_CONDITIONS_LESS_THAN:H_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:N_,FILTERS_CONDITIONS_NAMESPACE:zt,FILTERS_CONDITIONS_NONE:ev,FILTERS_CONDITIONS_NOT_BETWEEN:k_,FILTERS_CONDITIONS_NOT_CONTAIN:O_,FILTERS_CONDITIONS_NOT_EMPTY:E_,FILTERS_CONDITIONS_NOT_EQUAL:__,FILTERS_CONDITIONS_TODAY:F_,FILTERS_CONDITIONS_TOMORROW:V_,FILTERS_CONDITIONS_YESTERDAY:W_,FILTERS_DIVS_FILTER_BY_CONDITION:B_,FILTERS_DIVS_FILTER_BY_VALUE:j_,FILTERS_LABELS_CONJUNCTION:U_,FILTERS_LABELS_DISJUNCTION:tv,FILTERS_NAMESPACE:fr,FILTERS_VALUES_BLANK_CELLS:Hp,LOADING_NAMESPACE:eF,LOADING_TITLE:uM,PAGINATION_COUNTER_SECTION:eM,PAGINATION_FIRST_PAGE:nM,PAGINATION_LAST_PAGE:oM,PAGINATION_NAMESPACE:es,PAGINATION_NAV_SECTION:tM,PAGINATION_NEXT_PAGE:iM,PAGINATION_PAGE_SIZE_AUTO:J_,PAGINATION_PAGE_SIZE_SECTION:Np,PAGINATION_PREV_PAGE:rM,PAGINATION_SECTION:Q_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const tF={languageCode:"en-US",[NT]:"No available options",[DT]:"Insert row above",[kT]:"Insert row below",[LT]:"Insert column left",[$T]:"Insert column right",[FT]:["Remove row","Remove rows"],[VT]:["Remove column","Remove columns"],[WT]:"Undo",[BT]:"Redo",[Ap]:"Read only",[jT]:"Clear column",[r_]:"Alignment",[i_]:"Left",[o_]:"Center",[s_]:"Right",[a_]:"Justify",[l_]:"Top",[u_]:"Middle",[c_]:"Bottom",[KT]:"Freeze column",[XT]:"Unfreeze column",[h_]:"Borders",[d_]:"Top",[f_]:"Right",[g_]:"Bottom",[m_]:"Left",[p_]:"Remove border(s)",[JT]:"Add comment",[e_]:"Edit comment",[t_]:"Delete comment",[n_]:"Read-only comment",[ZT]:"Merge cells",[QT]:"Unmerge cells",[UT]:"Copy",[zT]:["Copy with header","Copy with headers"],[YT]:["Copy with group header","Copy with group headers"],[GT]:["Copy header only","Copy headers only"],[qT]:"Cut",[w_]:"Insert child row",[v_]:"Detach from parent",[C_]:["Hide column","Hide columns"],[y_]:["Show column","Show columns"],[S_]:["Hide row","Hide rows"],[b_]:["Show row","Show rows"],[ev]:"None",[R_]:"Is empty",[E_]:"Is not empty",[T_]:"Is equal to",[__]:"Is not equal to",[M_]:"Begins with",[P_]:"Ends with",[I_]:"Contains",[O_]:"Does not contain",[x_]:"Greater than",[A_]:"Greater than or equal to",[H_]:"Less than",[N_]:"Less than or equal to",[D_]:"Is between",[k_]:"Is not between",[L_]:"After",[$_]:"Before",[F_]:"Today",[V_]:"Tomorrow",[W_]:"Yesterday",[Hp]:"Blank cells",[B_]:"Filter by condition",[j_]:"Filter by value",[U_]:"And",[tv]:"Or",[z_]:"Select all",[Y_]:"Clear",[G_]:"OK",[q_]:"Cancel",[K_]:"Search",[X_]:"Value",[Z_]:"Second value",[Q_]:"Pagination",[Np]:"Page size",[J_]:"Auto",[eM]:"[start] - [end] of [total]",[tM]:"Page [currentPage] of [totalPages]",[nM]:"Go to first page",[rM]:"Go to previous page",[iM]:"Go to next page",[oM]:"Go to last page",[aM]:"Checked",[lM]:"Unchecked",[uM]:"Loading..."},o6=i6,yE=tF.languageCode,{register:s6,getItem:nF,hasItem:a6,getValues:l6}=Di("languagesDictionaries");rF(tF);function rF(t,e){let n=t,r=e;return Te(t)&&(r=t,n=r.languageCode),u6(n,r),s6(n,Qn(r)),Qn(r)}function u6(t,e){t!==yE&&Q4(e,nF(yE))}function iF(t){return cM(t)?Qn(nF(t)):null}function cM(t){return a6(t)}function c6(){return l6()}function oF(t,e,n){const r=iF(t);if(r===null)return null;const i=r[e];if(It(i))return null;const o=h6(i,n);return Array.isArray(o)?o[0]:o}function h6(t,e){return n6().reduce((n,r)=>r(n,e),t)}function d6(t){let e=K$(t);return cM(e)||(e=yE,X$(t)),e}function f6(t,e,n){return(e=g6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g6(t){var e=m6(t,"string");return typeof e=="symbol"?e:e+""}function m6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Us extends H${constructor(e,n){super(e,null),f6(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function US(t){let{activeHeaderClassName:e,...n}=t;return new Us({className:e,...n,selectionType:N$})}function p6(t){let{areaCornerVisible:e,...n}=t;return new Us({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:wT})}function w6(t){let{...e}=t;return new Us({className:"highlight",...e,selectionType:wT})}function v6(t){let{columnClassName:e,...n}=t;return new Us({className:e,...n,selectionType:LX})}function C6(t){let{cellCornerVisible:e,...n}=t;return new Us({className:"current",headerAttributes:[W0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:xp})}function y6(t){let{border:e,visualCellRange:n,...r}=t;return new Us({...e,...r,selectionType:$X},n)}function S6(t){let{...e}=t;return new Us({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:DX})}function $H(t){let{headerClassName:e,...n}=t;return new Us({className:e,...n,selectionType:pT})}function b6(t){let{rowClassName:e,...n}=t;return new Us({className:e,...n,selectionType:kX})}function R6(t,e){E6(t,e),e.add(t)}function E6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wr(t,e,n){return(e=T6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T6(t){var e=_6(t,"string");return typeof e=="symbol"?e:e+""}function _6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var po=new WeakSet;class M6{constructor(e){R6(this,po),wr(this,"options",void 0),wr(this,"layerLevel",0),wr(this,"focus",void 0),wr(this,"fill",void 0),wr(this,"layeredAreas",new Map),wr(this,"areas",new Map),wr(this,"rowHeaders",new Map),wr(this,"columnHeaders",new Map),wr(this,"activeRowHeaders",new Map),wr(this,"activeColumnHeaders",new Map),wr(this,"activeCornerHeaders",new Map),wr(this,"rowHighlights",new Map),wr(this,"columnHighlights",new Map),wr(this,"customSelections",[]),this.options=e,this.focus=C6(e),this.fill=S6(e)}isEnabledFor(e,n){let r=e;e===xp&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return us(po,this,cs).call(this,this.layeredAreas,p6)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return us(po,this,cs).call(this,this.areas,w6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return us(po,this,cs).call(this,this.rowHeaders,$H)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return us(po,this,cs).call(this,this.columnHeaders,$H)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return us(po,this,cs).call(this,this.activeRowHeaders,US)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return us(po,this,cs).call(this,this.activeColumnHeaders,US)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return us(po,this,cs).call(this,this.activeCornerHeaders,US)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return us(po,this,cs).call(this,this.rowHighlights,b6)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return us(po,this,cs).call(this,this.columnHighlights,v6)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(y6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),I(this.areas.values(),e=>void e.clear()),I(this.layeredAreas.values(),e=>void e.clear()),I(this.rowHeaders.values(),e=>void e.clear()),I(this.columnHeaders.values(),e=>void e.clear()),I(this.activeRowHeaders.values(),e=>void e.clear()),I(this.activeColumnHeaders.values(),e=>void e.clear()),I(this.activeCornerHeaders.values(),e=>void e.clear()),I(this.rowHighlights.values(),e=>void e.clear()),I(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function cs(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function FH(t,e,n){return(e=P6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=I6(t,"string");return typeof e=="symbol"?e:e+""}function I6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hM{constructor(e){FH(this,"ranges",[]),FH(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new hM(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function O6(t,e){sF(t,e),e.add(t)}function x6(t,e,n){return(e=A6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A6(t){var e=H6(t,"string");return typeof e=="symbol"?e:e+""}function H6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zS(t,e,n){sF(t,e),e.set(t,n)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dn(t,e){return t.get(dt(t,e))}function _c(t,e,n){return t.set(dt(t,e),n),n}function dt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bs=new WeakMap,Gl=new WeakMap,oi=new WeakMap,mt=new WeakSet;class dM{constructor(e,n){O6(this,mt),zS(this,bs,void 0),zS(this,Gl,0),zS(this,oi,{x:0,y:0}),x6(this,"tableApi",void 0),_c(bs,this,e),this.tableApi=n}setActiveLayerIndex(e){_c(Gl,this,e)}getCurrentSelection(){return dn(bs,this).peekByIndex(dn(Gl,this))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_c(oi,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=dt(mt,this,SE).call(this);const{row:h,col:d}=dt(mt,this,jH).call(this,o),f=this.tableApi.fixedRowsBottom(),m=this.tableApi.minSpareRows(),p=this.tableApi.minSpareCols(),y=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),b=this.tableApi.createCellCoords(h+i.row,d+i.col);if(b.row>=c){const k=Ar(r&&m>0&&f===0),P=b.col+1,O=P>=u,U=this.tableApi.createCellCoords(b.row-c,O?P-u:P);if(this.runLocalHooks("beforeColumnWrap",k,dt(mt,this,Lu).call(this,U),O),k.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&O&&dn(bs,this).size()>1){dt(mt,this,VH).call(this);const G=dt(mt,this,Og).call(this,"forward");G!==null&&U.assign(G)}b.assign(U)}}else if(b.row<0){const k=Ar(T),P=b.col-1,O=P<0,U=this.tableApi.createCellCoords(c+b.row,O?u+P:P);if(this.runLocalHooks("beforeColumnWrap",k,dt(mt,this,Lu).call(this,U),O),T){if(this.shouldSwitchSelectionLayer()&&O&&dn(bs,this).size()>1){dt(mt,this,WH).call(this);const G=dt(mt,this,Og).call(this,"backward");G!==null&&U.assign(G)}b.assign(U)}}if({width:u,height:c}=dt(mt,this,SE).call(this),b.col>=u){const k=Ar(r&&p>0),P=b.row+1,O=P>=c,U=this.tableApi.createCellCoords(O?P-c:P,b.col-u);if(this.runLocalHooks("beforeRowWrap",k,dt(mt,this,Lu).call(this,U),O),k.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(y){if(this.shouldSwitchSelectionLayer()&&O&&dn(bs,this).size()>1){dt(mt,this,VH).call(this);const G=dt(mt,this,Og).call(this,"forward");G!==null&&U.assign(G)}b.assign(U)}}else if(b.col<0){const k=Ar(y),P=b.row-1,O=P<0,U=this.tableApi.createCellCoords(O?c+P:P,u+b.col);if(this.runLocalHooks("beforeRowWrap",k,dt(mt,this,Lu).call(this,U),O),y){if(this.shouldSwitchSelectionLayer()&&O&&dn(bs,this).size()>1){dt(mt,this,WH).call(this);const G=dt(mt,this,Og).call(this,"backward");G!==null&&U.assign(G)}b.assign(U)}}const{rowDir:M,colDir:R}=dt(mt,this,BH).call(this,b);a=M,l=R,o=dt(mt,this,Lu).call(this,b)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:dn(Gl,this),visualCoords:o}}transformEnd(e,n){_c(oi,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=dt(mt,this,Zm).call(this,i.to.row,i.from.row),a=dt(mt,this,Qm).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=dt(mt,this,jH).call(this,i.highlight),f=this.tableApi.createCellCoords(s+r.row,a+r.col),m=i.getTopStartCorner(),p=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const R=f.col-d;f.col=dt(mt,this,Qm).call(this,m.col,p.col)+R}else if(r.col>0&&a<=d&&f.col>d){const R=dt(mt,this,Qm).call(this,p.col,m.col),k=Math.max(f.col-R,1);f.col=R+k}if(r.row<0&&s>=h&&f.row<h){const R=f.row-h;f.row=dt(mt,this,Zm).call(this,m.row,y.row)+R}else if(r.row>0&&s<=h&&f.row>h){const R=dt(mt,this,Zm).call(this,y.row,m.row),k=Math.max(f.row-R,1);f.row=R+k}const{rowDir:T,colDir:b}=dt(mt,this,BH).call(this,f);u=T,c=b;const M=dt(mt,this,Lu).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:dn(Gl,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function VH(){const t=dn(Gl,this)+1;this.setActiveLayerIndex(t>=dn(bs,this).size()?0:t),_c(oi,this,this.calculateOffset())}function WH(){const t=dn(Gl,this)-1;this.setActiveLayerIndex(t<0?dn(bs,this).size()-1:t),_c(oi,this,this.calculateOffset())}function BH(t){const{width:e,height:n}=dt(mt,this,SE).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function SE(){return{width:dn(oi,this).x+this.countRenderableColumns(),height:dn(oi,this).y+this.countRenderableRows()}}function Og(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[r,i,o,s]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],a=dt(mt,this,Zm).call(this,r,i),l=dt(mt,this,Qm).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Zm(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:dn(oi,this).y+n}function Qm(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:dn(oi,this).x+n}function jH(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(dn(oi,this).y+e,dn(oi,this).x+n)}function Lu(t){const e=t.clone();return e.col=t.col-dn(oi,this).x,e.row=t.row-dn(oi,this).y,this.tableApi.renderableToVisualCoords(e)}ut(dM,Tn);class N6 extends dM{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class D6 extends dM{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:r}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,r-1),o=this.tableApi.countRenderableRowsInRange(0,n-1),s=e.highlight.isHeader(),a=s?Math.abs(r):0,l=s?Math.abs(n):0;return{x:r<0?a:-i,y:n<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const nv=0,rv=1,aF=2,fM=3,k6=[fM,aF],L6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],YS=Symbol("root"),UH=Symbol("child");function Xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:YS;if(e!==YS&&e!==UH)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===YS;let i=nv;if(n){const o=t[0];t.length===0?i=rv:r&&o instanceof fh?i=fM:r&&Array.isArray(o)?i=Xc(o,UH):t.length>=2&&t.length<=4&&!t.some((a,l)=>!L6[l].includes(typeof a))&&(i=aF)}return i}function mf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!k6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===fM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),It(u)&&(u=a),It(c)&&(c=l),!r){const m=a,p=l,y=u,T=c;a=Math.min(m,y),l=Math.min(p,T),u=Math.max(m,y),c=Math.max(p,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),f=e(u,c);return n(h,d,f)}}function $6(t){const e=Xc(t.getSelected());if(e===nv||e===rv)return[];const n=mf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return wn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function F6(t){const e=Xc(t.getSelected());if(e===nv||e===rv)return[];const n=mf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return wn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function ol(t,e,n){V6(t,e),e.set(t,n)}function V6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e,n){return(e=W6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W6(t){var e=B6(t,"string");return typeof e=="symbol"?e:e+""}function B6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ht(t,e){return t.get(lF(t,e))}function Fr(t,e,n){return t.set(lF(t,e),n),n}function lF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vr=new WeakMap,$u=new WeakMap,xg=new WeakMap,Zs=new WeakMap,Ag=new WeakMap,jh=new WeakMap,Hg=new WeakMap;class uF{constructor(e,n){var r=this;sl(this,"settings",void 0),sl(this,"tableProps",void 0),sl(this,"inProgress",!1),sl(this,"selectedRange",new hM((i,o,s)=>this.tableProps.createCellRange(i,o,s))),sl(this,"highlight",void 0),ol(this,Vr,void 0),ol(this,$u,void 0),sl(this,"selectedByRowHeader",new Set),sl(this,"selectedByColumnHeader",new Set),ol(this,xg,!1),ol(this,Zs,!1),ol(this,Ag,"unknown"),ol(this,jh,-1),ol(this,Hg,0),this.settings=e,this.tableProps=n,this.highlight=new M6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[W0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Fr(Vr,this,new N6(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Fr($u,this,new D6(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ht(Vr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Ht(Vr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Ht(Vr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Ht(Vr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Ht(Vr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Ht(Vr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Ht(Vr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Ht(Vr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Ht($u,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Ht($u,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Ht(Hg,this))}getActiveSelectionLayerIndex(){return Ht(Hg,this)}setActiveSelectionLayerIndex(e){Fr(Hg,this,e)}markSource(e){Fr(Ag,this,e)}markEndSource(){Fr(Ag,this,"unknown")}getSelectionSource(){return Ht(Ag,this)}setExpectedLayers(e){Fr(jh,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Fr(jh,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=It(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Fr(Zs,this,!1),Fr(xg,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&It(n))&&(this.selectedRange.clear(),I(this.highlight.getAreas(),l=>void l.clear()),I(this.highlight.getLayeredAreas(),l=>void l.clear()),I(this.highlight.getRowHeaders(),l=>void l.clear()),I(this.highlight.getColumnHeaders(),l=>void l.clear()),I(this.highlight.getActiveRowHeaders(),l=>void l.clear()),I(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),I(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),I(this.highlight.getRowHighlights(),l=>void l.clear()),I(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const r=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&r.col<0&&!s||o===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(r),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const l=Ht(jh,this)===-1||this.selectedRange.size()===Ht(jh,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(wT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(pT,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(b).commit(),d.add(y).commit(),f.add(b).commit()):(a.add(y).add(T).commit(),l.add(b).add(M).commit(),d.add(y).add(T).commit(),f.add(b).add(M).commit())}const m=!Ht(Zs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),p=!Ht(Zs,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),p&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&p&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Ht(Vr,this).setActiveLayerIndex(n),Ht($u,this).setActiveLayerIndex(n);const r=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(xp,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(Fr(xg,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=Ht(Vr,this).transformStart(e,n,r);this.setRangeStart(i)}transformEnd(e,n){const{visualCoords:r,selectionLayer:i}=Ht(Vr,this).transformEnd(e,n);this.setRangeEnd(r,i)}transformFocus(e,n){const{selectionLayer:r,visualCoords:i}=Ht($u,this).transformStart(e,n);this.setRangeFocus(i.normalize(),r)}shiftRows(e,n){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ue(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ue(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ue(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ue(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ue(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ue(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=Ar(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Ht(xg,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ue(d.row,u,o-1),Ue(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),p=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",m,p,h),this.setRangeStartOnly(m,void 0,h),Fr(Zs,this,f),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectAll",m,p,h),this.finish()}selectCells(e){var n=this;const r=Xc(e);if(r===rv)return!1;if(r===nv)throw new Error(it`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=mf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),I(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ue(r.row,u,s-1),m=Ue(r.col,Math.min(i,o),Math.max(i,o))):(f=Ue(r,u,s-1),m=i);const p=this.tableProps.createCellCoords(f,m),y=l===0?0:Ue(p.row,u,-1),T=s-1,b=this.tableProps.createCellCoords(y,i),M=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",b,M,p),this.setRangeStartOnly(b,void 0,p),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",b,M,p),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ue(r.row,Math.min(e,n),Math.max(e,n)),d=Ue(r.col,a,o-1)):(h=e,d=Ue(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:Ue(f.col,a,-1),p=o-1,y=this.tableProps.createCellCoords(e,m),T=this.tableProps.createCellCoords(n,p);this.runLocalHooks("beforeSelectRows",y,T,f),this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",y,T,f),this.finish()}return c}importSelection(e){let{ranges:n,activeRange:r,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,Fr(Zs,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),n.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(r.highlight,i),Fr(Zs,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Ht(Zs,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:Ue(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ue(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ue(a.row,-1/0,c),col:Ue(a.col,-1/0,h)}),l.assign({row:Ue(l.row,-1/0,c),col:Ue(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.getActiveSelectedRange();this.highlight.isEnabledFor(xp,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ut(uF,Tn);const zH=/^(\r\n|\n\r|\r|\n)/,j6=/^[^\t\r\n]+/,YH=/^\t/;function U6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(YH))t=t.replace(YH,""),n+=1,e[r][n]="";else if(t.match(zH))t=t.replace(zH,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(j6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Dp(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function GS(t,e){const{instance:n,visualRow:r,visualCol:i,valueSetter:o}=e;return rt(o)?o.call(n,t,r,i,e):t}function z6(t,e){const{instance:n,visualRow:r,visualCol:i,valueGetter:o}=e;return rt(o)?o.call(n,t,r,i,e):t}function al(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){al(this,"hot",void 0),al(this,"metaManager",void 0),al(this,"tableMeta",void 0),al(this,"dataSource",void 0),al(this,"duckSchema",void 0),al(this,"colToPropCache",void 0),al(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Ww(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Te(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return MT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ve(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ae(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ae(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Gc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Qn(this.getSchema()):(m=[],me(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Vf(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<n&&l+f<s;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let p=0;p<u;p+=1)typeof o[p]>"u"&&(o[p]=[]),o[p].push(null);else o.push([null]);else for(let p=0;p<u;p++)o[p].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ae(this.tableMeta.columns)||ae(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];rE(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return SL(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];rE(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&jt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let c=i;if(!c)return null;const h=n.split(".");for(let d=0,f=h.length;d<f;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));const l=this.propToCol(n),u=this.hot.toPhysicalColumn(l);if(su(r)&&su(u)&&(a=z6(a,this.metaManager.getCellMeta(r,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=Ar(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Ar(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&jt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Mc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Mc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Dp(this.getRange(e,n,Mc.DESTINATION_RENDERER))}getCopyableText(e,n){return Dp(this.getRange(e,n,Mc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:q6,getItem:K6,hasItem:cF,getNames:X6,getValues:Afe}=Di("cellTypes");function gM(t){if(!cF(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return K6(t)}function fi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Tr(t,n),r&&qr(t,r),i&&Yl(t,i),q6(t,e)}function Z6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!jt(e,t)}function iv(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?gM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ve(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Te(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ve(r,(o,s)=>{if(Z6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),on(t,i)}function Q6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}kL(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Jm(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Pd(t){return t==null}const hF=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Ut(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Ut(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Wf(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function GH(t,e,n){return(e=J6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J6(t){var e=e9(t,"string");return typeof e=="symbol"?e:e+""}function e9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t9(){return class{}}class n9{constructor(e){GH(this,"metaCtor",t9()),GH(this,"meta",void 0),this.meta=this.metaCtor.prototype,on(this.meta,hF()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;on(this.meta,e),iv(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function r9(t,e,n){return(e=i9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9(t){var e=o9(t,"string");return typeof e=="symbol"?e:e+""}function o9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s9{constructor(e){r9(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){on(this.meta,e),iv(this.meta,e,e)}}function Ng(t,e,n){return(e=a9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a9(t){var e=l9(t,"string");return typeof e=="symbol"?e:e+""}function l9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kp{constructor(e){Ng(this,"valueFactory",void 0),Ng(this,"data",[]),Ng(this,"index",[]),Ng(this,"holes",new Set),this.valueFactory=e}obtain(e){Jm(()=>su(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jm(()=>su(e)||Pd(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Pd(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jm(()=>su(e)||Pd(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Pd(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function qH(t,e,n){return(e=u9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u9(t){var e=c9(t,"string");return typeof e=="symbol"?e:e+""}function c9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const h9=["data","width"];class d9{constructor(e){qH(this,"globalMeta",void 0),qH(this,"metas",new kp(()=>this._createMeta())),this.globalMeta=e,this.metas=new kp(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);on(r,n),iv(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Q6(this.globalMeta.getMetaConstructor(),h9).prototype}}function KH(t,e,n){return(e=f9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f9(t){var e=g9(t,"string");return typeof e=="symbol"?e:e+""}function g9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m9{constructor(e){KH(this,"columnMeta",void 0),KH(this,"metas",new kp(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);on(i,r),iv(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ae(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Jm(()=>su(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new kp(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class dF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new n9(e),this.tableMeta=new s9(this.globalMeta),this.columnMeta=new d9(this.globalMeta),this.cellMeta=new m9(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ut(dF,Tn);function XH(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Zn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":rt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Mc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let p,y=0,T=0;for(y=0,T=d.startRows;y<T;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)p=Qn(m),t.push(p);else if(i.dataType==="array")p=Qn(m[0]),t.push(p);else{p=[];for(let b=0,M=d.startCols;b<M;b++)p.push(null);t.push(p)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&fe(i.rootElement,[HL(-1),Vw(i.countCols()+(i.view?i.countRowHeaders():0))])}function ZH(t,e,n){return(e=p9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p9(t){var e=w9(t,"string");return typeof e=="symbol"?e:e+""}function w9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v9{constructor(e){var n=this;ZH(this,"metaManager",void 0),ZH(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),oe.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=jt(e,"type")?e.type:null;let c=rt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function C9(t,e,n){y9(t,e),e.set(t,n)}function y9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qS(t,e,n){return(e=S9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S9(t){var e=b9(t,"string");return typeof e=="symbol"?e:e+""}function b9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function R9(t,e){return t.get(E9(t,e))}function E9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var QH=new WeakMap;class T9{constructor(e){qS(this,"metaManager",void 0),qS(this,"usageTracker",new Set),qS(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),C9(this,QH,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,R9(QH,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const fF="gridDefault",Za="editorManager.handlingEditor",_9={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},M9="hooksRefRegisterer",gF={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){I(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ve(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Jo(gF,"MIXIN_NAME",M9,{writable:!1,enumerable:!1});function Wi(t,e,n){return(e=P9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P9(t){var e=I9(t,"string");return typeof e=="symbol"?e:e+""}function I9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const O9="base",qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class mh{static get EDITOR_TYPE(){return O9}constructor(e){Wi(this,"hot",void 0),Wi(this,"state",qt.VIRGIN),Wi(this,"_opened",!1),Wi(this,"_fullEditMode",!1),Wi(this,"_closeCallback",null),Wi(this,"TD",null),Wi(this,"row",null),Wi(this,"col",null),Wi(this,"prop",null),Wi(this,"originalValue",null),Wi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();r=u.row,i=u.col,o=c.row,s=c.col}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==qt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=qt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Rt(l);this.setValue(u)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=qt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=qt.FINISHED,this.discardEditor(s)}):(this.state=qt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=$n(n),a=Xt(n),l=$n(this.hot.rootElement),u=Xt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:p}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=p.name,T=["master","inline_start"].includes(y)?d:0,b=["master","top","bottom"].includes(y)?f:0,M=s.top===l.top?0:1;let R=s.top-l.top-M-T,k=0;this.hot.isRtl()?k=o.innerWidth-s.left-a-m-1+b:k=s.left-l.left-1-b,["top","top_inline_start_corner"].includes(y)&&(R+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(k+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),V=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&O<=0||O===V)&&(R+=1),U<=0&&(k+=1);const Z=i.rowsRenderCalculator.startPosition,z=i.columnsRenderCalculator.startPosition,ue=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),K=rn(this.hot.rootDocument);let ne=n.offsetTop;if(["inline_start","master"].includes(y)&&(ne+=Z-ee),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:D,wtTable:j}=r.bottomOverlay.clone;ne+=D.getWorkspaceHeight()-j.getHeight()-K}let ge=n.offsetLeft;this.hot.isRtl()?(ge>=0?ge=p.getWidth()-n.offsetLeft:ge=Math.abs(ge),ge+=z-ue-a):["top","master","bottom"].includes(y)&&(ge+=z-ue);const Ce=o.getComputedStyle(this.TD),ye=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Me=parseInt(Ce[ye],10)>0?0:1,We=parseInt(Ce.borderTopWidth,10)>0?0:1,Tt=Xt(n)+Me,_e=nn(n)+We,g=Z0(c)?K:0,w=Q0(h)?K:0,C=this.hot.view.maximumVisibleElementWidth(ge)-g+Me,L=Math.max(this.hot.view.maximumVisibleElementHeight(ne)-w+We,this.hot.stylesHandler.getDefaultRowHeight());return{top:R,start:k,height:_e,maxHeight:L,width:Tt,maxWidth:C}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ut(mh,gF);const x9={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===qt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},A9={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},H9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},N9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},D9={name:"editorOpen",callback(t,e,n){const{selection:r}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>r.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;n.includes("shift")?r.transformFocus(-u.row,-u.col):r.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ni(e))}};function k9(){return[_9,x9,A9,H9,N9,D9]}const L9={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},$9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeActive(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},F9={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},V9={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},W9={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},B9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},j9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},U9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},z9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Y9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},G9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},q9={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},K9={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},X9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeActive(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Z9(){return[L9,$9,F9,V9,W9,B9,j9,U9,z9,Y9,G9,q9,K9,X9]}const Q9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},J9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},e8={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),(i.some(a=>n.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-s.row,-s.col):n.transformStart(-s.row,-s.col),n.markEndSource()}},t8={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),(i.some(a=>n.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(s.row,s.col):n.transformStart(s.row,s.col),n.markEndSource()}},n8={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},r8={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},i8={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},o8={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},s8={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},a8={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},l8={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeActive().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},u8={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeActive().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},c8={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},h8={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},d8={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},f8={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function g8(){return[Q9,J9,e8,t8,n8,r8,i8,o8,s8,a8,l8,u8,c8,h8,d8,f8]}const m8={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},p8={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},w8={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},v8={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},C8={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},y8=[...k9(),...Z9(),...g8(),m8,p8,w8,v8,C8];function mF(t){const e={};return y8.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function S8(t){const e=t.getShortcutManager().addContext("editor"),n=mF(t),r={group:Za};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function b8(t){const e=t.getShortcutManager().addContext("grid"),n=mF(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ae(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:fF};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Za,runOnlyIf:()=>ae(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function R8(t){[b8,S8].forEach(e=>e(t))}function mM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=JH(t),i=JH(t);return r.addEventListener("focus",()=>n==null?void 0:n.onFocus("from_above")),i.addEventListener("focus",()=>n==null?void 0:n.onFocus("from_below")),e.prepend(r),e.append(i),{focus(o){o==="from_above"?r.focus():i.focus()},activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function JH(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&fe(n,[ri("Focus catcher")]),n}function E8(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:r}=t;if(n.isHidden(e.row)||r.isHidden(e.col))return null;const i=bp(t),o=Rp(t);return e.row=Ue(e.row,i.row,o.row),e.col=Ue(e.col,i.col,o.col),e}}function T8(t){const e=E8(t);let n;const{activate:r,deactivate:i}=mM(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const m=(d=e(n))!==null&&d!==void 0?d:bp(t),p=t.runHooks("modifyFocusOnTabNavigation","from_above",m);m&&p!==!1&&t.selectCell(m.row,m.col)}else{var f;const m=(f=e(n))!==null&&f!==void 0?f:Rp(t),p=t.runHooks("modifyFocusOnTabNavigation","from_below",m);m&&p!==!1&&t.selectCell(m.row,m.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&r()}),t.addHook("afterSelection",(h,d,f,m,p)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,p.value=!0),s){var y;n=(y=t.getSelectedRangeActive())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fF,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?bp(t):Rp(t)),u(),!1;h.preventDefault()},position:"after"}])}function ph(t){zo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function ov(t){const{selection:e,view:n}=t,r=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,p=f<=h,y=m>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?r.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:p&&y?r.highlight.row:p?f:y?m:T.row}}}function _8(t){return e=>{const n=ov(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;ph(t.getCell(r?-1:0,n,!0))})}}function M8(){return()=>{}}function P8(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:r,col:i}=n.highlight;ph(t.getCell(r,i,!0))})}}function I8(t){return e=>{const n=ov(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;ph(t.getCell(i,o,!0))})}}function O8(t){return e=>{const n=ov(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;ph(t.getCell(i,o,!0))})}}function x8(t){return e=>{const n=ov(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;ph(t.getCell(n,r?-1:0,!0))})}}function A8(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{ph(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function H8(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=P8(t):e.isSelectedByCorner()?s=M8():e.isSelectedByRowHeader()?s=x8(t):e.isSelectedByColumnHeader()?s=_8(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=I8(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=A8(t):e.getSelectedRange().size()>1&&(s=O8(t)),(o=s)===null||o===void 0||o(i)}}}const e1=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Dg=t=>t.map(e=>{const n=e.toLowerCase();return e1.has(n)?e1.get(n):n}).sort().join("+"),N8=t=>t.split("+"),t1=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),KS=t=>{let{which:e,key:n}=t;if(t1.has(e))return t1.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},pF=Symbol("shortcut-context");function bE(t){return Te(t)&&t.__kindOf===pF}const D8=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=qw({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:p=!1,relativeToGroup:y,position:T,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It(h))throw new Error("You need to define the shortcut's group.");if(rt(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(it`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const M={callback:c,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:p};ae(y)&&(M.relativeToGroup=y,M.position=T),bE(b)&&(M.forwardToContext=b),u.forEach(R=>{const k=Dg(R);if(n.hasItem(k)){const O=n.getItem(k);let U=O.findIndex(G=>G.group===y);U!==-1?T==="before"?U-=1:U+=1:U=O.length,O.splice(U,0,M)}else n.addItem(k,[M])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Ve(c,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=c[f])}),r(h)})},o=u=>{const c=Dg(u);n.removeItem(c)};return{__kindOf:pF,scope:e,addShortcut:r,addShortcuts:i,getShortcuts:u=>{const c=Dg(u),h=n.getItem(c);return ae(h)?h.slice():[]},hasShortcut:u=>{const c=Dg(u);return n.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{n.getItems().forEach(h=>{let[d,f]=h;const m=f.filter(p=>p.group!==u);m.length===0?o(N8(d)):(f.length=0,f.push(...m))})}}};function k8(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const L8=["meta","alt","shift","control"],Uh=k8(),zh=[];let kg=0;function $8(t,e,n,r,i){const o=f=>L8.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=[];return f.altKey&&p.push("alt"),m&&(f.ctrlKey||f.metaKey)?p.push("control/meta"):(f.ctrlKey&&p.push("control"),f.metaKey&&p.push("meta")),f.shiftKey&&p.push("shift"),p},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ta(f))return;const p=KS(f);let y=[];o(p)||(y=s(f));const T=[p].concat(y);!i(f,T)&&(_p()&&y.includes("meta")||!_p()&&y.includes("control"))&&i(f,[p].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=KS(f);o(m)&&Uh.press(m)}},u=f=>{if(typeof f.key=="string"){const m=KS(f);o(m)&&Uh.release(m)}},c=()=>{Uh.releaseAll()};return{mount:()=>{let f=t;for(kg+=1;f;)kg===1&&(f.document.documentElement.addEventListener("keydown",l),zh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),zh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=lu(f)},unmount:()=>{let f=t;for(kg-=1;f;){if(kg===0){for(let m=0;m<zh.length;m++){const{event:p,listener:y}=zh[m];f.document.documentElement.removeEventListener(p,y)}zh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=lu(f)}},isPressed:f=>Uh.isPressed(f),releasePressedKeys:()=>Uh.releaseAll()}}const F8=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=qw({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const T=D8(p,y);return o.addItem(p,T),T},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(it`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,y){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=bE(T)?T:u(T);let M=!1;if(!b.hasShortcut(y))return M;const R=b.getShortcuts(y);for(let k=0;k<R.length;k++){const{callback:P,runOnlyIf:O,preventDefault:U,stopPropagation:G,captureCtrl:V,forwardToContext:Z}=R[k];if(O(p)===!0){if(h=V,M=P(p,y)===!1,h=!1,U&&p.preventDefault(),G&&(Ni(p),p.stopPropagation()),M)break;Z&&d(p,y,Z)}}return M},m=$8(e,p=>{const y=l(),T=bE(y)?y:u(y);return n(p,T.scope)},r,i,d);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function n1(t){const{classNames:e}=YL(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function V8(t,e){wF(t,e),e.add(t)}function Qs(t,e,n){wF(t,e),e.set(t,n)}function wF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gt(t,e){return t.get(Ji(t,e))}function Xr(t,e,n){return t.set(Ji(t,e),n),n}function Ji(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const r1=23;var wo=new WeakMap,Lp=new WeakMap,pM=new WeakMap,RE=new WeakMap,wa=new WeakMap,Id=new WeakMap,pf=new WeakMap,Yh=new WeakMap,No=new WeakSet;class W8{constructor(e){let{rootElement:n,rootDocument:r,onThemeChange:i=()=>{}}=e;V8(this,No),Qs(this,wo,void 0),Qs(this,Lp,void 0),Qs(this,pM,void 0),Qs(this,RE,void 0),Qs(this,wa,!0),Qs(this,Id,{}),Qs(this,pf,{}),Qs(this,Yh,void 0),Xr(Lp,this,n),Xr(RE,this,r),Xr(Yh,this,i)}isClassicTheme(){return Gt(wa,this)}getCSSVariableValue(e){var n;if(Gt(wa,this))return null;if(Gt(Id,this)[`--ht-${e}`])return Gt(Id,this)[`--ht-${e}`];const r=(n=Ji(No,this,U8).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ji(No,this,vF).call(this,`--ht-${e}`);if(r!==null)return Gt(Id,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Gt(pf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Gt(wa,this))return r1;const e=Ji(No,this,B8).call(this);return e||r1}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Xr(wo,this,void 0),Xr(wa,this,!0),Gt(Yh,this).call(this,Gt(wo,this)),Ji(No,this,XS).call(this);return}if(e&&e!==Gt(wo,this)){if(!/ht-theme-.*/.test(e)){qe(`Invalid theme name: ${e}. Please provide a valid theme name.`),Xr(wo,this,void 0),Xr(wa,this,!1),Gt(Yh,this).call(this,Gt(wo,this)),Ji(No,this,XS).call(this);return}Gt(wo,this)&&Ji(No,this,z8).call(this),Xr(wo,this,e),Xr(wa,this,!1),Gt(Yh,this).call(this,Gt(wo,this)),Ji(No,this,XS).call(this)}}getThemeName(){return Gt(wo,this)}}function B8(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function XS(){this.isClassicTheme()||Xr(pM,this,getComputedStyle(Gt(Lp,this)));const t=Ji(No,this,j8).call(this,["box-sizing","border-bottom-width"]);Gt(pf,this).td={...Gt(pf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function j8(t){const e=Gt(RE,this),n=Gt(Lp,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function U8(t){const e=Math.ceil(parseFloat(Ji(No,this,vF).call(this,t)));return Number.isNaN(e)?null:e}function vF(t){const e=Gt(pM,this).getPropertyValue(t);return e===""?null:e}function z8(){Xr(pf,this,{}),Xr(Id,this,{}),Xr(wa,this,!0)}function Y8(t,e){CF(t,e),e.add(t)}function i1(t,e,n){CF(t,e),e.set(t,n)}function CF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o1(t,e){return t.get(Zc(t,e))}function s1(t,e,n){return t.set(Zc(t,e),n),n}function Zc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var EE=new WeakMap,TE=new WeakMap,Wd=new WeakSet;class G8{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;Y8(this,Wd),i1(this,EE,void 0),i1(this,TE,void 0),s1(EE,this,n),s1(TE,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=Zc(Wd,this,a1).call(this,e.from,n,r);if(i===null)return null;const o=Zc(Wd,this,a1).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function a1(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=Zc(Wd,this,l1).call(this,o1(EE,this),t.row,e);if(r===null)return null;const i=Zc(Wd,this,l1).call(this,o1(TE,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function l1(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let ni=null,ep=0;function q8(t){const e=t.ownerDocument;if(!ni){ni=e.createElement("div"),ni.setAttribute("role","status"),ni.setAttribute("aria-live","assertive"),ni.setAttribute("aria-atomic","true");const n=ni.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(ni)}ep+=1}function K8(){ep!==0&&(ep===1&&(ni.remove(),ni=null),ep-=1)}function X8(t){ni&&(ni.textContent="",setTimeout(()=>{ni&&(ni.textContent=t)},100))}let ZS=null;const Lg=new WeakSet,QS=new Map;function yF(t,e){var n,r,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Pi(s);let l,u,c,h,d,f,m=!0;const p={...e.initialState,...e};f4(o)&&d4(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Vl(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Vl(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Y(this.rootElement,["ht-wrapper","handsontable"]),Y(this.rootWrapperElement,"ht-root-wrapper"),Y(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),Y(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=(n=p==null?void 0:p.layoutDirection)!==null&&n!==void 0?n:"inherit",T=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(r=this.rootWrapperElement)===null||r===void 0||r.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new W8({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:g=>{Vl(this)&&(ce(this.rootWrapperElement,/ht-theme-.*/g),ce(this.rootPortalElement,/ht-theme-.*/g),g&&(Y(this.rootWrapperElement,g),Y(this.rootPortalElement,g),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||qe(`The "${g}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),p.language=d6(p.language);const b=Object.fromEntries(Object.entries(p).filter(g=>{let[w]=g;return!(oe.getSingleton().isRegistered(w)||oe.getSingleton().isDeprecated(w))})),M=new dF(s,b,[v9,T9]),R=M.getTableMeta(),k=M.getGlobalMeta(),P=qw();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${$0()}`,QS.set(this.guid,this),this.columnIndexMapper=new CE,this.rowIndexMapper=new CE,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{s.runHooks("beforeCompositionStart",g)}),u=new I4(s);const O=Di(this.guid);O.register("cellRangeMapper",new G8({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const U=g=>{const{row:w,col:C}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,C>=0?s.columnIndexMapper.getRenderableFromVisualIndex(C):C)},G=g=>{const{row:w,col:C}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,C>=0?s.columnIndexMapper.getVisualFromRenderableIndex(C):C)},V=(g,w)=>{const C=w>g?1:-1,L=Math.min(g,w),D=Math.max(g,w),j=s.rowIndexMapper.getNearestNotHiddenIndex(g,C);return j===null||C===1&&j>D||C===-1&&j<L?null:j>=0?s.rowIndexMapper.getRenderableFromVisualIndex(j):j},Z=(g,w)=>{const C=w>g?1:-1,L=Math.min(g,w),D=Math.max(g,w),j=s.columnIndexMapper.getNearestNotHiddenIndex(g,C);return j===null||C===1&&j>D||C===-1&&j<L?null:j>=0?s.columnIndexMapper.getRenderableFromVisualIndex(j):j};let z=new uF(R,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,C)=>s._createCellRange(g,w,C),visualToRenderableCoords:U,renderableToVisualCoords:G,findFirstNonHiddenRenderableRow:V,findFirstNonHiddenRenderableColumn:Z,isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=z;const ue=g=>{let{hiddenIndexesChanged:w}=g;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ue),this.rowIndexMapper.addLocalHook("cacheUpdated",ue),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const C=Ar(!1),L=this.selection.getSelectedRange(),{from:D,to:j}=L.current(),v=L.size()-1;this.runHooks("afterSelection",D.row,D.col,j.row,j.col,C,v),this.runHooks("afterSelectionByProp",D.row,s.colToProp(D.col),j.row,s.colToProp(j.col),C,v),w&&(!C.isTouched()||C.isTouched()&&!C.value)&&f.scrollTo(g);const S=z.isSelectedByRowHeader(),_=z.isSelectedByColumnHeader();S&&_?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):S?(ce(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):_?(ce(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(z.getSelectionSource())||h.closeEditor(null),z.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=Ar(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&f.scrollTo(g),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:C,to:L}=g[w];this.runHooks("afterSelectionEnd",C.row,C.col,L.row,L.col,w),this.runHooks("afterSelectionEndByProp",C.row,s.colToProp(C.col),L.row,s.colToProp(L.col),w),z.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterSelectRows",...w)}).addLocalHook("beforeSelectAll",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeSelectAll",...w)}).addLocalHook("afterSelectAll",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterSelectAll",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),C=0;C<g;C++)w[C]=arguments[C];return i.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=arguments.length>3?arguments[3]:void 0,D=arguments.length>4?arguments[4]:void 0;const j=v=>{if(v.length===0)return[];const S=[...v];return S.sort((x,E)=>{let[H]=x,[F]=E;return H===F?0:H>F?1:-1}),wn(S,(x,E)=>{let[H,F]=E;const A=x[x.length-1],[$,B]=A,W=$+B;if(H<=W){const q=Math.max(F-(W-H),0);A[1]+=q}else x.push([H,F]);return x},[S[0]])};switch(g){case"insert_row_below":case"insert_row_above":const v=s.countSourceRows();if(R.maxRows===v)return;const S=g==="insert_row_below"?"below":"above";w=w??(S==="below"?v:0);const{delta:_,startPhysicalIndex:x}=l.createRow(w,C,{source:L,mode:S});z.shiftRows(s.toVisualRow(x),_);break;case"insert_col_start":case"insert_col_end":const E=g==="insert_col_end"?"end":"start";w=w??(E==="end"?s.countSourceCols():0);const{delta:H,startPhysicalIndex:F}=l.createCol(w,C,{source:L,mode:E});if(H){if(Array.isArray(R.colHeaders)){const B=[s.toVisualColumn(F),0];B.length+=H,Array.prototype.splice.apply(R.colHeaders,B)}z.shiftColumns(s.toVisualColumn(F),H)}break;case"remove_row":const A=B=>{let W=0;I(B,q=>{let[te,le]=q;const Pe=Ut(te)?s.countRows()-1:Math.max(te-W,0);if(Number.isInteger(te)&&(te=Math.max(te-W,0)),!l.removeRow(te,le,L))return;if(z.isSelected()){const{row:et}=s.getSelectedRangeActive().highlight;et>=te&&et<=te+le-1&&h.closeEditor(!0)}const nt=s.countRows(),Ie=R.fixedRowsTop;Ie>=Pe+1&&(R.fixedRowsTop-=Math.min(le,Ie-Pe));const Ae=R.fixedRowsBottom;if(Ae&&Pe>=nt-Ae&&(R.fixedRowsBottom-=Math.min(le,Ae)),nt===0)z.deselect();else if(L==="ContextMenu.removeRow"){const et=z.getSelectedRange(),Nn=et.pop();et.clear().set(Nn.from).current().setTo(Nn.to),z.refresh()}else z.shiftRows(te,-le);W+=le})};Array.isArray(w)?A(j(w)):A([[w,C]]);break;case"remove_col":const $=B=>{let W=0;I(B,q=>{let[te,le]=q;const Pe=Ut(te)?s.countCols()-1:Math.max(te-W,0);let Xe=s.toPhysicalColumn(Pe);if(Number.isInteger(te)&&(te=Math.max(te-W,0)),!l.removeCol(te,le,L))return;if(z.isSelected()){const{col:et}=s.getSelectedRangeActive().highlight;et>=te&&et<=te+le-1&&h.closeEditor(!0)}if(s.countCols()===0)z.deselect();else if(L==="ContextMenu.removeColumn"){const et=z.getSelectedRange(),Nn=et.pop();et.clear().set(Nn.from).current().setTo(Nn.to),z.refresh()}else z.shiftColumns(te,-le);const Ae=R.fixedColumnsStart;Ae>=Pe+1&&(R.fixedColumnsStart-=Math.min(le,Ae-Pe)),Array.isArray(R.colHeaders)&&(typeof Xe>"u"&&(Xe=-1),R.colHeaders.splice(Xe,le)),W+=le})};Array.isArray(w)?$(j(w)):$([[w,C]]);break;default:throw new Error(`There is no such action "${g}"`)}D||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const g=R.minRows,w=R.minSpareRows,C=R.minCols,L=R.minSpareCols;if(g){const D=s.countRows();D<g&&l.createRow(D,g-D,{source:"auto"})}if(w){const D=s.countEmptyRows(!0);if(D<w){const j=w-D,v=Math.min(j,R.maxRows-s.countSourceRows());l.createRow(s.countRows(),v,{source:"auto"})}}{let D;(C||L)&&(D=s.countEmptyCols(!0));let j=s.countCols();if(C&&!R.columns&&j<C){const v=C-j;D+=v,l.createCol(j,v,{source:"auto"})}if(L&&!R.columns&&s.dataType==="array"&&D<L){j=s.countCols();const v=L-D,S=Math.min(v,R.maxCols-j);l.createCol(j,S,{source:"auto"})}}},populateFromArray(g,w,C,L,D){let j,v,S,_;const x=[],E={},H=[],F=g.row,A=g.col;if(v=w.length,v===0)return!1;let $=0,B=0;switch(Te(C)&&($=C.col-A+1,B=C.row-F+1),D){case"shift_down":const q=Nd(w),te=q.length,le=Math.max(te,$),Pe=s.getData().slice(F),Xe=Nd(Pe).slice(A,A+le);for(S=0;S<le;S+=1)if(S<te){for(j=0,v=q[S].length;j<B-v;j+=1)q[S].push(q[S][j%v]);S<Xe.length?H.push(q[S].concat(Xe[S])):H.push(q[S].concat(new Array(Pe.length).fill(null)))}else H.push(q[S%te].concat(Xe[S]));s.populateFromArray(F,A,Nd(H));break;case"shift_right":const nt=w.length,Ie=Math.max(nt,B),Ae=s.getData().slice(F).map(ot=>ot.slice(A));for(j=0;j<Ie;j+=1)if(j<nt){for(S=0,_=w[j].length;S<$-_;S+=1)w[j].push(w[j][S%_]);if(j<Ae.length)for(let ot=0;ot<Ae[j].length;ot+=1)w[j].push(Ae[j][ot]);else w[j].push(...new Array(Ae[0].length).fill(null))}else w.push(w[j%v].slice(0,Ie).concat(Ae[j]));s.populateFromArray(F,A,w);break;case"overwrite":default:E.row=g.row,E.col=g.col;let et=0,Nn=0,Dr=!0,kr;const _n=function(ct){let co=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Qa=w[ct%w.length];return co!==null?Qa[co%Qa.length]:Qa},Lr=w.length,_t=C?C.row-g.row+1:0;for(C?v=_t:v=Math.max(Lr,_t),j=0;j<v&&!(C&&E.row>C.row&&_t>Lr||!R.allowInsertRow&&E.row>s.countRows()-1||E.row>=R.maxRows);j++){const ot=j-et,ct=_n(ot).length,co=C?C.col-g.col+1:0;if(C?_=co:_=Math.max(ct,co),E.col=g.col,kr=s.getCellMeta(E.row,E.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&kr.skipRowOnPaste){et+=1,E.row+=1,v+=1;continue}for(Nn=0,S=0;S<_;S++){var W;if(C&&E.col>C.col&&co>ct||!R.allowInsertColumn&&E.col>s.countCols()-1||E.col>=R.maxCols)break;if(kr=s.getCellMeta(E.row,E.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&kr.skipColumnOnPaste){Nn+=1,E.col+=1,_+=1;continue}if(kr.readOnly&&L!=="UndoRedo.undo"){E.col+=1;continue}const Qa=S-Nn,Ys=!!kr.valueSetter;let Jn=_n(ot,Qa),$r=(W=s.getSourceDataAtCell(E.row,E.col))!==null&&W!==void 0?W:null;if(Jn!==null&&typeof Jn=="object"){if(Array.isArray(Jn)&&$r===null&&($r=[]),!Ys&&(typeof $r!="object"||$r===null))Dr=!1;else if($r!==null){const Gs=Gc(Array.isArray($r)?$r:$r[0]||$r),sg=Gc(Array.isArray(Jn)?Jn:Jn[0]||Jn);Ys||Wf(Gs,sg)||Array.isArray(Gs)&&Array.isArray(sg)?Jn=Qn(Jn):Dr=!1}}else!Ys&&$r!==null&&typeof $r=="object"&&(Dr=!1);Dr&&x.push([E.row,E.col,Jn]),Dr=!0,E.col+=1}E.row+=1}s.setDataAtCell(x,null,null,L||"populateFromArray");break}}};function ee(g){const w=K$(g);cM(w)?(s.runHooks("beforeLanguageChange",w),k.language=w,s.runHooks("afterLanguageChange",w)):X$(g)}function K(g,w){const C=g==="className"?s.rootElement:s.table;if(m)Y(C,w);else{let L=[],D=[];k[g]&&(L=Array.isArray(k[g])?k[g]:oE(k[g])),w&&(D=Array.isArray(w)?w:oE(w));const j=iE(L,D),v=iE(D,L);j.length&&ce(C,j),v.length&&Y(C,v)}k[g]=w}this.init=function(){u.setData(R.data),s.runHooks("beforeInit"),(ro()||z0())&&Y(s.rootElement,"mobile"),this.updateSettings(p,!0),this.view=new w4(this),h=uE.getInstance(s,R,z),f=H8(s),d=new Yq(s),Vl(this)&&(T8(s),q8(s.rootPortalElement),ML(p.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),m&&s.rootElement.offsetParent===null&&n$(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof m=="object"&&(s.runHooks("afterChange",m[0],m[1]),m=!1),s.runHooks("afterInit")};function ne(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ge(g,w,C){if(!g.length){C();return}const L=s.getActiveEditor(),D=new ne;let j=!0;D.onQueueEmpty=()=>{L&&j&&L.cancelChanges(),C()};for(let v=g.length-1;v>=0;v--){const[S,_,,x]=g[v],E=l.propToCol(_);let H;Number.isInteger(E)?H=s.getCellMeta(S,E):H={...Object.getPrototypeOf(R),...R},s.getCellValidator(H)&&(D.addValidatorToQueue(),s.validateCell(x,H,function(F,A){return function($){if(typeof $!="boolean")throw new Error("Validation error: result is not boolean");$===!1&&A.allowInvalid===!1&&(j=!1,g.splice(F,1),A.valid=!0),D.removeValidatorFormQueue()}}(v,H),w))}D.checkIfQueueIsEmpty()}function Ce(g,w){for(let L=g.length-1;L>=0;L--){let D=!1;if(g[L]===null){g.splice(L,1);continue}if(!((g[L][2]===null||g[L][2]===void 0)&&(g[L][3]===null||g[L][3]===void 0))){if(R.allowInsertRow)for(;g[L][0]>s.countRows()-1;){const{delta:j}=l.createRow(void 0,void 0,{source:"auto"});if(j===0){D=!0;break}}if(s.dataType==="array"&&(!R.columns||R.columns.length===0)&&R.allowInsertColumn)for(;l.propToCol(g[L][1])>s.countCols()-1;){const{delta:j}=l.createCol(void 0,void 0,{source:"auto"});if(j===0){D=!0;break}}D||l.set(g[L][0],g[L][1],g[L][3])}}if(g.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",g,w||"edit");const L=s.getActiveEditor();L&&ae(L.refreshValue)&&L.refreshValue()}else s.render()}this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,C){return s.view._wt.createCellRange(g,w,C)},this.validateCell=function(g,w,C,L){let D=s.getCellValidator(w);function j(v){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){C(v);return}const _=w.visualCol,x=w.visualRow,E=s.getCell(x,_,!0);if(E&&E.nodeName!=="TH"){const H=s.rowIndexMapper.getRenderableFromVisualIndex(x),F=s.columnIndexMapper.getRenderableFromVisualIndex(_);s.view._wt.getSetting("cellRenderer",H,F,E)}C(v)}_L(D)&&(D=function(v){return function(S,_){_(v.test(S))}}(D)),rt(D)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,L),s._registerImmediate(()=>{D.call(w,g,v=>{s&&(v=s.runHooks("afterValidate",v,g,w.visualRow,w.prop,L),w.valid=v,j(v),s.runHooks("postAfterValidate",v,g,w.visualRow,w.prop,L))})})):s._registerImmediate(()=>{w.valid=!0,j(w.valid,!1)})};function ye(g,w,C){return Array.isArray(g)?g:[[g,w,C]]}function Me(g,w){const C=s.runHooks("beforeChange",g,w||"edit"),L=g.filter(j=>j!==null);if(C===!1||L.length===0){var D;return(D=s.getActiveEditor())===null||D===void 0||D.cancelChanges(),[]}for(let j=L.length-1;j>=0;j--){const[v,S,,_]=L[j],x=l.propToCol(S);let E;Number.isInteger(x)?E=s.getCellMeta(v,x):E={...Object.getPrototypeOf(R),...R},L[j][3]=GS(_,E)}return L}this.setDataAtCell=function(g,w,C,L){const D=ye(g,w,C),j=[];let v=L,S,_,x;for(S=0,_=D.length;S<_;S++){const[H,F,A]=D[S];if(typeof D[S]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F>=this.countCols()?x=F:x=l.colToProp(F),j.push([H,x,u.getAtCell(this.toPhysicalRow(H),F),A])}!v&&typeof g=="object"&&(v=w);const E=Me(j,v);s.runHooks("afterSetDataAtCell",E,v),ge(E,v,()=>{Ce(E,v)})},this.setDataAtRowProp=function(g,w,C,L){const D=ye(g,w,C),j=[];let v=L,S,_;for(S=0,_=D.length;S<_;S++){const[E,H,F]=D[S];j.push([E,H,u.getAtCell(this.toPhysicalRow(E),H),F])}!v&&typeof g=="object"&&(v=w);const x=Me(j,L);s.runHooks("afterSetDataAtRowProp",x,v),ge(x,v,()=>{Ce(x,v)})},this.listen=function(){s&&!s.isListening()&&(QS.forEach(g=>{s!==g&&g.unlisten()}),ZS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(ZS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return ZS===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(g),s.view.render(),w&&z.isSelected()&&h.prepareEditor()},this.populateFromArray=function(g,w,C,L,D,j,v){if(!(typeof C=="object"&&typeof C[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const S=typeof L=="number"?s._createCellCoords(L,D):null;return c.populateFromArray(s._createCellCoords(g,w),C,S,j,v)},this.spliceCol=function(g,w,C){for(var L=arguments.length,D=new Array(L>3?L-3:0),j=3;j<L;j++)D[j-3]=arguments[j];return l.spliceCol(g,w,C,...D)},this.spliceRow=function(g,w,C){for(var L=arguments.length,D=new Array(L>3?L-3:0),j=3;j<L;j++)D[j-3]=arguments[j];return l.spliceRow(g,w,C,...D)},this.getSelected=function(){if(z.isSelected())return Je(z.getSelectedRange(),g=>{let{from:w,to:C}=g;return[w.row,w.col,C.row,C.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedActive=function(){const g=this.getSelectedRangeActive();if(!g)return;const{from:w,to:C}=g;return[w.row,w.col,C.row,C.col]},this.getSelectedRange=function(){if(z.isSelected())return Array.from(z.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRangeActive=function(){return z.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return z.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(g){if(!z.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];I(z.getSelectedRange(),C=>{if(C.isSingleHeader())return;const L=C.getTopStartCorner(),D=C.getBottomEndCorner();me(L.row,D.row,j=>{me(L.col,D.col,v=>{this.getCellMeta(j,v).readOnly||w.push([j,v,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const C=g();return this.resumeExecution(w),C},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const g=s.view,{width:w,height:C}=g.getLastSize(),{width:L,height:D}=s.rootElement.getBoundingClientRect(),j=L!==w||D!==C;s.runHooks("beforeRefreshDimensions",{width:w,height:C},{width:L,height:D},j)!==!1&&((j||g._wt.wtOverlays.scrollableElement===s.rootWindow)&&(g.setLastSize(L,D),g.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:C},{width:L,height:D},j))},this.updateData=function(g,w){XH(g,C=>{l=C},C=>{l=C,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),z.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:w,metaManager:M,firstRun:m})},this.loadData=function(g,w){XH(g,C=>{l=C},()=>{M.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),z.refresh(),m&&(m=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:w,metaManager:M,firstRun:m})},this.getInitialColumnCount=function(){const g=R.columns;let w=0;if(Array.isArray(g))w=g.length;else if(rt(g))if(s.dataType==="array"){const C=this.countSourceCols();for(let L=0;L<C;L+=1)g(L)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=l.colToPropCache.length);else if(ae(R.dataSchema)){const C=l.getSchema();w=Array.isArray(C)?C.length:Ww(C)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,C,L){return It(g)?l.getAll():l.getRange(s._createCellCoords(g,w),s._createCellCoords(C,L),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,C,L){return l.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(C,L))},this.getCopyableData=function(g,w){return l.getCopyable(g,l.colToProp(w))},this.getCopyableSourceData=function(g,w){return u.getCopyable(g,l.colToProp(w))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=(m?s.loadData:s.updateData).bind(this);let L=!1,D,j;if(ae(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ae(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ae(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(D in g)if(!(D==="data"||D==="language"))if(D==="className")K("className",g.className);else if(D==="tableClassName"&&s.table)K("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(oe.getSingleton().isRegistered(D)||oe.getSingleton().isDeprecated(D)){const E=g[D];rt(E)?(oe.getSingleton().addAsFixed(D,E,s),R[D]=E):Array.isArray(E)&&(oe.getSingleton().add(D,E,s),R[D]=E)}else!w&&jt(g,D)&&(k[D]=g[D]);if(w)s.useTheme(R.themeName||n1(s.rootContainer));else{const E=s.getCurrentThemeName();jt(g,"themeName")&&E!==g.themeName&&s.useTheme(g.themeName)}Lg.has(s)&&s.stylesHandler.getThemeName()!==void 0&&Lg.delete(s),Vl(s)&&!Lg.has(s)&&s.stylesHandler.isClassicTheme()&&(c$("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),Lg.add(s)),g.data===void 0&&R.data===void 0?C(null,"updateSettings"):g.data!==void 0?C(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!m&&g.language&&ee(g.language);const v=s.countCols(),S=R.columns;if(S&&rt(S)&&(L=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&M.clearCache(),v>0)for(D=0,j=0;D<v;D++){if(S){const E=L?S(D):S[j];E&&M.updateColumnMeta(j,E)}j+=1}ae(g.cell)&&Ve(g.cell,E=>{s.setCellMetaObject(E.row,E.col,E)}),s.runHooks("afterCellMetaReset");let _=s.rootElement.style.height;_!==""&&(_=parseInt(s.rootElement.style.height,10)),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let x=g.height;if(typeof g.height<"u")if(rt(x)&&(x=x()),x=s.runHooks("beforeHeightChange",x),x===null){const E=s.rootElement.getAttribute("data-initialstyle");E&&(E.indexOf("height")>-1||E.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",E):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else x!==void 0&&(s.rootElement.style.height=isNaN(x)?`${x}`:`${x}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let E=g.width;rt(E)&&(E=E()),E=s.runHooks("beforeWidthChange",E),s.rootElement.style.width=isNaN(E)?`${E}`:`${E}px`}w||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!m&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(_===""||x===""||x===void 0)&&_!==x&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedRangeActive();if(R.getValue){if(rt(R.getValue))return R.getValue.call(s);if(g)return s.getData()[g.highlight.row][R.getValue]}else if(g)return s.getDataAtCell(g.highlight.row,g.highlight.col);return null},this.getSettings=function(){return R},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,C,L,D){c.alter(g,w,C,L,D)},this.getCell=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,L=w,D=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;L=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;D=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return D===null||L===null||D===void 0||L===void 0?null:s.view.getCellAtCoords(s._createCellCoords(D,L),C)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:C,col:L}=w;let D=C,j=L;return C>=0&&(D=this.rowIndexMapper.getVisualFromRenderableIndex(C)),L>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(L)),s._createCellCoords(D,j)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return l.get(g,l.colToProp(w))},this.getDataAtRowProp=function(g,w){return l.get(g,w)},this.getDataAtCol=function(g){const w=[],C=l.getRange(s._createCellCoords(0,g),s._createCellCoords(R.data.length-1,g),l.DESTINATION_RENDERER);for(let L=0;L<C.length;L+=1)for(let D=0;D<C[L].length;D+=1)w.push(C[L][D]);return w},this.getDataAtProp=function(g){const w=[],C=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(R.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let L=0;L<C.length;L+=1)for(let D=0;D<C[L].length;D+=1)w.push(C[L][D]);return w},this.getSourceData=function(g,w,C,L){let D;return g===void 0?D=u.getData():D=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(C,L)),D},this.getSourceDataArray=function(g,w,C,L){let D;return g===void 0?D=u.getData(!0):D=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(C,L),!0),D},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,C,L){const D=ye(g,w,C),j=this.hasHook("afterSetSourceDataAtCell"),v=[],S=(x,E)=>{const H=this.toVisualRow(x),F=this.toVisualColumn(E);return Number.isInteger(F)?this.getCellMeta(H,F):{...Object.getPrototypeOf(R),...R}};j&&I(D,x=>{let[E,H,F]=x;const A=GS(F,S(E,H));v.push([E,H,u.getAtCell(E,H),A])}),I(D,x=>{let[E,H,F]=x;const A=GS(F,S(E,H));u.setAtCell(E,H,A)}),j&&this.runHooks("afterSetSourceDataAtCell",v,L),this.render();const _=s.getActiveEditor();_&&ae(_.refreshValue)&&_.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return u.getAtCell(g,w)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,C,L){const D=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,C,L],[j,v]=D;let[,,S,_]=D,x=null,E=null;S===void 0&&(S=j),_===void 0&&(_=v);let H="mixed";return me(Math.max(Math.min(j,S),0),Math.max(j,S),F=>{let A=!0;return me(Math.max(Math.min(v,_),0),Math.max(v,_),$=>(E=this.getCellMeta(F,$).type,x?A=x===E:x=E,A)),H=A?E:"mixed",A}),H},this.removeCellMeta=function(g,w,C){const[L,D]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let j=M.getCellMetaKeyValue(L,D,C);s.runHooks("beforeRemoveCellMeta",g,w,C,j)!==!1&&(M.removeCellMeta(L,D,C),s.runHooks("afterRemoveCellMeta",g,w,C,j)),j=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var C=arguments.length,L=new Array(C>2?C-2:0),D=2;D<C;D++)L[D-2]=arguments[D];if(L.length>0&&!Array.isArray(L[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&M.removeRow(this.toPhysicalRow(g),w),L.length>0&&I(L.reverse(),j=>{M.createRow(this.toPhysicalRow(g)),I(j,(v,S)=>this.setCellMetaObject(g,S,v))}),s.render()},this.setCellMetaObject=function(g,w,C){typeof C=="object"&&Ve(C,(L,D)=>{this.setCellMeta(g,w,D,L)})},this.setCellMeta=function(g,w,C,L){if(s.runHooks("beforeSetCellMeta",g,w,C,L)===!1)return;let j=g,v=w;g<this.countRows()&&(j=this.toPhysicalRow(g)),w<this.countCols()&&(v=this.toPhysicalColumn(w)),M.setCellMeta(j,v,C,L),s.runHooks("afterSetCellMeta",g,w,C,L)},this.getCellsMeta=function(){return M.getCellsMeta()},this.getCellMeta=function(g,w){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},L=this.toPhysicalRow(g),D=this.toPhysicalColumn(w);return L===null&&(L=g),D===null&&(D=w),M.getCellMeta(L,D,{visualRow:g,visualColumn:w,...C})},this.getColumnMeta=function(g){return M.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return M.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||R.columns)},this.getCellRenderer=function(g,w){const C=typeof g=="number"?s.getCellMeta(g,w).renderer:g.renderer;return typeof C=="string"?Op(C):It(C)?Op("text"):C},this.getCellEditor=function(g,w){const C=typeof g=="number"?s.getCellMeta(g,w).editor:g.editor;return typeof C=="string"?Ip(C):It(C)?Ip("text"):C},this.getCellValidator=function(g,w){const C=typeof g=="number"?s.getCellMeta(g,w).validator:g.validator;return typeof C=="string"?uT(C):C},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,C){const L=new ne;g&&(L.onQueueEmpty=g);let D=s.countRows()-1;for(;D>=0;){if(w!==void 0&&w.indexOf(D)===-1){D-=1;continue}let j=s.countCols()-1;for(;j>=0;){if(C!==void 0&&C.indexOf(j)===-1){j-=1;continue}L.addValidatorToQueue(),s.validateCell(s.getDataAtCell(D,j),s.getCellMeta(D,j),v=>{if(typeof v!="boolean")throw new Error("Validation error: result is not boolean");v===!1&&(L.valid=!1),L.removeValidatorFormQueue()},"validateCells"),j-=1}D-=1}L.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=R.rowHeaders,C=g;return C!==void 0&&(C=s.runHooks("modifyRowHeader",C)),C===void 0?(w=[],me(s.countRows()-1,L=>{w.push(s.getRowHeader(L))})):Array.isArray(w)&&w[C]!==void 0?w=w[C]:rt(w)?w=w(C):w&&typeof w!="string"&&typeof w!="number"&&(w=C+1),w},this.hasRowHeaders=function(){return!!R.rowHeaders},this.hasColHeaders=function(){if(R.colHeaders!==void 0&&R.colHeaders!==null)return!!R.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const C=s.runHooks("modifyColHeader",g);if(C===void 0){const S=[],_=s.countCols();for(let x=0;x<_;x++)S.push(s.getColHeader(x));return S}let L=R.colHeaders;const D=function(S){const _=[],x=s.countCols();let E=0;for(;E<x;E++)rt(R.columns)&&R.columns(E)&&_.push(E);return _[S]},j=s.toPhysicalColumn(C),v=D(j);return R.colHeaders===!1?L=null:R.columns&&rt(R.columns)&&R.columns(v)&&R.columns(v).title?L=R.columns(v).title:R.columns&&R.columns[j]&&R.columns[j].title?L=R.columns[j].title:Array.isArray(R.colHeaders)&&R.colHeaders[j]!==void 0?L=R.colHeaders[j]:rt(R.colHeaders)?L=R.colHeaders(j):R.colHeaders&&typeof R.colHeaders!="string"&&typeof R.colHeaders!="number"&&(L=Zw(C)),L=s.runHooks("modifyColumnHeaderValue",L,g,w),L},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(w===void 0||w===R.width)&&(w=R.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(g,w){let C=s._getColWidthFromSettings(g);return C=s.runHooks("modifyColWidth",C,g,w),C===void 0&&(C=Kc),C},this._getRowHeightFromSettings=function(g){const w=s.stylesHandler.getDefaultRowHeight();let C=R.rowHeights;if(C!=null){switch(typeof C){case"object":C=C[g];break;case"function":C=C(g);break}typeof C=="string"&&(C=parseInt(C,10))}return C!=null&&C<w?w:C},this.getRowHeight=function(g,w){let C=s._getRowHeightFromSettings(g);return C=s.runHooks("modifyRowHeight",C,g,w),C},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=R.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return fE(s.countRows()-1,C=>{if(s.isEmptyRow(C))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return fE(s.countCols()-1,C=>{if(s.isEmptyCol(C))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return R.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return R.isEmptyCol.call(s,g)},this.selectCell=function(g,w,C,L){let D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return It(g)||It(w)?!1:this.selectCells([[g,w,C,L]],D,j)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&f.suspend();const L=z.selectCells(g);return L&&C&&s.listen(),f.resume(),L},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;return z.selectColumns(g,w,C)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;return z.selectRows(g,w,C)},this.deselectCell=function(){z.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),z.selectAll(g,w,C)};const We=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g,w){if(typeof g=="number"){var C;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(C=arguments[4])!==null&&C!==void 0?C:!0}}const{row:L,col:D,considerHiddenIndexes:j}=g??{};let v=L,S=D;if(rt(w)&&this.addHookOnce("afterScroll",w),j===void 0||j){const H=Number.isInteger(L)&&L>=0,F=Number.isInteger(D)&&D>=0,A=H?We(this.rowIndexMapper,L):void 0,$=F?We(this.columnIndexMapper,D):void 0;if(A===null||$===null)return!1;v=H?s.rowIndexMapper.getRenderableFromVisualIndex(A):L,S=F?s.columnIndexMapper.getRenderableFromVisualIndex($):D}const _=Number.isInteger(v),x=Number.isInteger(S);let E=!1;return _&&v>=0&&x&&S>=0?E=s.view.scrollViewport(s._createCellCoords(v,S),g.horizontalSnap,g.verticalSnap):_&&v>=0&&(x&&S<0||!x)?E=s.view.scrollViewportVertically(v,g.verticalSnap):x&&S>=0&&(_&&v<0||!_)&&(E=s.view.scrollViewportHorizontally(S,g.horizontalSnap)),rt(w)&&(E?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),E},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;rt(g)&&this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeActive(),C=this.scrollViewportTo(w.toObject());return C?this.view.render():rt(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),C},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,Vl(this)&&K8(),this.getShortcutManager().destroy(),O.clear(),M.clearCache(),QS.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&qo(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),P.getItems().forEach(g=>{let[,w]=g;w.destroy()}),P.clear(),s.runHooks("afterDestroy")},!0),oe.getSingleton().destroy(s),Ve(s,(g,w,C)=>{rt(g)?C[w]=Tt(w):w!=="guid"&&(C[w]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,z=null,h=null,s=null};function Tt(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return P.getItem(Zn(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w,C){oe.getSingleton().add(g,w,s,C)},this.hasHook=function(g){return oe.getSingleton().has(g,s)||oe.getSingleton().has(g)},this.addHookOnce=function(g,w,C){oe.getSingleton().once(g,w,s,C)},this.removeHook=function(g,w){oe.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,C,L,D,j,v){return oe.getSingleton().run(s,g,w,C,L,D,j,v)},this.getTranslatedPhrase=function(g,w){return oF(R.language,g,w)},this.toHTML=()=>cE(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",cE(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const w=!!m;this.stylesHandler.useTheme(g);const C=this.stylesHandler.getThemeName();w||(s.render(),s.scrollViewportTo(0,0),n1(this.rootContainer)&&(ce(this.rootContainer,/ht-theme-.*/g),C&&Y(this.rootContainer,C))),this.runHooks("afterSetTheme",C,w)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=g;typeof C=="function"&&(C=setTimeout(C,w)),this.timeouts.push(C)},this._clearTimeouts=function(){I(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){I(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return h};const _e=F8({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&_e.releasePressedKeys()}),this.getShortcutManager=function(){return _e},this.getFocusManager=function(){return d},lT().forEach(g=>{const w=Yf(g);P.addItem(g,new w(this))}),R8(s),_e.setActiveContextName("grid"),oe.getSingleton().run(s,"construct")}function u1(t,e,n){t.addEventListener(e,n,!1)}function c1(t,e,n){t.removeEventListener(e,n,!1)}function $g(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function SF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=$g(s).fontSize,o.style.fontFamily=$g(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=$g(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=$g(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),p=o.clientWidth+f+m+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>p?y.width=`${n.minWidth}px`:p>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${p}px`;const T=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>T?y.height=`${n.minHeight}px`:n.maxHeight<T?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(u1(s,"input",a),u1(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){c1(s,"input",a),c1(s,"keydown",l)}}}function h1(t,e){const n=X0(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}jf(e,i)}function ll(t,e,n){return(e=Z8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z8(t){var e=Q8(t,"string");return typeof e=="symbol"?e:e+""}function Q8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J8="ht_editor_visible",Fg="ht_editor_hidden",d1="textEditor",e7="text";class Eu extends mh{static get EDITOR_TYPE(){return e7}constructor(e){super(e),ll(this,"eventManager",new Pi(this)),ll(this,"autoResize",SF(this.hot.rootDocument)),ll(this,"TEXTAREA",void 0),ll(this,"textareaStyle",void 0),ll(this,"TEXTAREA_PARENT",void 0),ll(this,"textareaParentStyle",void 0),ll(this,"layerClass",void 0),this.eventManager=new Pi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),$d(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==qt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),jf(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),fe(this.TEXTAREA,[["data-hot-input",""],xr(-1)]),Y(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Y(this.TEXTAREA_PARENT,"handsontableInputHolder"),be(this.TEXTAREA_PARENT,this.layerClass)&&ce(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Fg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){jL()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ce(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Fg)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(be(i,"handsontableEditor"))return n=!0,!1}),be(this.TEXTAREA_PARENT,Fg)&&ce(this.TEXTAREA_PARENT,Fg),n?(this.layerClass=J8,Y(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Y(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){U0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ae(this.hot.getSelected()),group:d1},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;h1(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;h1(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(d1)}}const t7="base",n7="htTextEllipsis";function Xf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Y(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(pA())):a&&c.push(pA()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(wA())):(u.push(s.invalidCellClassName),a&&c.push(wA()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(n7),ce(e,u),Y(e,l),Uo(e,c),fe(e,h)}Xf.RENDERER_TYPE=t7;const r7="text";function zs(t,e,n,r,i,o,s){Xf.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Rt(a),s.trimWhitespace&&(a=a.trim()),Ba(e,a)}zs.RENDERER_TYPE=r7;const i7="text",bF={CELL_TYPE:i7,editor:Eu,renderer:zs};fi(bF);Re.editors={BaseEditor:mh};function Re(t,e){const n=new yF(t,e||{},TT);return n.init(),n}Re.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new yF(t,e,TT)};Re.DefaultSettings=hF();Re.hooks=oe.getSingleton();Re.CellCoords=cu;Re.CellRange=fh;Re.packageName="handsontable";Re.buildDate="23/09/2025 14:16:56";Re.version="16.1.1";Re.languages={dictionaryKeys:o6,getLanguageDictionary:iF,getLanguagesDictionaries:c6,registerLanguageDictionary:rF,getTranslatedPhrase:oF};function o7(t,e,n){return(e=l7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function s7(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f1(Object(n),!0).forEach(function(r){o7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function a7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l7(t){var e=a7(t,"string");return typeof e=="symbol"?e:e+""}function Bd(t){"@babel/helpers - typeof";return Bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bd(t)}var Bc=Symbol("unassigned"),u7="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function $p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function RF(t){var e=Re.hooks.getRegistered(),n={};Object.assign(n,Re.DefaultSettings);for(var r in n)n[r]={default:Bc};for(var i=0;i<e.length;i++)n[e[i]]={default:Bc};return n.settings={default:Bc},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function EF(t){var e={},n=t.settings;if(n!==Bc)for(var r in n)$p(n,r)&&n[r]!==Bc&&(e[r]=n[r]);for(var i in t)$p(t,i)&&i!=="settings"&&t[i]!==Bc&&(e[i]=t[i]);return e}function g1(t,e){var n=EF(t),r=t.settings?t.settings:n,i=t.settings?n:null,o={};for(var s in r)$p(r,s)&&r[s]!==void 0&&(!(e&&s!=="data")||!m1(e[s],r[s]))&&(o[s]=r[s]);for(var a in i)$p(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!m1(e[a],i[a]))&&(o[a]=i[a]);return o}function m1(t,e){var n=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(Bd(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Bd(t)!==Bd(e)?!1:n(t)===n(e)}var c7="16.1.1",wM=qD({name:"HotTable",props:RF("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=g1(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(u7),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=g1(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=sB(new Re.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:c7}),h7=["id"];function d7(t,e,n,r,i,o){return mp(),KD("div",{id:t.id},[aB(t.$slots,"default")],8,h7)}wM.render=d7;wM.__file="src/HotTable.vue";var f7=qD({name:"HotColumn",props:RF("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=EF(this.$props),n=s7({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});f7.__file="src/HotColumn.vue";const g7={__name:"BaseHotTable",setup(t,{expose:e}){const n=Fl(null);return e({hotInstance:n}),(r,i)=>(mp(),XD(ZD(wM),lB({ref_key:"innerHot",ref:n,licenseKey:"non-commercial-and-evaluation"},r.$attrs,{theme:"htThemeMain"}),null,16))}};function p1(t,e,n){return(e=m7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m7(t){var e=p7(t,"string");return typeof e=="symbol"?e:e+""}function p7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const w1="handsontableEditor",w7="handsontable";class vM extends Eu{constructor(){super(...arguments),p1(this,"isFlippedVertically",!1),p1(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return w7}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),jf(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&on(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:w1,relativeToGroup:Za,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ni(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedActive()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedActive()&&(this.isFlippedVertically?(l=s.getSelectedActive()[0],a=Math.max(0,l-1)):(l=s.getSelectedActive()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(s.getSelectedActive()){if(this.isFlippedVertically)a=s.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedActive()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(w1)}}function v7(t,e){TF(t,e),e.add(t)}function v1(t,e,n){TF(t,e),e.set(t,n)}function TF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JS(t,e,n){return(e=C7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C7(t){var e=y7(t,"string");return typeof e=="symbol"?e:e+""}function y7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eb(t,e){return t.get(va(t,e))}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const S7="autocomplete";var tb=new WeakMap,C1=new WeakMap,Js=new WeakSet;class CM extends vM{constructor(){super(...arguments),v7(this,Js),JS(this,"query",null),JS(this,"strippedChoices",[]),JS(this,"rawChoices",[]),v1(this,tb,this.hot.guid.slice(0,9)),v1(this,C1,zf(()=>{this.focus()},100))}static get EDITOR_TYPE(){return S7}getValue(){const e=this.rawChoices.find(n=>{const r=this.stripValueIfNeeded(n);return(va(Js,this,Gh).call(this,r)?r.value:r)===this.TEXTAREA.value});return ae(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Y(this.htContainer,"autocompleteEditor"),Y(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[D2(),P2(),AL("listbox"),V2()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[_i("false"),W2(`${eb(tb,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:a=>va(Js,this,Gh).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",eb(C1,this)),this.htEditor.updateSettings({colWidths:e?[Xt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{zs(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:p,locale:y}=this.cellProperties,T=this.query;let b=Rt(d),M,R;b&&!p&&(M=m===!0?b.indexOf(T):b.toLocaleLowerCase(y).indexOf(T.toLocaleLowerCase(y)),M!==-1&&(R=b.substr(M,T.length),b=b.replace(R,`<strong>${R}</strong>`))),n&&fe(l,[I2(),...r?[z2(i)]:[],...r?[Y2(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=b},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{fe(h,[W0()]),fe(this.TEXTAREA,...B2(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(fe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Os()),fe(this.htEditor.rootElement,[xL(),j2("polite"),U2("text"),["id",`${eb(tb,this)}-listbox-${o}-${s}`]]),fe(this.TEXTAREA,..._i("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&fe(this.TEXTAREA,[_i("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=X0(this.TEXTAREA),r=e$(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=this.stripValueIfNeeded(this.getValue()),a=va(Js,this,Gh).call(this,s)?s.value:s;let l=null,u=e;i||(u=u.toSorted());const c=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let m=0;m<u.length;m++){const p=va(Js,this,Gh).call(this,u[m])?Gm(Rt(u[m].value)):Gm(Rt(u[m]));if((d?p:p.toLocaleLowerCase(h)).indexOf(f)!==-1&&(c.push(m),o===!1))break}o===!1?l=c[0]:(u=c.map(m=>u[m]),l=u.indexOf(f)>-1?u.indexOf(f):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Nd([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),jf(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=t$(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),va(Js,this,y1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),va(Js,this,y1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=i=>Rt(n?i:Gm(i));return e.every(i=>va(Js,this,Gh).call(this,i))?e.map(i=>({key:r(i.key),value:r(i.value)})):e.map(i=>r(i))}onBeforeKeyDown(e){if(s$(e.keyCode)||e.keyCode===ve.BACKSPACE||e.keyCode===ve.DELETE||e.keyCode===ve.INSERT){let n=10;if(e.keyCode===ve.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function y1(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+rn(this.hot.rootDocument)})}function Gh(t){return Te(t)&&ae(t.key)&&ae(t.value)}const b7="checkbox";class _F extends mh{static get EDITOR_TYPE(){return b7}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');be(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const xa=()=>window,bi=()=>window.document,_E=(t,e)=>window.setTimeout(t,e),Ao=function(t,e,n,r){t.addEventListener(e,n,!!r)},hs=function(t,e,n,r){t.removeEventListener(e,n,!!r)},R7=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Yr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},nb=function(t,e){Yr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},rb=function(t,e){t.className=R7((" "+t.className+" ").replace(" "+e+" "," "))},yM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Zr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},E7=function(t){let e=t.getDay();return e===0||e===6},T7=function(t){return t%4===0&&t%100!==0||t%400===0},S1=function(t,e){return[31,T7(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Vg=function(t){Zr(t)&&t.setHours(0,0,0,0)},Wg=function(t,e){return t.getTime()===e.getTime()},Fp=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Zr(e[r])?n&&(t[r]=new Date(e[r].getTime())):yM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Fp({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},b1=function(t,e,n){let r=bi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Fp(r,n),t.dispatchEvent(r)},R1=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},vo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},E1=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},_7=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},M7=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},P7=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():M7(o,i))+"</td>"},I7=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},O7=function(t){return"<tbody>"+t.join("")+"</tbody>"},x7=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+E1(t,e)+'">'+E1(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},A7=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,p=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",yM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(p=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},H7=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+x7(t)+O7(e)+"</table>"};function ME(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||xa().event;let o=i.target||i.srcElement;if(o)if(Yr(o,"is-disabled")||(Yr(o,"pika-button")&&!Yr(o,"is-empty")&&!Yr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&_E(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Yr(o,"pika-prev")?e.prevMonth():Yr(o,"pika-next")&&e.nextMonth()),Yr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||xa().event;let o=i.target||i.srcElement;o&&(Yr(o,"pika-select-month")?e.gotoMonth(o.value):Yr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||xa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Zr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=bi().activeElement;do if(Yr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=_E(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||xa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Yr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Ao(o,"change",e._onChange)));do if(Yr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=bi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Ao(e.el,"mousedown",e._onMouseDown,!0),Ao(e.el,"touchend",e._onMouseDown,!0),Ao(e.el,"change",e._onChange),n.keyboardInput&&Ao(bi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?bi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Ao(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Zr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Ao(n.trigger,"click",e._onInputClick),Ao(n.trigger,"focus",e._onInputFocus),Ao(n.trigger,"blur",e._onInputBlur)):this.show()}ME.prototype={config:function(t){this._o||(this._o=Fp({},vo,!0));let e=Fp(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Zr(e.minDate)||(e.minDate=!1),Zr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),yM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||vo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Zr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Zr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",b1(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Zr(t))return;let n=this._o.minDate,r=this._o.maxDate;Zr(n)&&t<n?t=n:Zr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Vg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),b1(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Zr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=R1(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=R1({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Vg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=vo.minDate,this._o.minYear=vo.minYear,this._o.minMonth=vo.minMonth,this._o.startRange=vo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Vg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=vo.maxDate,this._o.maxYear=vo.maxYear,this._o.maxMonth=vo.maxMonth,this._o.endRange=vo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+A7(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&_E(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=xa().innerWidth||bi().documentElement.clientWidth,i=xa().innerHeight||bi().documentElement.clientHeight,o=bi().body.scrollTop||bi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+xa().pageXOffset,a=l.bottom+xa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",nb(this.el,u?"left-aligned":"right-aligned"),nb(this.el,c?"bottom-aligned":"top-aligned"),rb(this.el,u?"right-aligned":"left-aligned"),rb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=S1(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Vg(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=S1(h,u),m=o+s,p=m;for(;p>7;)p-=7;m+=7-p;let y=!1;for(let T=0,b=0;T<m;T++){let M=new Date(t,e,1+(T-s)),R=Zr(this._d)?Wg(M,this._d):!1,k=Wg(M,i),P=r.events.indexOf(M.toDateString())!==-1,O=T<s||T>=o+s,U=1+(T-s),G=e,V=t,Z=r.startRange&&Wg(r.startRange,M),z=r.endRange&&Wg(r.endRange,M),ue=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,ee=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&E7(M)||r.disableDayFn&&r.disableDayFn(M);O&&(T<s?(U=f+U,G=u,V=h):(U=U-o,G=c,V=d));let K={day:U,month:G,year:V,hasEvent:P,isSelected:R,isToday:k,isDisabled:ee,isEmpty:O,isStartRange:Z,isEndRange:z,isInRange:ue,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&R&&(y=!0),l.push(_7(K)),++b===7&&(r.showWeekNumber&&l.unshift(P7(this,T-s,e,t,r.firstWeekOfYearMinDays)),a.push(I7(l,r.isRTL,r.pickWholeWeek,y)),l=[],b=0,y=!1)}return H7(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),rb(this.el,"is-hidden"),this._o.bound&&(Ao(bi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&hs(bi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),nb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),hs(this.el,"mousedown",this._onMouseDown,!0),hs(this.el,"touchend",this._onMouseDown,!0),hs(this.el,"change",this._onChange),t.keyboardInput&&hs(bi(),"keydown",this._onKeyChange),t.field&&(hs(t.field,"change",this._onInputChange),t.bound&&(hs(t.trigger,"click",this._onInputClick),hs(t.trigger,"focus",this._onInputFocus),hs(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function N7(t,e){D7(t,e),e.add(t)}function D7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T1(t,e,n){return(e=k7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k7(t){var e=L7(t,"string");return typeof e=="symbol"?e:e+""}function L7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ib(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MF="date",_1="dateEditor",$7="DD/MM/YYYY";var Bg=new WeakSet;class PF extends Eu{constructor(){super(...arguments),N7(this,Bg),T1(this,"parentDestroyed",!1),T1(this,"$datePicker",null)}static get EDITOR_TYPE(){return MF}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof ME!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Y(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{be(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:_1})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_1),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=ib(Bg,this,ob).call(this),r=this.hot.view.isMouseDown(),i=e?rT(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new ME(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Vf(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:ib(Bg,this,ob).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=X(a).format(ib(Bg,this,ob).call(this))),this.setValue(a),i&&i(),ro()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+nn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Xt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ob(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:$7}const F7="dropdown";class IF extends CM{static get EDITOR_TYPE(){return F7}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const V7="numeric";class OF extends Eu{static get EDITOR_TYPE(){return V7}}function W7(t,e,n){return(e=B7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B7(t){var e=j7(t,"string");return typeof e=="symbol"?e:e+""}function j7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const U7="password";class xF extends Eu{constructor(){super(...arguments),W7(this,"autoResize",SF(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return U7}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,qo(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...xr(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const sb="ht_editor_visible",M1="selectEditor",z7="select";class AF extends mh{static get EDITOR_TYPE(){return z7}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...bu()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),Y(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",be(this.selectWrapper,sb)&&ce(this.selectWrapper,sb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),qo(this.select),Ve(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ka(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Y(this.selectWrapper,sb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:M1};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(M1)}}const Y7="time";class HF extends Eu{static get EDITOR_TYPE(){return Y7}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function G7(){Tr(mh),Tr(CM),Tr(_F),Tr(PF),Tr(IF),Tr(vM),Tr(OF),Tr(xF),Tr(AF),Tr(Eu),Tr(HF)}const q7="html";function SM(t,e,n,r,i,o,s){Xf.apply(this,[t,e,n,r,i,o,s]),Ka(e,o??"",!1)}SM.RENDERER_TYPE=q7;const K7="autocomplete";function wh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?SM:zs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...bu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),Y(e,"htAutocomplete"),!t.acArrowListener){const h=new Pi(t);t.acArrowListener=function(d){be(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}wh.RENDERER_TYPE=K7;const X7="dropdown";function bM(t,e,n,r,i,o,s){wh.apply(this,[t,e,n,r,i,o,s])}bM.RENDERER_TYPE=X7;const P1=new WeakMap,I1=new WeakMap,Z7="htBadValue",Qc="data-row",Jc="data-col",Q7="checkboxRenderer",NF="checkbox";oe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===NF){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function RM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Xf.apply(this,[t,e,n,r,i,o,s]),J7(t);let u=e5(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),qo(e),o===s.checkedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Rt(o).toLocaleLowerCase(s.locale)===Rt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Ut(o)?Y(u,"noValue"):(u.style.display="none",Y(u,Z7),h=!0),fe(u,[[Qc,n],[Jc,r]]),l&&fe(u,[ri(u.checked?t.getTranslatedPhrase(aM):t.getTranslatedPhrase(lM)),DL(u.checked),O2()]),!h&&c){let p="";if(c.value)p=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const T=t.getDataAtRowProp(n,c.property);p=T!==null?T:""}const y=t5(a,p,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),P1.has(t)||(P1.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),T={group:Q7,relativeToGroup:Za,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const b=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&(b==null?void 0:b.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}}],T)}function f(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),T=[],b=new Map;let M=[],R=0;if(y){for(let k=0;k<y.length;k++){const{row:P,col:O}=y[k].getTopStartCorner(),{row:U,col:G}=y[k].getBottomEndCorner();for(let V=P;V<=U;V+=1)for(let Z=O;Z<=G;Z+=1){const z=t.getCellMeta(V,Z);if(z.hidden)continue;const ue={checkedTemplate:z.checkedTemplate,uncheckedTemplate:z.uncheckedTemplate};if(z.type!=="checkbox"){p===!0&&!z.readOnly&&(b.has(T.length)?b.set(T.length,[...b.get(T.length),[V,Z,null]]):b.set(T.length,[[V,Z,null]]));continue}if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const ee=t.getDataAtCell(V,Z);p===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(ee)?M.push([V,Z,z.uncheckedTemplate,ue]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(ee)&&M.push([V,Z,z.checkedTemplate,ue]):M.push([V,Z,z.uncheckedTemplate,ue]),R+=1}T.push(R),R=0}M.every(k=>{let[,,P]=k;return P===M[0][2]})?M=M.map(k=>{let[P,O,U]=k;return[P,O,U]}):M=M.map(k=>{let[P,O,,U]=k;return[P,O,U.checkedTemplate]}),M.length>0&&T.forEach((k,P)=>{let O=M.splice(0,k);b.size&&b.has(P)&&(O=[...O,...b.get(P)]),t.setDataAtCell(O)})}}function m(){const p=t.getSelectedRange();if(p){for(let y=0;y<p.length;y++){const T=p[y].getTopStartCorner(),b=p[y].getBottomEndCorner();for(let M=T.row;M<=b.row;M++)for(let R=T.col;R<=b.col;R++){if(t.getCellMeta(M,R).readOnly)continue;const P=t.getCell(M,R);if(zo(P)&&P.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}RM.RENDERER_TYPE=NF;function J7(t){let e=I1.get(t);if(!e){const{rootElement:n}=t;e=new Pi(t),e.addEventListener(n,"click",r=>r5(r,t)),e.addEventListener(n,"mouseup",r=>n5(r,t)),e.addEventListener(n,"change",r=>i5(r,t)),I1.set(t,e)}return e}function e5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function t5(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function n5(t,e){const{target:n}=t;EM(n)&&(!n.hasAttribute(Qc)||!n.hasAttribute(Jc)||setTimeout(e.listen,10))}function r5(t,e){const{target:n}=t;if(!EM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(Jc))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(Jc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function i5(t,e){const{target:n}=t;if(!EM(n)||!n.hasAttribute(Qc)||!n.hasAttribute(Jc))return;const r=parseInt(n.getAttribute(Qc),10),i=parseInt(n.getAttribute(Jc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function EM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const o5="handsontable";function TM(t,e,n,r,i,o,s){wh.apply(this,[t,e,n,r,i,o,s])}TM.RENDERER_TYPE=o5;var s5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a5(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ab,O1;function l5(){return O1||(O1=1,ab={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ab}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var lb,x1;function DF(){if(x1)return lb;x1=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let p="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let P=0;P<t.length;P++){let O=t[P];if(p=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),p!==l)return n(p,u,c,h,d,f)*O.factor}if(p=l.replace("%",""),p!==l)return n(p,u,c,h,d,f)/100;let T=parseFloat(l);if(isNaN(T))return;let b=h(T);if(b&&b!=="."&&(p=l.replace(new RegExp(`${e(b)}$`),""),p!==l))return n(p,u,c,h,d,f);let M={};Object.keys(f).forEach(P=>{M[f[P]]=P});let R=Object.keys(M).sort().reverse(),k=R.length;for(let P=0;P<k;P++){let O=R[P],U=M[O];if(p=l.replace(O,""),p!==l){let G;switch(U){case"thousand":G=Math.pow(10,3);break;case"million":G=Math.pow(10,6);break;case"billion":G=Math.pow(10,9);break;case"trillion":G=Math.pow(10,12);break}return n(p,u,c,h,d,f)*G}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let p=r(l,u,c);return n(p,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=PM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),p=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,m,p);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return lb={unformat:a},lb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ub,A1;function _M(){if(A1)return ub;A1=1;let t=DF();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,T){let b=d(y),M=m(T);return b&&M}function d(y){return t.unformat(y)!==void 0}function f(y,T,b,M=!1){let R=Object.keys(y).map(k=>{if(!T[k])return console.error(`${b} Invalid key: ${k}`),!1;let P=y[k],O=T[k];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(P,u,`[Validate ${k}]`,!0))return!1}else if(typeof P!==O.type)return console.error(`${b} ${k} type mismatched: "${O.type}" expected, "${typeof P}" provided`),!1;if(O.restrictions&&O.restrictions.length){let U=O.restrictions.length;for(let G=0;G<U;G++){let{restriction:V,message:Z}=O.restrictions[G];if(!V(P,y))return console.error(`${b} ${k} invalid value: ${Z}`),!1}}return O.restriction&&!O.restriction(P,y)?(console.error(`${b} ${k} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(P)===-1?(console.error(`${b} ${k} invalid value: must be among ${JSON.stringify(O.validValues)}, "${P}" provided`),!1):!(O.children&&!f(P,O.children,`[Validate ${k}]`))});return M||R.push(...Object.keys(T).map(k=>{let P=T[k];if(typeof P=="string"&&(P={type:P}),P.mandatory){let O=P.mandatory;if(typeof O=="function"&&(O=O(y)),O&&y[k]===void 0)return console.error(`${b} Missing mandatory key "${k}"`),!1}return!0})),R.reduce((k,P)=>k&&P,!0)}function m(y){return f(y,u,"[Validate format]")}function p(y){return f(y,c,"[Validate language]")}return ub={validate:h,validateFormat:m,validateInput:d,validateLanguage:p},ub}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function u5(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function c5(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function h5(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function d5(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function f5(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function g5(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function m5(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function p5(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function w5(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function v5(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function C5(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function y5(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function S5(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function b5(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function R5(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function E5(t,e={}){return typeof t!="string"?t:(t=u5(t,e),t=c5(t,e),h5(t,e),g5(t,e),m5(t,e),S5(t,e),v5(t,e),C5(t,e),p5(t,e),y5(t,e),w5(t,e),d5(t,e),f5(t,e),b5(t,e),R5(t,e),e)}var MM={parseFormat:E5};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cb,H1;function PM(){if(H1)return cb;H1=1;const t=l5(),e=_M(),n=MM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,cb=r,cb}function T5(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function _5(t,e){t.forEach(n=>{let r;try{r=T5(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var M5=t=>({loadLanguagesInNode:e=>_5(e,t)}),kF={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(P){var O,U,G,V=g.prototype={constructor:g,toString:null,valueOf:null},Z=new g(1),z=20,ue=4,ee=-7,K=21,ne=-1e7,ge=1e7,Ce=!1,ye=1,Me=0,We={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Tt="0123456789abcdefghijklmnopqrstuvwxyz",_e=!0;function g(v,S){var _,x,E,H,F,A,$,B,W=this;if(!(W instanceof g))return new g(v,S);if(S==null){if(v&&v._isBigNumber===!0){W.s=v.s,!v.c||v.e>ge?W.c=W.e=null:v.e<ne?W.c=[W.e=0]:(W.e=v.e,W.c=v.c.slice());return}if((A=typeof v=="number")&&v*0==0){if(W.s=1/v<0?(v=-v,-1):1,v===~~v){for(H=0,F=v;F>=10;F/=10,H++);H>ge?W.c=W.e=null:(W.e=H,W.c=[v]);return}B=String(v)}else{if(!r.test(B=String(v)))return G(W,B,A);W.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(H=B.indexOf("."))>-1&&(B=B.replace(".","")),(F=B.search(/e/i))>0?(H<0&&(H=F),H+=+B.slice(F+1),B=B.substring(0,F)):H<0&&(H=B.length)}else{if(b(S,2,Tt.length,"Base"),S==10&&_e)return W=new g(v),D(W,z+W.e+1,ue);if(B=String(v),A=typeof v=="number"){if(v*0!=0)return G(W,B,A,S);if(W.s=1/v<0?(B=B.slice(1),-1):1,g.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+v)}else W.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(_=Tt.slice(0,S),H=F=0,$=B.length;F<$;F++)if(_.indexOf(x=B.charAt(F))<0){if(x=="."){if(F>H){H=$;continue}}else if(!E&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){E=!0,F=-1,H=0;continue}return G(W,String(v),A,S)}A=!1,B=U(B,S,10,W.s),(H=B.indexOf("."))>-1?B=B.replace(".",""):H=B.length}for(F=0;B.charCodeAt(F)===48;F++);for($=B.length;B.charCodeAt(--$)===48;);if(B=B.slice(F,++$)){if($-=F,A&&g.DEBUG&&$>15&&(v>c||v!==o(v)))throw Error(a+W.s*v);if((H=H-F-1)>ge)W.c=W.e=null;else if(H<ne)W.c=[W.e=0];else{if(W.e=H,W.c=[],F=(H+1)%u,H<0&&(F+=u),F<$){for(F&&W.c.push(+B.slice(0,F)),$-=u;F<$;)W.c.push(+B.slice(F,F+=u));F=u-(B=B.slice(F)).length}else F-=$;for(;F--;B+="0");W.c.push(+B)}}else W.c=[W.e=0]}g.clone=m,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=function(v){var S,_;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(_=v[S],b(_,0,f,S),z=_),v.hasOwnProperty(S="ROUNDING_MODE")&&(_=v[S],b(_,0,8,S),ue=_),v.hasOwnProperty(S="EXPONENTIAL_AT")&&(_=v[S],_&&_.pop?(b(_[0],-1e9,0,S),b(_[1],0,f,S),ee=_[0],K=_[1]):(b(_,-1e9,f,S),ee=-(K=_<0?-_:_))),v.hasOwnProperty(S="RANGE"))if(_=v[S],_&&_.pop)b(_[0],-1e9,-1,S),b(_[1],1,f,S),ne=_[0],ge=_[1];else if(b(_,-1e9,f,S),_)ne=-(ge=_<0?-_:_);else throw Error(s+S+" cannot be zero: "+_);if(v.hasOwnProperty(S="CRYPTO"))if(_=v[S],_===!!_)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ce=_;else throw Ce=!_,Error(s+"crypto unavailable");else Ce=_;else throw Error(s+S+" not true or false: "+_);if(v.hasOwnProperty(S="MODULO_MODE")&&(_=v[S],b(_,0,9,S),ye=_),v.hasOwnProperty(S="POW_PRECISION")&&(_=v[S],b(_,0,f,S),Me=_),v.hasOwnProperty(S="FORMAT"))if(_=v[S],typeof _=="object")We=_;else throw Error(s+S+" not an object: "+_);if(v.hasOwnProperty(S="ALPHABET"))if(_=v[S],typeof _=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_))_e=_.slice(0,10)=="0123456789",Tt=_;else throw Error(s+S+" invalid: "+_)}else throw Error(s+"Object expected: "+v);return{DECIMAL_PLACES:z,ROUNDING_MODE:ue,EXPONENTIAL_AT:[ee,K],RANGE:[ne,ge],CRYPTO:Ce,MODULO_MODE:ye,POW_PRECISION:Me,FORMAT:We,ALPHABET:Tt}},g.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!g.DEBUG)return!0;var S,_,x=v.c,E=v.e,H=v.s;e:if({}.toString.call(x)=="[object Array]"){if((H===1||H===-1)&&E>=-1e9&&E<=f&&E===o(E)){if(x[0]===0){if(E===0&&x.length===1)return!0;break e}if(S=(E+1)%u,S<1&&(S+=u),String(x[0]).length==S){for(S=0;S<x.length;S++)if(_=x[S],_<0||_>=l||_!==o(_))break e;if(_!==0)return!0}}}else if(x===null&&E===null&&(H===null||H===1||H===-1))return!0;throw Error(s+"Invalid BigNumber: "+v)},g.maximum=g.max=function(){return C(arguments,-1)},g.minimum=g.min=function(){return C(arguments,1)},g.random=function(){var v=9007199254740992,S=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_){var x,E,H,F,A,$=0,B=[],W=new g(Z);if(_==null?_=z:b(_,0,f),F=i(_/u),Ce)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(F*=2));$<F;)A=x[$]*131072+(x[$+1]>>>11),A>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),x[$]=E[0],x[$+1]=E[1]):(B.push(A%1e14),$+=2);$=F/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(F*=7);$<F;)A=(x[$]&31)*281474976710656+x[$+1]*1099511627776+x[$+2]*4294967296+x[$+3]*16777216+(x[$+4]<<16)+(x[$+5]<<8)+x[$+6],A>=9e15?crypto.randomBytes(7).copy(x,$):(B.push(A%1e14),$+=7);$=F/7}else throw Ce=!1,Error(s+"crypto unavailable");if(!Ce)for(;$<F;)A=S(),A<9e15&&(B[$++]=A%1e14);for(F=B[--$],_%=u,F&&_&&(A=h[u-_],B[$]=o(F/A)*A);B[$]===0;B.pop(),$--);if($<0)B=[H=0];else{for(H=-1;B[0]===0;B.splice(0,1),H-=u);for($=1,A=B[0];A>=10;A/=10,$++);$<u&&(H-=u-$)}return W.e=H,W.c=B,W}}(),g.sum=function(){for(var v=1,S=arguments,_=new g(S[0]);v<S.length;)_=_.plus(S[v++]);return _},U=function(){var v="0123456789";function S(_,x,E,H){for(var F,A=[0],$,B=0,W=_.length;B<W;){for($=A.length;$--;A[$]*=x);for(A[0]+=H.indexOf(_.charAt(B++)),F=0;F<A.length;F++)A[F]>E-1&&(A[F+1]==null&&(A[F+1]=0),A[F+1]+=A[F]/E|0,A[F]%=E)}return A.reverse()}return function(_,x,E,H,F){var A,$,B,W,q,te,le,Pe,Xe=_.indexOf("."),nt=z,Ie=ue;for(Xe>=0&&(W=Me,Me=0,_=_.replace(".",""),Pe=new g(x),te=Pe.pow(_.length-Xe),Me=W,Pe.c=S(k(y(te.c),te.e,"0"),10,E,v),Pe.e=Pe.c.length),le=S(_,x,E,F?(A=Tt,v):(A=v,Tt)),B=W=le.length;le[--W]==0;le.pop());if(!le[0])return A.charAt(0);if(Xe<0?--B:(te.c=le,te.e=B,te.s=H,te=O(te,Pe,nt,Ie,E),le=te.c,q=te.r,B=te.e),$=B+nt+1,Xe=le[$],W=E/2,q=q||$<0||le[$+1]!=null,q=Ie<4?(Xe!=null||q)&&(Ie==0||Ie==(te.s<0?3:2)):Xe>W||Xe==W&&(Ie==4||q||Ie==6&&le[$-1]&1||Ie==(te.s<0?8:7)),$<1||!le[0])_=q?k(A.charAt(1),-nt,A.charAt(0)):A.charAt(0);else{if(le.length=$,q)for(--E;++le[--$]>E;)le[$]=0,$||(++B,le=[1].concat(le));for(W=le.length;!le[--W];);for(Xe=0,_="";Xe<=W;_+=A.charAt(le[Xe++]));_=k(_,B,A.charAt(0))}return _}}(),O=function(){function v(x,E,H){var F,A,$,B,W=0,q=x.length,te=E%d,le=E/d|0;for(x=x.slice();q--;)$=x[q]%d,B=x[q]/d|0,F=le*$+B*te,A=te*$+F%d*d+W,W=(A/H|0)+(F/d|0)+le*B,x[q]=A%H;return W&&(x=[W].concat(x)),x}function S(x,E,H,F){var A,$;if(H!=F)$=H>F?1:-1;else for(A=$=0;A<H;A++)if(x[A]!=E[A]){$=x[A]>E[A]?1:-1;break}return $}function _(x,E,H,F){for(var A=0;H--;)x[H]-=A,A=x[H]<E[H]?1:0,x[H]=A*F+x[H]-E[H];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,E,H,F,A){var $,B,W,q,te,le,Pe,Xe,nt,Ie,Ae,et,Nn,Dr,kr,_n,Lr,_t=x.s==E.s?1:-1,ot=x.c,ct=E.c;if(!ot||!ot[0]||!ct||!ct[0])return new g(!x.s||!E.s||(ot?ct&&ot[0]==ct[0]:!ct)?NaN:ot&&ot[0]==0||!ct?_t*0:_t/0);for(Xe=new g(_t),nt=Xe.c=[],B=x.e-E.e,_t=H+B+1,A||(A=l,B=p(x.e/u)-p(E.e/u),_t=_t/u|0),W=0;ct[W]==(ot[W]||0);W++);if(ct[W]>(ot[W]||0)&&B--,_t<0)nt.push(1),q=!0;else{for(Dr=ot.length,_n=ct.length,W=0,_t+=2,te=o(A/(ct[0]+1)),te>1&&(ct=v(ct,te,A),ot=v(ot,te,A),_n=ct.length,Dr=ot.length),Nn=_n,Ie=ot.slice(0,_n),Ae=Ie.length;Ae<_n;Ie[Ae++]=0);Lr=ct.slice(),Lr=[0].concat(Lr),kr=ct[0],ct[1]>=A/2&&kr++;do{if(te=0,$=S(ct,Ie,_n,Ae),$<0){if(et=Ie[0],_n!=Ae&&(et=et*A+(Ie[1]||0)),te=o(et/kr),te>1)for(te>=A&&(te=A-1),le=v(ct,te,A),Pe=le.length,Ae=Ie.length;S(le,Ie,Pe,Ae)==1;)te--,_(le,_n<Pe?Lr:ct,Pe,A),Pe=le.length,$=1;else te==0&&($=te=1),le=ct.slice(),Pe=le.length;if(Pe<Ae&&(le=[0].concat(le)),_(Ie,le,Ae,A),Ae=Ie.length,$==-1)for(;S(ct,Ie,_n,Ae)<1;)te++,_(Ie,_n<Ae?Lr:ct,Ae,A),Ae=Ie.length}else $===0&&(te++,Ie=[0]);nt[W++]=te,Ie[0]?Ie[Ae++]=ot[Nn]||0:(Ie=[ot[Nn]],Ae=1)}while((Nn++<Dr||Ie[0]!=null)&&_t--);q=Ie[0]!=null,nt[0]||nt.splice(0,1)}if(A==l){for(W=1,_t=nt[0];_t>=10;_t/=10,W++);D(Xe,H+(Xe.e=W+B*u-1)+1,F,q)}else Xe.e=B,Xe.r=+q;return Xe}}();function w(v,S,_,x){var E,H,F,A,$;if(_==null?_=ue:b(_,0,8),!v.c)return v.toString();if(E=v.c[0],F=v.e,S==null)$=y(v.c),$=x==1||x==2&&(F<=ee||F>=K)?R($,F):k($,F,"0");else if(v=D(new g(v),S,_),H=v.e,$=y(v.c),A=$.length,x==1||x==2&&(S<=H||H<=ee)){for(;A<S;$+="0",A++);$=R($,H)}else if(S-=F,$=k($,H,"0"),H+1>A){if(--S>0)for($+=".";S--;$+="0");}else if(S+=H-A,S>0)for(H+1==A&&($+=".");S--;$+="0");return v.s<0&&E?"-"+$:$}function C(v,S){for(var _,x,E=1,H=new g(v[0]);E<v.length;E++)x=new g(v[E]),(!x.s||(_=T(H,x))===S||_===0&&H.s===S)&&(H=x);return H}function L(v,S,_){for(var x=1,E=S.length;!S[--E];S.pop());for(E=S[0];E>=10;E/=10,x++);return(_=x+_*u-1)>ge?v.c=v.e=null:_<ne?v.c=[v.e=0]:(v.e=_,v.c=S),v}G=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,_=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(H,F,A,$){var B,W=A?F:F.replace(E,"");if(x.test(W))H.s=isNaN(W)?null:W<0?-1:1;else{if(!A&&(W=W.replace(v,function(q,te,le){return B=(le=le.toLowerCase())=="x"?16:le=="b"?2:8,!$||$==B?te:q}),$&&(B=$,W=W.replace(S,"$1").replace(_,"0.$1")),F!=W))return new g(W,B);if(g.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+F);H.s=null}H.c=H.e=null}}();function D(v,S,_,x){var E,H,F,A,$,B,W,q=v.c,te=h;if(q){e:{for(E=1,A=q[0];A>=10;A/=10,E++);if(H=S-E,H<0)H+=u,F=S,$=q[B=0],W=o($/te[E-F-1]%10);else if(B=i((H+1)/u),B>=q.length)if(x){for(;q.length<=B;q.push(0));$=W=0,E=1,H%=u,F=H-u+1}else break e;else{for($=A=q[B],E=1;A>=10;A/=10,E++);H%=u,F=H-u+E,W=F<0?0:o($/te[E-F-1]%10)}if(x=x||S<0||q[B+1]!=null||(F<0?$:$%te[E-F-1]),x=_<4?(W||x)&&(_==0||_==(v.s<0?3:2)):W>5||W==5&&(_==4||x||_==6&&(H>0?F>0?$/te[E-F]:0:q[B-1])%10&1||_==(v.s<0?8:7)),S<1||!q[0])return q.length=0,x?(S-=v.e+1,q[0]=te[(u-S%u)%u],v.e=-S||0):q[0]=v.e=0,v;if(H==0?(q.length=B,A=1,B--):(q.length=B+1,A=te[u-H],q[B]=F>0?o($/te[E-F]%te[F])*A:0),x)for(;;)if(B==0){for(H=1,F=q[0];F>=10;F/=10,H++);for(F=q[0]+=A,A=1;F>=10;F/=10,A++);H!=A&&(v.e++,q[0]==l&&(q[0]=1));break}else{if(q[B]+=A,q[B]!=l)break;q[B--]=0,A=1}for(H=q.length;q[--H]===0;q.pop());}v.e>ge?v.c=v.e=null:v.e<ne&&(v.c=[v.e=0])}return v}function j(v){var S,_=v.e;return _===null?v.toString():(S=y(v.c),S=_<=ee||_>=K?R(S,_):k(S,_,"0"),v.s<0?"-"+S:S)}return V.absoluteValue=V.abs=function(){var v=new g(this);return v.s<0&&(v.s=1),v},V.comparedTo=function(v,S){return T(this,new g(v,S))},V.decimalPlaces=V.dp=function(v,S){var _,x,E,H=this;if(v!=null)return b(v,0,f),S==null?S=ue:b(S,0,8),D(new g(H),v+H.e+1,S);if(!(_=H.c))return null;if(x=((E=_.length-1)-p(this.e/u))*u,E=_[E])for(;E%10==0;E/=10,x--);return x<0&&(x=0),x},V.dividedBy=V.div=function(v,S){return O(this,new g(v,S),z,ue)},V.dividedToIntegerBy=V.idiv=function(v,S){return O(this,new g(v,S),0,1)},V.exponentiatedBy=V.pow=function(v,S){var _,x,E,H,F,A,$,B,W,q=this;if(v=new g(v),v.c&&!v.isInteger())throw Error(s+"Exponent not an integer: "+j(v));if(S!=null&&(S=new g(S)),A=v.e>14,!q.c||!q.c[0]||q.c[0]==1&&!q.e&&q.c.length==1||!v.c||!v.c[0])return W=new g(Math.pow(+j(q),A?v.s*(2-M(v)):+j(v))),S?W.mod(S):W;if($=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new g(NaN);x=!$&&q.isInteger()&&S.isInteger(),x&&(q=q.mod(S))}else{if(v.e>9&&(q.e>0||q.e<-1||(q.e==0?q.c[0]>1||A&&q.c[1]>=24e7:q.c[0]<8e13||A&&q.c[0]<=9999975e7)))return H=q.s<0&&M(v)?-0:0,q.e>-1&&(H=1/H),new g($?1/H:H);Me&&(H=i(Me/u+2))}for(A?(_=new g(.5),$&&(v.s=1),B=M(v)):(E=Math.abs(+j(v)),B=E%2),W=new g(Z);;){if(B){if(W=W.times(q),!W.c)break;H?W.c.length>H&&(W.c.length=H):x&&(W=W.mod(S))}if(E){if(E=o(E/2),E===0)break;B=E%2}else if(v=v.times(_),D(v,v.e+1,1),v.e>14)B=M(v);else{if(E=+j(v),E===0)break;B=E%2}q=q.times(q),H?q.c&&q.c.length>H&&(q.c.length=H):x&&(q=q.mod(S))}return x?W:($&&(W=Z.div(W)),S?W.mod(S):H?D(W,Me,ue,F):W)},V.integerValue=function(v){var S=new g(this);return v==null?v=ue:b(v,0,8),D(S,S.e+1,v)},V.isEqualTo=V.eq=function(v,S){return T(this,new g(v,S))===0},V.isFinite=function(){return!!this.c},V.isGreaterThan=V.gt=function(v,S){return T(this,new g(v,S))>0},V.isGreaterThanOrEqualTo=V.gte=function(v,S){return(S=T(this,new g(v,S)))===1||S===0},V.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},V.isLessThan=V.lt=function(v,S){return T(this,new g(v,S))<0},V.isLessThanOrEqualTo=V.lte=function(v,S){return(S=T(this,new g(v,S)))===-1||S===0},V.isNaN=function(){return!this.s},V.isNegative=function(){return this.s<0},V.isPositive=function(){return this.s>0},V.isZero=function(){return!!this.c&&this.c[0]==0},V.minus=function(v,S){var _,x,E,H,F=this,A=F.s;if(v=new g(v,S),S=v.s,!A||!S)return new g(NaN);if(A!=S)return v.s=-S,F.plus(v);var $=F.e/u,B=v.e/u,W=F.c,q=v.c;if(!$||!B){if(!W||!q)return W?(v.s=-S,v):new g(q?F:NaN);if(!W[0]||!q[0])return q[0]?(v.s=-S,v):new g(W[0]?F:ue==3?-0:0)}if($=p($),B=p(B),W=W.slice(),A=$-B){for((H=A<0)?(A=-A,E=W):(B=$,E=q),E.reverse(),S=A;S--;E.push(0));E.reverse()}else for(x=(H=(A=W.length)<(S=q.length))?A:S,A=S=0;S<x;S++)if(W[S]!=q[S]){H=W[S]<q[S];break}if(H&&(E=W,W=q,q=E,v.s=-v.s),S=(x=q.length)-(_=W.length),S>0)for(;S--;W[_++]=0);for(S=l-1;x>A;){if(W[--x]<q[x]){for(_=x;_&&!W[--_];W[_]=S);--W[_],W[x]+=l}W[x]-=q[x]}for(;W[0]==0;W.splice(0,1),--B);return W[0]?L(v,W,B):(v.s=ue==3?-1:1,v.c=[v.e=0],v)},V.modulo=V.mod=function(v,S){var _,x,E=this;return v=new g(v,S),!E.c||!v.s||v.c&&!v.c[0]?new g(NaN):!v.c||E.c&&!E.c[0]?new g(E):(ye==9?(x=v.s,v.s=1,_=O(E,v,0,3),v.s=x,_.s*=x):_=O(E,v,0,ye),v=E.minus(_.times(v)),!v.c[0]&&ye==1&&(v.s=E.s),v)},V.multipliedBy=V.times=function(v,S){var _,x,E,H,F,A,$,B,W,q,te,le,Pe,Xe,nt,Ie=this,Ae=Ie.c,et=(v=new g(v,S)).c;if(!Ae||!et||!Ae[0]||!et[0])return!Ie.s||!v.s||Ae&&!Ae[0]&&!et||et&&!et[0]&&!Ae?v.c=v.e=v.s=null:(v.s*=Ie.s,!Ae||!et?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(x=p(Ie.e/u)+p(v.e/u),v.s*=Ie.s,$=Ae.length,q=et.length,$<q&&(Pe=Ae,Ae=et,et=Pe,E=$,$=q,q=E),E=$+q,Pe=[];E--;Pe.push(0));for(Xe=l,nt=d,E=q;--E>=0;){for(_=0,te=et[E]%nt,le=et[E]/nt|0,F=$,H=E+F;H>E;)B=Ae[--F]%nt,W=Ae[F]/nt|0,A=le*B+W*te,B=te*B+A%nt*nt+Pe[H]+_,_=(B/Xe|0)+(A/nt|0)+le*W,Pe[H--]=B%Xe;Pe[H]=_}return _?++x:Pe.splice(0,1),L(v,Pe,x)},V.negated=function(){var v=new g(this);return v.s=-v.s||null,v},V.plus=function(v,S){var _,x=this,E=x.s;if(v=new g(v,S),S=v.s,!E||!S)return new g(NaN);if(E!=S)return v.s=-S,x.minus(v);var H=x.e/u,F=v.e/u,A=x.c,$=v.c;if(!H||!F){if(!A||!$)return new g(E/0);if(!A[0]||!$[0])return $[0]?v:new g(A[0]?x:E*0)}if(H=p(H),F=p(F),A=A.slice(),E=H-F){for(E>0?(F=H,_=$):(E=-E,_=A),_.reverse();E--;_.push(0));_.reverse()}for(E=A.length,S=$.length,E-S<0&&(_=$,$=A,A=_,S=E),E=0;S;)E=(A[--S]=A[S]+$[S]+E)/l|0,A[S]=l===A[S]?0:A[S]%l;return E&&(A=[E].concat(A),++F),L(v,A,F)},V.precision=V.sd=function(v,S){var _,x,E,H=this;if(v!=null&&v!==!!v)return b(v,1,f),S==null?S=ue:b(S,0,8),D(new g(H),v,S);if(!(_=H.c))return null;if(E=_.length-1,x=E*u+1,E=_[E]){for(;E%10==0;E/=10,x--);for(E=_[0];E>=10;E/=10,x++);}return v&&H.e+1>x&&(x=H.e+1),x},V.shiftedBy=function(v){return b(v,-9007199254740991,c),this.times("1e"+v)},V.squareRoot=V.sqrt=function(){var v,S,_,x,E,H=this,F=H.c,A=H.s,$=H.e,B=z+4,W=new g("0.5");if(A!==1||!F||!F[0])return new g(!A||A<0&&(!F||F[0])?NaN:F?H:1/0);if(A=Math.sqrt(+j(H)),A==0||A==1/0?(S=y(F),(S.length+$)%2==0&&(S+="0"),A=Math.sqrt(+S),$=p(($+1)/2)-($<0||$%2),A==1/0?S="5e"+$:(S=A.toExponential(),S=S.slice(0,S.indexOf("e")+1)+$),_=new g(S)):_=new g(A+""),_.c[0]){for($=_.e,A=$+B,A<3&&(A=0);;)if(E=_,_=W.times(E.plus(O(H,E,B,1))),y(E.c).slice(0,A)===(S=y(_.c)).slice(0,A))if(_.e<$&&--A,S=S.slice(A-3,A+1),S=="9999"||!x&&S=="4999"){if(!x&&(D(E,E.e+z+2,0),E.times(E).eq(H))){_=E;break}B+=4,A+=4,x=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(D(_,_.e+z+2,1),v=!_.times(_).eq(H));break}}return D(_,_.e+z+1,ue,v)},V.toExponential=function(v,S){return v!=null&&(b(v,0,f),v++),w(this,v,S,1)},V.toFixed=function(v,S){return v!=null&&(b(v,0,f),v=v+this.e+1),w(this,v,S)},V.toFormat=function(v,S,_){var x,E=this;if(_==null)v!=null&&S&&typeof S=="object"?(_=S,S=null):v&&typeof v=="object"?(_=v,v=S=null):_=We;else if(typeof _!="object")throw Error(s+"Argument not an object: "+_);if(x=E.toFixed(v,S),E.c){var H,F=x.split("."),A=+_.groupSize,$=+_.secondaryGroupSize,B=_.groupSeparator||"",W=F[0],q=F[1],te=E.s<0,le=te?W.slice(1):W,Pe=le.length;if($&&(H=A,A=$,$=H,Pe-=H),A>0&&Pe>0){for(H=Pe%A||A,W=le.substr(0,H);H<Pe;H+=A)W+=B+le.substr(H,A);$>0&&(W+=B+le.slice(H)),te&&(W="-"+W)}x=q?W+(_.decimalSeparator||"")+(($=+_.fractionGroupSize)?q.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):q):W}return(_.prefix||"")+x+(_.suffix||"")},V.toFraction=function(v){var S,_,x,E,H,F,A,$,B,W,q,te,le=this,Pe=le.c;if(v!=null&&(A=new g(v),!A.isInteger()&&(A.c||A.s!==1)||A.lt(Z)))throw Error(s+"Argument "+(A.isInteger()?"out of range: ":"not an integer: ")+j(A));if(!Pe)return new g(le);for(S=new g(Z),B=_=new g(Z),x=$=new g(Z),te=y(Pe),H=S.e=te.length-le.e-1,S.c[0]=h[(F=H%u)<0?u+F:F],v=!v||A.comparedTo(S)>0?H>0?S:B:A,F=ge,ge=1/0,A=new g(te),$.c[0]=0;W=O(A,S,0,1),E=_.plus(W.times(x)),E.comparedTo(v)!=1;)_=x,x=E,B=$.plus(W.times(E=B)),$=E,S=A.minus(W.times(E=S)),A=E;return E=O(v.minus(_),x,0,1),$=$.plus(E.times(B)),_=_.plus(E.times(x)),$.s=B.s=le.s,H=H*2,q=O(B,x,H,ue).minus(le).abs().comparedTo(O($,_,H,ue).minus(le).abs())<1?[B,x]:[$,_],ge=F,q},V.toNumber=function(){return+j(this)},V.toPrecision=function(v,S){return v!=null&&b(v,1,f),w(this,v,S,2)},V.toString=function(v){var S,_=this,x=_.s,E=_.e;return E===null?x?(S="Infinity",x<0&&(S="-"+S)):S="NaN":(v==null?S=E<=ee||E>=K?R(y(_.c),E):k(y(_.c),E,"0"):v===10&&_e?(_=D(new g(_),z+E+1,ue),S=k(y(_.c),_.e,"0")):(b(v,2,Tt.length,"Base"),S=U(k(y(_.c),E,"0"),10,v,x,!0)),x<0&&_.c[0]&&(S="-"+S)),S},V.valueOf=V.toJSON=function(){return j(this)},V._isBigNumber=!0,P!=null&&g.set(P),g}function p(P){var O=P|0;return P>0||P===O?O:O-1}function y(P){for(var O,U,G=1,V=P.length,Z=P[0]+"";G<V;){for(O=P[G++]+"",U=u-O.length;U--;O="0"+O);Z+=O}for(V=Z.length;Z.charCodeAt(--V)===48;);return Z.slice(0,V+1||1)}function T(P,O){var U,G,V=P.c,Z=O.c,z=P.s,ue=O.s,ee=P.e,K=O.e;if(!z||!ue)return null;if(U=V&&!V[0],G=Z&&!Z[0],U||G)return U?G?0:-ue:z;if(z!=ue)return z;if(U=z<0,G=ee==K,!V||!Z)return G?0:!V^U?1:-1;if(!G)return ee>K^U?1:-1;for(ue=(ee=V.length)<(K=Z.length)?ee:K,z=0;z<ue;z++)if(V[z]!=Z[z])return V[z]>Z[z]^U?1:-1;return ee==K?0:ee>K^U?1:-1}function b(P,O,U,G){if(P<O||P>U||P!==o(P))throw Error(s+(G||"Argument")+(typeof P=="number"?P<O||P>U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function M(P){var O=P.c.length-1;return p(P.e/u)==O&&P.c[O]%2!=0}function R(P,O){return(P.length>1?P.charAt(0)+"."+P.slice(1):P)+(O<0?"e":"e+")+O}function k(P,O,U){var G,V;if(O<0){for(V=U+".";++O;V+=U);P=V+P}else if(G=P.length,++O>G){for(V=U,O-=G;--O;V+=U);P+=V}else O<G&&(P=P.slice(0,O)+"."+P.slice(O));return P}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(s5)})(kF);var LF=kF.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const qi=PM(),P5=_M(),I5=MM,O5=LF,kn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Zf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:$F,decimalSuffixes:Vp}=qi.currentBytes(),IM={general:{scale:1024,suffixes:Vp},binary:{scale:1024,suffixes:$F},decimal:{scale:1e3,suffixes:Vp}};function x5(t,e={},n){if(typeof e=="string"&&(e=I5.parseFormat(e)),!P5.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=A5(t,e,n);return s=Z5(s,i),s=Q5(s,o),s}function A5(t,e,n){switch(e.output){case"currency":return e=wc(e,qi.currentCurrencyDefaultFormat()),V5(t,e,qi);case"percent":return e=wc(e,qi.currentPercentageDefaultFormat()),F5(t,e,qi,n);case"byte":return e=wc(e,qi.currentByteDefaultFormat()),k5(t,e,qi,n);case"time":return e=wc(e,qi.currentTimeDefaultFormat()),$5(t);case"ordinal":return e=wc(e,qi.currentOrdinalDefaultFormat()),L5(t,e,qi);case"number":default:return Qf({instance:t,providedFormat:e})}}function H5(t){let e=IM.decimal;return sv(t._value,e.suffixes,e.scale).suffix}function N5(t){let e=IM.binary;return sv(t._value,e.suffixes,e.scale).suffix}function D5(t){let e=IM.general;return sv(t._value,e.suffixes,e.scale).suffix}function sv(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function k5(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Zf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Vp,marker:"bd"},binary:{scale:1024,suffixes:s||$F,marker:"b"},decimal:{scale:1e3,suffixes:a||Vp,marker:"d"}}[i],{value:c,suffix:h}=sv(t._value,u.suffixes,u.scale);return`${Qf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function L5(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Zf,e),o=Qf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function $5(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function F5(t,e,n,r){let i=e.prefixSymbol,o=Qf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Zf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function V5(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Zf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Qf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function W5({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&kn[e]?(a=r[e],t=t/kn[e]):l>=kn.trillion||n&&s(l/kn.trillion)===1?(a=r.trillion,t=t/kn.trillion):l<kn.trillion&&l>=kn.billion||n&&s(l/kn.billion)===1?(a=r.billion,t=t/kn.billion):l<kn.billion&&l>=kn.million||n&&s(l/kn.million)===1?(a=r.million,t=t/kn.million):(l<kn.million&&l>=kn.thousand||n&&s(l/kn.thousand)===1)&&(a=r.thousand,t=t/kn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function B5({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function jg(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function j5(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+jg(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(jg(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=jg(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${jg(e)}`),n}function U5(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?j5(t,e):new O5(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function z5(t,e,n,r,i,o){if(r===-1)return t;let s=U5(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function Y5(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function G5(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function q5(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),G5(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function K5(t,e){return t+e}function X5(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Z5(t,e){return e+t}function Q5(t,e){return t+e}function Qf({instance:t,providedFormat:e,state:n=qi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Zf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,p=s.trimMantissa,y=s.thousandSeparated,T=s.spaceSeparated,b=s.negative,M=s.forceSign,R=s.exponential,k=s.roundingFunction,P="";if(d){let U=W5({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:T,roundingFunction:k,totalLength:a});o=U.value,P+=U.abbreviation,a&&(f=U.mantissaPrecision)}if(R){let U=B5({value:o,characteristicPrecision:l});o=U.value,P=U.abbreviation+P}let O=z5(o.toString(),o,m,f,p,k);return O=Y5(O,o,u,l),O=q5(O,o,y,n,r),(d||R)&&(O=K5(O,P)),(M||o<0)&&(O=X5(O,o,b)),O}function wc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var J5=t=>({format:(...e)=>x5(...e,t),getByteUnit:(...e)=>D5(...e,t),getBinaryByteUnit:(...e)=>N5(...e,t),getDecimalByteUnit:(...e)=>H5(...e,t),formatOrDefault:wc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const $s=LF;function eZ(t,e,n){let r=new $s(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new $s(i),t._value=r.plus(i).toNumber(),t}function FF(t,e,n){let r=new $s(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new $s(i),t._value=r.minus(i).toNumber(),t}function tZ(t,e,n){let r=new $s(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new $s(i),t._value=r.times(i).toNumber(),t}function nZ(t,e,n){let r=new $s(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new $s(i),t._value=r.dividedBy(i).toNumber(),t}function rZ(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function iZ(t,e,n){let r=n(t._value);return FF(r,e,n),Math.abs(r._value)}var oZ=t=>({add:(e,n)=>eZ(e,n,t),subtract:(e,n)=>FF(e,n,t),multiply:(e,n)=>tZ(e,n,t),divide:(e,n)=>nZ(e,n,t),set:(e,n)=>rZ(e,n,t),difference:(e,n)=>iZ(e,n,t),BigNumber:$s});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const sZ="2.5.0",ts=PM(),aZ=_M(),lZ=M5(Zt),uZ=DF();let ul=J5(Zt),Wl=oZ(Zt);const cZ=MM;class VF{constructor(e){this._value=e}clone(){return Zt(this._value)}format(e={}){return ul.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=cZ.parseFormat(e)),e=ul.formatOrDefault(e,ts.currentCurrencyDefaultFormat()),e.output="currency",ul.format(this,e)}formatTime(e={}){return e.output="time",ul.format(this,e)}binaryByteUnits(){return ul.getBinaryByteUnit(this)}decimalByteUnits(){return ul.getDecimalByteUnit(this)}byteUnits(){return ul.getByteUnit(this)}difference(e){return Wl.difference(this,e)}add(e){return Wl.add(this,e)}subtract(e){return Wl.subtract(this,e)}multiply(e){return Wl.multiply(this,e)}divide(e){return Wl.divide(this,e)}set(e){return Wl.set(this,WF(e))}value(){return this._value}valueOf(){return this._value}}function WF(t){let e=t;return Zt.isNumbro(t)?e=t._value:typeof t=="string"?e=Zt.unformat(t):isNaN(t)&&(e=NaN),e}function Zt(t){return new VF(WF(t))}Zt.version=sZ;Zt.isNumbro=function(t){return t instanceof VF};Zt.language=ts.currentLanguage;Zt.registerLanguage=ts.registerLanguage;Zt.setLanguage=ts.setLanguage;Zt.languages=ts.languages;Zt.languageData=ts.languageData;Zt.zeroFormat=ts.setZeroFormat;Zt.defaultFormat=ts.currentDefaults;Zt.setDefaults=ts.setDefaults;Zt.defaultCurrencyFormat=ts.currentCurrencyDefaultFormat;Zt.validate=aZ.validate;Zt.loadLanguagesInNode=lZ.loadLanguagesInNode;Zt.unformat=uZ.unformat;Zt.BigNumber=Wl.BigNumber;var hZ=Zt,cl=a5(hZ);const dZ="numeric";function BF(t,e){if(qn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!cl.languages()[r]){const o=r.replace("-",""),s=cl.allLanguages?cl.allLanguages[r]:cl[o];s&&cl.registerLanguage(s)}cl.setLanguage(r),t=cl(t).format(i||"0")}return t}function OM(t,e,n,r,i,o,s){let a=o;if(qn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=BF(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}zs(t,e,n,r,i,a,s)}OM.RENDERER_TYPE=dZ;const fZ="password";function xM(t,e,n,r,i,o,s){zs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Ka(e,u)}xM.RENDERER_TYPE=fZ;const gZ="select";function AM(t,e,n,r,i,o,s){zs.apply(this,[t,e,n,r,i,o,s])}AM.RENDERER_TYPE=gZ;const mZ="time";function HM(t,e,n,r,i,o,s){zs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}HM.RENDERER_TYPE=mZ;function pZ(){qr(wh),qr(Xf),qr(RM),qr(bM),qr(TM),qr(SM),qr(OM),qr(xM),qr(AM),qr(zs),qr(HM)}const wZ="autocomplete";function av(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,N1(n,e)):N1(n,e)(this.source):e(!0)}av.VALIDATOR_TYPE=wZ;function N1(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(Wf(n,r[o])){i=!0;break}e(i)}}function jF(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const vZ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:jF},Symbol.toStringTag,{value:"Module"})),CZ="date";function NM(t,e){const n=g$(MF,this.instance);let r=t,i=!0;r==null&&(r="");let o=X(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=yZ(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}NM.VALIDATOR_TYPE=CZ;function yZ(t,e){const n=X(jF(t)),r=X(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const SZ="dropdown";function DM(t,e){av.apply(this,[t,e])}DM.VALIDATOR_TYPE=SZ;const bZ="numeric";function kM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:qn(t))}kM.VALIDATOR_TYPE=bZ;const RZ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],EZ="time";function LM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=X(i,RZ,!0).isValid()?X(i):X(i,n);let a=s.isValid(),l=X(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}LM.VALIDATOR_TYPE=EZ;function TZ(){Yl(av),Yl(DM),Yl(NM),Yl(kM),Yl(LM)}function UF(t){return Te(t)&&t.value!==void 0?t.value:t}function zF(t,e,n){const r=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),i=o=>Te(o)&&ae(o.key)&&ae(o.value);return i(r)?i(t)?t:{key:t,value:t}:t}const _Z="autocomplete",MZ={CELL_TYPE:_Z,editor:CM,renderer:wh,validator:av,valueGetter:UF,valueSetter:zF};function PZ(t,e,n){const{checkedTemplate:r,uncheckedTemplate:i}=this.getCellMeta(e,n),o=Rt(t),s=o===Rt(r),a=o===Rt(i);return s||a?s?r:i:t}const IZ="checkbox",OZ={CELL_TYPE:IZ,editor:_F,renderer:RM,valueSetter:PZ},xZ="date";function YF(t,e,n,r,i,o,s){wh.apply(this,[t,e,n,r,i,o,s])}YF.RENDERER_TYPE=xZ;const AZ="date",HZ={CELL_TYPE:AZ,editor:PF,renderer:YF,validator:NM};function NZ(t){return UF.call(this,t)}function DZ(t,e,n,r){return zF.call(this,t,e,n,r)}const kZ="dropdown",LZ={CELL_TYPE:kZ,editor:IF,renderer:bM,validator:DM,filter:!1,strict:!0,valueGetter:NZ,valueSetter:DZ},$Z="handsontable",FZ={CELL_TYPE:$Z,editor:vM,renderer:TM};function VZ(t){if(typeof t=="string"&&w$(t)){const e=v$(t);return Pd(e)?t:e}return t}const WZ="numeric",BZ={CELL_TYPE:WZ,editor:OF,renderer:OM,validator:kM,dataType:"number",valueSetter:VZ},jZ="password",UZ={CELL_TYPE:jZ,editor:xF,renderer:xM,copyable:!1},zZ="select",YZ={CELL_TYPE:zZ,editor:AF,renderer:AM},GZ="time",qZ={CELL_TYPE:GZ,editor:HF,renderer:HM,validator:LM};function KZ(){fi(MZ),fi(OZ),fi(HZ),fi(LZ),fi(FZ),fi(BZ),fi(UZ),fi(YZ),fi(bF),fi(qZ)}function XZ(t,e){GF(t,e),e.add(t)}function Fu(t,e,n){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D1(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ug(t,e,n){return t.set($M(t,e),n),n}function Yt(t,e){return t.get($M(t,e))}function $M(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const k1=new Map([["plugin",gK],["cell-type",cF],["editor",f$],["renderer",S$],["validator",b$]]),qF=Symbol("mainSetting"),JZ="base",zg=[];let hl=null;var Jt=new WeakMap,dl=new WeakMap,L1=new WeakSet;class Ke{static get PLUGIN_KEY(){return JZ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){XZ(this,L1),D1(this,Jt,null),Fu(this,"eventManager",new Pi(this)),Fu(this,"pluginName",null),Fu(this,"pluginsInitializedCallbacks",[]),Fu(this,"isPluginsReady",!1),Fu(this,"enabled",!1),Fu(this,"initialized",!1),D1(this,dl,{}),Jo(this,"hot",e,{writable:!1}),hl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!k1.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);k1.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");zg.push(o)}}if(hl||(hl=lT()),hl.indexOf(this.pluginName)>=0&&hl.splice(hl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),hl.length===0){if(zg.length>0){const i=[`${zg.join(`
`)}
`,"You have to import and register them manually."].join("");throw zg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return Te(Yt(Jt,this))?Ld(Yt(Jt,this),n):Yt(Jt,this);if((Array.isArray(Yt(Jt,this))||Te(Yt(Jt,this)))&&n[qF]===e){var r;return Array.isArray(Yt(Jt,this))?Yt(Jt,this):(r=Yt(Jt,this)[e])!==null&&r!==void 0?r:n[e]}if(e.includes(".")){const i=Ep(Yt(Jt,this),e),o=Ep(n,e);return Te(i)?Ld(i,o):i!==void 0?i:o}return Te(Yt(Jt,this))?Ld(Yt(Jt,this),n)[e]:n[e]}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){qe(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Ug(Jt,this,e),Yt(Jt,this)}return n&&typeof n=="object"&&typeof e=="object"?((Yt(Jt,this)===null||typeof Yt(Jt,this)!="object")&&Ug(Jt,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(r=>{if(!(r in e))return;const i=n[r];if((i?i(e[r]):!0)===!1){qe(`${this.pluginName} Plugin: "${r}" option is not valid and it will be ignored.`);return}Yt(Jt,this)[r]=e[r]}),Yt(Jt,this)):(Ug(Jt,this,e),e)}addHook(e,n,r){Yt(dl,this)[e]=Yt(dl,this)[e]||[];const i=Yt(dl,this)[e];this.hot.addHook(e,n,r),i.push(n),Yt(dl,this)[e]=i}removeHooks(e){I(Yt(dl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Yt(dl,this);Ve(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){I(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=$M(L1,this,eQ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Ug(Jt,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ve(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function eQ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function fl(t,e,n){return(e=tQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tQ(t){var e=nQ(t,"string");return typeof e=="symbol"?e:e+""}function nQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let FM=class{constructor(e){fl(this,"hot",null),fl(this,"container",null),fl(this,"injected",!1),fl(this,"rows",[]),fl(this,"columns",[]),fl(this,"samples",null),fl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Y(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),I(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),I(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{I(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{I(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{I(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),I(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{I(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Y(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Y(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function qh(t,e,n){return(e=rQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lv{static get SAMPLE_COUNT(){return 3}constructor(e){qh(this,"samples",null),qh(this,"dataFactory",null),qh(this,"customSampleCount",null),qh(this,"allowDuplicates",!1),qh(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:lv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return me(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a,this):this.dataFactory(a,r,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Te(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Rt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function oQ(t,e){KF(t,e),e.add(t)}function hb(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kh(t,e,n){return(e=sQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aa(t,e){return t.get(Pr(t,e))}function Wp(t,e,n){return t.set(Pr(t,e),n),n}function Pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutoColumnSizeSeed");const db="autoColumnSize",lQ=10,uQ="autoColumnSize";var VM=new WeakMap,vc=new WeakMap,eh=new WeakMap,Kr=new WeakSet;class jd extends Ke{static get PLUGIN_KEY(){return db}static get PLUGIN_PRIORITY(){return lQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),oQ(this,Kr),Kh(this,"ghostTable",new FM(this.hot)),Kh(this,"samplesGenerator",new lv((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Kh(this,"inProgress",!1),Kh(this,"measuredColumns",0),Kh(this,"columnWidthsMap",new Xa),hb(this,VM,!1),hb(this,vc,[]),hb(this,eh,[]),this.hot.columnIndexMapper.registerMap(uQ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Pr(Kr,this,$1).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[db]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pr(Kr,e,dQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pr(Kr,e,fQ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pr(Kr,e,mQ).call(e,...i)}),this.addHook("beforeRender",()=>Pr(Kr,this,hQ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>Pr(Kr,this,gQ).call(this)),super.enablePlugin()}updatePlugin(){Wp(eh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Pr(Kr,this,$1).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Pr(Kr,this,XF).call(this,s,o)}),this.ghostTable.columns.length&&(Pr(Kr,this,ZF).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){hf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+jd.CALCULATION_STEP,i)},e,n),r=r+jd.CALCULATION_STEP+1,r<i?o=cf(s):(hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[db];let n=jd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Te(e)&&(n=e.syncLimit,F0(n)?n=sT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Kc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Aa(vc,this).length;return(s-1<o||Aa(vc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Aa(vc,this).push(i):Aa(vc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function cQ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||Pr(Kr,this,XF).call(this,n,e))}),this.ghostTable.columns.length&&(Pr(Kr,this,ZF).call(this),this.ghostTable.clean())}function XF(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function ZF(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function hQ(){this.calculateVisibleColumnsWidth(),this.inProgress||(Pr(Kr,this,cQ).call(this,Aa(eh,this)),Wp(eh,this,[]))}function dQ(t,e){e||this.recalculateAllColumnsWidth()}function fQ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Aa(eh,this).push(...e)}function $1(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function gQ(){Wp(vc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Wp(VM,this,!0)}function mQ(t){if(!Aa(VM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Aa(eh,this).push(...e)}const Ql={horizontal:"horizontal",vertical:"vertical"};function pQ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function wQ(t){const e={};return t===!0?(e.directions=Object.keys(Ql),e.autoInsertRow=!0):Te(t)?(ae(t.autoInsertRow)?t.direction===Ql.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ae(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ql)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function vQ(t,e){CQ(t,e),e.add(t)}function CQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,e,n){return(e=yQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yQ(t){var e=SQ(t,"string");return typeof e=="symbol"?e:e+""}function SQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("modifyAutofillRange");oe.getSingleton().register("beforeAutofill");oe.getSingleton().register("afterAutofill");const F1="autofill",bQ=20,RQ=["fillHandle"],EQ="insert_row_below",TQ=200;var gl=new WeakSet;class _Q extends Ke{constructor(){super(...arguments),vQ(this,gl),Vu(this,"addingStarted",!1),Vu(this,"mouseDownOnCellCorner",!1),Vu(this,"mouseDragOutside",!1),Vu(this,"handleDraggedCells",0),Vu(this,"directions",[]),Vu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return F1}static get PLUGIN_PRIORITY(){return bQ}static get SETTING_KEYS(){return[F1,...RQ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Wu(gl,this,IQ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Wu(gl,this,PQ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Wu(gl,this,OQ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:r,col:i}=n.getTopStartCorner(),{row:o,col:s}=n.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:o,endCol:s}]),l=[],u=[],c=[];return I(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)u.indexOf(d)===-1&&u.push(d)}),I(l,h=>{const d=[];I(u,f=>{const m=e?this.hot.getSourceDataAtCell(h,f):null;e&&Te(m)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=pQ(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=this.getSelectionData(!0),p=o.clone(),y=this.hot._createCellRange(h,h,d),T=this.hot.runHooks("beforeAutofill",f,p,y,c);if(T===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=T;const M=T;if(["up","left"].indexOf(c)>-1&&!(M.length===1&&M[0].length===0))if(b=[],c==="up"){const R=d.row-h.row+1,k=R%M.length;for(let P=0;P<R;P++)b.push(M[(P+(M.length-k))%M.length])}else{const R=d.col-h.col+1,k=R%M[0].length;for(let P=0;P<M.length;P++){b.push([]);for(let O=0;O<R;O++)b[P].push(M[P][(O+(M[P].length-k))%M[P].length])}}if(m.some(R=>R.some(k=>Te(k)))){const R=Wu(gl,this,MQ).call(this,b,m,h,d,c);R.length&&(b=R)}this.hot.populateFromArray(h.row,h.col,b,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,p,y,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ql.vertical)&&this.directions.includes(Ql.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ql.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ql.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(EQ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},TQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Ut(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Ut(s)||!Ut(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Je(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=$n(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+nn(this.hot.table),i=$n(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Xt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Wu(gl,this,xQ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Wu(gl,this,AQ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=wQ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function MQ(t,e,n,r){const i=[];for(let o=Math.min(n.row,r.row);o<=Math.max(n.row,r.row);o+=1){i.push([]);for(let s=Math.min(n.col,r.col);s<=Math.max(n.col,r.col);s+=1){const a=this.hot.getSourceDataAtCell(o,s),l=o-Math.min(n.row,r.row),u=s-Math.min(n.col,r.col),c=l%e.length,h=u%e[0].length;Te(a)?i[l][u]=e[c][h]:i[l][u]=t[c][h]}}return i}function PQ(){this.selectAdjacent()&&this.fillIn()}function IQ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function OQ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function xQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function AQ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function HQ(t,e){QF(t,e),e.add(t)}function V1(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bu(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JF(t,e,n){return t.set(Qr(t,e),n),n}function Bp(t,e){return t.get(Qr(t,e))}function Qr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fb="autoRowSize",kQ=40,LQ="autoRowSize",W1="htFirstDatasetColumnNotRendered";var wf=new WeakMap,WM=new WeakMap,gi=new WeakSet;class Ud extends Ke{static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return kQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),HQ(this,gi),Bu(this,"headerHeight",null),Bu(this,"ghostTable",new FM(this.hot)),Bu(this,"samplesGenerator",new lv((n,r)=>{const i=this.hot.toPhysicalColumn(r);if(this.hot.columnIndexMapper.isHidden(i)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,r):n===-1&&(o=this.hot.getColHeader(r)),{value:o}})),Bu(this,"inProgress",!1),Bu(this,"measuredRows",0),Bu(this,"rowHeightsMap",new Xa),V1(this,wf,[]),V1(this,WM,!1),this.hot.rowIndexMapper.registerMap(LQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Qr(gi,this,B1).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[fb];return e===!0||Te(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qr(gi,e,WQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qr(gi,e,BQ).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qr(gi,e,UQ).call(e,...i)}),this.addHook("beforeViewRender",()=>Qr(gi,this,FQ).call(this)),this.addHook("beforeRender",()=>Qr(gi,this,VQ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Qr(gi,this,jQ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),Qr(gi,this,eV).call(this,!1),this.addHook("beforeRowResize",(e,n,r)=>Qr(gi,this,B1).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){hf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Ud.CALCULATION_STEP,i)},e,n),r=r+Ud.CALCULATION_STEP+1,r<i?o=cf(s):(hf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[fb];let n=Ud.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Te(e)&&(n=e.syncLimit,F0(n)?n=sT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight();if(e<0){var r;return(r=this.headerHeight)!==null&&r!==void 0?r:n}const i=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(i))return n;const o=this.rowHeightsMap.getValueAtIndex(i);let s=n;return o!==null&&o>n&&(s=o),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function $Q(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function eV(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?ce(this.hot.rootElement,W1):Y(this.hot.rootElement,W1)}function FQ(){Qr(gi,this,eV).call(this)}function VQ(){this.calculateVisibleRowsHeight(),this.inProgress||(Qr(gi,this,$Q).call(this,Bp(wf,this)),JF(wf,this,[]))}function B1(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function WQ(t,e){e||this.recalculateAllRowsHeight()}function BQ(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Bp(wf,this).push(...e)}function jQ(){this.recalculateAllRowsHeight(),JF(WM,this,!0)}function UQ(t){if(!Bp(WM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Bp(wf,this).push(...e)}const{getListWithInsertedItems:zQ,getListWithRemovedItems:YQ}=U$("physicallyIndexed");class GQ extends Ru{constructor(){super(e=>e)}insert(e,n){const r=AT(this.indexedValues,n);this.indexedValues=zQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=YQ(this.indexedValues,e);this.indexedValues=xT(n,e),super.remove(e)}}const{getListWithInsertedItems:qQ,getListWithRemovedItems:KQ}=U$("physicallyIndexed");class XQ extends Ru{constructor(){super(e=>e)}insert(e,n){this.indexedValues=qQ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=KQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function ZQ(t,e){QQ(t,e),e.add(t)}function QQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JQ(t,e,n){return(e=eJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eJ(t){var e=tJ(t,"string");return typeof e=="symbol"?e:e+""}function tJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nJ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const j1="bindRowsWithHeaders",rJ=210,iJ="loose",U1=new Map([["loose",GQ],["strict",XQ]]);var z1=new WeakSet;class oJ extends Ke{constructor(){super(...arguments),ZQ(this,z1),JQ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return j1}static get PLUGIN_PRIORITY(){return rJ}isEnabled(){return!!this.hot.getSettings()[j1]}enablePlugin(){var e;if(this.enabled)return;const n=(e=U1.get(this.getSetting()))!==null&&e!==void 0?e:U1.get(iJ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>nJ(z1,this,sJ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function sJ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function aJ(t,e){tV(t,e),e.add(t)}function lJ(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y1(t,e,n){return(e=uJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uJ(t){var e=cJ(t,"string");return typeof e=="symbol"?e:e+""}function cJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G1(t,e){return t.get(Pc(t,e))}function gb(t,e,n){return t.set(Pc(t,e),n),n}function Pc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tp="collapsibleColumns",hJ=290,dJ=["nestedHeaders"],jc="collapsibleIndicator",q1=tp,K1=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ju=new WeakMap,Xh=new WeakSet;class fJ extends Ke{constructor(){super(...arguments),aJ(this,Xh),Y1(this,"nestedHeadersPlugin",null),Y1(this,"headerStateManager",null),lJ(this,ju,null)}static get PLUGIN_KEY(){return tp}static get PLUGIN_PRIORITY(){return hJ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[tp,...dJ]}isEnabled(){return!!this.hot.getSettings()[tp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||qe("You need to configure the Nested Headers plugin in order to use collapsible headers."),gb(ju,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Pc(Xh,this,pJ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pc(Xh,e,wJ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Pc(Xh,e,gJ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Pc(Xh,this,mJ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),gb(ju,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeActive().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:q1,relativeToGroup:Za,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(q1)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${jc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${jc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${jc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!K1.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Va(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;I(r,f=>{var m;let{row:p,col:y}=f;const{collapsible:T,isCollapsed:b}=(m=this.headerStateManager.getHeaderSettings(p,y))!==null&&m!==void 0?m:{};if(!T||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&I(r,f=>{let{row:m,col:p}=f;const{colspanCompensation:y,affectedColumns:T,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,m,p);y>0&&(s.push(...T),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=EL([...a,...s]):n==="expand"&&(l=Va(a,f=>!s.includes(f)));const u=K1.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){I(o,f=>{f()});return}this.hot.batchExecution(()=>{I(s,f=>{G1(ju,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,T=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;y!==null&&T!==null&&this.hot.selectCell(y,T)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return G1(ju,this).getHiddenIndexes()}destroy(){gb(ju,this,null),super.destroy()}}function gJ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${jc}`);if(Uo(e,[_i("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Y(u,jc),e.querySelector("div:first-child").appendChild(u)),ce(u,["collapsed","expanded"]),s?(Y(u,"collapsed"),Ba(u,"+"),l&&fe(e,..._i(!1))):(Y(u,"expanded"),Ba(u,"-"),l&&fe(e,..._i(!0))),l&&fe(u,...bu());else{var c;(c=u)===null||c===void 0||c.remove()}}function mJ(t,e){be(t.target,jc)&&(be(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):be(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ni(t))}function pJ(){this.updatePlugin()}function wJ(t,e){e||this.updatePlugin()}function ml(t,e,n){return(e=vJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t){var e=CJ(t,"string");return typeof e=="symbol"?e:e+""}function CJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yJ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SJ=!1,bJ=!0,RJ=!0;class EJ{constructor(e,n){ml(this,"hot",void 0),ml(this,"sortingStates",new Jw),ml(this,"sortEmptyCells",SJ),ml(this,"indicator",bJ),ml(this,"headerAction",RJ),ml(this,"compareFunctionFactory",void 0),ml(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Te(e)&&Ve(e,(n,r)=>{yJ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Te(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ae(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function nV(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Yo:Ut(i)?Ut(o)?Yo:s&&t==="asc"?Wt:Bt:Ut(o)?s&&t==="asc"?Bt:Wt:isNaN(i)&&!isNaN(o)?t==="asc"?Bt:Wt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Wt:Bt:i>o?t==="asc"?Bt:Wt:Yo}}const rV="default";function TJ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Yo;if(a){if(Ut(r))return t==="asc"?Wt:Bt;if(Ut(i))return t==="asc"?Bt:Wt}return isNaN(o)?Bt:isNaN(s)?Wt:o<s?t==="asc"?Wt:Bt:o>s?t==="asc"?Bt:Wt:Yo}}const _J="numeric";function MJ(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Ut(s),u=Ut(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Bt;if(l===!1&&u)return Wt}return d===!1&&f?t==="asc"?Wt:Bt:d&&f===!1?t==="asc"?Bt:Wt:d===!1&&f===!1?nV(t,e,n)(s,a):c===i&&h===r?t==="asc"?Wt:Bt:c===r&&h===i?t==="asc"?Bt:Wt:Yo}}const PJ="checkbox";function IJ(t,e,n){return uV(t,e.dateFormat,n)}const OJ="date";function xJ(t,e,n){return uV(t,e.timeFormat,n)}const AJ="time",{register:Jf,getItem:X1,hasItem:HJ}=Di("sorting.compareFunctionFactory"),{register:iV,getItem:NJ}=Di("sorting.mainSortComparator");function oV(t){return HJ(t)?X1(t):X1(rV)}Jf(PJ,MJ);Jf(OJ,IJ);Jf(rV,nV);Jf(_J,TJ);Jf(AJ,xJ);const Yo=0,Wt=-1,Bt=1;function DJ(t,e){const n=NJ(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const jp="asc",Up="desc",sV="colHeader";function kJ(t){if(Te(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[jp,Up].includes(n)}function LJ(t){if(t.some(n=>kJ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function Z1(t){if(t!==Up)return t===jp?Up:jp}function aV(t){return t.querySelector(`.${sV}`)}function lV(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function BM(t,e,n){return t===-1&&e>=0&&ja(n)===!1}function uV(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Yo;if(Ut(r))return Ut(i)?Yo:o&&t==="asc"?Wt:Bt;if(Ut(i))return o&&t==="asc"?Bt:Wt;const s=X(r,e),a=X(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Wt:Bt:a.isBefore(s)?t==="asc"?Bt:Wt:Yo:Wt:Bt}}function $J(t,e){qe(it`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const FJ="ascending",VJ="descending",cV="indicatorDisabled",hV="columnSorting",dV="sortAction",fV=new Map([[jp,FJ],[Up,VJ]]);function WJ(t,e,n,r){const i=[hV];if(r&&i.push(dV),n===!1)return i.push(cV),i;const o=t.getSortOrderOfColumn(e);return ae(o)&&i.push(fV.get(o)),i}function BJ(){return Array.from(fV.values()).concat(dV,cV,hV)}function jJ(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:oV(u.type))(l,u,d)(c,h)}(0)}}function UJ(t,e){zJ(t,e),e.add(t)}function zJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yg(t,e,n){return(e=YJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=GJ(t,"string");return typeof e=="symbol"?e:e+""}function GJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zp="columnSorting",qJ=50,Yp="append",KJ="replace",Q1=zp;iV(zp,jJ);oe.getSingleton().register("beforeColumnSort");oe.getSingleton().register("afterColumnSort");const Zh=new WeakMap;var Bl=new WeakSet;class gV extends Ke{constructor(){super(...arguments),UJ(this,Bl),Yg(this,"columnStatesManager",null),Yg(this,"columnMetaCache",null),Yg(this,"pluginKey",zp),Yg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return qJ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Zh.has(this.hot)&&Zh.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),$J(Zh.get(this.hot),this.pluginKey);return}this.enabled||(Zh.set(this.hot,this.pluginKey),this.columnStatesManager=new EJ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Xa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Cc(Bl,this,XJ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cc(Bl,e,QJ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Cc(Bl,this,PE).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cc(Bl,e,ZJ).call(e,...r)}),this.hot.view&&Cc(Bl,this,PE).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=aV(r);lV(n,r)===!1||i===null||this.updateHeaderClasses(i)};Zh.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Za,position:"before",group:Q1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Q1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new z$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ae(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return LJ(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Je(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ae(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Je(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ae(n)){const i=Z1(n);return ae(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:Z1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yp;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(It(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Yp)return[...o.slice(0,r),...o.slice(r+1),s];if(n===KJ)return[...o.slice(0,r),s,...o.slice(r+1)]}return ae(s)?o.concat(s):o}getPluginColumnConfig(e){if(Te(e)){const n=e[this.pluginKey];if(Te(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):rt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Je(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Je(n,u=>u[0]);DJ(n,this.pluginKey,Je(e,u=>u.sortOrder),Je(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Je(n,u=>u[0]),a=new Map(Je(o,(u,c)=>[u,s[c]])),l=Je(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Te(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Te(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ce(e,BJ()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Y(e,WJ(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ae(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&be(e.target,sV)}onAfterOnCellMouseDown(e,n){if(BM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function PE(){const t=this.getAllSavedSortSettings();if(Te(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function XJ(t,e){const n=aV(e);if(lV(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);fe(e,...F2(s?`${s}ending`:"none"))}}function ZJ(t){t===!0&&this.hot.view&&Cc(Bl,this,PE).call(this)}function QJ(t,e,n,r){BM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function mb(t){return t==null||isNaN(t)}function JJ(t,e){if(typeof t!="number")return t;const n=r=>r.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const r=Math.round(t).toString().length;return n(t.toFixed(8-r))}return t;default:return t}}function pl(t,e,n){return(e=eee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eee(t){var e=tee(t,"string");return typeof e=="symbol"?e:e+""}function tee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nee{constructor(e,n){pl(this,"plugin",void 0),pl(this,"hot",void 0),pl(this,"endpoints",[]),pl(this,"settings",void 0),pl(this,"settingsType","array"),pl(this,"currentEndpoint",null),pl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),I(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();I(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;I(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?I(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):I(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){I(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];I(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),I(i,o=>{let s=[];I(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,I(e.ranges,r=>{I(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],I(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],I(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],I(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&I(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),I(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.result=JJ(e.result,e.roundFloat),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){qe("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function ree(t,e){iee(t,e),e.add(t)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oee(t,e,n){return(e=see(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:e+""}function aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pb="columnSummary",lee=220;var wl=new WeakSet;class uee extends Ke{constructor(){super(...arguments),ree(this,wl),oee(this,"endpoints",null)}static get PLUGIN_KEY(){return pb}static get PLUGIN_PRIORITY(){return lee}isEnabled(){return!!this.hot.getSettings()[pb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[pb],this.endpoints=new nee(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,cee).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,dee).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,hee).call(e,...r)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,fee).call(e,...r)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,gee).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uu(wl,e,mee).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ve(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=mb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ve(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=mb(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=mb(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ve(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(it`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function cee(){this.endpoints.initEndpoints()}function hee(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function dee(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function fee(t,e){e||this.endpoints.refreshAllEndpoints()}function gee(t,e){e||this.endpoints.refreshAllEndpoints()}function mee(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function pee(t,e){mV(t,e),e.add(t)}function wb(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yc(t,e){return t.get(jM(t,e))}function IE(t,e,n){return t.set(jM(t,e),n),n}function jM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gp=new WeakMap,Gg=new WeakMap,qg=new WeakMap,J1=new WeakSet;class pV{constructor(){pee(this,J1),wb(this,Gp,!0),wb(this,Gg,null),wb(this,qg,new ResizeObserver(e=>jM(J1,this,wee).call(this,e)))}setObservedElement(e){IE(Gg,this,e)}unobserve(){yc(qg,this).unobserve(yc(Gg,this))}observe(){IE(Gp,this,!0),yc(qg,this).observe(yc(Gg,this))}destroy(){yc(qg,this).disconnect()}}function wee(t){if(yc(Gp,this)||!Array.isArray(t)||!t.length){IE(Gp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ut(pV,Tn);function ea(t,e,n){vee(t,e),e.set(t,n)}function vee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(wV(t,e))}function Co(t,e,n){return t.set(wV(t,e),n),n}function wV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zu=new WeakMap,vb=new WeakMap,Cb=new WeakMap,ds=new WeakMap,ta=new WeakMap,na=new WeakMap,Kg=new WeakMap,Yu=new WeakMap;class Jl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;ea(this,zu,void 0),ea(this,vb,void 0),ea(this,Cb,!1),ea(this,ds,null),ea(this,ta,void 0),ea(this,na,void 0),ea(this,Kg,!0),ea(this,Yu,new pV),Co(zu,this,e),Co(vb,this,r),Co(Cb,this,n),Co(ta,this,this.createEditor()),Co(na,this,vt(ta,this).style),vt(Yu,this).setObservedElement(this.getInputElement()),vt(Yu,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){vt(na,this).left=`${e}px`,vt(na,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Xt(this.getInputElement()),height:nn(this.getInputElement())}}observeSize(){vt(Yu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){vt(na,this).display="block",Co(Kg,this,!1)}hide(){vt(Yu,this).unobserve(),vt(Kg,this)||(vt(na,this).display="none"),Co(Kg,this,!0)}isVisible(){return vt(na,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return vt(zu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=vt(zu,this).createElement("div"),n=vt(zu,this).createElement("textarea");return e.style.display="none",Co(ds,this,vt(zu,this).createElement("div")),vt(ds,this).setAttribute("dir",vt(Cb,this)?"rtl":"ltr"),Y(vt(ds,this),Jl.CLASS_EDITOR_CONTAINER),vt(vb,this).appendChild(vt(ds,this)),Y(e,Jl.CLASS_EDITOR),Y(n,Jl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),vt(ds,this).appendChild(e),e}getInputElement(){return vt(ta,this).querySelector(`.${Jl.CLASS_INPUT}`)}getEditorElement(){return vt(ta,this)}destroy(){const e=vt(ds,this)?vt(ds,this).parentNode:null;vt(ta,this).parentNode.removeChild(vt(ta,this)),Co(ta,this,null),Co(na,this,null),vt(Yu,this).destroy(),e&&e.removeChild(vt(ds,this))}}ut(Jl,Tn);function yb(t,e,n){return(e=Cee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=yee(t,"string");return typeof e=="symbol"?e:e+""}function yee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const See=250,bee=250;class vV{constructor(e){yb(this,"wasLastActionShow",!0),yb(this,"showDebounced",null),yb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},bee)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:See;this.showDebounced=zf(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ut(vV,Tn);function Ree(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Eee(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function vl(t,e){const n={};return I(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ca(t,e,n,r,i){I(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Tee(s,a,e,n,r,i)})})}function Tee(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Ree(s.className,r):a=Eee(s.className,r)),o(t,e,"className",a)}function CV(t){return`<span class="selected">â</span>${t}`}function np(t,e){let n=!1;return Array.isArray(t)&&I(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function uv(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const ze="---------";function _ee(){return{name:ze}}const vi="alignment";function Mee(){return{key:vi,name(){return this.getTranslatedPhrase(r_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${vi}:left`,name(){return this.getTranslatedPhrase(i_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:center`,name(){return this.getTranslatedPhrase(o_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:right`,name(){return this.getTranslatedPhrase(s_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:justify`,name(){return this.getTranslatedPhrase(a_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:ze},{key:`${vi}:top`,name(){return this.getTranslatedPhrase(l_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:middle`,name(){return this.getTranslatedPhrase(u_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${vi}:bottom`,name(){return this.getTranslatedPhrase(c_)},callback(){const t=this.getSelectedRange(),e=vl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ca(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const cv="clear_column";function Pee(){return{key:cv,name(){return this.getTranslatedPhrase(jT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const eg="col_left";function Iee(){return{key:eg,name(){return this.getTranslatedPhrase(LT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const tg="col_right";function Oee(){return{key:tg,name(){return this.getTranslatedPhrase($T)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const ng="make_read_only";function xee(){return{key:ng,checkable:!0,ariaChecked(){return np(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Ap)},name(){let t=this.getTranslatedPhrase(Ap);return np(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=CV(t)),t},callback(){const t=this.getSelectedRange(),e=np(t,(n,r)=>this.getCellMeta(n,r).readOnly);I(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const hv="redo";function Aee(){return{key:hv,name(){return this.getTranslatedPhrase(BT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const rg="remove_col";function Hee(){return{key:rg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(VT,e)},callback(){this.alter("remove_col",$6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const dv="remove_row";function Nee(){return{key:dv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(FT,e)},callback(){this.alter("remove_row",F6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const fv="row_above";function Dee(){return{key:fv,name(){return this.getTranslatedPhrase(DT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const gv="row_below";function kee(){return{key:gv,name(){return this.getTranslatedPhrase(kT)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const vf="no_items";function Lee(){return{key:vf,name(){return this.getTranslatedPhrase(NT)},disabled:!0,isCommand:!1}}const mv="undo";function $ee(){return{key:mv,name(){return this.getTranslatedPhrase(WT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Fee=[fv,gv,eg,tg,cv,dv,rg,mv,hv,ng,vi,ze,vf],Vee={[ze]:_ee,[vf]:Lee,[fv]:Dee,[gv]:kee,[eg]:Iee,[tg]:Oee,[cv]:Pee,[dv]:Nee,[rg]:Hee,[mv]:$ee,[hv]:Aee,[ng]:xee,[vi]:Mee};function yV(){const t={};return Ve(Vee,(e,n)=>{t[n]=e()}),t}function Wee(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(e_):this.getTranslatedPhrase(JT)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Bee(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(t_)},callback(){this.getSelectedRangeActive().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function jee(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(n_);return np(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,rp))?CV(e):e},callback(){this.getSelectedRangeActive().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,rp);t.updateCommentMeta(n,r,{[rp]:!i})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Uee(t,e){SV(t,e),e.add(t)}function Cl(t,e,n){SV(t,e),e.set(t,n)}function SV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zee(t,e,n){return(e=Yee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:e+""}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wo(t,e,n){return t.set(Sn(t,e),n),n}function $e(t,e){return t.get(Sn(t,e))}function Sn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qp="comments",qee=60,Rs="comment",Od="value",bV="style",rp="readOnly",Qh=qp,OE=`plugin:${qp}`;var yt=new WeakMap,Do=new WeakMap,pv=new WeakMap,ip=new WeakMap,Kp=new WeakMap,xE=new WeakMap,Xp=new WeakMap,xn=new WeakSet;class Kee extends Ke{constructor(){super(...arguments),Uee(this,xn),zee(this,"range",{}),Cl(this,yt,null),Cl(this,Do,null),Cl(this,pv,!1),Cl(this,ip,!1),Cl(this,Kp,!1),Cl(this,xE,null),Cl(this,Xp,"")}static get PLUGIN_KEY(){return qp}static get PLUGIN_PRIORITY(){return qee}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[qp]}enablePlugin(){var e=this;this.enabled||($e(yt,this)||(Wo(yt,this,new Jl(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),$e(yt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sn(xn,e,rte).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),$e(Do,this)||Wo(Do,this,new vV(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Sn(xn,this,ete).call(this,n,a)),this.addHook("afterScroll",()=>Sn(xn,this,ite).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Sn(xn,this,eN).call(this,n)),this.addHook("beforeCompositionStart",n=>Sn(xn,this,eN).call(this,n)),$e(Do,this).addLocalHook("hide",()=>this.hide()),$e(Do,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){$e(Do,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(OE);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeActive();Wo(ip,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(OE),this.hot._registerTimeout(()=>{Wo(ip,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isCell()},group:Qh}),r.addShortcut({keys:[["Escape"]],callback:()=>{$e(yt,this).setValue($e(Xp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>$e(yt,this).isVisible()&&$e(yt,this).isFocused(),group:Qh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>$e(yt,this).isVisible()&&$e(yt,this).isFocused(),group:Qh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Wo(Kp,this,!0),$e(yt,this).setValue($e(yt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Qh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Qh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Sn(xn,this,Qee).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Sn(xn,this,Xee).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Sn(xn,this,Jee).call(this)),this.eventManager.addEventListener(n,"focus",()=>Sn(xn,this,nte).call(this)),this.eventManager.addEventListener(n,"blur",()=>Sn(xn,this,tte).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Sn(xn,this,Zee).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Wa(e.target,"TD","TBODY");return!!(n&&be(n,"htCommentCell")&&Wa(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=$e(yt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const{row:i,col:o}=Sn(xn,this,Sc).call(this);this.updateCommentMeta(i,o,{[Od]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:r}=Sn(xn,this,Sc).call(this);this.hot.setCellMeta(n,r,Rs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const{row:e,col:n}=Sn(xn,this,Sc).call(this);return this.getCommentMeta(e,n,Od)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Od)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:r}=Sn(xn,this,Sc).call(this);if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(n,r);return $e(Do,this).cancelHiding(),$e(yt,this).setValue((e=i[Rs]?i[Rs][Od]:null)!==null&&e!==void 0?e:""),$e(yt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){$e(yt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!$e(yt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=Sn(xn,this,Sc).call(this);let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;$e(yt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),p=this.getCommentMeta(i,o,bV);p?$e(yt,this).setSize(p.width,p.height):$e(yt,this).resetSize();const y=c?0:f.getColumnWidth(a),T=l&&!u?nn(m):0,{left:b,top:M,width:R,height:k}=m.getBoundingClientRect(),{width:P,height:O}=$e(yt,this).getSize(),{innerWidth:U,innerHeight:G}=this.hot.rootWindow,V=this.hot.rootDocument.documentElement,Z=rn(this.hot.rootDocument),z=Z0(this.hot.rootWindow)?Z:0,ue=Q0(this.hot.rootWindow)?Z:0;let ee=b+h.scrollX+y,K=M+h.scrollY+T;this.hot.isRtl()&&(ee-=P+y),this.hot.isLtr()&&b+R+P>U-z?ee=b+h.scrollX-P-1:this.hot.isRtl()&&ee<-(V.scrollWidth-V.clientWidth)&&(ee=b+h.scrollX+y+1),M+O>G-ue&&(K-=O-k+1),$e(yt,this).setPosition(ee,K),$e(yt,this).setReadOnlyState(this.getCommentMeta(i,o,rp)),$e(yt,this).observeSize()}focusEditor(){$e(yt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Rs];let o;i?(o=Qn(i),Vf(o,r)):o=r,this.hot.setCellMeta(e,n,Rs,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Rs])return i[Rs][r]}addToContextMenu(e){e.items.push({name:ze},Wee(this),Bee(this),jee(this))}getEditorInputElement(){return $e(yt,this).getInputElement()}destroy(){var e,n;(e=$e(yt,this))===null||e===void 0||e.destroy(),(n=$e(Do,this))===null||n===void 0||n.destroy(),super.destroy()}}function Xee(t){if(!(!this.hot.view||!this.hot.view._wt)&&!$e(pv,this)&&!this.targetIsCommentTextArea(t)){const e=Wa(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Zee(t){t.stopPropagation()}function Qee(t){const{rootDocument:e}=this.hot;if(!($e(pv,this)||$e(yt,this).isFocused()||be(t.target,"wtBorder")||$e(xE,this)===t.target||!$e(yt,this)))if(Wo(xE,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));$e(Do,this).show(n)}else ka(t.target,e)&&!this.targetIsCommentTextArea(t)&&$e(Do,this).hide()}function Jee(){Wo(pv,this,!1)}function ete(t,e){e[Rs]&&e[Rs][Od]&&Y(t,e.commentedCellClassName)}function tte(){if($e(Kp,this)){Wo(Kp,this,!1);return}Wo(Xp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function nte(){Wo(Xp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(OE)}function rte(t,e){const{row:n,col:r}=Sn(xn,this,Sc).call(this);this.updateCommentMeta(n,r,{[bV]:{width:t,height:e}})}function eN(t){$e(yt,this).isFocused()&&Ni(t)}function ite(){$e(ip,this)||this.hide()}function Sc(){return this.range instanceof fh?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function Sb(t,e,n){return(e=ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ote(t){var e=ste(t,"string");return typeof e=="symbol"?e:e+""}function ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RV{constructor(e){Sb(this,"hot",void 0),Sb(this,"commands",{}),Sb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=ate(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||jt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),I(u,c=>c.apply(this.hot,r))}}function ate(t,e){let n;return I(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function bb(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;bb(this,"hot",void 0),bb(this,"predefinedItems",yV()),bb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ve(e,(r,i)=>{let o="";r.name===ze?(n[ze]=r,o=ze):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return cte(e,this.defaultOrderPattern,this.predefinedItems)}}function cte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Te(i)?Ve(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Te(o)?on(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):I(i,(o,s)=>{let a=n[o];!a&&Fee.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Te(o)&&on(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ra(t,e,n){return(e=hte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hte(t){var e=dte(t,"string");return typeof e=="symbol"?e:e+""}function dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fte{constructor(e,n){ra(this,"top",void 0),ra(this,"topRelative",void 0),ra(this,"left",void 0),ra(this,"leftRelative",void 0),ra(this,"scrollTop",void 0),ra(this,"scrollLeft",void 0),ra(this,"cellHeight",void 0),ra(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Jh(t,e,n){gte(t,e),e.set(t,n)}function gte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(TV(t,e))}function Xg(t,e,n){return t.set(TV(t,e),n),n}function TV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nr=new WeakMap,vr=new WeakMap,Cr=new WeakMap,Rb=new WeakMap,Gu=new WeakMap;class mte{constructor(e){Jh(this,nr,void 0),Jh(this,vr,void 0),Jh(this,Cr,void 0),Jh(this,Rb,!1),Jh(this,Gu,{above:0,below:0,left:0,right:0}),Xg(Rb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ne(Gu,this)[e]=n,this}setElement(e){return Xg(nr,this,e),this}setParentElement(e){return Xg(vr,this,e),this}updatePosition(e){Xg(Cr,this,new fte(e,Ne(nr,this).ownerDocument.defaultView)),Ne(Rb,this)?(Ne(Cr,this).fitsBelow(Ne(nr,this))?this.setPositionBelowCursor():Ne(Cr,this).fitsAbove(Ne(nr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ne(nr,this).dir==="rtl"?Ne(Cr,this).fitsOnLeft(Ne(nr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ne(Cr,this).fitsOnRight(Ne(nr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ne(Gu,this).above+Ne(Cr,this).top-Ne(nr,this).offsetHeight;if(Ne(vr,this)){const r=Ne(vr,this).ownerDocument.defaultView.getComputedStyle(Ne(vr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ne(Cr,this).top+Ne(Cr,this).cellHeight-Ne(nr,this).scrollHeight+i+o}Ne(nr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ne(Gu,this).below+Ne(Cr,this).top+1;if(Ne(vr,this)){const r=Ne(vr,this).ownerDocument.defaultView.getComputedStyle(Ne(vr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ne(Cr,this).top-i-o}Ne(nr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ne(Cr,this).left;if(Ne(vr,this)){const n=Ne(vr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ne(vr,this).querySelector(".htCore")).borderRightWidth,10);e+=Ne(Cr,this).cellWidth+r}else e+=Ne(Gu,this).right;Ne(nr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ne(Gu,this).left+Ne(Cr,this).left-Ne(nr,this).offsetWidth;if(Ne(vr,this)){const n=Ne(vr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ne(vr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ne(nr,this).style.left=`${e}px`}}function UM(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ue(e,-1,p()-1);function a(T,b){const M=p()-1;return T<0&&(T=M),T>M&&(T=0),o.has(T)?-1:(o.add(T),r(T,!1)===!1&&(T=a(b===1?++T:--T,b)),T)}function l(T){T>-1&&T<p()&&r(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<p()&&(s=T)}function c(){return s}function h(){p()>0&&(o.clear(),s=a(0,1))}function d(){p()>0&&(o.clear(),s=a(p()-1,-1))}function f(){p()>0&&(o.clear(),s=a(++s,1))}function m(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:p,clear:y}}function pte(t){return Je(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function AE(t){return jt(t,"submenu")}function HE(t){return new RegExp(ze,"i").test(t.name)}function op(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function tN(t){return jt(t,"disableSelection")}function wte(t){return be(t,"htSeparator")}function vte(t){return be(t,"htSubmenu")}function Cte(t){return be(t,"htDisabled")}function yte(t){return be(t,"htSelectionDisabled")}function Ste(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function _V(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function bte(t,e){let n=t.slice(0);return n.reverse(),n=_V(n,e),n.reverse(),n}function Rte(t){const e=[];return I(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Ete(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,n=t.slice(0);return n=_V(n,e),n=bte(n,e),n=Rte(n),n}function Tte(t){return t.checkable===!0}function _te(t){return UM({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||wte(r)||Cte(r)||yte(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Mte(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedActive();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedActive();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const MV="menu",nN=MV;function Pte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Mte(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:MV})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${nN}:${u}`:nN}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Ite(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(qo(n),Y(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!op(a,t)&&!tN(a)&&!HE(a);fe(n,[...Tte(a)?[M2(),ri(c),DL(h)]:[_2(),ri(u)],...d?[xr(-1)]:[],...op(a,t)?[Ed()]:[],...AE(a)?[_i(!1)]:[]])}n.className="",n.appendChild(l),HE(a)?Y(n,"htSeparator"):typeof a.renderer=="function"?(Y(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ka(l,u),op(a,t)?Y(n,"htDisabled"):tN(a)?Y(n,"htSelectionDisabled"):AE(a)&&Y(n,"htSubmenu")}}function Eb(t,e,n){Ote(t,e),e.set(t,n)}function Ote(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e,n){return(e=xte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Ate(t,"string");return typeof e=="symbol"?e:e+""}function Ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tb(t,e,n){return t.set(PV(t,e),n),n}function ia(t,e){return t.get(PV(t,e))}function PV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rN=215;var qu=new WeakMap,Zg=new WeakMap,Qg=new WeakMap;class vh{get tableBorderWidth(){return ia(Qg,this)===void 0&&this.hotMenu&&Tb(Qg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ia(Qg,this)}constructor(e,n){var r=this;yo(this,"hot",void 0),yo(this,"options",void 0),yo(this,"eventManager",new Pi(this)),yo(this,"container",void 0),yo(this,"positioner",void 0),yo(this,"hotMenu",null),yo(this,"hotSubMenus",{}),yo(this,"parentMenu",void 0),yo(this,"menuItems",null),yo(this,"origOutsideClickDeselects",null),Eb(this,qu,void 0),Eb(this,Zg,void 0),Eb(this,Qg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:rN,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new mte(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(ce(this.options.container,/ht-theme-.*/g),Y(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=lu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ia(qu,this)}getKeyboardShortcutsCtrl(){return ia(Zg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=zf(a=>this.openSubMenu(a),300),n=this.options.minWidth||rN;let r=!1,i=Va(this.menuItems,a=>(a.key===vf&&(r=!0),Ste(a,this.hot)));if(i.length<1&&!r)i.push(yV()[vf]);else if(i.length===0)return;i=Ete(i,ze);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ae(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Ite(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ia(qu,this).setCurrentPage(l.row):ia(qu,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Tp()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Tp()||!ja(a))&&o&&this.hasSelectedItem()&&(ro()||z0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Tb(qu,this,_te(this.hotMenu)),Tb(Zg,this,Pte(this)),ia(Zg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ia(qu,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);fe(r,[_i(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!vte(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new vh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&fe(n,[_i(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&fe(i,[_i(!1)])}}closeAllSubMenus(){I(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?pte(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||HE(e)||op(e,this.hot)||AE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=wn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?nn(this.hotMenu.getCell(u,0)):0;return a+(l.name===ze?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(rt(r)&&(r=r.call(this.hot),r===null||It(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Y(i,`htMenu handsontable ${this.options.className}`),r&&Y(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&fe(this.hotMenu.rootElement,[T2(),xr(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ka(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ka(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&be(e.target,"htCore")&&ka(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ut(vh,Tn);function Hte(t,e){Nte(t,e),e.add(t)}function Nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _b(t,e,n){return(e=Dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=kte(t,"string");return typeof e=="symbol"?e:e+""}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xd="contextMenu",Lte=70,iN=xd;oe.getSingleton().register("afterContextMenuDefaultOptions");oe.getSingleton().register("beforeContextMenuShow");oe.getSingleton().register("afterContextMenuShow");oe.getSingleton().register("afterContextMenuHide");oe.getSingleton().register("afterContextMenuExecute");var ed=new WeakSet;class wv extends Ke{constructor(){super(...arguments),Hte(this,ed),_b(this,"commandExecutor",new RV(this.hot)),_b(this,"itemsFactory",null),_b(this,"menu",null)}static get PLUGIN_KEY(){return xd}static get PLUGIN_PRIORITY(){return Lte}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[fv,gv,ze,eg,tg,ze,dv,rg,ze,mv,hv,ze,ng,ze,vi]}isEnabled(){return!!this.hot.getSettings()[xd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[xd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new vh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Jg(ed,this,Fte).call(this)),this.menu.addLocalHook("afterOpen",()=>Jg(ed,this,Vte).call(this)),this.menu.addLocalHook("afterClose",()=>Jg(ed,this,Wte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Jg(ed,this,$te).call(this,r)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=uv(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:iN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iN)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ve(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new EV(this.hot,wv.DEFAULT_ITEMS);const e=this.hot.getSettings()[xd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),I(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function $te(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),be(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(be(o,"current")&&be(o,"wtBorder"))))return;const s=uv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Fte(){this.hot.runHooks("beforeContextMenuShow",this)}function Vte(){this.hot.runHooks("afterContextMenuShow",this)}function Wte(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}wv.SEPARATOR={name:ze};function Bte(t){return{key:"copy",name(){return this.getTranslatedPhrase(UT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function jte(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(GT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Ute(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(YT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function zte(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(zT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Yte(t){return{key:"cut",name(){return this.getTranslatedPhrase(qT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Gte{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class qte{constructor(){this.clipboardData=new Gte}preventDefault(){}composedPath(){return[]}}function Kte(t,e){IV(t,e),e.add(t)}function Ku(t,e,n){IV(t,e),e.set(t,n)}function IV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function or(t,e){return t.get(Ic(t,e))}function Xu(t,e,n){return t.set(Ic(t,e),n),n}function Ic(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oa=new WeakMap,Mb=new WeakMap,td=new WeakMap,NE=new WeakMap,DE=new WeakMap,nd=new WeakMap,rd=new WeakSet;class Xte{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Kte(this,rd),Ku(this,oa,void 0),Ku(this,Mb,void 0),Ku(this,td,void 0),Ku(this,NE,void 0),Ku(this,DE,void 0),Ku(this,nd,void 0),Xu(Mb,this,n),Xu(td,this,r),Xu(NE,this,i),Xu(DE,this,o),Xu(nd,this,s)}setSelectedRange(e){Xu(oa,this,e)}getCellsRange(){if(or(Mb,this).call(this)===0||or(td,this).call(this)===0)return null;const{row:e,col:n}=or(oa,this).getTopStartCorner(),{row:r,col:i}=or(oa,this).getBottomEndCorner(),o=Ic(rd,this,Zte).call(this,e,r),s=Ic(rd,this,Pb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(or(td,this).call(this)===0||or(nd,this).call(this)===0)return null;const{col:e}=or(oa,this).getTopStartCorner(),{col:n}=or(oa,this).getBottomEndCorner(),r=Ic(rd,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(or(td,this).call(this)===0||or(nd,this).call(this)===0)return null;const{col:e}=or(oa,this).getTopStartCorner(),{col:n}=or(oa,this).getBottomEndCorner(),r=Ic(rd,this,Pb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-or(nd,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Pb(t,e){return Math.min(e,Math.max(t+or(DE,this).call(this)-1,t))}function Zte(t,e){return Math.min(e,Math.max(t+or(NE,this).call(this)-1,t))}function OV(t){const e=[],n=[];return I(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);me(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Qte(t,e){xV(t,e),e.add(t)}function sa(t,e,n){xV(t,e),e.set(t,n)}function xV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=ene(t,"string");return typeof e=="symbol"?e:e+""}function ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mr(t,e){return t.get(Yn(t,e))}function Yi(t,e,n){return t.set(Yn(t,e),n),n}function Yn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterCopyLimit");oe.getSingleton().register("modifyCopyableRange");oe.getSingleton().register("beforeCut");oe.getSingleton().register("afterCut");oe.getSingleton().register("beforePaste");oe.getSingleton().register("afterPaste");oe.getSingleton().register("beforeCopy");oe.getSingleton().register("afterCopy");const Ib="copyPaste",tne=80,nne=["fragmentSelection"],AV="application/ht-source-data-json-html",oN=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var kE=new WeakMap,LE=new WeakMap,$E=new WeakMap,Zu=new WeakMap,em=new WeakMap,tm=new WeakMap,Qu=new WeakMap,Zp=new WeakMap,sr=new WeakSet;class rne extends Ke{constructor(){super(...arguments),Qte(this,sr),id(this,"columnsLimit",1/0),id(this,"rowsLimit",1/0),id(this,"pasteMode","overwrite"),id(this,"uiContainer",this.hot.rootDocument.body),sa(this,kE,!1),sa(this,LE,!1),sa(this,$E,!1),sa(this,Zu,"cells-only"),sa(this,em,!1),sa(this,tm,!1),sa(this,Qu,new Xte({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),sa(this,Zp,!1),id(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ib}static get SETTING_KEYS(){return[Ib,...nne]}static get PLUGIN_PRIORITY(){return tne}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ib]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Yi(kE,this,this.getSetting("copyColumnHeaders")),Yi(LE,this,this.getSetting("copyColumnGroupHeaders")),Yi($E,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Yn(sr,this,sne).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Yn(sr,r,ane).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Yn(sr,this,lne).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Bf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Yn(sr,r,une).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Yn(sr,r,cne).call(r,...o)}),this.addHook("afterSelection",()=>Yn(sr,this,hne).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Yi(Zu,this,e),Yi(em,this,!0),Yn(sr,this,sN).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Yi(tm,this,!0),Yn(sr,this,sN).call(this,"cut")}getRangedCopyableData(e){return Dp(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=[],{rows:i,columns:o}=OV(e);return I(i,s=>{const a=[];I(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=n?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);n&&Te(u)&&(u=JSON.stringify(u)),a.push(u)}}),r.push(a)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new qte;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Mr(Qu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Mr(Zu,this)==="column-headers-only"?n.set("headers",Mr(Qu,this).getMostBottomColumnHeadersRange()):(Mr(Zu,this)==="with-column-headers"?n.set("headers",Mr(Qu,this).getMostBottomColumnHeadersRange()):Mr(Zu,this)==="with-column-group-headers"&&n.set("headers",Mr(Qu,this).getAllColumnHeadersRange()),n.set("cells",Mr(Qu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner();let h=a,d=l,f=a,m=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:y,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,y===!0)continue;f=T,d=l;const b=[],M=s.length%i;for(;b.length<o||d<=c;){var p;const{skipColumnOnPaste:R,visualCol:k}=this.hot.getCellMeta(T,d),P=this.hot.getSourceDataAtCell(T,d),O=b.length%o;if(d=k+1,R===!0)continue;m=k;const U=n==null||(p=n[M])===null||p===void 0?void 0:p[O];let G=e[M][O];if(n&&PL(U)){const V=JSON.parse(U);(Te(P)||P===null)&&(G=V)}b.push(G)}s.push(b)}return Yi(Zp,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,m]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Mr(em,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Yi(em,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Yn(sr,this,ine).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Yn(sr,this,aN).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),Yi(Zu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Mr(tm,this)||this.isEditorOpened()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Yi(tm,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Yn(sr,this,aN).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||zo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!$d(n,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(AV);h&&(s=dE(h,this.hot.rootDocument).data);const d=Fw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=dE(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=U6(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function sN(t){if(Bf()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&r$(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function ine(t){const{rows:e}=OV(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function one(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&eT(r)}}}function HV(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&tT(r)}}}function aN(t,e,n){const r=Dp(e);if(t&&t.clipboardData){const i=hE(e),o=hE(n);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[oN,i].join("")),t.clipboardData.setData(AV,[oN,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r)}function sne(t){t.items.push({name:"---------"},Bte(this)),Mr(kE,this)&&t.items.push(zte(this)),Mr(LE,this)&&t.items.push(Ute(this)),Mr($E,this)&&t.items.push(jte(this)),t.items.push(Yte(this))}function ane(t,e,n,r,i){Mr(Zp,this)&&(i.value=!0),Yi(Zp,this,!1)}function lne(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function une(){Yn(sr,this,HV).call(this)}function cne(){Yn(sr,this,one).call(this)}function hne(){Yn(sr,this,HV).call(this)}function NV(t,e){return`border_row${t}col${e}`}function Ad(){return{width:1,color:"#000"}}function xs(){return{hide:!0}}function dne(){return{width:1,color:"#000",cornerVisible:!1}}function Ob(t){if(ae(t.start)||ae(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ae(t.end)||ae(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function od(t){return ae(t.start)&&(t.left=t.start),ae(t.end)&&(t.right=t.end),t}function xb(t,e){return{id:NV(t,e),border:dne(),row:t,col:e,top:xs(),bottom:xs(),start:xs(),end:xs()}}function fne(t,e){return jt(e,"border")&&e.border&&(t.border=e.border),jt(e,"top")&&ae(e.top)&&(e.top?(Te(e.top)||(e.top=Ad()),t.top=e.top):(e.top=xs(),t.top=e.top)),jt(e,"bottom")&&ae(e.bottom)&&(e.bottom?(Te(e.bottom)||(e.bottom=Ad()),t.bottom=e.bottom):(e.bottom=xs(),t.bottom=e.bottom)),jt(e,"start")&&ae(e.start)&&(e.start?(Te(e.start)||(e.start=Ad()),t.start=e.start):(e.start=xs(),t.start=e.start)),jt(e,"end")&&ae(e.end)&&(e.end?(Te(e.end)||(e.end=Ad()),t.end=e.end):(e.end=xs(),t.end=e.end)),t}function Fs(t,e){let n=!1;return I(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!jt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function vv(t){return`<span class="selected">â</span>${t}`}function gne(t){return t.some(e=>ae(e.left)||ae(e.right))}function mne(t){return t.some(e=>ae(e.start)||ae(e.end))}const pne=new Map([["left","start"],["right","end"]]);function wne(t){var e;return(e=pne.get(t))!==null&&e!==void 0?e:t}function vne(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(g_);return Fs(this,"bottom")&&(e=vv(e)),e},callback(e,n){const r=Fs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function Cne(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(m_);return Fs(this,e)&&(n=vv(n)),n},callback(n,r){const i=Fs(this,e);t.prepareBorder(r,e,i)}}}function yne(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(p_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Fs(this)}}}function Sne(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(f_);return Fs(this,e)&&(n=vv(n)),n},callback(n,r){const i=Fs(this,e);t.prepareBorder(r,e,i)}}}function bne(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(d_);return Fs(this,"top")&&(e=vv(e)),e},callback(e,n){const r=Fs(this,"top");t.prepareBorder(n,"top",r)}}}function Rne(t,e){Ene(t,e),e.add(t)}function Ene(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tne(t,e,n){return(e=_ne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ne(t){var e=Mne(t,"string");return typeof e=="symbol"?e:e+""}function Mne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sp="customBorders",Pne=90;var Ab=new WeakSet;class Ine extends Ke{constructor(){super(...arguments),Rne(this,Ab),Tne(this,"savedBorders",[])}static get PLUGIN_KEY(){return sp}static get PLUGIN_PRIORITY(){return Pne}isEnabled(){return!!this.hot.getSettings()[sp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>lN(Ab,this,One).call(this,e)),this.addHook("init",()=>lN(Ab,this,xne).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Ob(n));const o=Xc(e),s=mf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});I(e,a=>{s(a).forAll((l,u)=>{I(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,wne(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Xc(e),r=mf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return I(e,o=>{r(o).forAll((s,a)=>{I(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(od(l))})})}),i}clearBorders(e){e?this.setBorders(e):(I(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=xb(e,n);r&&(a=fne(a,r),I(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",od(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,o=>{me(e.from.col,i,s=>{const a=xb(o,s);let l=0;o===e.from.row&&jt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&jt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&jt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&jt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",od(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=NV(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=xb(e,n):o=Ob(o),i?(o[r]=xs(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",od(o)))):(o[r]=Ad(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",od(o)))}prepareBorder(e,n,r){I(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":me(o.col,s.col,a=>{me(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":me(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":me(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":me(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){I(e,n=>{const r=Ob(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return wn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Je(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){I(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){I(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Je(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):I(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return I(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return I(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):I(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);I(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[sp];if(Array.isArray(e)){const n=Qn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=gne(e),r=mne(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function One(t){this.hot.getSettings()[sp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(h_)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[bne(this),Sne(this),vne(this),Cne(this),yne(this)]}})}function xne(){this.changeBorderSettings()}function Ane(t,e){Hne(t,e),e.add(t)}function Hne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hb(t,e,n){return(e=Nne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nne(t){var e=Dne(t,"string");return typeof e=="symbol"?e:e+""}function Dne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cN="dragToScroll",kne=100;var Nb=new WeakSet;class Lne extends Ke{constructor(){super(...arguments),Ane(this,Nb),Hb(this,"boundaries",null),Hb(this,"callback",null),Hb(this,"listening",!1)}static get PLUGIN_KEY(){return cN}static get PLUGIN_PRIORITY(){return kne}isEnabled(){return!!this.hot.getSettings()[cN]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>uN(Nb,this,hN).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>uN(Nb,this,hN).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=lu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function hN(t){if(ja(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function $ne(t,e){DV(t,e),e.add(t)}function Fne(t,e,n){DV(t,e),e.set(t,n)}function DV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Db(t,e,n){return(e=Vne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vne(t){var e=Wne(t,"string");return typeof e=="symbol"?e:e+""}function Wne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bne(t,e){return t.get(Ci(t,e))}function kV(t,e,n){return t.set(Ci(t,e),n),n}function Ci(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("afterDropdownMenuDefaultOptions");oe.getSingleton().register("beforeDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuShow");oe.getSingleton().register("afterDropdownMenuHide");oe.getSingleton().register("afterDropdownMenuExecute");const ap="dropdownMenu",jne=230,Cf="changeType",kb=ap;var Cv=new WeakMap,Ki=new WeakSet;class yv extends Ke{static get PLUGIN_KEY(){return ap}static get PLUGIN_PRIORITY(){return jne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[eg,tg,ze,rg,ze,cv,ze,ng,ze,vi]}constructor(e){super(e),$ne(this,Ki),Db(this,"commandExecutor",new RV(this.hot)),Db(this,"itemsFactory",null),Db(this,"menu",null),Fne(this,Cv,!1),this.hot.addHook("afterGetColHeader",(n,r)=>Ci(Ki,this,zne).call(this,n,r))}isEnabled(){return this.hot.getSettings()[ap]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new EV(this.hot,yv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ci(Ki,e,Zne).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ci(Ki,e,Xne).call(e,...o)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[ap],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new vh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ci(Ki,this,Yne).call(this)),this.menu.addLocalHook("afterOpen",()=>Ci(Ki,this,Gne).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Ci(Ki,this,qne).call(this,o)),this.menu.addLocalHook("afterClose",()=>Ci(Ki,this,Kne).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),I(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeActive();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeActive(),o=uv(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Cf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:kb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:kb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ci(Ki,this,Une).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ve(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function LV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Une(t){if(be(t.target,Cf)){const e=uv(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),kV(Cv,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function zne(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Cf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Cf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(fe(s,[bu(),ri(" ")]),fe(e,[AL("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Yne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Gne(){this.hot.runHooks("afterDropdownMenuShow",this),Ci(Ki,this,LV).call(this,this.menu)}function qne(t){Ci(Ki,this,LV).call(this,t)}function Kne(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Xne(t){return Bne(Cv,this)?null:t}function Zne(t){be(t.target,Cf)&&kV(Cv,this,!0)}yv.SEPARATOR={name:ze};function dN(t,e,n){return(e=Qne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qne(t){var e=Jne(t,"string");return typeof e=="symbol"?e:e+""}function Jne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ere{constructor(e){dN(this,"hot",void 0),dN(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return me(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function fN(t,e,n){return(e=tre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tre(t){var e=nre(t,"string");return typeof e=="symbol"?e:e+""}function nre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){fN(this,"dataProvider",void 0),fN(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ao(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=on(ao(zM.DEFAULT_OPTIONS),n),n=on(n,e),n.filename=$w(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function rre(t,e){ire(t,e),e.add(t)}function ire(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $V="\r",ore='"',sre=`
`,are="=",lre="+",ure="-",cre="@",hre="	";var Lb=new WeakSet;class dre extends zM{constructor(){super(...arguments),rre(this,Lb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Je(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),I(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Rt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=gN(Lb,this,gre).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=gN(Lb,this,fre).call(this,i)),(n||i.indexOf($V)>=0||i.indexOf(ore)>=0||i.indexOf(sre)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function fre(t){return t.startsWith(are)||t.startsWith(lre)||t.startsWith(ure)||t.startsWith(cre)||t.startsWith(hre)||t.startsWith($V)?`'${t}`:t}function gre(t,e){return e.test(t)?`'${t}`:t}const mre="csv",FE={[mre]:dre};function pre(t,e,n){return typeof FE[t]=="function"?new FE[t](e,n):null}const wre="exportFile",vre=240;class Cre extends Ke{static get PLUGIN_KEY(){return wre}static get PLUGIN_PRIORITY(){return vre}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!FE[e])throw new Error(`Export format type "${e}" is not supported.`);return pre(e,new ere(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ju(t,e,n){return(e=yre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yre(t){var e=Sre(t,"string");return typeof e=="symbol"?e:e+""}function Sre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ig{constructor(e,n){let{id:r,stateless:i=!0}=n;Ju(this,"hot",void 0),Ju(this,"id",void 0),Ju(this,"elements",[]),Ju(this,"hidden",!1),Ju(this,"stateId",""),Ju(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Jw)}getElements(){return this.elements}reset(){I(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ut(ig,Tn);const yf={};function Ua(t,e){if(!yf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=yf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function eu(t){if(!yf[t])throw Error(`Filter condition "${t}" does not exist.`);return yf[t].descriptor}function ln(t,e,n){n.key=t,yf[t]={condition:e,descriptor:n}}const Hn="none";function bre(){return!0}ln(Hn,bre,{name:ev,inputsCount:0,showOperators:!1});const zd="empty";function Rre(t){return Ut(t.value)}ln(zd,Rre,{name:R_,inputsCount:0,showOperators:!0});const lp="not_empty";function Ere(t,e){return!Ua(zd,e)(t)}ln(lp,Ere,{name:E_,inputsCount:0,showOperators:!0});const Yd="eq";function Tre(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale)===Rt(n)}ln(Yd,Tre,{name:T_,inputsCount:1,showOperators:!0});const up="neq";function _re(t,e){return!Ua(Yd,e)(t)}ln(up,_re,{name:__,inputsCount:1,showOperators:!0});const FV="gt";function Mre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}ln(FV,Mre,{name:x_,inputsCount:1,showOperators:!0});const VV="gte";function Pre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}ln(VV,Pre,{name:A_,inputsCount:1,showOperators:!0});const WV="lt";function Ire(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}ln(WV,Ire,{name:H_,inputsCount:1,showOperators:!0});const BV="lte";function Ore(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}ln(BV,Ore,{name:N_,inputsCount:1,showOperators:!0});const YM="date_after";function xre(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}ln(YM,xre,{name:L_,inputsCount:1,showOperators:!0});const GM="date_before";function Are(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}ln(GM,Are,{name:$_,inputsCount:1,showOperators:!0});const Qp="between";function Hre(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ua(GM,[o]),a=Ua(YM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}ln(Qp,Hre,{name:D_,inputsCount:2,showOperators:!0});const jV="not_between";function Nre(t,e){return!Ua(Qp,e)(t)}ln(jV,Nre,{name:k_,inputsCount:2,showOperators:!0});const UV="begins_with";function Dre(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Rt(n))}ln(UV,Dre,{name:M_,inputsCount:1,showOperators:!0});const zV="ends_with";function kre(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Rt(n))}ln(zV,kre,{name:P_,inputsCount:1,showOperators:!0});const qM="contains";function Lre(t,e){let[n]=e;return Rt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Rt(n))>=0}ln(qM,Lre,{name:I_,inputsCount:1,showOperators:!0});const YV="not_contains";function $re(t,e){return!Ua(qM,e)(t)}ln(YV,$re,{name:O_,inputsCount:1,showOperators:!0});const GV="date_tomorrow";function Fre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}ln(GV,Fre,{name:V_,inputsCount:0});const qV="date_today";function Vre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}ln(qV,Vre,{name:F_,inputsCount:0});const KV="date_yesterday";function Wre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}ln(KV,Wre,{name:W_,inputsCount:0});$L();function Bre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function og(t){const e=new Set(t);return function(n){return e.has(n)}}function KM(t){return t??""}function VE(t){return Array.from(new Set(t)).map(e=>KM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function mN(t,e,n,r){const i=[],o=t===e;let s;return o||(s=og(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Bre(a,n)};r&&r(u),i.push(u)}),i}const tu="by_value";function jre(t,e){let[n]=e;return n(t.value)}ln(tu,jre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[og(e)]},showOperators:!1});const Sf={};function Ure(t){if(!Sf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Sf[t].func;return function(n,r){return e(n,r)}}function zre(t){return Sf[t].name}function XM(t,e,n){Sf[t]={name:e,func:n}}const $a="conjunction",Yre=U_;function Gre(t,e){return t.every(n=>n.func(e))}XM($a,Yre,Gre);const Jp="disjunction",qre=tv;function Kre(t,e){return t.some(n=>n.func(e))}XM(Jp,qre,Kre);const ZM="disjunctionWithExtraCondition",Xre=tv;function Zre(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}XM(ZM,Xre,Zre);const Qre="numeric",XV="text",Jre="date",pN={[Qre]:[Hn,ze,zd,lp,ze,Yd,up,ze,FV,VV,WV,BV,Qp,jV],[XV]:[Hn,ze,zd,lp,ze,Yd,up,ze,UV,zV,ze,qM,YV],[Jre]:[Hn,ze,zd,lp,ze,Yd,up,ze,GM,YM,Qp,ze,GV,qV,KV]};function eie(t){const e=[];let n=t;return pN[n]||(n=XV),I(pN[n],r=>{let i;r===ze?i={name:ze}:i=ao(eu(r)),e.push(i)}),e}function sd(t,e,n){return(e=tie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tie(t){var e=nie(t,"string");return typeof e=="symbol"?e:e+""}function nie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $b="built",Fb="building",wN=["click","input","keydown","keypress","keyup","focus","blur","change"];let io=class ZV{static get DEFAULTS(){return ao({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){sd(this,"hot",void 0),sd(this,"eventManager",new Pi(this)),sd(this,"options",void 0),sd(this,"_element",void 0),sd(this,"buildState",void 0),this.hot=e,this.options=on(ZV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Fb?this._element:this.buildState===$b?(this.update(),this._element):(this.buildState=Fb,this.build(),this.buildState=$b,this._element)}isBuilt(){return this.buildState===$b}translateIfPossible(e){return typeof e=="string"&&e.startsWith(fr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Fb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Y(this._element,this.options.className),this.options.children.length)I(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ve(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),I(wN,r=>e(n,r))}else I(wN,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ut(io,Tn);function rie(t,e){QV(t,e),e.add(t)}function iie(t,e,n){QV(t,e),e.set(t,n)}function QV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nm(t,e){return t.get(QM(t,e))}function oie(t,e,n){return t.set(QM(t,e),n),n}function QM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ec=new WeakMap,vN=new WeakSet;class Fa extends io{static get DEFAULTS(){return ao({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,on(Fa.DEFAULTS,n)),rie(this,vN),iie(this,ec,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>QM(vN,this,sie).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");oie(ec,this,this._element.firstChild),Y(this._element,"htUIInput"),Y(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(nm(ec,this).type=this.options.type,nm(ec,this).placeholder=this.translateIfPossible(this.options.placeholder),nm(ec,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&nm(ec,this).focus()}}function sie(t){this.options.value=t.target.value}function aie(t,e){JV(t,e),e.add(t)}function ad(t,e,n){JV(t,e),e.set(t,n)}function JV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tc(t,e,n){return t.set(Gd(t,e),n),n}function Lt(t,e){return t.get(Gd(t,e))}function Gd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vn=new WeakMap,rm=new WeakMap,im=new WeakMap,Vb=new WeakMap,om=new WeakMap,sm=new WeakSet;class bf extends io{static get DEFAULTS(){return ao({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,on(bf.DEFAULTS,n)),aie(this,sm),ad(this,vn,null),ad(this,rm,[]),ad(this,im,void 0),ad(this,Vb,void 0),ad(this,om,void 0),this.registerHooks()}getMenu(){return Lt(vn,this)}registerHooks(){this.addLocalHook("click",()=>Gd(sm,this,cie).call(this))}setItems(e){tc(rm,this,this.translateNames(e)),Lt(vn,this)&&Lt(vn,this).setMenuItems(Lt(rm,this))}translateNames(e){return I(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),tc(vn,this,new vh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Lt(vn,this).setMenuItems(Lt(rm,this));const e=new io(this.hot,{className:"htUISelectCaption"}),n=new io(this.hot,{className:"htUISelectDropdown"});tc(im,this,e),tc(Vb,this,e.element),tc(om,this,n),this.hot.getSettings().ariaTags&&(fe(n.element,[bu()]),fe(this._element,[xL()])),I([e,n],r=>this._element.appendChild(r.element)),Lt(vn,this).addLocalHook("select",r=>Gd(sm,this,lie).call(this,r)),Lt(vn,this).addLocalHook("afterClose",()=>Gd(sm,this,uie).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Lt(vn,this).hot.getTranslatedPhrase(ev),Lt(Vb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Lt(vn,this)&&(Lt(vn,this).open(),Lt(vn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Lt(vn,this).getNavigator().toFirstItem(),Lt(vn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Lt(vn,this)&&Lt(vn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Lt(vn,this)&&(Lt(vn,this).destroy(),tc(vn,this,null)),Lt(im,this)&&Lt(im,this).destroy(),Lt(om,this)&&Lt(om,this).destroy(),super.destroy()}}function lie(t){t.name!==ze&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function uie(){this.runLocalHooks("afterClose")}function cie(){this.openOptions()}function hie(t,e){die(t,e),e.add(t)}function die(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CN(t,e,n){return(e=fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fie(t){var e=gie(t,"string");return typeof e=="symbol"?e:e+""}function gie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wb=new WeakSet;class WE extends ig{constructor(e,n){super(e,{id:n.id,stateless:!1}),hie(this,Wb),CN(this,"name",""),CN(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new bf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fa(this.hot,{placeholder:X_})),this.elements.push(new Fa(this.hot,{placeholder:Z_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>yN(Wb,this,mie).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),I(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>yN(Wb,this,pie).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ao(e.command);n.name.startsWith(zt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),I(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||eu(Hn),n=[];return I(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=eu(e?e.name:Hn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||I(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof bf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Y(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[eu(Hn)];if(e!==null){const{visualIndex:r}=e;n=eie(this.hot.getDataType(0,r,this.hot.countRows(),r))}I(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function mie(t){I(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function pie(t){dh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ni(t))}function SN(t,e,n){wie(t,e),e.set(t,n)}function wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ld(t,e){return t.get(eW(t,e))}function bN(t,e,n){return t.set(eW(t,e),n),n}function eW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nc=new WeakMap,Bb=new WeakMap;class ew extends io{static get DEFAULTS(){return ao({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,on(ew.DEFAULTS,n)),SN(this,nc,void 0),SN(this,Bb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),bN(Bb,this,e),bN(nc,this,this._element.firstChild),ld(nc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ld(Bb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ld(nc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ld(nc,this).checked=e)}focus(){this.isBuilt()&&ld(nc,this).focus()}}function vie(t,e){Cie(t,e),e.add(t)}function Cie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yie(t,e,n){return(e=Sie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sie(t){var e=bie(t,"string");return typeof e=="symbol"?e:e+""}function bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RN=0;var EN=new WeakSet;class Eie extends ig{constructor(e,n){super(e,{id:n.id,stateless:!1}),vie(this,EN),yie(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuOperators"),I(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[$a,Jp];I(e,n=>{const r=new ew(this.hot,{name:"operator",label:{htmlFor:n,textContent:zre(n)},value:n,checked:n===e[RN],id:n});r.addLocalHook("change",i=>Rie(EN,this,Tie).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(it`Radio button with index ${e} doesn't exist.`);I(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof ew&&n.isChecked());return e?e.getValue():$a}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&I(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$a,n=arguments.length>1?arguments[1]:void 0,r=e;r===ZM&&(r=Jp),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(RN)}}function Tie(t){this.setState(t.target.value)}function _ie(t,e,n){Mie(t,e),e.set(t,n)}function Mie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jb(t,e){return t.get(tW(t,e))}function Pie(t,e,n){return t.set(tW(t,e),n),n}function tW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ud=new WeakMap;class Rf extends io{static get DEFAULTS(){return ao({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,on(Rf.DEFAULTS,n)),_ie(this,ud,void 0)}build(){super.build(),Pie(ud,this,this._element.firstChild)}update(){this.isBuilt()&&(jb(ud,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&jb(ud,this).focus()}activate(){jb(ud,this).click()}}function Iie(t,e){nW(t,e),e.add(t)}function rc(t,e,n){nW(t,e),e.set(t,n)}function nW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get(Oc(t,e))}function Bi(t,e,n){return t.set(Oc(t,e),n),n}function Oc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TN="multipleSelect.itemBox";var Xi=new WeakMap,en=new WeakMap,Ub=new WeakMap,fs=new WeakMap,aa=new WeakMap,la=new WeakMap,cd=new WeakSet;class Ef extends io{static get DEFAULTS(){return ao({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,on(Ef.DEFAULTS,n)),Iie(this,cd),rc(this,Xi,[]),rc(this,en,void 0),rc(this,Ub,void 0),rc(this,fs,void 0),rc(this,aa,void 0),rc(this,la,void 0),Bi(fs,this,new Fa(this.hot,{placeholder:K_,className:"htUIMultipleSelectSearch"})),Bi(aa,this,new Rf(this.hot,{textContent:z_,className:"htUISelectAll"})),Bi(la,this,new Rf(this.hot,{textContent:Y_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return De(en,this)}registerHooks(){De(fs,this).addLocalHook("keydown",e=>Oc(cd,this,xie).call(this,e)),De(fs,this).addLocalHook("input",e=>Oc(cd,this,Oie).call(this,e)),De(aa,this).addLocalHook("click",e=>Oc(cd,this,Aie).call(this,e)),De(la,this).addLocalHook("click",e=>Oc(cd,this,Hie).call(this,e))}setItems(e){var n;Bi(Xi,this,e),(n=De(en,this))===null||n===void 0||n.loadData(De(Xi,this))}setLocale(e){Bi(Ub,this,e)}getLocale(){return De(Ub,this)}getItems(){return[...De(Xi,this)]}getValue(){return Die(De(Xi,this))}getSearchInputElement(){return De(fs,this)}getSelectAllElement(){return De(aa,this)}getClearAllElement(){return De(la,this)}isSelectedAllValues(){return De(Xi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new io(this.hot,{className:"htUISelectionControls",children:[De(aa,this),De(la,this)]});this._element.appendChild(De(fs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=De(en,this))===null||s===void 0||s.destroy(),Y(o,"htUIMultipleSelectHot"),Bi(en,this,new this.hot.constructor(o,{data:De(Xi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{De(en,this).listen()},modifyColWidth:u=>{const c=De(en,this).container.scrollWidth-rn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),De(en,this).init();const l=De(en,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:TN}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{De(en,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:TN})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&De(en,this).listen()}reset(){De(fs,this).reset(),De(aa,this).reset(),De(la,this).reset()}update(){this.isBuilt()&&(De(en,this).loadData(Nie(De(Xi,this),this.options.value)),super.update())}destroy(){var e;(e=De(en,this))===null||e===void 0||e.destroy(),De(fs,this).destroy(),De(la,this).destroy(),De(aa,this).destroy(),Bi(fs,this,null),Bi(la,this,null),Bi(aa,this,null),Bi(en,this,null),Bi(Xi,this,null),super.destroy()}}function Oie(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...De(Xi,this)]:n=De(Xi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),De(en,this).loadData(n)}function xie(t){this.runLocalHooks("keydown",t,this),nT(dh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ni(t),De(en,this).listen(),De(en,this).selectCell(0,0))}function Aie(t){const e=[];t.preventDefault(),De(en,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(_T(n,r)[0])}),De(en,this).setSourceDataAtCell(e)}function Hie(t){const e=[];t.preventDefault(),De(en,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(_T(n,r)[0])}),De(en,this).setSourceDataAtCell(e)}function Nie(t,e){const n=og(e);return t.map(r=>(r.checked=n(r.value),r))}function Die(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function kie(t,e){Lie(t,e),e.add(t)}function Lie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $ie(t,e,n){return(e=Fie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fie(t){var e=Vie(t,"string");return typeof e=="symbol"?e:e+""}function Vie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function am(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hd=new WeakSet;class Wie extends ig{constructor(e,n){super(e,{id:n.id,stateless:!1}),kie(this,hd),$ie(this,"name",""),this.name=n.name,this.elements.push(new Ef(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>am(hd,this,Bie).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>am(hd,this,jie).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===tu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Hn:tu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Va(i,h=>h.name===tu),u={},c=this.hot.getTranslatedPhrase(Hp);if(l){const h=s(r,a),d=Je(h,b=>b.value),f=new Map(h.map(b=>[b.value,this.hot.getCellMeta(b.meta.visualRow,b.meta.visualCol)])),m=VE(d);o&&(l.args[0]=o);const p=[],y=mN(m,l.args[0],c,b=>{b.checked&&p.push(b.value),am(hd,this,_N).call(this,b,f)}),T=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,T).locale,u.args=[p],u.command=eu(tu),u.itemsSnapshot=y}else u.args=[],u.command=eu(Hn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ef)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Hp),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=VE(r),s=mN(o,o,e,l=>{am(hd,this,_N).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Je(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:KM(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function Bie(t){dh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ni(t))}function _N(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function jie(t,e){switch(e.type){case"numeric":return BF(t,e);default:return t}}var rW;function Uie(t,e){zie(t,e),e.add(t)}function zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yie(t,e,n){return(e=Gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=qie(t,"string");return typeof e=="symbol"?e:e+""}function qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var MN=new WeakSet;class Tf extends ig{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Uie(this,MN),Yie(this,"name",""),this.name=n.name,this.elements.push(new Fa(this.hot,{type:"button",value:G_,className:"htUIButton htUIButtonOK",identifier:Tf.BUTTON_OK})),this.elements.push(new Fa(this.hot,{type:"button",value:q_,className:"htUIButton htUIButtonCancel",identifier:Tf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){I(this.elements,e=>{e.addLocalHook("click",(n,r)=>Kie(MN,this,Xie).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuActionBar"),I(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}rW=Tf;function Xie(t,e){e.options.identifier===rW.BUTTON_OK?this.accept():this.cancel()}function zb(t,e,n){return(e=Zie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Qie(t,"string");return typeof e=="symbol"?e:e+""}function Qie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PN="ConditionCollection.filteringStates";class JM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;zb(this,"hot",void 0),zb(this,"isMapRegistrable",void 0),zb(this,"filteringStates",new Jw),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(PN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$a;return e.length?Ure(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$a,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(it`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(It(Sf[r]))throw new Error(it`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ua(a,s)}]},i):u.push({name:a,args:s,func:Ua(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(PN),this.filteringStates=null,this.clearLocalHooks()}}ut(JM,Tn);function IN(t,e,n){return(e=Jie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jie(t){var e=eoe(t,"string");return typeof e=="symbol"?e:e+""}function eoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];IN(this,"conditionCollection",void 0),IN(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return I(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return I(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return I(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function toe(t,e){noe(t,e),e.add(t)}function noe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yl(t,e,n){return(e=roe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:e+""}function ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lm=new WeakSet;class oW{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];toe(this,lm),yl(this,"hot",void 0),yl(this,"conditionCollection",void 0),yl(this,"columnDataFactory",void 0),yl(this,"changes",[]),yl(this,"grouping",!1),yl(this,"latestEditedColumnPosition",-1),yl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Yb(lm,this,ooe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Yb(lm,this,soe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Yb(lm,this,aoe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,I(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=o$(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new JM(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const p=r.columnDataFactory(h);let y;f.isEmpty()?y=p:y=new iW(f,b=>r.columnDataFactory(b)).filter(),y=Je(y,b=>b.meta.visualRow);const T=og(y);return f.destroy(),Va(p,b=>T(b.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ve(this,(e,n)=>{this[n]=null})}}function ooe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function soe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function aoe(){I(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ut(oW,Tn);function loe(t){return UM({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Ef)return r;if(i.element&&!uu(i.element))return!1;i.focus()}})}const dd="filters";function uoe(t,e){let n=-1,r;const i=loe(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(dd),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof io&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(dd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(dd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const p=r.getNavigator();p.getCurrentPage()>-1&&(n=p.getCurrentPage()),p.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const p=e[i.getCurrentPage()];p instanceof bf&&(p.openOptions(),m.preventDefault()),p instanceof Rf&&(p.activate(),m.preventDefault()),p instanceof io||m.preventDefault()}}],dd)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(dd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function coe(t,e){sW(t,e),e.add(t)}function Gb(t,e,n){sW(t,e),e.set(t,n)}function sW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e,n){return(e=hoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hoe(t){var e=doe(t,"string");return typeof e=="symbol"?e:e+""}function doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cp(t,e,n){return t.set(Rr(t,e),n),n}function yi(t,e){return t.get(Rr(t,e))}function Rr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BE="filters",foe=250,ON=BE;var vs=new WeakMap,jE=new WeakMap,ql=new WeakMap,Wr=new WeakSet;class goe extends Ke{static get PLUGIN_KEY(){return BE}static get PLUGIN_PRIORITY(){return foe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,coe(this,Wr),fd(this,"dropdownMenuPlugin",null),fd(this,"conditionCollection",null),fd(this,"conditionUpdateObserver",null),fd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),fd(this,"filtersRowsMap",null),Gb(this,vs,void 0),Gb(this,jE,new WeakSet),Gb(this,ql,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rr(Wr,n,Soe).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[BE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Kf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>Rr(Wr,this,xN).call(this,"accept")),a.addLocalHook("cancel",()=>Rr(Wr,this,xN).call(this,"cancel")),a.addLocalHook("change",l=>Rr(Wr,this,yoe).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(B_)}:`,s=()=>`${this.hot.getTranslatedPhrase(j_)}:`;if(!this.components.get("filter_by_condition")){const a=new WE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Rr(Wr,this,AN).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Eie(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new WE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Rr(Wr,this,AN).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Wie(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Tf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new JM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new oW(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Rr(Wr,this,boe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Rr(Wr,e,Coe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Rr(Wr,this,voe).call(this)),this.addHook("afterDropdownMenuShow",()=>Rr(Wr,this,poe).call(this)),this.addHook("afterDropdownMenuHide",()=>Rr(Wr,this,woe).call(this)),this.addHook("afterChange",a=>Rr(Wr,this,moe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!yi(vs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=yi(vs,this).getMenu(),c=u.getNavigator(),h=yi(vs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];cp(vs,this,uoe(this.dropdownMenuPlugin.menu,a));const l=u=>{yi(vs,this).listen(),u.preventDefault(),dh(u.keyCode,"TAB")&&(u.shiftKey?yi(vs,this).toPreviousItem():yi(vs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:ON})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ON)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$a;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,yi(ql,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Je(n.filter(),u=>u.meta.visualRow);const l=og(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),I(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),cp(ql,this,this.exportConditions())}else s!==!1&&!r?(cp(ql,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(yi(ql,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return I(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),p=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:KM(p)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=VE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Jp&&n.command.key!==Hn&&r.command.key!==Hn&&i.command.key!==Hn?o=ZM:i.command.key!==Hn&&(n.command.key===Hn||r.command.key===Hn)&&(o=$a),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new iW(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return I(i,s=>{I(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function moe(t){t&&I(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function poe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function woe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function voe(){const t=this.dropdownMenuPlugin.menu;yi(jE,this).has(t)||yi(vs,this).setMenu(t),yi(jE,this).add(t)}function Coe(t){t.items.push({name:ze}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function xN(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Hn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Hn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Hn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function yoe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===WE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function AN(){this.setListeningDropdownMenu()}function Soe(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Y(e,"htFiltersActive"):ce(e,"htFiltersActive")}function boe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&cp(ql,this,yi(ql,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===tu),s=n.filter(a=>a.name!==tu);if(o.length>=2||s.length>=3)qe(it`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const aW="internal-use-in-handsontable",UE={licenseKey:aW,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function lW(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function uW(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Roe(t){var e;const n=t[Kn],r=uW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=lW(t);return{...UE,...r,...i}}function Eoe(t){var e;const n=t[Kn],r=uW(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=lW(t);return{...r,...i}}function Toe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Sv(){const t="engine_relationship",e=Di(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function eP(){const t="shared_engine_usage",e=Di(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function _oe(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||It(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Moe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&It(r.hyperformula)){const o=Sv(),s=eP().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:aW}),(r.getConfig().leapYear1900!==UE.leapYear1900||Wf(r.getConfig().nullDate,UE.nullDate)===!1)&&qe(it`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Moe(t,e,n){const r=e[Kn],i=Roe(e),o=Sv(),s=eP();Poe(t,r.functions),Ioe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Ooe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function HN(t){var e;const n=Sv(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function NN(t,e){if(t){const n=Sv(),r=n.get(t),i=eP(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Poe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){qe(s.message)}})}function Ioe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){qe(r.message)}}}function Ooe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){qe(a.message)}}),t.resumeEvaluation())}function xoe(t,e){return(It(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const cW="DD/MM/YYYY";function Aoe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Hoe(t){return Aoe(t)?t.substr(1):t}function Noe(t){return typeof t=="string"&&t.startsWith("=")}function tP(t,e){return typeof t=="string"&&e==="date"}function hW(t,e){return X(t,e,!0).isValid()}function dW(t,e){return X(t,e,!0).format(cW)}function Doe(t,e){return X(t,cW,!0).format(e)}function fW(t,e){const r=new Date(Date.UTC(0,0,t+-1));return X(r).format(e)}function koe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function Loe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function $oe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function nP(t,e,n){const r=Loe(t,koe(t,e,n));return $oe(r)}function Sl(t,e,n){Foe(t,e),e.set(t,n)}function Foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){return t.get(gW(t,e))}function ua(t,e,n){return t.set(gW(t,e),n),n}function gW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gd=new WeakMap,ca=new WeakMap,Br=new WeakMap,um=new WeakMap,qb=new WeakMap,Kb=new WeakMap,cm=new WeakMap;class DN{constructor(e,n,r){Sl(this,gd,void 0),Sl(this,ca,void 0),Sl(this,Br,void 0),Sl(this,um,[]),Sl(this,qb,[]),Sl(this,Kb,void 0),Sl(this,cm,[]),ua(gd,this,e),ua(ca,this,n),ua(Br,this,r)}setRemovedHfIndexes(e){return ua(cm,this,e.map(n=>{const r=Pt(ca,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Pt(cm,this)}getRemovedHfIndexes(){return Pt(cm,this)}getHfIndexFromVisualIndex(e){const n=Pt(ca,this).getIndexesSequence(),r=Pt(ca,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Zn(Pt(gd,this))}s`;Pt(Br,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Pt(Br,this).getEngine()[r](Pt(Br,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ua(qb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),ua(Kb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Pt(Br,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=nP(Pt(qb,this),Pt(Kb,this),Pt(ca,this).getNumberOfIndexes());Pt(Br,this).getSheetId()===null?Pt(Br,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Zn(Pt(gd,this))}Order`;return n=>{if(Pt(Br,this).isPerformingUndoRedo())return;const r=Pt(ca,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Pt(um,this).map(l=>r.indexOf(l)),o=Pt(Br,this).getEngine().getSheetDimensions(Pt(Br,this).getSheetId());let s;Pt(gd,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Pt(Br,this).getEngine()[e](Pt(Br,this).getSheetId(),i)}ua(um,this,r)}}init(){ua(um,this,Pt(ca,this).getIndexesSequence())}}function bl(t,e,n){Voe(t,e),e.set(t,n)}function Voe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gs(t,e){return t.get(mW(t,e))}function Rl(t,e,n){return t.set(mW(t,e),n),n}function mW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hm=new WeakMap,dm=new WeakMap,Xb=new WeakMap,Zb=new WeakMap,Qb=new WeakMap,Jb=new WeakMap,eR=new WeakMap;class Woe{constructor(e,n,r){bl(this,hm,void 0),bl(this,dm,void 0),bl(this,Xb,void 0),bl(this,Zb,!1),bl(this,Qb,!1),bl(this,Jb,null),bl(this,eR,null),Rl(hm,this,new DN("row",e,this)),Rl(dm,this,new DN("column",n,this)),Rl(Xb,this,r)}getForAxis(e){return e==="row"?gs(hm,this):gs(dm,this)}setPerformUndo(e){Rl(Zb,this,e)}setPerformRedo(e){Rl(Qb,this,e)}isPerformingUndoRedo(){return gs(Zb,this)||gs(Qb,this)}getSheetId(){return gs(eR,this)}getEngine(){return gs(Jb,this)}getPostponeAction(){return gs(Xb,this)}setupSyncEndpoint(e,n){Rl(Jb,this,e),Rl(eR,this,n),gs(hm,this).init(),gs(dm,this).init()}}function Boe(t,e){pW(t,e),e.add(t)}function El(t,e,n){return(e=joe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function joe(t){var e=Uoe(t,"string");return typeof e=="symbol"?e:e+""}function Uoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tR(t,e,n){pW(t,e),e.set(t,n)}function pW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e,n){return t.set(Le(t,e),n),n}function au(t,e){return t.get(Le(t,e))}function Le(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Kn="formulas",zoe=["maxRows","maxColumns","language"],Yoe=260;oe.getSingleton().register("afterNamedExpressionAdded");oe.getSingleton().register("afterNamedExpressionRemoved");oe.getSingleton().register("afterSheetAdded");oe.getSingleton().register("afterSheetRemoved");oe.getSingleton().register("afterSheetRenamed");oe.getSingleton().register("afterFormulasValuesUpdate");const Ch=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Vs=new WeakMap,bv=new WeakMap,md=new WeakMap,Be=new WeakSet;class Goe extends Ke{constructor(){var e;super(...arguments),e=this,Boe(this,Be),tR(this,Vs,!1),tR(this,bv,!1),tR(this,md,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,use).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,cse).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,hse).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,dse).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,fse).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Le(Be,e,gse).call(e,...r)}]]),El(this,"staticRegister",Di("formulas")),El(this,"engine",null),El(this,"sheetId",null),El(this,"sheetName",null),El(this,"indexSyncer",null),El(this,"rowAxisSyncer",null),El(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return Yoe}static get SETTING_KEYS(){return[Kn,...zoe]}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=_oe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){qe("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,Le(Be,this,_f).call(this));r!==!1&&Le(Be,this,qd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,kN).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,LN).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,kN).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,LN).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,Zoe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,Qoe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,qoe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,Joe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,$N).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,$N).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,ese).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,tse).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,ise).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,ose).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,nse).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,rse).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,sse).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,ase).call(n,...i)}),this.indexSyncer=new Woe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,Xoe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,lse).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Le(Be,n,Koe).call(n,...i)}),au(md,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){au(md,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),NN(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Eoe(this.hot.getSettings());Toe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(ae(r)&&ae(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,Le(Be,this,_f).call(this));Le(Be,this,qd).call(this,o)}}super.updatePlugin(e)}destroy(){au(md,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),za(md,this,null),NN(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ae(n)&&!B$(n))return qe("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return qe("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return qe(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){iT(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Le(Be,this,qd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Zn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),HN(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ae(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ae(l)===!1||ae(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=HN(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){qe(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return tP(r,o.type)&&(hW(r,o.dateFormat)?r=dW(r,o.dateFormat):Noe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function qd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function wW(t,e,n){if(Te(n)&&n!==null){const r=this.hot.toVisualRow(t),i=this.hot.toVisualColumn(e),o=this.hot.getCellMeta(r,i).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function _f(t,e,n,r){return this.hot.getSourceDataArray(t,e,n,r).map((i,o)=>i.map((s,a)=>Le(Be,this,wW).call(this,o,a,s)))}function qoe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&qn(s)&&(s=fW(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Koe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:p}=h.start,{row:y,col:T}=h.end,b=y-m+1,M=T-p+1;for(let R=0;R<f.length;R+=1)for(let k=0;k<f[R].length;k+=1){const P=f[R][k],O=m+R%b,U=p+k%M,G=this.hot.getCellMeta(O,U);tP(P,G.type)&&(P.startsWith("'")?f[R][k]=P.slice(1):this.isFormulaCellType(O,U,this.sheetId)===!1&&(f[R][k]=Doe(P,G.dateFormat)))}return f}function kN(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Zn(Kn))||za(bv,this,It(this.hot.getSettings().data))}function Xoe(){if(au(bv,this)){this.switchSheet(this.sheetName);return}const t=Le(Be,this,_f).call(this);t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;tP(i,s.type)&&(hW(i,a)?t[r][o]=dW(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),za(Vs,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),za(Vs,this,!1)}function LN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Zn(Kn)))return;const r=xoe(this.engine,this.hot.getSettings()[Kn].sheetName);if(Le(Be,this,qd).call(this,r),n!=="updateSettings")if(au(bv,this))this.switchSheet(this.sheetName);else{const i=Le(Be,this,_f).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){za(Vs,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),za(Vs,this,!1)}}}function Zoe(t,e,n,r){if(r!=="get"||au(Vs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=Hoe(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&qn(s)&&(s=fW(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Qoe(t,e,n,r){if(r!=="get"||au(Vs,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function $N(t,e){if(Ch(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};l=Le(Be,this,wW).call(this,c,h,l),c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Joe(t,e){if(Ch(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!qn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){qe(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function ese(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function tse(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function nse(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function rse(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ise(t,e,n){if(Ch(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ose(t,e,n){if(Ch(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function sse(t,e,n,r){if(Ch(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ase(t,e,n,r){if(Ch(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function lse(t,e,n){var r;za(Vs,this,!0);const i=Le(Be,this,_f).call(this,n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());za(Vs,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function use(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function cse(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function hse(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function dse(t){this.hot.runHooks("afterSheetAdded",t)}function fse(t,e){Le(Be,this,qd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function gse(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function mse(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(C_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function pse(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(y_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Je(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function wse(t,e){vW(t,e),e.add(t)}function vse(t,e,n){vW(t,e),e.set(t,n)}function vW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tl(t,e){return t.get(Sa(t,e))}function FN(t,e,n){return t.set(Sa(t,e),n),n}function Sa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideColumns");oe.getSingleton().register("afterHideColumns");oe.getSingleton().register("beforeUnhideColumns");oe.getSingleton().register("afterUnhideColumns");const VN="hiddenColumns",Cse=310;var So=new WeakMap,_l=new WeakSet;class yse extends Ke{constructor(){super(...arguments),wse(this,_l),vse(this,So,null)}static get PLUGIN_KEY(){return VN}static get PLUGIN_PRIORITY(){return Cse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[VN]}enablePlugin(){var e=this;this.enabled||(FN(So,this,new Qw),Tl(So,this).addLocalHook("init",()=>Sa(_l,this,_se).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Tl(So,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(_l,e,Tse).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Sa(_l,this,bse).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Sa(_l,this,Sse).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(_l,e,Ese).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Sa(_l,this,Rse).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Tl(So,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));I(l,u=>{o[u]=!1}),i=wn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Tl(So,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{Tl(So,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Je(Tl(So,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Tl(So,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){FN(So,this,null),super.destroy()}}function Sse(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function bse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Rse(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return I(t,r=>{let i=!0,o=0;me(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Ese(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Y(e,n)}function Tse(t){t.items.push({name:ze},mse(this),pse(this))}function _se(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Mse(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(S_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Pse(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(b_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Je(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Ise(t,e){CW(t,e),e.add(t)}function Ose(t,e,n){CW(t,e),e.set(t,n)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e){return t.get(ba(t,e))}function WN(t,e,n){return t.set(ba(t,e),n),n}function ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeHideRows");oe.getSingleton().register("afterHideRows");oe.getSingleton().register("beforeUnhideRows");oe.getSingleton().register("afterUnhideRows");const BN="hiddenRows",xse=320;var bo=new WeakMap,Pl=new WeakSet;class Ase extends Ke{constructor(){super(...arguments),Ise(this,Pl),Ose(this,bo,null)}static get PLUGIN_KEY(){return BN}static get PLUGIN_PRIORITY(){return xse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[BN]}enablePlugin(){var e=this;this.enabled||(WN(bo,this,new Qw),Ml(bo,this).addLocalHook("init",()=>ba(Pl,this,$se).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ml(bo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Pl,e,Lse).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>ba(Pl,this,Nse).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>ba(Pl,this,Hse).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ba(Pl,e,kse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>ba(Pl,this,Dse).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ml(bo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));I(l,u=>{o[u]=!1}),i=wn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ml(bo,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{Ml(bo,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Je(Ml(bo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ml(bo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){WN(bo,this,null),super.destroy()}}function Hse(t,e){return this.isHidden(e)?0:t}function Nse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Dse(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return I(t,r=>{let i=!0,o=0;me(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function kse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Y(e,n)}function Lse(t){t.items.push({name:ze},Mse(this),Pse(this))}function $se(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Fse(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(KT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Vse(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(XT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Wse(t,e){yW(t,e),e.add(t)}function Bse(t,e,n){yW(t,e),e.set(t,n)}function yW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zE(t,e){return t.get(tw(t,e))}function nR(t,e,n){return t.set(tw(t,e),n),n}function tw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnFreeze");oe.getSingleton().register("afterColumnFreeze");oe.getSingleton().register("beforeColumnUnfreeze");oe.getSingleton().register("afterColumnUnfreeze");const jN="manualColumnFreeze",jse=110;var jl=new WeakMap,rR=new WeakSet;class Use extends Ke{constructor(){super(...arguments),Wse(this,rR),Bse(this,jl,!1)}static get PLUGIN_KEY(){return jN}static get PLUGIN_PRIORITY(){return jse}isEnabled(){return!!this.hot.getSettings()[jN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>tw(rR,this,zse).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>tw(rR,this,Yse).call(this,e,n)),super.enablePlugin())}disablePlugin(){nR(jl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;zE(jl,this)||nR(jl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;zE(jl,this)||nR(jl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function zse(t){t.items.push({name:"---------"},Fse(this),Vse(this))}function Yse(t,e){if(zE(jl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function fm(t,e,n){return(e=Gse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=qse(t,"string");return typeof e=="symbol"?e:e+""}function qse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iR=0,UN=1,zN=2,ic="px";let SW=class{constructor(e){fm(this,"hot",void 0),fm(this,"_element",null),fm(this,"state",iR),fm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=zN}build(){this.state===iR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=UN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=iR}isAppended(){return this.state===zN}isBuilt(){return this.state>=UN}setPosition(e,n){qn(e)&&(this._element.style.top=e+ic),qn(n)&&(this._element.style[this.inlineProperty]=n+ic)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){qn(e)&&(this._element.style.width=e+ic),qn(n)&&(this._element.style.height=n+ic)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){qn(e)&&(this._element.style.marginTop=e+ic),qn(n)&&(this._element.style[`margin${Zn(this.inlineProperty)}`]=n+ic)}getOffset(){const e=this._element.style,n=`margin${Zn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Kse="ht__manualColumnMove--backlight";let Xse=class extends SW{build(){super.build(),Y(this._element,Kse)}};const Zse="ht__manualColumnMove--guideline";let Qse=class extends SW{build(){super.build(),Y(this._element,Zse)}};function Jse(t,e){bW(t,e),e.add(t)}function ji(t,e,n){bW(t,e),e.set(t,n)}function bW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(t,e,n){return t.set(Ra(t,e),n),n}function de(t,e){return t.get(Ra(t,e))}function Ra(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeColumnMove");oe.getSingleton().register("afterColumnMove");const oR="manualColumnMove",eae=120,YN="ht__manualColumnMove",nw="show-ui",YE="on-moving--columns",GE="after-selection--columns";var ur=new WeakMap,_a=new WeakMap,As=new WeakMap,hp=new WeakMap,Ha=new WeakMap,lr=new WeakMap,gm=new WeakMap,mi=new WeakMap,bc=new WeakMap,rw=new WeakMap,Kd=new WeakMap,Il=new WeakSet;class tae extends Ke{constructor(){super(...arguments),Jse(this,Il),ji(this,ur,new Xse(this.hot)),ji(this,_a,new Qse(this.hot)),ji(this,As,[]),ji(this,hp,0),ji(this,Ha,!1),ji(this,lr,{}),ji(this,gm,void 0),ji(this,mi,void 0),ji(this,bc,void 0),ji(this,rw,void 0),ji(this,Kd,void 0)}static get PLUGIN_KEY(){return oR}static get PLUGIN_PRIORITY(){return eae}isEnabled(){return!!this.hot.getSettings()[oR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Il,e,nae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Il,e,iae).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ra(Il,this,sae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ra(Il,e,aae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,YN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ce(this.hot.rootElement,YN),this.unregisterEvents(),de(ur,this).destroy(),de(_a,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=de(gm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Ir(gm,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Ir(gm,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=wn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[oR];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(de(mi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,de(mi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=de(ur,this).getOffset().start,u=de(ur,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,p=Xt(this.hot.rootElement),y=m.innerWidth-de(bc,this)-p;h=m.innerWidth-de(lr,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=de(lr,this).eventPageX-(de(bc,this)-(r.scrollX===void 0?i:0));if(de(rw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(de(mi,this))&&(o+=i),o+=c,de(mi,this)<0)de(Kd,this)>0?de(lr,this).col=0:de(lr,this).col=e>0?e-1:e;else if(de(lr,this).TD.offsetWidth/2+o<=h){const m=de(mi,this)>=de(hp,this)?de(hp,this)-1:de(mi,this);de(lr,this).col=m+1,o+=de(lr,this).TD.offsetWidth}else de(lr,this).col=de(mi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&de(mi,this)<de(Kd,this)&&(f-=de(bc,this)<=r.scrollX?de(bc,this):0),de(ur,this).setPosition(null,d),de(_a,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ra(Il,this,rae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ra(Il,this,oae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){de(ur,this).build(),de(_a,this).build()}destroy(){de(ur,this).destroy(),de(_a,this).destroy(),super.destroy()}}function nae(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeActive(),a=be(t.target,"sortAction");if(!s||!o||de(Ha,this)||t.button!==0||a){Ir(Ha,this,!1),de(As,this).length=0,ce(this.hot.rootElement,[YE,nw]);return}const l=de(_a,this).isBuilt()&&!de(_a,this).isAppended(),u=de(ur,this).isBuilt()&&!de(ur,this).isAppended();l&&u&&(de(_a,this).appendTo(i.hider),de(ur,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Ir(Ha,this,!0);const m=n.firstChild?u$(t,n.firstChild).x:t.offsetX;de(lr,this).eventPageX=t.pageX,Ir(mi,this,e.col),de(lr,this).TD=n,de(lr,this).col=e.col,Ir(As,this,this.prepareColumnsToMoving(d,f)),Ir(rw,this,!!this.hot.getSettings().rowHeaders),Ir(hp,this,this.hot.countCols()),Ir(Kd,this,this.hot.getSettings().fixedColumnsStart),Ir(bc,this,$n(this.hot.rootElement).left);const p=de(rw,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,T=e.col<de(Kd,this),b=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),R=this.getColumnsWidth(d,e.col-1)+M,k=this.getColumnsWidth(p,d-1)+(T?b:0)+R;de(ur,this).setPosition(y,k),de(ur,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),de(ur,this).setOffset(null,-R),Y(this.hot.rootElement,YE)}else ce(this.hot.rootElement,GE),Ir(Ha,this,!1),de(As,this).length=0}function rae(t){de(Ha,this)&&(de(lr,this).eventPageX=t.pageX,this.refreshPositions())}function iae(t,e,n,r){!this.hot.getSelectedRangeActive()||!de(Ha,this)||(de(As,this).indexOf(e.col)>-1?ce(this.hot.rootElement,nw):Y(this.hot.rootElement,nw),r.row=!0,r.column=!0,r.cell=!0,Ir(mi,this,e.col),de(lr,this).TD=n)}function oae(){const t=de(lr,this).col,e=de(As,this).length;if(Ir(mi,this,void 0),Ir(Ha,this,!1),ce(this.hot.rootElement,[YE,nw,GE]),this.hot.selection.isSelectedByColumnHeader()&&Y(this.hot.rootElement,GE),e<1||t===void 0)return;const n=de(As,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(de(As,this),t);if(de(As,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function sae(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;de(ur,this).setPosition(r),de(ur,this).setSize(null,t.hider.offsetHeight-r)}function aae(){this.moveBySettingsOrLoad()}function lae(t,e){RW(t,e),e.add(t)}function Vn(t,e,n){RW(t,e),e.set(t,n)}function RW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,n){return t.set(Zi(t,e),n),n}function ie(t,e){return t.get(Zi(t,e))}function Zi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iw="manualColumnResize",uae=130,GN="manualColumnWidths";var Es=new WeakMap,mm=new WeakMap,Jr=new WeakMap,ow=new WeakMap,Bo=new WeakMap,cae=new WeakMap,Uc=new WeakMap,pm=new WeakMap,br=new WeakMap,Cs=new WeakMap,gu=new WeakMap,sw=new WeakMap,xc=new WeakMap,Xd=new WeakMap,ti=new WeakMap,Zd=new WeakMap,Ro=new WeakSet;class hae extends Ke{static get PLUGIN_KEY(){return iw}static get PLUGIN_PRIORITY(){return uae}constructor(e){super(e),lae(this,Ro),Vn(this,Es,null),Vn(this,mm,null),Vn(this,Jr,[]),Vn(this,ow,null),Vn(this,Bo,null),Vn(this,cae,null),Vn(this,Uc,null),Vn(this,pm,null),Vn(this,br,this.hot.rootDocument.createElement("DIV")),Vn(this,Cs,this.hot.rootDocument.createElement("DIV")),Vn(this,gu,null),Vn(this,sw,!1),Vn(this,xc,0),Vn(this,Xd,null),Vn(this,ti,void 0),Vn(this,Zd,void 0),Y(ie(br,this),"manualColumnResizer"),Y(ie(Cs,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[iw]}enablePlugin(){var e=this;this.enabled||(Kt(ti,this,new Xa),ie(ti,this).addLocalHook("init",()=>Zi(Ro,this,dae).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ie(ti,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Ro,e,vae).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Ro,e,Cae).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zi(Ro,e,yae).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(Zd,this,ie(ti,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",GN,ie(ti,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",GN,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ie(ti,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ie(ti,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||ie(xc,this)>1)return;Kt(Es,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ie(Es,this)),i=r.col;if(i<0)return;const o=nn(ie(Es,this)),s=ie(Es,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(Es,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ie(Es,this),r.row,r.col)),Kt(mm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Kt(Jr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();I(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;me(d,f,m=>{ie(Jr,this).includes(m)||ie(Jr,this).push(m)})})}ie(Jr,this).includes(ie(mm,this))||Kt(Jr,this,[ie(mm,this)]),Kt(pm,this,l.start-6),Kt(Uc,this,parseInt(s.width,10)),ie(br,this).style.top=`${l.top}px`,ie(br,this).style[this.inlineDir]=`${ie(pm,this)+ie(Uc,this)}px`,ie(br,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ie(br,this))}refreshHandlePosition(){ie(br,this).style[this.inlineDir]=`${ie(pm,this)+ie(ow,this)}px`}setupGuidePosition(){const e=parseInt(nn(ie(br,this)),10),n=parseInt(ie(br,this).style.top,10)+e,r=this.hot.view.getTableHeight();Y(ie(br,this),"active"),Y(ie(Cs,this),"active"),ie(Cs,this).style.top=`${n}px`,this.refreshGuidePosition(),ie(Cs,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ie(Cs,this))}refreshGuidePosition(){ie(Cs,this).style[this.inlineDir]=ie(br,this).style[this.inlineDir]}hideHandleAndGuide(){ce(ie(br,this),"active"),ce(ie(Cs,this),"active")}checkIfColumnHeader(e){const n=Wa(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ie(Bo,this),r,!0);o!==void 0&&Kt(Bo,this,o),this.setManualSize(r,ie(Bo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(Bo,this),r,!0),i&&e()};ie(xc,this)>=2&&(ie(Jr,this).length>1?(I(ie(Jr,this),i=>{n(i)}),e()):I(ie(Jr,this),i=>{n(i,!0)})),Kt(xc,this,0),Kt(Xd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Zi(Ro,this,fae).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Zi(Ro,this,gae).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Zi(Ro,this,mae).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Zi(Ro,this,pae).call(this)),this.eventManager.addEventListener(ie(br,this),"contextmenu",()=>Zi(Ro,this,wae).call(this))}destroy(){super.destroy()}}function dae(){const t=this.hot.getSettings()[iw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ie(ti,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ie(ti,this).setValueAtIndex(r,n)})},!0),Kt(Zd,this,t)):t===!0&&Array.isArray(ie(Zd,this))&&this.hot.batchExecution(()=>{ie(Zd,this).forEach((n,r)=>{ie(ti,this).setValueAtIndex(r,n)})},!0)}function fae(t){if(!J0(t.target)&&ie(sw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ie(gu,this)||this.setupHandlePosition(e))}}function gae(t){t.target.parentNode===this.hot.rootElement&&be(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ie(Es,this)),this.setupGuidePosition(),Kt(gu,this,!0),ie(Xd,this)===null&&(Kt(Xd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(Xd,this))),Kt(xc,this,ie(xc,this)+1),this.startX=t.pageX,Kt(Bo,this,ie(Uc,this)))}function mae(t){if(ie(gu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Kt(ow,this,ie(Uc,this)+e),I(ie(Jr,this),n=>{Kt(Bo,this,this.setManualSize(n,ie(ow,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function pae(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ie(Bo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(Bo,this),n,!1)};ie(gu,this)&&(this.hideHandleAndGuide(),Kt(gu,this,!1),ie(Bo,this)!==ie(Uc,this)&&(ie(Jr,this).length>1?(I(ie(Jr,this),r=>{e(r)}),t()):I(ie(Jr,this),r=>{e(r,!0)})),this.setupHandlePosition(ie(Es,this)))}function wae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(br,this)),this.hot.rootElement.removeChild(ie(Cs,this)),Kt(gu,this,!1),Kt(sw,this,!0),this.hot._registerImmediate(()=>{Kt(sw,this,!1)})}function vae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ie(ti,this).getValueAtIndex(r);this.hot.getSettings()[iw]&&i&&(n=i)}return n}function Cae(t,e){const n=ie(ti,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function yae(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function sR(t,e,n){return(e=Sae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sae(t){var e=bae(t,"string");return typeof e=="symbol"?e:e+""}function bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aR=0,qN=1,KN=2,oc="px";let EW=class{constructor(e){sR(this,"hot",void 0),sR(this,"_element",null),sR(this,"state",aR),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=KN}build(){this.state===aR&&(this._element=this.hot.rootDocument.createElement("div"),this.state=qN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=aR}isAppended(){return this.state===KN}isBuilt(){return this.state>=qN}setPosition(e,n){e!==void 0&&(this._element.style.top=e+oc),n!==void 0&&(this._element.style.left=n+oc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+oc),n&&(this._element.style.height=n+oc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+oc),n&&(this._element.style.marginLeft=n+oc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Rae="ht__manualRowMove--backlight";class Eae extends EW{build(){super.build(),Y(this._element,Rae)}}const Tae="ht__manualRowMove--guideline";class _ae extends EW{build(){super.build(),Y(this._element,Tae)}}function Mae(t,e){TW(t,e),e.add(t)}function sc(t,e,n){TW(t,e),e.set(t,n)}function TW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(t,e,n){return t.set(Ea(t,e),n),n}function xe(t,e){return t.get(Ea(t,e))}function Ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeRowMove");oe.getSingleton().register("afterRowMove");const lR="manualRowMove",Pae=140,XN="ht__manualRowMove",aw="show-ui",qE="on-moving--rows",KE="after-selection--rows";var cr=new WeakMap,Ma=new WeakMap,Hs=new WeakMap,Na=new WeakMap,Or=new WeakMap,wm=new WeakMap,Ol=new WeakSet;class Iae extends Ke{constructor(){super(...arguments),Mae(this,Ol),sc(this,cr,new Eae(this.hot)),sc(this,Ma,new _ae(this.hot)),sc(this,Hs,[]),sc(this,Na,void 0),sc(this,Or,{}),sc(this,wm,void 0)}static get PLUGIN_KEY(){return lR}static get PLUGIN_PRIORITY(){return Pae}isEnabled(){return!!this.hot.getSettings()[lR]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Ol,e,Oae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Ol,e,Aae).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ea(Ol,this,Nae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ea(Ol,e,Dae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,XN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ce(this.hot.rootElement,XN),this.unregisterEvents(),xe(cr,this).destroy(),xe(Ma,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=xe(wm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(nu(wm,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return nu(wm,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=wn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[lR];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return me(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=xe(Or,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=xe(Or,this).TD,a=this.hot.rootElement,l=$n(a),u=qc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=xe(Or,this).eventPageY-d+c,m=o.hider.offsetHeight,p=o.TBODY.offsetTop,y=xe(cr,this).getOffset().top,T=xe(cr,this).getSize().height,b=s.offsetHeight/2,M=s.offsetHeight;let R=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const k=f>=R+b;this.isFixedRowTop(e.row)&&(R+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?xe(Or,this).row=n>0?n-1:n:k?(xe(Or,this).row=e.row+1,R+=e.row===0?M-1:M):xe(Or,this).row=e.row;let P=f,O=R;f+T+y>=m?P=m-T-y:f+y<p&&(P=p+Math.abs(y)),R>=m-1&&(O=m-1),xe(cr,this).setPosition(P),xe(Ma,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ea(Ol,this,xae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ea(Ol,this,Hae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){xe(cr,this).build(),xe(Ma,this).build()}destroy(){xe(cr,this).destroy(),xe(Ma,this).destroy(),super.destroy()}}function Oae(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!s||xe(Na,this)||t.button!==0){nu(Na,this,!1),xe(Hs,this).length=0,ce(this.hot.rootElement,[qE,aw]);return}const l=xe(Ma,this).isBuilt()&&!xe(Ma,this).isAppended(),u=xe(cr,this).isBuilt()&&!xe(cr,this).isAppended();l&&u&&(xe(Ma,this).appendTo(i.hider),xe(cr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,nu(Na,this,!0),xe(Or,this).eventPageY=t.pageY,xe(Or,this).coords=e,xe(Or,this).TD=n,nu(Hs,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+o.getRowHeaderWidth(),p=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);xe(cr,this).setPosition(null,m),xe(cr,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),xe(cr,this).setOffset(-p,null),Y(this.hot.rootElement,qE),this.refreshPositions()}else ce(this.hot.rootElement,KE),nu(Na,this,!1),xe(Hs,this).length=0}function xae(t){xe(Na,this)&&(xe(Or,this).eventPageY=t.pageY,this.refreshPositions())}function Aae(t,e,n,r){!this.hot.getSelectedRangeActive()||!xe(Na,this)||(xe(Hs,this).indexOf(e.row)>-1?ce(this.hot.rootElement,aw):Y(this.hot.rootElement,aw),r.row=!0,r.column=!0,r.cell=!0,xe(Or,this).coords=e,xe(Or,this).TD=n)}function Hae(){const t=xe(Or,this).row,e=xe(Hs,this).length;if(nu(Na,this,!1),ce(this.hot.rootElement,[qE,aw,KE]),this.hot.selection.isSelectedByRowHeader()&&Y(this.hot.rootElement,KE),e<1||t===void 0)return;const n=xe(Hs,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(xe(Hs,this),t);if(xe(Hs,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Nae(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;xe(cr,this).setPosition(null,r),xe(cr,this).setSize(t.hider.offsetWidth-r)}function Dae(){this.moveBySettingsOrLoad()}function kae(t,e){_W(t,e),e.add(t)}function Wn(t,e,n){_W(t,e),e.set(t,n)}function _W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e,n){return t.set(Ts(t,e),n),n}function re(t,e){return t.get(Ts(t,e))}function Ts(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lw="manualRowResize",Lae=30,ZN="manualRowHeights";var ko=new WeakMap,vm=new WeakMap,ei=new WeakMap,Qd=new WeakMap,Pa=new WeakMap,rP=new WeakMap,zc=new WeakMap,Cm=new WeakMap,ir=new WeakMap,Ho=new WeakMap,mu=new WeakMap,uw=new WeakMap,Ac=new WeakMap,Jd=new WeakMap,eo=new WeakMap,ef=new WeakMap,ha=new WeakSet;class $ae extends Ke{static get PLUGIN_KEY(){return lw}static get PLUGIN_PRIORITY(){return Lae}constructor(e){super(e),kae(this,ha),Wn(this,ko,null),Wn(this,vm,null),Wn(this,ei,[]),Wn(this,Qd,null),Wn(this,Pa,null),Wn(this,rP,null),Wn(this,zc,null),Wn(this,Cm,null),Wn(this,ir,this.hot.rootDocument.createElement("DIV")),Wn(this,Ho,this.hot.rootDocument.createElement("DIV")),Wn(this,mu,!1),Wn(this,uw,!1),Wn(this,Ac,0),Wn(this,Jd,null),Wn(this,eo,void 0),Wn(this,ef,void 0),Y(re(ir,this),"manualRowResizer"),Y(re(Ho,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[lw]}enablePlugin(){this.enabled||(Vt(eo,this,new Xa),re(eo,this).addLocalHook("init",()=>Ts(ha,this,zae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re(eo,this)),this.addHook("modifyRowHeight",(e,n)=>Ts(ha,this,Uae).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Vt(ef,this,re(eo,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",ZN,re(eo,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",ZN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return re(eo,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(Qd,this)}setupHandlePosition(e){if(re(Ac,this)>1)return;Vt(ko,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(ko,this)),o=i.row;if(o<0)return;const s=Xt(re(ko,this)),a=re(ko,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(ko,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(ko,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(ko,this),i.row,i.col)),Vt(vm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Vt(ei,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();I(d,f=>{const m=f.getTopStartCorner().row,p=f.getBottomStartCorner().row;me(m,p,y=>{re(ei,this).includes(y)||re(ei,this).push(y)})})}re(ei,this).includes(re(vm,this))||Vt(ei,this,[re(vm,this)]),Vt(Cm,this,c.top-6),Vt(zc,this,parseInt(a.height,10)),re(ir,this).style.top=`${re(Cm,this)+re(zc,this)}px`,re(ir,this).style[this.inlineDir]=`${c.start}px`,re(ir,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(ir,this))}refreshHandlePosition(){re(ir,this).style.top=`${re(Cm,this)+re(Qd,this)}px`}setupGuidePosition(){const e=parseInt(Xt(re(ir,this)),10),n=parseInt(re(ir,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();Y(re(ir,this),"active"),Y(re(Ho,this),"active"),re(Ho,this).style.top=re(ir,this).style.top,re(Ho,this).style[this.inlineDir]=`${n}px`,re(Ho,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(Ho,this))}refreshGuidePosition(){re(Ho,this).style.top=re(ir,this).style.top}hideHandleAndGuide(){ce(re(ir,this),"active"),ce(re(Ho,this),"active")}checkIfRowHeader(e){const n=Wa(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(Pa,this)<n?n:re(Pa,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Vt(Pa,this,o),this.setManualSize(r,re(Pa,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(Ac,this)>=2&&(re(ei,this).length>1?(I(re(ei,this),i=>{n(i)}),e()):I(re(ei,this),i=>{n(i,!0)})),Vt(Ac,this,0),Vt(Jd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ts(ha,this,Fae).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ts(ha,this,Vae).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ts(ha,this,Wae).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ts(ha,this,Bae).call(this)),this.eventManager.addEventListener(re(ir,this),"contextmenu",()=>Ts(ha,this,jae).call(this))}destroy(){super.destroy()}}function Fae(t){if(!J0(t.target)&&re(uw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(mu,this)||this.setupHandlePosition(e))}}function Vae(t){be(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(ko,this)),this.setupGuidePosition(),Vt(mu,this,!0),re(Jd,this)===null&&(Vt(Jd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(Jd,this))),Vt(Ac,this,re(Ac,this)+1),Vt(rP,this,t.pageY),Vt(Pa,this,re(zc,this)))}function Wae(t){re(mu,this)&&(Vt(Qd,this,re(zc,this)+(t.pageY-re(rP,this))),I(re(ei,this),e=>{Vt(Pa,this,this.setManualSize(e,re(Qd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Bae(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(mu,this)&&(this.hideHandleAndGuide(),Vt(mu,this,!1),re(Pa,this)!==re(zc,this)&&(re(ei,this).length>1?(I(re(ei,this),r=>{e(r)}),t()):I(re(ei,this),r=>{e(r,!0)})),this.setupHandlePosition(re(ko,this)))}function jae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(ir,this)),this.hot.rootElement.removeChild(re(Ho,this)),Vt(mu,this,!1),Vt(uw,this,!0),this.hot._registerImmediate(()=>{Vt(uw,this,!1)})}function Uae(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),o=re(eo,this).getValueAtIndex(i);if(this.hot.getSettings()[lw]&&o){var r;(r=this.hot.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.isEnabled()?n=Math.max(o,n??0):n=o}}return n}function zae(){const t=this.hot.getSettings()[lw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re(eo,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re(eo,this).setValueAtIndex(r,n)}),Vt(ef,this,t)):t===!0&&Array.isArray(re(ef,this))&&re(ef,this).forEach((n,r)=>{re(eo,this).setValueAtIndex(r,n)})},!0)}var QN={},JN;function Yae(){if(JN)return QN;JN=1;var t=Gw();return t("flatMap"),QN}Yae();var eD={},tD={},uR,nD;function Gae(){if(nD)return uR;nD=1;var t=gn(),e=pn(),n=Xo(),r=c0();return uR=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},uR}var rD;function qae(){if(rD)return tD;rD=1;var t=Et(),e=gn(),n=Hr(),r=pn(),i=Xo(),o=Gae(),s=f0(),a=Nr(),l=Ya(),u=g0(),c=qa(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,m=s(function(){for(var p=this.iterator,y=this.mapper,T,b;;){if(b=this.inner)try{if(T=r(e(b.next,b.iterator)),!T.done)return T.value;this.inner=null}catch(M){a(p,"throw",M)}if(T=r(e(this.next,p)),this.done=!!T.done)return;try{this.inner=o(y(T.value,this.counter++),!1)}catch(M){a(p,"throw",M)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(y){r(this);try{n(y)}catch(T){a(this,"throw",T)}return d?e(d,this,y):new m(i(this),{mapper:y,inner:null})}}),tD}var iD;function Kae(){return iD||(iD=1,qae()),eD}Kae();function Xae(t,e,n){Zae(t,e),e.set(t,n)}function Zae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e,n){return(e=Qae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qae(t){var e=Jae(t,"string");return typeof e=="symbol"?e:e+""}function Jae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oD(t,e){return t.get(MW(t,e))}function ym(t,e,n){return t.set(MW(t,e),n),n}function MW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Al=new WeakMap;class Lo{constructor(e,n,r,i,o,s){xl(this,"row",void 0),xl(this,"col",void 0),xl(this,"rowspan",void 0),xl(this,"colspan",void 0),xl(this,"removed",!1),xl(this,"cellCoordsFactory",void 0),xl(this,"cellRangeFactory",void 0),Xae(this,Al,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return it`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),ym(Al,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,ym(Al,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return ym(Al,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return oD(Al,this)||ym(Al,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),oD(Al,this)}}function ele(t,e){tle(t,e),e.add(t)}function tle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sm(t,e,n){return(e=nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nle(t){var e=rle(t,"string");return typeof e=="symbol"?e:e+""}function rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var da=new WeakSet;class cw{constructor(e){ele(this,da),Sm(this,"plugin",void 0),Sm(this,"mergedCells",[]),Sm(this,"mergedCellsMatrix",new Map),Sm(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return it`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){qe(cw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Lo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Hl(da,this,sD).call(this,a),a):(u&&qe(cw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Hl(da,this,ile).call(this,r),r):!1}clear(){I(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;me(n,n+i,s=>{me(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ue(u,i,i+s-1),d=Ue(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Hl(da,this,bm).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Hl(da,this,bm).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Hl(da,this,bm).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Hl(da,this,bm).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Hl(da,this,sD).call(this,s)})}}function bm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function sD(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function ile(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function cR(t,e,n){return(e=ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ole(t){var e=sle(t,"string");return typeof e=="symbol"?e:e+""}function sle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ale{constructor(e){cR(this,"plugin",void 0),cR(this,"mergedCellsCollection",void 0),cR(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,p=this.getFarthestCollection(e,n,r,i);if(p){if(r==="down"){const y=p.row+p.rowspan-a-m;o[2]+y>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?y:0}else if(r==="right"){const y=p.col+p.colspan-l-m;o[3]+y>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?y:0}else if(r==="up"){const y=u-m-p.row+1;o[0]+y<0?o[0]+=m:o[0]-=m?y:0}else if(r==="left"){const y=c-m-p.col+1;o[1]+y<0?o[1]+=m:o[1]-=m?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),on(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,p=d-m;let y=null,T=null,b=null;switch(r){case"up":y="includesVertically",b=c-p+1;break;case"left":y="includesHorizontally",b=c-p+1;break;case"down":y="includesVertically",b=h+p-1;break;case"right":y="includesHorizontally",b=h+p-1;break}return I(i,M=>{M[y](b)&&M.isFarther(T,r)&&(T=M)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return I(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(m=>{let{colspan:p}=m;return p===h.getWidth()}):!f.every(m=>{let{rowspan:p}=m;return p===h.getHeight()})}}function hR(t,e,n){return(e=lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lle(t){var e=ule(t,"string");return typeof e=="symbol"?e:e+""}function ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cle{constructor(e){hR(this,"plugin",void 0),hR(this,"hot",void 0),hR(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function hle(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(QT)}return this.getTranslatedPhrase(ZT)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedActive();return e?Lo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function tf(t,e,n){return(e=dle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dle(t){var e=fle(t,"string");return typeof e=="symbol"?e:e+""}function fle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aD{constructor(e){tf(this,"data",void 0),tf(this,"next",null),tf(this,"prev",null),this.data=e}}class Rm{constructor(){tf(this,"first",null),tf(this,"last",null)}push(e){const n=new aD(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new aD(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function gle(t,e){PW(t,e),e.add(t)}function Nl(t,e,n){PW(t,e),e.set(t,n)}function PW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(hw(t,e))}function jr(t,e,n){return t.set(hw(t,e),n),n}function hw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eo=new WeakMap,To=new WeakMap,_o=new WeakMap,Mo=new WeakMap,XE=new WeakMap,Em=new WeakMap,Tm=new WeakMap,dR=new WeakSet;class mle{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;gle(this,dR),Nl(this,Eo,new Rm),Nl(this,To,new Rm),Nl(this,_o,null),Nl(this,Mo,null),Nl(this,XE,null),Nl(this,Em,null),Nl(this,Tm,null),jr(XE,this,n),jr(Em,this,r),jr(Tm,this,i)}getCurrentVerticalNode(){return ht(Mo,this).data}getFirstVerticalNode(){return ht(To,this).first.data}getNextVerticalNode(){return ht(Mo,this).next.data}getPrevVerticalNode(){return ht(Mo,this).prev.data}getCurrentHorizontalNode(){return ht(_o,this).data}getFirstHorizontalNode(){return ht(Eo,this).first.data}getNextHorizontalNode(){return ht(_o,this).next.data}getPrevHorizontalNode(){return ht(_o,this).prev.data}setPrevNodeAsActive(){jr(Mo,this,ht(Mo,this).prev),jr(_o,this,ht(_o,this).prev)}setNextNodeAsActive(){jr(Mo,this,ht(Mo,this).next),jr(_o,this,ht(_o,this).next)}buildFocusOrder(e){jr(Eo,this,new Rm),e.forEach((n,r)=>{const i=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.row;a<=s.row;a++)if(!ht(Em,this).isHidden(a))for(let l=o.col;l<=s.col;l++){if(ht(Tm,this).isHidden(l))continue;const u=hw(dR,this,lD).call(this,{selectedRange:n,selectionLayer:r,listOrder:ht(Eo,this),mergeCellsVisitor:i,row:a,column:l});u&&jr(_o,this,u)}}),ht(Eo,this).first&&(ht(Eo,this).first.prev=ht(Eo,this).last,ht(Eo,this).last.next=ht(Eo,this).first),jr(To,this,new Rm),e.forEach((n,r)=>{const i=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.col;a<=s.col;a++)if(!ht(Tm,this).isHidden(a))for(let l=o.row;l<=s.row;l++){if(ht(Em,this).isHidden(l))continue;const u=hw(dR,this,lD).call(this,{selectedRange:n,selectionLayer:r,listOrder:ht(To,this),mergeCellsVisitor:i,row:l,column:a});u&&jr(Mo,this,u)}}),ht(To,this).first&&(ht(To,this).first.prev=ht(To,this).last,ht(To,this).last.next=ht(To,this).first)}setActiveNode(e,n,r){return ht(Eo,this).inorder(i=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=i.data;if(o===r&&e>=s&&e<=a&&n>=l&&n<=u)return jr(_o,this,i),!0}),ht(To,this).inorder(i=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=i.data;if(o===r&&e>=s&&e<=a&&n>=l&&n<=u)return jr(Mo,this,i),!0}),this}}function lD(t){let{selectedRange:e,selectionLayer:n,listOrder:r,mergeCellsVisitor:i,row:o,column:s}=t;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),c=ht(XE,this).call(this,o,s);if(c&&i.has(c))return null;const h={selectionLayer:n,colStart:s,colEnd:s,rowStart:o,rowEnd:o};if(c){if(i.add(c),c.row<a.row||c.row+c.rowspan-1>l.row||c.col<a.col||c.col+c.colspan-1>l.col)return null;h.colStart=c.col,h.colEnd=c.col+c.colspan-1,h.rowStart=c.row,h.rowEnd=c.row+c.rowspan-1}const d=r.push(h);return o===u.row&&s===u.col||c&&u.row>=c.row&&u.row<=c.row+c.rowspan-1&&u.col>=c.col&&u.col<=c.col+c.colspan-1?d:null}function IW(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function ple(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Te(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[p,y]=t.translateMergedCellToRenderable(h,m,d,f),T=t.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const V=e._getRowHeightFromSettings(l);if(V!==void 0){const z=e.stylesHandler.areCellsBorderBox()?0:1;i.set(l,V-z)}else if(Bf()){const Z=IW(e,h,m);i.set(l,Z/m)}}const b=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),R=p-b+1,k=y-M+1;let P=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(T){const V=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(V)||(P=Math.max(P,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(V)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const U=Math.min(m,R),G=Math.min(f,k);P===l&&O===u?(a.setAttribute("rowspan",U),a.setAttribute("colspan",G)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function wle(t,e){OW(t,e),e.add(t)}function _m(t,e,n){OW(t,e),e.set(t,n)}function OW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fR(t,e,n){return(e=vle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vle(t){var e=Cle(t,"string");return typeof e=="symbol"?e:e+""}function Cle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mf(t,e,n){return t.set(gt(t,e),n),n}function bt(t,e){return t.get(gt(t,e))}function gt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}oe.getSingleton().register("beforeMergeCells");oe.getSingleton().register("afterMergeCells");oe.getSingleton().register("beforeUnmergeCells");oe.getSingleton().register("afterUnmergeCells");const ZE="mergeCells",yle=150,uD=ZE;var Ei=new WeakMap,Ti=new WeakMap,jo=new WeakMap,cD=new WeakMap,Ct=new WeakSet;class Sle extends Ke{constructor(){super(...arguments),wle(this,Ct),fR(this,"mergedCellsCollection",null),fR(this,"autofillCalculations",null),fR(this,"selectionCalculations",null),_m(this,Ei,null),_m(this,Ti,{row:0,col:0}),_m(this,jo,new mle({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_m(this,cD,ple(this))}static get PLUGIN_KEY(){return ZE}static get PLUGIN_PRIORITY(){return yle}static get DEFAULT_SETTINGS(){return{[qF]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[ZE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new cw(this),this.autofillCalculations=new ale(this),this.selectionCalculations=new cle(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,ble).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ele).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Tle).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,_le).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Mle).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,dD).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,dD).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ile).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ole).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,xle).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,hD).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,hD).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Rle).call(e,...r)}),this.addHook("afterRenderer",function(){return bt(cD,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ple).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ale).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Hle).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Nle).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Dle).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,kle).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Lle).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,$le).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Fle).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Vle).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Wle).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ble).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,jle).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,Ule).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gt(Ct,e,zle).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!j0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=ff(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=ff(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Lo.containsNegativeValues(e)?(qe(Lo.NEGATIVE_VALUES_WARNING(e)),!1):Lo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(qe(Lo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Lo.isSingleCell(e)?(qe(Lo.IS_SINGLE_CELL(e)),!1):Lo.containsZeroSpan(e)?(qe(Lo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),I(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,o=>{me(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeActive();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:uD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uD)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Te(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Te(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Te(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Te(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function ble(){this.generateFromSettings(),this.hot.render()}function Rle(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Ele(t){bt(Ti,this).row=t.row,bt(Ti,this).col=t.col}function Tle(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;bt(Ei,this)&&(i.getRenderableFromVisualIndex(bt(Ei,this).row)!==null&&(n.row=bt(Ei,this).row),r.getRenderableFromVisualIndex(bt(Ei,this).col)!==null&&(n.col=bt(Ei,this).col),Mf(Ei,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function _le(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Mle(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Mf(Ei,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Mf(Ei,this,e.clone()),n&&e.assign(n)}function hD(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),p=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ue(m,u,h),Ue(p,c,d),Ue(this.hot.getLastRenderedVisibleRow(),u,h),Ue(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Ple(t){t.items.push({name:"---------"},hle(this))}function dD(){Mf(Ei,this,null)}function Ile(){if(bt(Ei,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=bt(Ei,this).clone().normalize();bt(jo,this).setActiveNode(r.row,r.col),bt(Ti,this).row>0||bt(Ti,this).col>0?bt(jo,this).setPrevNodeAsActive():(n==="E-W"&&bt(Ti,this).col<0||e==="S-N"&&bt(Ti,this).row<0)&&bt(jo,this).setNextNodeAsActive()}function Ole(t,e){const{columnIndexMapper:n,rowIndexMapper:r}=this.hot;let i=this.hot.getActiveSelectionLayerIndex(),o=null,s=null;if(bt(Ti,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(jo,this).getPrevHorizontalNode();s=n.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1),i=u}else if(bt(Ti,this).col>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(jo,this).getNextHorizontalNode();s=n.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1),i=u}else if(bt(Ti,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(jo,this).getPrevVerticalNode();s=n.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1),i=u}else if(bt(Ti,this).row>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(jo,this).getNextVerticalNode();s=n.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1),i=u}if(o!==null||s!==null){this.hot.selection.setActiveSelectionLayerIndex(i);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(o,s),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(l),c.clear(),c.add(l).commit()}bt(jo,this).setActiveNode(t,e,i),Mf(Ti,this,{row:0,col:0})}function xle(){bt(jo,this).buildFocusOrder(this.hot.getSelectedRange())}function Ale(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Hle(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Nle(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Dle(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function kle(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Lle(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function $le(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Fle(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Vle(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Wle(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),r=this.mergedCellsCollection.getWithinRange(n);I(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Ble(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function jle(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Ule(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function zle(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,IW(this.hot,e,m))}),t}function Yle(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:oV(u.type))(l,u,d)(c,h);if(m===Yo){const p=a+1;if(typeof e[p]<"u")return s(p)}return m}(0)}}const xW="sort";function Gle(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${xW}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function qle(t){const e=t.className.split(" "),n=new RegExp(`^${xW}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Kle(t,e,n){return(e=Xle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xle(t){var e=Zle(t,"string");return typeof e=="symbol"?e:e+""}function Zle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dw="multiColumnSorting",Qle=170,fD=dw;iV(dw,Yle);class Jle extends gV{constructor(){super(...arguments),Kle(this,"pluginKey",dw)}static get PLUGIN_KEY(){return dw}static get PLUGIN_PRIORITY(){return Qle}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Yp)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Za,position:"before",group:fD})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fD)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),ce(e,qle(e)),this.enabled!==!1&&Y(e,Gle(...r))}onAfterOnCellMouseDown(e,n){BM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Yp))):this.sort(this.getColumnNextConfig(n.col)))}}function gD(t,e,n){return(e=eue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eue(t){var e=tue(t,"string");return typeof e=="symbol"?e:e+""}function tue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nue="multipleSelectionHandles",rue=160;class iue extends Ke{constructor(){super(...arguments),gD(this,"dragged",[]),gD(this,"lastSetCell",null)}static get PLUGIN_KEY(){return nue}static get PLUGIN_PRIORITY(){return rue}isEnabled(){return ro()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(be(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(be(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(be(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function QE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function AW(){return{label:"",isPlaceholder:!0}}function oue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;I(t,i=>{const o=[];let s=0;n.push(o),I(i,a=>{const l=QE();if(Te(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Rt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Rt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(AW());return!u})});const r=Math.max(...Je(n,i=>i.length));return I(n,i=>{if(i.length<r){const o=Je(new Array(r-i.length),()=>QE());i.splice(i.length,0,...o)}}),n}function gR(t,e,n){sue(t,e),e.set(t,n)}function sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(t,e){return t.get(HW(t,e))}function pd(t,e,n){return t.set(HW(t,e),n),n}function HW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mD=["label","collapsible"];var ms=new WeakMap,Dl=new WeakMap,mR=new WeakMap;class aue{constructor(){gR(this,ms,[]),gR(this,Dl,0),gR(this,mR,1/0)}setColumnsLimit(e){pd(mR,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];pd(ms,this,oue(e,Ui(mR,this))),pd(Dl,this,Ui(ms,this).length)}getData(){return Ui(ms,this)}mergeWith(e){I(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&on(s,o,mD)})}map(e){I(Ui(ms,this),n=>{I(n,r=>{const i=e({...r});Te(i)&&on(r,i,mD)})})}getHeaderSettings(e,n){var r;if(e>=Ui(Dl,this)||e<0)return null;const i=Ui(ms,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ui(Dl,this)||e<0)return i;const o=Ui(ms,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ui(Dl,this)}getColumnsCount(){return Ui(Dl,this)>0?Ui(ms,this)[0].length:0}clear(){pd(ms,this,[]),pd(Dl,this,0)}}function pR(t,e,n){return(e=lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lue(t){var e=uue(t,"string");return typeof e=="symbol"?e:e+""}function uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NW="DF-pre-order";function DW(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=DW.call(this.childs[r],t,e)}return n}const cue="DF-post-order";function kW(t,e){for(let n=0;n<this.childs.length;n++)if(kW.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const LW="BF";function hue(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const due=LW,pD=new Map([[NW,DW],[cue,kW],[LW,hue]]);class fw{constructor(e){pR(this,"data",{}),pR(this,"parent",null),pR(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new fw({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:due;if(!pD.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);pD.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function wR(t,e,n){fue(t,e),e.set(t,n)}function fue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e){return t.get($W(t,e))}function gue(t,e,n){return t.set($W(t,e),n),n}function $W(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ac=new WeakMap,kl=new WeakMap,lc=new WeakMap;class mue{constructor(e){wR(this,ac,new Map),wR(this,kl,new Map),wR(this,lc,null),gue(lc,this,e)}getRoots(){return Array.from(rr(ac,this).values())}getRootByColumn(e){let n;return rr(kl,this).has(e)&&(n=rr(ac,this).get(rr(kl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-rr(kl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;rr(kl,this).clear(),I(rr(ac,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)rr(kl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=rr(lc,this).getColumnsCount();let n=0;for(;n<e;){const r=rr(lc,this).getHeaderSettings(0,n),i=new fw;rr(ac,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=rr(lc,this).getHeadersSettings(r,n,i);r+=1,I(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new fw(a),e.addChild(l)),r<rr(lc,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){rr(ac,this).clear(),rr(kl,this).clear()}}function FW(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function gw(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function mw(t){return gw(t,"origColspan")===t.data.origColspan}function iP(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(mw(t))return iP(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)I(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,FW(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):mw(a)&&(l.isCollapsed=gw(a,"isCollapsed"))}),{rollbackModification:()=>oP(t),affectedColumns:Array.from(o),colspanCompensation:s}}function oP(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(mw(t))return oP(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)I(o,l=>{FW(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=gw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):mw(l)&&(u.isCollapsed=gw(l,"isCollapsed"))}),{rollbackModification:()=>iP(t),affectedColumns:Array.from(s),colspanCompensation:a}}function pue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function wue(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const wD=new Map([["collapse",oP],["expand",iP],["hide-column",pue],["show-column",wue]]);function vue(t,e,n){if(!wD.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return wD.get(t)(e,n)}function Mm(t){const e=[];return I(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=yue(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(AW());else{const f=Cue(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function Cue(t){const{crossHiddenColumns:e,...n}=QE(t);return n}function yue(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function vR(t,e,n){Sue(t,e),e.set(t,n)}function Sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e,n){return t.set(VW(t,e),n),n}function $t(t,e){return t.get(VW(t,e))}function VW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Po=new WeakMap,yr=new WeakMap,Ll=new WeakMap;class bue{constructor(){vR(this,Po,new aue),vR(this,yr,new mue($t(Po,this))),vR(this,Ll,[[]])}setState(e){$t(Po,this).setData(e);let n=!1;try{$t(yr,this).buildTree()}catch{$t(yr,this).clear(),$t(Po,this).clear(),n=!0}return wd(Ll,this,Mm($t(yr,this).getRoots())),n}setColumnsLimit(e){$t(Po,this).setColumnsLimit(e)}mergeStateWith(e){const n=Je(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});$t(Po,this).mergeWith(n),$t(yr,this).buildTree(),wd(Ll,this,Mm($t(yr,this).getRoots()))}mapState(e){$t(Po,this).map(e),$t(yr,this).buildTree(),wd(Ll,this,Mm($t(yr,this).getRoots()))}mapNodes(e){return wn($t(yr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=$t(yr,this).getNode(n,r);let o;return i&&(o=vue(e,i,r),wd(Ll,this,Mm($t(yr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=$t(Ll,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=$t(yr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=$t(yr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},NW)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return $t(Po,this).getLayersCount()}getColumnsCount(){return $t(Po,this).getColumnsCount()}clear(){wd(Ll,this,[]),$t(Po,this).clear(),$t(yr,this).clear()}}function vd(t,e,n){return(e=Rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rue(t){var e=Eue(t,"string");return typeof e=="symbol"?e:e+""}function Eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tue{constructor(e,n){vd(this,"hot",void 0),vd(this,"nestedHeaderSettingsGetter",void 0),vd(this,"layersCount",0),vd(this,"container",void 0),vd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Ka(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function _ue(t,e){WW(t,e),e.add(t)}function vD(t,e,n){return(e=Mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mue(t){var e=Pue(t,"string");return typeof e=="symbol"?e:e+""}function Pue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uc(t,e,n){WW(t,e),e.set(t,n)}function WW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,n){return t.set(Cn(t,e),n),n}function ke(t,e){return t.get(Cn(t,e))}function Cn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const CD="nestedHeaders",Iue=280;var pt=new WeakMap,fa=new WeakMap,nf=new WeakMap,Rv=new WeakMap,pw=new WeakMap,$l=new WeakMap,In=new WeakSet;class Oue extends Ke{constructor(){super(...arguments),_ue(this,In),uc(this,pt,new bue),uc(this,fa,null),uc(this,nf,null),uc(this,Rv,!1),uc(this,pw,null),vD(this,"ghostTable",new Tue(this.hot,(e,n)=>this.getHeaderSettings(e,n))),vD(this,"detectedOverlappedHeaders",!1),uc(this,$l,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:r}=n;if(r.isHeader()&&r.col>=0){const o=ke(pt,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=o,s.visualCellRange.from.col=o,s.visualCellRange.to.col=o,s.commit()}})}static get PLUGIN_KEY(){return CD}static get PLUGIN_PRIORITY(){return Iue}isEnabled(){return!!this.hot.getSettings()[CD]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&qe(it`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Cn(In,this,Yue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Gue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Nue).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Due).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,kue).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Lue).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,$ue).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Fue).call(e,...i)}),this.addHook("afterSelection",()=>ke($l,this).call(this)),this.addHook("afterSelectionFocusSet",()=>ke($l,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,xue).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Cn(In,this,Wue).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,jue).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Uue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Aue).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Hue).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Vue).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,Bue).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Cn(In,e,zue).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",ke($l,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",ke($l,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ke(pt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ke(pt,this).setState(e)),this.detectedOverlappedHeaders&&qe(it`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ke(pt,this).triggerColumnModification(i,r)}),!ke(fa,this)&&this.enabled&&Ns(fa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ke(pt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",ke($l,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",ke($l,this)),this.clearColspans(),ke(pt,this).clear(),ke(fa,this).unsubscribe(),Ns(fa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ke(pt,this)}getLayersCount(){return ke(pt,this).getLayersCount()}getHeaderSettings(e,n){return ke(pt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ce(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ce(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ce(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),ce(o,"hiddenHeader"),ce(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=ke(pt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)Y(o,"hiddenHeader");else if(c>1){var m,p,y;const{wtOverlays:T}=l._wt,b=(m=T.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),M=(p=T.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o);((y=T.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&Y(o,"hiddenHeaderText");const k=b||M?Math.min(c,r-i):c;k>1&&o.setAttribute("colspan",k)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const T=o.querySelector("div.relative");T&&f&&f.length>0&&(ce(T,this.hot.getColumnMeta(u).headerClassName),Y(T,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ke(pt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Ns(pt,this,null),ke(fa,this)!==null&&(ke(fa,this).unsubscribe(),Ns(fa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ke(pt,this).getHeaderTreeNodeData(e.row,e.col)}}function xue(t,e){var n;const r=this.hot.getSelectedRangeActive();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=ke(pw,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Ns(pw,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=ke(pt,this).findLeftMostColumnIndex(a,l),m=ke(pt,this).findRightMostColumnIndex(a,l),p=m-f+1;if(f<c&&m>h)return f;if(s){let y=null;return f>=c&&m>h?p>d?(e.value="start",y=f):(e.value="end",y=m):f<c&&m<=h&&(p>d?(e.value="end",y=m):(e.value="start",y=f)),y}return f<=c?f:m}function Aue(t,e,n){const r=ke(pt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ke(pt,this).getHeaderSettings(e,t);if(o===pT){if(!a)return r.columnIndex}else if(o===N$&&(l>s-i||!a))return null;return t}function Hue(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const m=c+f,p=d-a;if(p===0)continue;((i=ke(pt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][p]="")}}}function Nue(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Due(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Ns(nf,this,e.clone()),Ns(Rv,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Yw(t)||ja(t)&&l||l$(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function kue(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ue(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Lue(){Ns(Rv,this,!1)}function $ue(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ke(Rv,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ke(pt,this).getHeaderTreeNodeData(ke(nf,this).row,ke(nf,this).col);if(e.setHighlight(ke(nf,this)),o>e.getWidth()||i<n||i+o-1>r){const s=ke(pt,this).findTopMostEntireHeaderLevel(Ue(n,i,i+o-1),Ue(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Fue(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ke(pt,this).findLeftMostColumnIndex(n.row,n.col),o=ke(pt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Vue(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Ns(pw,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Wue(t){if(ke(pt,this).getLayersCount()>0){t.length=0;for(let e=0;e<ke(pt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Bue(t){const e=ke(pt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ke(pt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),qn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ke(pt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function jue(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Uue(t,e,n){var r;const{label:i}=(r=ke(pt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function zue(t,e){if(t<0)return this.hot.getCell(t,ke(pt,this).findLeftMostColumnIndex(t,e),!0)}function Yue(){this.updatePlugin()}function Gue(t,e){e||this.updatePlugin()}function Cd(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xue{constructor(e,n){Cd(this,"hot",void 0),Cd(this,"data",null),Cd(this,"plugin",void 0),Cd(this,"parentReference",new WeakMap),Cd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&I(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&I(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ve(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(I(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),me(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];I(r,o=>{i.push(this.getDataObject(o))}),I(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function yD(t,e,n){return(e=Zue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sP{constructor(e,n){yD(this,"hot",void 0),yD(this,"plugin",void 0),this.hot=n,this.plugin=e}}class $o extends sP{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getDataObject(r);if(!i)return;const o=this.dataManager.getRowLevel(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(I(l,c=>{c&&s.removeChild(c)}),Y(n,$o.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",me(0,o-1,()=>{const d=c.createElement("SPAN");Y(d,$o.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(i)){const c=this.hot.rootDocument.createElement("DIV");u&&fe(c,[bu()]),Y(n,$o.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Y(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.expandButton}`),u&&fe(n,[_i(!1)])):(Y(c,`${$o.CSS_CLASSES.button} ${$o.CSS_CLASSES.collapseButton}`),u&&fe(n,[_i(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class Jue extends sP{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),I(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{me(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&I(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];I(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return I(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);I(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return I(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);I(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&I(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];I(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];I(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];I(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&I(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);be(e.target,$o.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ni(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function ece(t,e,n){tce(t,e),e.set(t,n)}function tce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nce(t,e,n){return(e=rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rce(t){var e=ice(t,"string");return typeof e=="symbol"?e:e+""}function ice(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oce(t,e){return t.get(sce(t,e))}function sce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SD=new WeakMap;class ace extends sP{constructor(){super(...arguments),nce(this,"dataManager",this.plugin.dataManager),ece(this,SD,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(w_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedActive();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(v_)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const r=this.hot.getSelectedActive(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return I(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=oce(SD,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Pm(t,e,n){return(e=lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cce{constructor(e){Pm(this,"plugin",void 0),Pm(this,"hot",void 0),Pm(this,"dataManager",void 0),Pm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const p=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(p,a),p}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return It(i)&&(qe(it`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function hce(t,e){BW(t,e),e.add(t)}function bD(t,e,n){BW(t,e),e.set(t,n)}function BW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CR(t,e,n){return(e=dce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dce(t){var e=fce(t,"string");return typeof e=="symbol"?e:e+""}function fce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dp(t,e){return t.get(yn(t,e))}function ww(t,e,n){return t.set(yn(t,e),n),n}function yn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vw="nestedRows",gce=300,RD=vw,mce="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Ev=new WeakMap,cc=new WeakMap,On=new WeakSet;class pce extends Ke{constructor(){super(...arguments),hce(this,On),CR(this,"dataManager",null),CR(this,"headersUI",null),CR(this,"collapsedRowsMap",null),bD(this,Ev,!1),bD(this,cc,!1)}static get PLUGIN_KEY(){return vw}static get PLUGIN_PRIORITY(){return gce}isEnabled(){return!!this.hot.getSettings()[vw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Kf),this.dataManager=new Xue(this,this.hot),this.collapsingUI=new Jue(this,this.hot),this.headersUI=new $o(this,this.hot),this.contextMenuUI=new ace(this,this.hot),this.rowMoveController=new cce(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Oce).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,xce).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Cce).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,yce).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Sce).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,vce).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Ece).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Rce).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Tce).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,_ce).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Mce).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Pce).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,bce).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,Ice).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yn(On,e,wce).call(e,...r)}),this.addHook("beforeLoadData",n=>yn(On,this,ED).call(this,n)),this.addHook("beforeUpdateData",n=>yn(On,this,ED).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:RD,relativeToGroup:Za,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RD)}disableCoreAPIModifiers(){ww(cc,this,!0)}enableCoreAPIModifiers(){ww(cc,this,!1)}onModifyRowData(e){if(!dp(cc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!dp(cc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return dp(cc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function wce(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function vce(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Cce(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),ww(Ev,this,!0),this.dataManager.getData().slice()}function yce(t){return this.contextMenuUI.appendOptions(t)}function Sce(t,e){this.headersUI.appendLevelIndicators(t,e)}function bce(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Rce(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{ww(Ev,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Ece(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Tce(){this.collapsingUI.collapsedRowsStash.stash()}function _ce(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Mce(){this.collapsingUI.collapsedRowsStash.stash()}function Pce(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ice(){this.dataManager.rewriteCache()}function Oce(){this.headersUI.updateRowHeaderWidth()}function xce(t,e){dp(Ev,this)&&(e.skipRender=!0)}function ED(t){if(!j$(t)){iT(mce),this.hot.getSettings()[vw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Ace(t,e){jW(t,e),e.add(t)}function ga(t,e,n){jW(t,e),e.set(t,n)}function jW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ge(t,e){return t.get(rf(t,e))}function Io(t,e,n){return t.set(rf(t,e),n),n}function rf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hce=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var Hc=new WeakMap,Ul=new WeakMap,yR=new WeakMap,Bn=new WeakMap,hc=new WeakMap,di=new WeakMap,SR=new WeakMap,bR=new WeakMap,Im=new WeakSet;class UW{constructor(e){let{rootElement:n,uiContainer:r,isRtl:i,themeName:o,phraseTranslator:s,shouldHaveBorder:a,a11yAnnouncer:l}=e;Ace(this,Im),ga(this,Hc,void 0),ga(this,Ul,void 0),ga(this,yR,!1),ga(this,Bn,void 0),ga(this,hc,void 0),ga(this,di,void 0),ga(this,SR,void 0),ga(this,bR,void 0),Io(Hc,this,n),Io(Ul,this,r),Io(yR,this,i),Io(hc,this,o),Io(di,this,s),Io(SR,this,a),Io(bR,this,l),this.install()}install(){var e;if((e=Ge(Bn,this))!==null&&e!==void 0&&e.container)return;const n=TL`${Hce}`,{container:r,first:i,prev:o,next:s,last:a,pageSizeSelect:l}=n.refs;Io(Bn,this,n.refs),r.setAttribute("dir",Ge(yR,this)?"rtl":"ltr");const u=h=>h.currentTarget.disabled,c=(h,d,f)=>{d.addEventListener(h,m=>{u(m)||f()})};c("click",i,()=>this.runLocalHooks("firstPageClick")),c("focus",i,()=>this.runLocalHooks("focus",i)),c("click",o,()=>this.runLocalHooks("prevPageClick")),c("focus",o,()=>this.runLocalHooks("focus",o)),c("click",s,()=>this.runLocalHooks("nextPageClick")),c("focus",s,()=>this.runLocalHooks("focus",s)),c("click",a,()=>this.runLocalHooks("lastPageClick")),c("focus",a,()=>this.runLocalHooks("focus",a)),c("focus",l,()=>this.runLocalHooks("focus",l)),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Ge(Ul,this)?(Ge(Ul,this).appendChild(n.fragment),Y(r,[Ge(hc,this),"handsontable"])):Ge(Hc,this).after(n.fragment)}getContainer(){return Ge(Bn,this).container}getFocusableElements(){const{first:e,prev:n,next:r,last:i,pageSizeSelect:o}=Ge(Bn,this);return[o,e,n,r,i].filter(s=>!s.disabled)}updateWidth(e){return Ge(Bn,this).container.style.width=`${e}px`,this}updateTheme(e){if(Io(hc,this,e),Ge(Ul,this)){const{container:n}=Ge(Bn,this);ce(n,/ht-theme-.*/g),Ge(hc,this)&&Y(n,Ge(hc,this))}return this}getHeight(){return Ge(Bn,this).container.offsetHeight}refreshBorderState(){const{container:e}=Ge(Bn,this);return Ge(Ul,this)||Ge(SR,this).call(this)?Y(e,"ht-pagination--bordered"):ce(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:r,firstVisibleRowIndex:i,lastVisibleRowIndex:o,totalRenderedRows:s,pageSizeList:a,pageSize:l,autoPageSize:u}=e;const{first:c,prev:h,next:d,last:f,pageCounterSection:m,pageNavSection:p,pageNavLabel:y,pageSizeSelect:T,pageSizeLabel:b}=Ge(Bn,this),M=Ge(di,this).call(this,eM,{start:i+1,end:o+1,total:s}),R=Ge(di,this).call(this,tM,{currentPage:n,totalPages:r}),k=Ge(di,this).call(this,Np);m.textContent=M,y.textContent=R,T.textContent="",b.textContent=`${k}:`,fe(p,[ri(Ge(di,this).call(this,Q_))]),fe(T,[ri(Ge(di,this).call(this,Np)),xr(-1)]),Ge(bR,this).call(this,R),this.refreshBorderState(),a.forEach(U=>{const G=U==="auto"?Ge(di,this).call(this,J_):U,V=new Option(G,U);(u&&U==="auto"||!u&&U===l)&&(V.selected=!0),T.add(V)});const P=n===1,O=n===r;if(p.style.display!=="none"){const U=Ge(Hc,this).ownerDocument.activeElement;P?(Y(c,"ht-page-navigation-section__button--disabled"),Y(h,"ht-page-navigation-section__button--disabled"),c.disabled=!0,h.disabled=!0):(ce(c,"ht-page-navigation-section__button--disabled"),ce(h,"ht-page-navigation-section__button--disabled"),c.disabled=!1,h.disabled=!1),O?(Y(d,"ht-page-navigation-section__button--disabled"),Y(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(ce(d,"ht-page-navigation-section__button--disabled"),ce(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[c,h,d,f].includes(U)&&(h.disabled?d.focus():d.disabled&&h.focus())}return fe(c,[ri(Ge(di,this).call(this,nM)),Ed(P),xr(-1)]),fe(h,[ri(Ge(di,this).call(this,rM)),Ed(P),xr(-1)]),fe(d,[ri(Ge(di,this).call(this,iM)),Ed(O),xr(-1)]),fe(f,[ri(Ge(di,this).call(this,oM)),Ed(O),xr(-1)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:r}=Ge(Bn,this);return n.style.display=e?"":"none",r.disabled=!e,rf(Im,this,RR).call(this),this}setCounterSectionVisibility(e){return Ge(Bn,this).pageCounterSection.style.display=e?"":"none",rf(Im,this,RR).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:r,prev:i,next:o,last:s}=Ge(Bn,this);return n.style.display=e?"":"none",r.disabled=!e,i.disabled=!e,o.disabled=!e,s.disabled=!e,rf(Im,this,RR).call(this),this}destroy(){var e;(e=Ge(Bn,this))===null||e===void 0||e.container.remove(),Io(Bn,this,null)}}function RR(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:r}=Ge(Bn,this),i=e.style.display!=="none"||n.style.display!=="none"||r.style.display!=="none";Ge(Ul,this)||(i?Y(Ge(Hc,this).querySelector(".ht-wrapper"),"htPagination"):ce(Ge(Hc,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=i?"":"none"}ut(UW,Tn);const Nce=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function Dce(t){return Nce.some(e=>{const n=!!t[e];return n&&qe(it`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function ER(t,e,n){return(e=kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kce(t){var e=Lce(t,"string");return typeof e=="symbol"?e:e+""}function Lce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ce{constructor(){ER(this,"pageSize",1),ER(this,"totalItems",0),ER(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:r}=e;this.pageSize=Math.max(n,1),this.totalItems=r,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,r=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:r,pageSize:this.pageSize}}}function Fce(t,e,n){return(e=Vce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vce(t){var e=Wce(t,"string");return typeof e=="symbol"?e:e+""}function Wce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bce{constructor(){Fce(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:r}=e;const i=n(),o=r(),s=[];let a=0,l=1,u=0;for(let c=0;c<i.length;c++){const h=i[c];u>0&&l+h>=o&&(s.push({startIndex:a,endIndex:c-1,pageSize:u}),a=c,l=1,u=0),l+=h,u+=1}s.push({startIndex:a,endIndex:Math.max(0,i.length-1),pageSize:u}),this.pages=s}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const TD=new Map([["fixed",$ce],["auto",Bce]]);function _D(t){if(!TD.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=TD.get(t);return new e}function jce(t){let{focusableElements:e}=t;return UM({initialPage:0,size:()=>e().length,onItemSelect:r=>{e()[r].focus()}})}function Uce(t,e){zW(t,e),e.add(t)}function Oo(t,e,n){zW(t,e),e.set(t,n)}function zW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function se(t,e){return t.get(st(t,e))}function bn(t,e,n){return t.set(st(t,e),n),n}function st(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nc="pagination",zce=900,YW=Nc,th=`plugin:${Nc}`,MD=it`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var of=new WeakMap,Gn=new WeakMap,Qi=new WeakMap,Nt=new WeakMap,Si=new WeakMap,Cw=new WeakMap,fp=new WeakMap,ii=new WeakMap,to=new WeakMap,ft=new WeakSet,TR=new WeakMap;class Yce extends Ke{constructor(){super(...arguments),Uce(this,ft),Oo(this,of,null),Oo(this,Gn,1),Oo(this,Qi,10),Oo(this,Nt,null),Oo(this,Si,null),Oo(this,Cw,!1),Oo(this,fp,!1),Oo(this,ii,null),Oo(this,to,null),Oo(this,TR,()=>{var e;!se(Cw,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&st(ft,this,ru).call(this)})}static get PLUGIN_KEY(){return Nc}static get PLUGIN_PRIORITY(){return zce}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[Nc]}enablePlugin(){var e,n=this;if(Dce(this.hot.getSettings())){this.hot.getSettings()[Nc]=!1;return}if(this.enabled)return;const r=this.hot.getSettings()[Nc];(r==null?void 0:r.initialPage)!==void 0&&bn(Gn,this,this.getSetting("initialPage")),(r==null?void 0:r.pageSize)!==void 0&&bn(Qi,this,this.getSetting("pageSize")),bn(of,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),se(Qi,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&qe(MD),bn(Si,this,_D(se(Qi,this)==="auto"?"auto":"fixed")),se(Nt,this)||(bn(Nt,this,new UW({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>st(ft,this,Xce).call(this),a11yAnnouncer:i=>X8(i)})),st(ft,this,PD).call(this),se(Nt,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",i=>this.setPageSize(i)).addLocalHook("focus",i=>{se(ii,this).setCurrentPage(se(Nt,this).getFocusableElements().indexOf(i)),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(th),this.hot.listen(),se(to,this).deactivate()})),se(ii,this)||bn(ii,this,jce({focusableElements:()=>se(Nt,this).getFocusableElements()})),se(to,this)||bn(to,this,mM(this.hot,se(Nt,this).getContainer(),{onFocus:i=>{this.hot.getShortcutManager().setActiveContextName(th),this.hot.listen(),i==="from_above"?se(ii,this).toFirstItem():se(ii,this).toLastItem(),se(to,this).deactivate()}})),st(ft,this,Gce).call(this),st(ft,this,qce).call(this),this.addHook("init",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ihe).call(n,...o)},-1),this.addHook("beforeSelectAll",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ID).call(n,...o)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ID).call(n,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,Zce).call(n,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,Qce).call(n,...o)}),this.addHook("beforePaste",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,Jce).call(n,...o)}),this.addHook("afterViewRender",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,the).call(n,...o)}),this.addHook("afterRender",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,nhe).call(n,...o)}),this.addHook("afterScrollVertically",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ohe).call(n,...o)}),this.addHook("afterLanguageChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,she).call(n,...o)}),this.addHook("modifyRowHeight",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ehe).call(n,...o)}),this.addHook("beforeHeightChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,rhe).call(n,...o)}),this.addHook("afterSetTheme",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,ahe).call(n,...o)}),this.addHook("afterDialogShow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,lhe).call(n,...o)}),this.addHook("beforeDialogHide",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return st(ft,n,uhe).call(n,...o)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",se(TR,this)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),st(ft,this,ru).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",se(TR,this)).unregisterMap(this.pluginName),se(Nt,this).destroy(),bn(Nt,this,null),st(ft,this,Kce).call(this),super.disablePlugin()}getPaginationData(){const e=se(Si,this).getTotalPages();let n=-1,r=-1;const{pageSize:i,startIndex:o}=se(Si,this).getState(se(Gn,this)),s=this.hot.countRows();let a=0;for(let l=o;a<i&&!(l>=s);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(n===-1&&(n=l),r=l,a+=1);return{currentPage:se(Gn,this),totalPages:e,pageSize:i,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:se(Qi,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:r}}setPage(e){const n=se(Gn,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&(bn(Gn,this,e),st(ft,this,ru).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,se(Gn,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const r=se(Qi,this);this.hot.runHooks("beforePageSizeChange",r,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&qe(MD),bn(Si,this,_D(e==="auto"?"auto":"fixed")),bn(Qi,this,e),st(ft,this,ru).call(this),this.hot.runHooks("afterPageSizeChange",r,se(Qi,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),st(ft,this,PD).call(this)}nextPage(){this.setPage(se(Gn,this)+1)}prevPage(){this.setPage(se(Gn,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(se(Si,this).getTotalPages())}hasPreviousPage(){return se(Gn,this)>1}hasNextPage(){return se(Gn,this)<se(Si,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){se(Nt,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){se(Nt,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){se(Nt,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){se(Nt,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){se(Nt,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){se(Nt,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;bn(of,this,null),bn(Si,this,null),(e=se(Nt,this))===null||e===void 0||e.destroy(),bn(Nt,this,null),super.destroy()}}function Gce(){this.eventManager.addEventListener(this.hot.rootDocument,"mouseup",t=>{!se(Nt,this).getContainer().contains(t.target)&&this.hot.getShortcutManager().getActiveContextName()===th&&(se(to,this).activate(),se(ii,this).clear(),this.hot.getShortcutManager().setActiveContextName("grid"))})}function qce(){var t;const e=this.hot.getShortcutManager();((t=e.getContext(th))!==null&&t!==void 0?t:e.addContext(th,"global")).addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{let i=se(ii,this).getCurrentPage();if(r.shiftKey){se(ii,this).toPreviousItem();const o=se(ii,this).getCurrentPage();if(o>=i){st(ft,this,OD).call(this);return}i=o}else{se(ii,this).toNextItem();const o=se(ii,this).getCurrentPage();if(o<=i){st(ft,this,OD).call(this);return}i=o}r.preventDefault()},group:YW})}function Kce(){this.hot.getShortcutManager().getContext(th).removeShortcutsByGroup(YW)}function PD(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function ru(){bn(Cw,this,!0),se(of,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;se(Si,this).calculate({pageSize:se(Qi,this),totalItems:e,viewportSizeProvider:()=>{const{view:o}=this.hot;if(o.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?o._wt.wtTable.getColumnHeaderHeight():0,c=se(Nt,this).getHeight();return o.getWorkspaceHeight()-c-u-l}const s=o.hasHorizontalScroll()?rn():0;return o.getViewportHeight()-s},itemsSizeProvider:()=>{const o=n.getDefaultRowHeight();return this.hot.rowIndexMapper.getRenderableIndexes().map(a=>{var l;return(l=this.hot.getRowHeight(this.hot.toVisualRow(a)))!==null&&l!==void 0?l:o})}});const r=se(Si,this).getTotalPages();if(bn(Gn,this,Ue(se(Gn,this),1,r)),t.length>0){const{startIndex:o,pageSize:s}=se(Si,this).getState(se(Gn,this));t.splice(o,s)}t.length>0?this.hot.batchExecution(()=>{t.forEach(o=>se(of,this).setValueAtIndex(o,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),bn(Cw,this,!1);const i=this.getPaginationData();se(Nt,this).updateState({...i,totalRenderedRows:e}),(this.getSetting("showPageSize")||this.getSetting("showNavigation"))&&i.totalPages>1?se(to,this).activate():se(to,this).deactivate()}function Xce(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function ID(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();(se(Gn,this)>1||t.row>=0)&&(t.row=n),e.row=r}function Zce(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function Qce(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=Ue(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function Jce(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();if(n===-1||r===-1)return!1;e.forEach(i=>{let{startRow:o}=i;if(t.length===0)return;const s=Math.min(t.length-(r-o+1),t.length);t.splice(0,s)})}function ehe(t,e){if(t===void 0||!se(Si,this).getState(se(Gn,this)))return;const{firstVisibleRowIndex:n}=this.getPaginationData();return e!==0&&e===n&&(t+=1),t}function the(){if(se(Qi,this)!=="auto"||se(fp,this)){bn(fp,this,!1);return}st(ft,this,ru).call(this),bn(fp,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function nhe(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();se(Nt,this).updateWidth(e).refreshBorderState()}function rhe(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${se(Nt,this).getHeight()}px)`}function ihe(){se(Qi,this)!=="auto"&&st(ft,this,ru).call(this)}function ohe(){se(Nt,this).refreshBorderState()}function she(){st(ft,this,ru).call(this)}function ahe(t){se(Nt,this).updateTheme(t)}function OD(){se(to,this).activate(),se(ii,this).clear(),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName("grid")}function lhe(){se(to,this).deactivate()}function uhe(){se(to,this).activate()}function _R(t,e,n){return(e=che(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=hhe(t,"string");return typeof e=="symbol"?e:e+""}function hhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dhe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_R(this,"rootWindow",void 0),_R(this,"prefix",void 0),_R(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){I(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function fhe(t,e,n){return(e=ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ghe(t){var e=mhe(t,"string");return typeof e=="symbol"?e:e+""}function mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}oe.getSingleton().register("persistentStateSave");oe.getSingleton().register("persistentStateLoad");oe.getSingleton().register("persistentStateReset");const xD="persistentState",phe=0,AD=new WeakSet;class whe extends Ke{constructor(){super(...arguments),fhe(this,"storage",void 0)}static get PLUGIN_KEY(){return xD}static get PLUGIN_PRIORITY(){return phe}isEnabled(){return!!this.hot.getSettings()[xD]}enablePlugin(){this.enabled||(AD.has(this.hot)||(AD.add(this.hot),c$("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new dhe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function vhe(t,e){Che(t,e),e.add(t)}function Che(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MR(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=She(t,"string");return typeof e=="symbol"?e:e+""}function She(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const PR="search",bhe=190,Rhe="htSearchResult",Ehe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},The=function(t,e,n){return It(t)||t===null||!t.toLocaleLowerCase||t.length===0||It(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var IR=new WeakSet;class _he extends Ke{constructor(){super(...arguments),vhe(this,IR),MR(this,"callback",Ehe),MR(this,"queryMethod",The),MR(this,"searchResultClass",Rhe)}static get PLUGIN_KEY(){return PR}static get PLUGIN_PRIORITY(){return bhe}isEnabled(){return this.hot.getSettings()[PR]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[PR];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return HD(IR,e,ND).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return HD(IR,e,ND).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return me(0,i-1,l=>{me(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const p={row:l,col:u,data:c};s.push(p)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Te(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function ND(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Om(t,e,n){return(e=Mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mhe(t){var e=Phe(t,"string");return typeof e=="symbol"?e:e+""}function Phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GW{constructor(e){Om(this,"viewportWidth",void 0),Om(this,"overwriteColumnWidthFn",void 0),Om(this,"baseWidths",new Map),Om(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Ihe extends GW{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=Kc?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),o.push(d),s-=m)}),s<=Kc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,p=m;o.includes(f)||(p=Math.round(m*l)),this.stretchedWidths.set(f,p),u=f,d<i.length-1&&(c+=p)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function DD(t,e,n){Ohe(t,e),e.set(t,n)}function Ohe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OR(t,e){return t.get(qW(t,e))}function xm(t,e,n){return t.set(qW(t,e),n),n}function qW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Am=new WeakMap,yd=new WeakMap;class xhe extends GW{constructor(){super(...arguments),DD(this,Am,0),DD(this,yd,-1)}prepare(e){super.prepare(e),xm(Am,this,0),xm(yd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),xm(yd,this,e),xm(Am,this,n)}calculate(){if(OR(yd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+OR(Am,this),0);this.stretchedWidths.set(OR(yd,this),n)}}function Ahe(t,e){KW(t,e),e.add(t)}function Hm(t,e,n){KW(t,e),e.set(t,n)}function KW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){return t.get(Dc(t,e))}function xR(t,e,n){return t.set(Dc(t,e),n),n}function Dc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hhe="stretchColumns";var An=new WeakMap,dc=new WeakMap,AR=new WeakMap,Nm=new WeakMap,Sd=new WeakSet;class Nhe{constructor(e){Ahe(this,Sd),Hm(this,An,void 0),Hm(this,dc,void 0),Hm(this,AR,new Map([["all",new Ihe(Dc(Sd,this,kD).bind(this))],["last",new xhe(Dc(Sd,this,kD).bind(this))]])),Hm(this,Nm,"none"),xR(An,this,e),xR(dc,this,Dt(An,this).columnIndexMapper.createAndRegisterIndexMap(Hhe,"physicalIndexToValue"))}useStrategy(e){xR(Nm,this,Dt(AR,this).has(e)?e:"none")}refreshStretching(){if(Dt(Nm,this)==="none"){Dt(dc,this).clear();return}Dt(An,this).batchExecution(()=>{Dt(dc,this).clear();const e=Dt(AR,this).get(Dt(Nm,this));let r=Dt(An,this).view.getViewportWidth();Dc(Sd,this,Dhe).call(this)&&(r-=rn(Dt(An,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Dt(An,this).countCols();i++)Dt(An,this).columnIndexMapper.isHidden(Dt(An,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Dc(Sd,this,khe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Dt(dc,this).setValueAtIndex(Dt(An,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Dt(dc,this).getValueAtIndex(Dt(An,this).toPhysicalColumn(e))}}function Dhe(){const{view:t,stylesHandler:e}=Dt(An,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=Dt(An,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(!Dt(An,this).rowIndexMapper.isHidden(Dt(An,this).toPhysicalRow(l))&&(o+=((a=Dt(An,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n)){s=!0;break}}return s}function khe(t){var e;return(e=Dt(An,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Kc}function kD(t,e){return Dt(An,this).runHooks("beforeStretchingColumnWidth",t,e)}function Lhe(t,e){XW(t,e),e.add(t)}function HR(t,e,n){XW(t,e),e.set(t,n)}function XW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NR(t,e,n){return t.set(yw(t,e),n),n}function ys(t,e){return t.get(yw(t,e))}function yw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $he="stretchColumns",Fhe=155;var Rc=new WeakMap,Dm=new WeakMap,bd=new WeakMap,DR=new WeakSet;class Vhe extends Ke{constructor(){super(...arguments),Lhe(this,DR),HR(this,Rc,new Nhe(this.hot)),HR(this,Dm,null),HR(this,bd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;ys(Dm,this)!==null&&ys(Dm,this)!==i.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),NR(Dm,this,i.width)})})}))}static get PLUGIN_KEY(){return $he}static get PLUGIN_PRIORITY(){return Fhe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(ys(Rc,this).useStrategy(this.hot.getSettings().stretchH),ys(bd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yw(DR,e,Bhe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yw(DR,e,Whe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){ys(Rc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),ys(bd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return ys(Rc,this).getStretchedWidth(e)}destroy(){ys(bd,this).disconnect(),NR(bd,this,null),NR(Rc,this,null),super.destroy()}}function Whe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function Bhe(t){t&&ys(Rc,this).refreshStretching()}function jhe(t,e){Uhe(t,e),e.add(t)}function Uhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function km(t,e,n){return(e=zhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zhe(t){var e=Yhe(t,"string");return typeof e=="symbol"?e:e+""}function Yhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ghe="touchScroll",qhe=200;var Lm=new WeakSet;class Khe extends Ke{constructor(){super(...arguments),jhe(this,Lm),km(this,"scrollbars",[]),km(this,"clones",[]),km(this,"lockedCollection",!1),km(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Ghe}static get PLUGIN_PRIORITY(){return qhe}static get SETTING_KEYS(){return!0}isEnabled(){return B0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>kR(Lm,this,Xhe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>kR(Lm,this,Zhe).call(this)),this.addHook("afterMomentumScroll",()=>kR(Lm,this,Qhe).call(this))}}function Xhe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Zhe(){this.freezeOverlays=!0,I(this.clones,t=>{Y(t,"hide-tween")})}function Qhe(){this.freezeOverlays=!1,I(this.clones,t=>{ce(t,"hide-tween"),Y(t,"show-tween")}),this.hot._registerTimeout(()=>{I(this.clones,t=>{ce(t,"show-tween")})},400),I(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Jhe(t,e){ede(t,e),e.add(t)}function ede(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tde(t,e,n){return(e=nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nde(t){var e=rde(t,"string");return typeof e=="symbol"?e:e+""}function rde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ide(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gp="trimRows",ode=330;var LD=new WeakSet;class sde extends Ke{constructor(){super(...arguments),Jhe(this,LD),tde(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return gp}static get PLUGIN_PRIORITY(){return ode}isEnabled(){return!!this.hot.getSettings()[gp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Kf),this.trimmedRowsMap.addLocalHook("init",()=>ide(LD,this,ade).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[gp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),I(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(I(e,l=>{o[l]=!1}),i=wn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function ade(){const t=this.hot.getSettings()[gp];Array.isArray(t)&&this.hot.batchExecution(()=>{I(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function lde(t,e,n){return(e=ude(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ude(t){var e=cde(t,"string");return typeof e=="symbol"?e:e+""}function cde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ki{constructor(e){lde(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function $m(t,e,n){return(e=hde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hde(t){var e=dde(t,"string");return typeof e=="symbol"?e:e+""}function dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aP extends ki{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),$m(this,"stateBefore",void 0),$m(this,"range",void 0),$m(this,"type",void 0),$m(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new aP({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){I(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ca(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function $D(t,e,n){return(e=fde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fde(t){var e=gde(t,"string");return typeof e=="symbol"?e:e+""}function gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lP extends ki{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),$D(this,"columns",void 0),$D(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new lP({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),nP(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function FD(t,e,n){return(e=mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mde(t){var e=pde(t,"string");return typeof e=="symbol"?e:e+""}function pde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uP extends ki{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),FD(this,"previousSortState",void 0),FD(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new uP({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function VD(t,e,n){return(e=wde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wde(t){var e=vde(t,"string");return typeof e=="symbol"?e:e+""}function vde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cP extends ki{constructor(e){let{index:n,amount:r}=e;super("insert_col"),VD(this,"index",void 0),VD(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new cP({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function WD(t,e,n){return(e=Cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cde(t){var e=yde(t,"string");return typeof e=="symbol"?e:e+""}function yde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hP extends ki{constructor(e){let{index:n,amount:r}=e;super("insert_row"),WD(this,"index",void 0),WD(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new hP({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Fm(t,e,n){return(e=Sde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sde(t){var e=bde(t,"string");return typeof e=="symbol"?e:e+""}function bde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dP extends ki{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Fm(this,"changes",void 0),Fm(this,"selected",void 0),Fm(this,"countCols",void 0),Fm(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new dP({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){const r=Qn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(r,null,null,"UndoRedo.redo")}}function BD(t,e,n){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rde(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fP extends ki{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),BD(this,"conditionsStack",void 0),BD(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new fP({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Tde(t,e,n){return(e=_de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _de(t){var e=Mde(t,"string");return typeof e=="symbol"?e:e+""}function Mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gP extends ki{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Tde(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new gP({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function ZW(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return me(r,i,l=>{me(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function ps(t,e,n){return(e=Pde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pde(t){var e=Ide(t,"string");return typeof e=="symbol"?e:e+""}function Ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mP extends ki{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),ps(this,"index",void 0),ps(this,"indexes",void 0),ps(this,"data",void 0),ps(this,"amount",void 0),ps(this,"headers",void 0),ps(this,"columnPositions",void 0),ps(this,"rowPositions",void 0),ps(this,"fixedColumnsStart",void 0),ps(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return me(l.length-1,m=>{const p=[],y=l[m];me(u,c,T=>{p.push(y[e.toPhysicalColumn(T)])}),h.push(p)}),me(i-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&me(i-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new mP({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:ZW(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Je(this.data[c],o));const l=Je(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),I(e.getSourceDataArray(),(c,h)=>{I(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&I(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function fc(t,e,n){return(e=Ode(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ode(t){var e=xde(t,"string");return typeof e=="symbol"?e:e+""}function xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pP extends ki{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),fc(this,"index",void 0),fc(this,"data",void 0),fc(this,"fixedRowsBottom",void 0),fc(this,"fixedRowsTop",void 0),fc(this,"rowIndexesSequence",void 0),fc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Qn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new pP({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:ZW(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function jD(t,e,n){return(e=Ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ade(t){var e=Hde(t,"string");return typeof e=="symbol"?e:e+""}function Hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wP extends ki{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),jD(this,"rows",void 0),jD(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new wP({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),nP(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Nde(t,e,n){return(e=Dde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dde(t){var e=kde(t,"string");return typeof e=="symbol"?e:e+""}function kde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vP extends ki{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Nde(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new vP({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function Lde(t,e){[aP,lP,uP,cP,hP,dP,fP,gP,mP,pP,wP,vP].forEach(n=>n.startRegisteringEvents(t,e))}function $de(t,e){Fde(t,e),e.add(t)}function Fde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LR(t,e,n){return(e=Vde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vde(t){var e=Wde(t,"string");return typeof e=="symbol"?e:e+""}function Wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $R(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UD="undoRedo",Bde="undoRedo",jde=1e3;oe.getSingleton().register("beforeUndo");oe.getSingleton().register("afterUndo");oe.getSingleton().register("beforeRedo");oe.getSingleton().register("afterRedo");const zD=new Set;var Vm=new WeakSet;class Ude extends Ke{static get PLUGIN_KEY(){return Bde}static get PLUGIN_PRIORITY(){return jde}static get SETTING_KEYS(){return!0}constructor(e){super(e),$de(this,Vm),LR(this,"doneActions",[]),LR(this,"undoneActions",[]),LR(this,"ignoreNewActions",!1),Lde(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $R(Vm,e,zde).call(e,...r)}),this.registerShortcuts(),$R(Vm,this,Yde).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),$R(Vm,this,Gde).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:UD};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UD)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Qn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function zde(t,e){e==="loadData"&&this.clear()}function Yde(){const t=e=>{zD.has(e)||(qe(it`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),zD.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Gde(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function FR(t,e,n){qde(t,e),e.set(t,n)}function qde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(t,e){return t.get(QW(t,e))}function Wm(t,e,n){return t.set(QW(t,e),n),n}function QW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pi="ht-dialog",Kde=`
<div data-ref="dialogElement" class="${pi}">
  <div data-ref="contentWrapperElement" class="${pi}__content-wrapper">
    <div data-ref="contentElement" class="${pi}__content"></div>
  </div>
</div>
`;var VR=new WeakMap,Sr=new WeakMap,WR=new WeakMap;class JW{constructor(e){let{rootElement:n,isRtl:r}=e;FR(this,VR,void 0),FR(this,Sr,void 0),FR(this,WR,!1),Wm(VR,this,n),Wm(WR,this,r),this.install()}install(){var e;if((e=Ur(Sr,this))!==null&&e!==void 0&&e.dialogElement)return;const n=TL`${Kde}`;Wm(Sr,this,n.refs);const{dialogElement:r}=Ur(Sr,this);r.addEventListener("click",()=>this.runLocalHooks("clickDialogElement")),fe(r,[G2(),xr(-1),["dir",Ur(WR,this)?"rtl":"ltr"]]),Ur(VR,this).after(n.fragment)}getDialogElement(){return Ur(Sr,this).dialogElement}isInsideDialog(e){return Ur(Sr,this).dialogElement.contains(e)}updateDialog(e){let{isVisible:n,content:r,customClassName:i,background:o,contentBackground:s,animation:a,a11y:l}=e;const{dialogElement:u,contentElement:c}=Ur(Sr,this),h=i?` ${i}`:"",d=o?` ${pi}--background-${o}`:"",f=a?` ${pi}--animation`:"",m=n?` ${pi}--show`:"";u.className=`${pi}${h}${d}${f}${m}`,fe(u,[l.role==="alertdialog"?A2():x2()]),l.ariaLabel&&!l.ariaLabelledby?fe(u,[l.ariaLabel?ri(l.ariaLabel):void 0]):Uo(u,"aria-label"),l.ariaLabelledby?fe(u,[k2(l.ariaLabelledby)]):Uo(u,"aria-labelledby"),l.ariaDescribedby?fe(u,[L2(l.ariaDescribedby)]):Uo(u,"aria-describedby");const p=s?` ${pi}__content--background`:"";return c.className=`${pi}__content${p}`,c.innerHTML="",typeof r=="string"?Ka(c,r):(r instanceof HTMLElement||r instanceof DocumentFragment)&&c.appendChild(r),this}showDialog(e){const{dialogElement:n}=Ur(Sr,this);return n.style.display="block",e&&n.offsetHeight,Y(n,`${pi}--show`),this}hideDialog(e){const{dialogElement:n}=Ur(Sr,this);return ce(n,`${pi}--show`),e?n.addEventListener("transitionend",()=>{be(n,`${pi}--show`)||(n.style.display="none")},{once:!0}):n.style.display="none",this}focusDialog(){Ur(Sr,this).dialogElement.focus()}updateWidth(e){return Ur(Sr,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return Ur(Sr,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=Ur(Sr,this))===null||e===void 0||e.dialogElement.remove(),Wm(Sr,this,null)}}ut(JW,Tn);function Xde(t,e){eB(t,e),e.add(t)}function Bm(t,e,n){eB(t,e),e.set(t,n)}function eB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,n){return t.set(_s(t,e),n),n}function Rn(t,e){return t.get(_s(t,e))}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sw="dialog",Zde=360,JE=Sw,nh=`plugin:${Sw}`;var ar=new WeakMap,Ec=new WeakMap,Yc=new WeakMap,gc=new WeakMap,ma=new WeakSet;class Qde extends Ke{constructor(){super(...arguments),Xde(this,ma),Bm(this,ar,null),Bm(this,Ec,!1),Bm(this,Yc,null),Bm(this,gc,null)}static get PLUGIN_KEY(){return Sw}static get PLUGIN_PRIORITY(){return Zde}static get DEFAULT_SETTINGS(){return{content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>Te(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[Sw]}enablePlugin(){this.enabled||(Rn(ar,this)||(xo(ar,this,new JW({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),Rn(ar,this).addLocalHook("clickDialogElement",()=>_s(ma,this,nfe).call(this)),xo(Yc,this,mM(this.hot,Rn(ar,this).getDialogElement(),{onFocus:e=>{this.hot.getShortcutManager().setActiveContextName(nh),this.hot.listen(),this.hot.runHooks("afterDialogFocus",`tab_${e}`)}}))),_s(ma,this,Jde).call(this),this.addHook("modifyFocusOnTabNavigation",e=>_s(ma,this,tfe).call(this,e),1),this.addHook("afterViewRender",()=>_s(ma,this,ofe).call(this)),this.addHook("afterListen",()=>_s(ma,this,rfe).call(this)),this.addHook("afterUnlisten",()=>_s(ma,this,ife).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),_s(ma,this,efe).call(this),super.disablePlugin()}isVisible(){return Rn(Ec,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.enabled)return;if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Rn(ar,this).showDialog(this.getSetting("animation")),xo(Ec,this,!0),xo(gc,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow");const{activeElement:n}=this.hot.rootDocument;(this.hot.rootWrapperElement.contains(n)||this.hot.rootPortalElement.contains(n))&&(this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(nh),this.hot.listen(),Rn(ar,this).focusDialog(),this.hot.runHooks("afterDialogFocus","show"))}hide(){this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Rn(ar,this).hideDialog(this.getSetting("animation")),this.hot.getShortcutManager().setActiveContextName("grid"),xo(Ec,this,!1),Rn(gc,this)?(this.hot.selection.importSelection(Rn(gc,this)),this.hot.view.render(),xo(gc,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){this.enabled&&(this.updatePluginSettings(e),Rn(ar,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")}))}focus(){Rn(ar,this).focusDialog()}destroy(){var e;(e=Rn(ar,this))===null||e===void 0||e.destroyDialog(),xo(ar,this,null),xo(Ec,this,!1),xo(Yc,this,null),xo(gc,this,null),super.destroy()}}function Jde(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(nh))!==null&&t!==void 0?t:e.addContext(nh);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Rn(Ec,this)&&this.getSetting("closable"),group:JE}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{this.hot._registerTimeout(()=>{const{activeElement:i}=this.hot.rootDocument;if(!Rn(ar,this).isInsideDialog(i)){this.hot.unlisten();return}r.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")},0)},group:JE})}function efe(){this.hot.getShortcutManager().getContext(nh).removeShortcutsByGroup(JE)}function tfe(t){if(this.isVisible())return Rn(Yc,this).focus(t),!1}function nfe(){this.isVisible()&&!this.hot.isListening()&&(this.hot.getShortcutManager().setActiveContextName(nh),this.hot.runHooks("afterDialogFocus","click")),this.hot.listen()}function rfe(){Rn(Yc,this).deactivate()}function ife(){Rn(Yc,this).activate()}function ofe(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,r=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Rn(ar,this).updateWidth(r);const i=e.querySelector(".hot-display-license-info");if(i){const o=i.offsetHeight,s=parseFloat(n.getComputedStyle(i).marginTop);Rn(ar,this).updateHeight(o+s)}}function sfe(t){let{id:e,icon:n,title:r,description:i}=t;return`
    <div class="${Kl}__content">
      <i class="${Kl}__icon">${n}</i>
      <div class="${Kl}__text">
        <h2 id="${e}-${iu}-title" class="${Kl}__title">${r}</h2>
        ${i?`<p id="${e}-${iu}-description" class="${Kl}__description">${i}</p>`:""}
      </div>
    </div>
  `}function afe(t,e){tB(t,e),e.add(t)}function lfe(t,e,n){tB(t,e),e.set(t,n)}function tB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YD(t,e,n){return t.set(CP(t,e),n),n}function Gr(t,e){return t.get(CP(t,e))}function CP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const iu="loading",ufe=350,Kl=`ht-${iu}`;var jn=new WeakMap,GD=new WeakSet;class cfe extends Ke{constructor(){super(...arguments),afe(this,GD),lfe(this,jn,null)}static get PLUGIN_KEY(){return iu}static get PLUGIN_PRIORITY(){return ufe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${Kl}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[iu]}enablePlugin(){if(!this.enabled){if(Gr(jn,this)===null){var e;YD(jn,this,this.hot.getPlugin("dialog")),(e=Gr(jn,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>CP(GD,this,hfe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=Gr(jn,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!Gr(jn,this)||!((e=Gr(jn,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),Gr(jn,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!Gr(jn,this)||!((e=Gr(jn,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(Gr(jn,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,r;if(!this.isEnabled()||!Gr(jn,this)||!((n=Gr(jn,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const i=this.hot.guid,o=this.getSetting("icon"),s=(r=this.getSetting("title"))!==null&&r!==void 0?r:this.hot.getTranslatedPhrase(uM),a=this.getSetting("description"),l=sfe({id:i,icon:o,title:s,description:a});Gr(jn,this).update({content:l,customClassName:Kl,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${i}-${iu}-title`,ariaDescribedby:a?`${i}-${iu}-description`:void 0}})}destroy(){YD(jn,this,null),super.destroy()}}function hfe(){Gr(jn,this).focus()}function dfe(){Ye(jd),Ye(_Q),Ye(Ud),Ye(oJ),Ye(fJ),Ye(gV),Ye(uee),Ye(Kee),Ye(wv),Ye(rne),Ye(Ine),Ye(Lne),Ye(yv),Ye(Cre),Ye(goe),Ye(Goe),Ye(yse),Ye(Ase),Ye(Use),Ye(tae),Ye(hae),Ye(Iae),Ye($ae),Ye(Sle),Ye(Jle),Ye(iue),Ye(Oue),Ye(pce),Ye(Yce),Ye(whe),Ye(_he),Ye(Vhe),Ye(Khe),Ye(sde),Ye(Ude),Ye(Qde),Ye(cfe)}function ffe(){G7(),pZ(),TZ(),KZ(),dfe()}function gfe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var BR,jR,UR,zR,YR;ffe();gfe(Re);Re.__GhostTable=FM;Re._getListenersCounter=Fq;Re._getRegisteredMapsCounter=W4;Re.EventManager=Pi;const mfe=[f2,eq,_4,vZ,Z2,fq,w2,iK,X2,C2,pq,rK],pfe=[uq,wq];Re.helper={};Re.dom={};I(mfe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Re.helper[e]=t[e])})});I(pfe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Re.dom[e]=t[e])})});Re.cellTypes=(BR=Re.cellTypes)!==null&&BR!==void 0?BR:{};I(X6(),t=>{Re.cellTypes[t]=gM(t)});Re.cellTypes.registerCellType=fi;Re.cellTypes.getCellType=gM;Re.editors=(jR=Re.editors)!==null&&jR!==void 0?jR:{};I(Hq(),t=>{Re.editors[`${Zn(t)}Editor`]=Ip(t)});Re.editors.registerEditor=Tr;Re.editors.getEditor=Ip;Re.renderers=(UR=Re.renderers)!==null&&UR!==void 0?UR:{};I(CK(),t=>{const e=Op(t);t==="base"&&(Re.renderers.cellDecorator=e),Re.renderers[`${Zn(t)}Renderer`]=e});Re.renderers.registerRenderer=qr;Re.renderers.getRenderer=Op;Re.validators=(zR=Re.validators)!==null&&zR!==void 0?zR:{};I(bK(),t=>{Re.validators[`${Zn(t)}Validator`]=uT(t)});Re.validators.registerValidator=Yl;Re.validators.getValidator=uT;Re.plugins=(YR=Re.plugins)!==null&&YR!==void 0?YR:{};I(lT(),t=>{Re.plugins[t]=Yf(t)});Re.plugins[`${Zn(Ke.PLUGIN_KEY)}Plugin`]=Ke;Re.plugins.registerPlugin=Ye;Re.plugins.getPlugin=Yf;const wfe=["id"],Vfe={__name:"RecipeDetail",setup(t){const e=Fl(!1),n=Fl(null),{vError:r,vSuccess:i,vInfo:o,vWarning:s}=uB(),a=wB(),l=dB(),{userId:u}=cB(),c=hB(null),h=l.params.id,d=Fl(""),f=Fl([{phase:"",itemCd:"",itemName:"",content:0,inPrice:0,unitPrice:0}]),m=Fl([]),p=fB({clientName:"",clientId:"",prodName:"",managerName:"",managerId:"",regDate:"",labNo:"",prodType:"",recipeId:h,userId:u}),y=[{data:"phase",type:Re.cellTypes.text,width:60,className:"htCenter"},{data:"itemCd",type:Re.cellTypes.text,width:180,className:"htCenter"},{data:"itemName",type:Re.cellTypes.text,width:720},{data:"content",type:Re.cellTypes.numeric,width:200,className:"htRight"},{data:"inPrice",type:Re.cellTypes.numeric,width:200,className:"htRight"},{data:"unitPrice",type:Re.cellTypes.numeric,width:200,className:"htRight"}],T=async()=>{if(Ov(p.prodName)){s("ì íëªì ìë ¥í´ì£¼ì¸ì.");return}if(k.value!==100){s("í¨ëì í©ì´ 100ì´ ìëëë¤. íì¸í´ì£¼ì¸ì.");return}try{const K={recipeInfo:{...p},recipeList:f.value};K.recipeInfo.regDate=AP(K.recipeInfo.regDate);const ne=await xv.saveRecipeInfo(K);p.recipeId=ne.data.recipeId,i("ì ì¥ëììµëë¤.")}catch(K){r(K.message||"ì ì¥ ì¤ ì¤ë¥ê° ë°ìíìµëë¤.")}},b=K=>{d.value=K,K==="C"?c.value=bB:K==="U"&&(c.value=SB),e.value=!0},M=K=>{d.value==="C"?(p.clientName=K.clientName,p.clientId=K.clientId):d.value==="U"&&(p.managerId=K.userId,p.managerName=K.memberNm)},R=async(K,ne)=>{var Ce,ye;if(!K)return;const ge=(ye=(Ce=n.value)==null?void 0:Ce.hotInstance)==null?void 0:ye.hotInstance;if(ge)for(const[Me,We,Tt,_e]of K){if(We==="itemCd"&&_e&&_e!==Tt)try{const g=await HP.getItemInfo(_e);if(g){ge.setDataAtRowProp(Me,"inPrice",g.inPrice||0);const w=Number(ge.getDataAtRowProp(Me,"content"));if(!isNaN(w)&&g.inPrice!=null){let C=w*g.inPrice*.001*.01;C=parseFloat(C.toFixed(7)),ge.setDataAtRowProp(Me,"unitPrice",C)}}else ge.setDataAtRowProp(Me,"inPrice",0)}catch(g){console.error("íëª© ì¡°í ì¤ë¥:",g)}if(We==="content"&&_e!==Tt){const g=Number(_e),w=Number(ge.getDataAtRowProp(Me,"inPrice"));if(!isNaN(g)&&!isNaN(w)&&w>0){const C=parseFloat((g*w*.001*.01).toFixed(7));ge.setDataAtRowProp(Me,"unitPrice",C)}}}},k=Pv(()=>{const K=f.value.reduce((ne,ge)=>ne+(Number(ge.content)||0),0);return parseFloat(K.toFixed(7))}),P=Pv(()=>f.value.reduce((K,ne)=>K+(Number(ne.inPrice)||0),0)),O=Pv(()=>f.value.reduce((K,ne)=>K+(Number(ne.unitPrice)||0),0).toFixed(7)),U=()=>{f.value.push({phase:"",itemCd:"",itemName:"",content:0,cost:0,unitPrice:0})},G=Fl(null),V=(K,ne,ge,Ce)=>{G.value=[K,ne,ge,Ce]},Z=()=>{var Ce,ye;if(!G.value){s("ì­ì í  íì ì ííì¸ì.");return}const[K,,ne]=G.value,ge=(ye=(Ce=n.value)==null?void 0:Ce.hotInstance)==null?void 0:ye.hotInstance;ge&&ge.alter("remove_row",K,ne-K+1)};gB(async()=>{var ne;if(m.value=await mB.getCodeList("prod_type"),!!((ne=n.value)==null?void 0:ne.hotInstance))if(Ov(h))p.regDate=yB();else{const ge=await xv.getRecipeInfo(h);Object.assign(p,ge.recipeInfo),f.value.splice(0,f.value.length,...ge.recipeList),z(f.value)}});const z=async K=>{var Ce,ye;const ne=(ye=(Ce=n.value)==null?void 0:Ce.hotInstance)==null?void 0:ye.hotInstance;if(!ne)return;const ge=await Promise.all(f.value.map(Me=>Me.itemCd?HP.getItemInfo(Me.itemCd).catch(()=>null):null));f.value.forEach((Me,We)=>{const Tt=ge[We];if(!Tt)return;ne.setDataAtRowProp(We,"inPrice",Tt.inPrice||0);const _e=Number(ne.getDataAtRowProp(We,"content"));if(!isNaN(_e)&&Tt.inPrice!=null){let g=_e*Tt.inPrice*.001*.01;g=parseFloat(g.toFixed(7)),ne.setDataAtRowProp(We,"unitPrice",g)}})},ue=async()=>{if(Ov(h)){o("ì²ë°©ì ë³´ê° ììµëë¤. ì ì¥ í ìëí´ì£¼ì¸ì.");return}try{const K={recipeInfo:{...p},recipeList:f.value},ne=await xv.downloadRecipe(K),ge=window.URL.createObjectURL(ne),Ce=document.createElement("a");Ce.href=ge,Ce.download=`recipe_${p.prodName}.xlsx`,Ce.click(),window.URL.revokeObjectURL(ge)}catch(K){r("ìì ë¤ì´ë¡ë ì¤í¨",K)}},ee=()=>{a.push({name:"RecipeList"})};return(K,ne)=>{const ge=Li("v-breadcrumbs"),Ce=Li("v-text-field"),ye=Li("v-col"),Me=Li("v-row"),We=Li("v-date-input"),Tt=Li("v-select"),_e=Li("v-btn"),g=Li("v-form"),w=Li("v-card-text"),C=Li("v-card"),L=Li("v-dialog");return mp(),KD(pB,null,[yh("div",{id:K.$attrs.id},null,8,wfe),Oe(ge,{items:["MES","ì°êµ¬ê´ë¦¬","ì²ë°©ìì¸"]}),Oe(C,null,{default:wt(()=>[Oe(w,null,{default:wt(()=>[Oe(g,{onSubmit:vB(T,["prevent"])},{default:wt(()=>[Oe(Me,null,{default:wt(()=>[Oe(ye,null,{default:wt(()=>[Oe(Ce,{modelValue:p.clientName,"onUpdate:modelValue":ne[0]||(ne[0]=D=>p.clientName=D),label:"ê³ ê°ì¬",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":ne[1]||(ne[1]=D=>b("C"))},null,8,["modelValue"])]),_:1}),Oe(ye,null,{default:wt(()=>[Oe(Ce,{modelValue:p.prodName,"onUpdate:modelValue":ne[2]||(ne[2]=D=>p.prodName=D),label:"ì íëª",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),Oe(Me,null,{default:wt(()=>[Oe(ye,null,{default:wt(()=>[Oe(Ce,{modelValue:p.managerName,"onUpdate:modelValue":ne[3]||(ne[3]=D=>p.managerName=D),label:"ë´ë¹ìëª",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":ne[4]||(ne[4]=D=>b("U"))},null,8,["modelValue"])]),_:1}),Oe(ye,null,{default:wt(()=>[Oe(We,{modelValue:p.regDate,"onUpdate:modelValue":ne[5]||(ne[5]=D=>p.regDate=D),label:"ë±ë¡ì¼","display-format":ZD(AP),variant:"underlined",density:"compact"},null,8,["modelValue","display-format"])]),_:1}),Oe(ye,null,{default:wt(()=>[Oe(Ce,{modelValue:p.labNo,"onUpdate:modelValue":ne[6]||(ne[6]=D=>p.labNo=D),label:"Lab No",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),Oe(ye,null,{default:wt(()=>[Oe(Tt,{modelValue:p.prodType,"onUpdate:modelValue":ne[7]||(ne[7]=D=>p.prodType=D),label:"ì íì½ë",items:m.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1})]),_:1}),Oe(Me,{class:"justify-end mb-3 mr-2",dense:""},{default:wt(()=>[Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{color:"brown-lighten-4",class:"mt-3 mr-3",text:"ì¶ê°+",density:"compact",onClick:U})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{color:"brown-lighten-4",class:"mt-3",text:"ì­ì -",density:"compact",onClick:Z})]),_:1})]),_:1}),Oe(Me,null,{default:wt(()=>[Oe(ye,null,{default:wt(()=>[Oe(g7,{ref_key:"hotTable",ref:n,data:f.value,colHeaders:["Phase","íëª©ì½ë","íëª©ëª","í¨ë","ìê°(ì)","ë¨ê°(ì/g)"],columns:y,stretchH:"none",height:430,afterChange:R,afterSelection:V},null,8,["data"])]),_:1})]),_:1}),Oe(Me,{class:"d-flex justify-end mb-2 mr-3 dense"},{default:wt(()=>[Oe(ye,{cols:"auto"},{default:wt(()=>ne[13]||(ne[13]=[yh("strong",null,"í©ê³",-1)])),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[yh("span",null,"í¨ë : "+Iv(k.value)+"%",1)]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[yh("span",null,"ìê°(ì) : "+Iv(P.value.toLocaleString("ko-kr"))+"ì",1)]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[yh("span",null,"ë¨ê°(ì/g) : "+Iv(O.value)+"ì",1)]),_:1})]),_:1}),Oe(Me,{class:"justify-end mb-3 mr-2",dense:""},{default:wt(()=>[Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"BOMì°ê²°",onClick:ne[8]||(ne[8]=D=>b("B"))})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"ì ì¥",color:"brown-lighten-4",type:"submit"})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"ì ì±ë¶(ìì¶)",color:"#FFE0B2",onClick:ne[9]||(ne[9]=D=>b("J"))})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"ë¨ê°",onClick:ue})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"ì¤êµ­ìííê°",onClick:ne[10]||(ne[10]=D=>b("G"))})]),_:1}),Oe(ye,{cols:"auto"},{default:wt(()=>[Oe(_e,{text:"ëª©ë¡",onClick:ee})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),Oe(L,{modelValue:e.value,"onUpdate:modelValue":ne[12]||(ne[12]=D=>e.value=D),width:"800px",height:"800px",persistent:""},{default:wt(()=>[(mp(),XD(CB(c.value),{id:K.id,onSelected:M,onCloseDialog:ne[11]||(ne[11]=D=>e.value=!1)},null,40,["id"]))]),_:1},8,["modelValue"])],64)}}};export{Vfe as default};
