import{a as xV,s as HV}from"./index-Z2YNGKhZ.js";import{s as NV}from"./index-D49h5Cbk.js";import{A as Nr,H as VE,J as DV,$ as $V,e as WE,o as BE,K as v1,M as kV,L as LV,U as C1,V as FV,Z as VV,W as y1,a8 as $C,p as Oe,h as dt,l as vi,a2 as WV,G as b1,t as rR,F as S1,P as BV,a0 as jV}from"./index-BCdxernO.js";import{s as R1}from"./index-DhHuXiFi.js";import{s as E1}from"./index-WWuz9eST.js";import{s as UV}from"./index-BE87lW_G.js";import{A as $a}from"./apiLab-DBKUW3x6.js";import{i as ka}from"./common-Ctgf_4Dl.js";import{e as zV}from"./exportToExcel-BIsrPQTg.js";import{s as YV}from"./index-CEOpAmiF.js";import{a as GV,b as KV,s as XV}from"./index-CKfU0QJd.js";import{A as qV}from"./apiItem-B0JHHkd5.js";import{c as Yg}from"./_commonjsHelpers-CZnAS8i4.js";import{C as ZV}from"./ClientListPop-BQhfi3oc.js";import{U as JV}from"./UserListPop-40qvmJxy.js";import{s as QV}from"./index-Dsa_8OmY.js";import"./index-BGn1OEmN.js";import"./apiBase-DJzL_JWR.js";import"./apiSystem-BBpYMteA.js";var Zh=function(t){return t&&t.Math===Math&&t},dn=Zh(typeof globalThis=="object"&&globalThis)||Zh(typeof window=="object"&&window)||Zh(typeof self=="object"&&self)||Zh(typeof Yg=="object"&&Yg)||Zh(typeof Yg=="object"&&Yg)||function(){return this}()||Function("return this")(),jE={},fn=function(t){try{return!!t()}catch{return!0}},eW=fn,Wr=!eW(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),tW=fn,Av=!tW(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),nW=Av,Gg=Function.prototype.call,yn=nW?Gg.bind(Gg):function(){return Gg.apply(Gg,arguments)},T1={},_1={}.propertyIsEnumerable,M1=Object.getOwnPropertyDescriptor,iW=M1&&!_1.call({1:2},1);T1.f=iW?function(e){var n=M1(this,e);return!!n&&n.enumerable}:_1;var Ov=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},P1=Av,I1=Function.prototype,oR=I1.call,rW=P1&&I1.bind.bind(oR,oR),gn=P1?rW:function(t){return function(){return oR.apply(t,arguments)}},A1=gn,oW=A1({}.toString),sW=A1("".slice),Bu=function(t){return sW(oW(t),8,-1)},aW=gn,lW=fn,uW=Bu,kC=Object,cW=aW("".split),hW=lW(function(){return!kC("z").propertyIsEnumerable(0)})?function(t){return uW(t)==="String"?cW(t,""):kC(t)}:kC,UE=function(t){return t==null},dW=UE,fW=TypeError,cg=function(t){if(dW(t))throw new fW("Can't call method on "+t);return t},gW=hW,mW=cg,hg=function(t){return gW(mW(t))},LC=typeof document=="object"&&document.all,In=typeof LC>"u"&&LC!==void 0?function(t){return typeof t=="function"||t===LC}:function(t){return typeof t=="function"},pW=In,mr=function(t){return typeof t=="object"?t!==null:pW(t)},FC=dn,wW=In,vW=function(t){return wW(t)?t:void 0},Nh=function(t,e){return arguments.length<2?vW(FC[t]):FC[t]&&FC[t][e]},CW=gn,dg=CW({}.isPrototypeOf),yW=dn,LP=yW.navigator,FP=LP&&LP.userAgent,xv=FP?String(FP):"",O1=dn,VC=xv,VP=O1.process,WP=O1.Deno,BP=VP&&VP.versions||WP&&WP.version,jP=BP&&BP.v8,ho,pw;jP&&(ho=jP.split("."),pw=ho[0]>0&&ho[0]<4?1:+(ho[0]+ho[1]));!pw&&VC&&(ho=VC.match(/Edge\/(\d+)/),(!ho||ho[1]>=74)&&(ho=VC.match(/Chrome\/(\d+)/),ho&&(pw=+ho[1])));var bW=pw,UP=bW,SW=fn,RW=dn,EW=RW.String,zE=!!Object.getOwnPropertySymbols&&!SW(function(){var t=Symbol("symbol detection");return!EW(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&UP&&UP<41}),TW=zE,x1=TW&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_W=Nh,MW=In,PW=dg,IW=x1,AW=Object,YE=IW?function(t){return typeof t=="symbol"}:function(t){var e=_W("Symbol");return MW(e)&&PW(e.prototype,AW(t))},OW=String,Hv=function(t){try{return OW(t)}catch{return"Object"}},xW=In,HW=Hv,NW=TypeError,zi=function(t){if(xW(t))return t;throw new NW(HW(t)+" is not a function")},DW=zi,$W=UE,fg=function(t,e){var n=t[e];return $W(n)?void 0:DW(n)},WC=yn,BC=In,jC=mr,kW=TypeError,LW=function(t,e){var n,i;if(e==="string"&&BC(n=t.toString)&&!jC(i=WC(n,t))||BC(n=t.valueOf)&&!jC(i=WC(n,t))||e!=="string"&&BC(n=t.toString)&&!jC(i=WC(n,t)))return i;throw new kW("Can't convert object to primitive value")},H1={exports:{}},zP=dn,FW=Object.defineProperty,GE=function(t,e){try{FW(zP,t,{value:e,configurable:!0,writable:!0})}catch{zP[t]=e}return e},VW=dn,WW=GE,YP="__core-js_shared__",GP=H1.exports=VW[YP]||WW(YP,{});(GP.versions||(GP.versions=[])).push({version:"3.47.0",mode:"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"});var KE=H1.exports,KP=KE,N1=function(t,e){return KP[t]||(KP[t]=e||{})},BW=cg,jW=Object,Dh=function(t){return jW(BW(t))},UW=gn,zW=Dh,YW=UW({}.hasOwnProperty),pr=Object.hasOwn||function(e,n){return YW(zW(e),n)},GW=gn,KW=0,XW=Math.random(),qW=GW(1.1.toString),XE=function(t){return"Symbol("+(t===void 0?"":t)+")_"+qW(++KW+XW,36)},ZW=dn,JW=N1,XP=pr,QW=XE,eB=zE,tB=x1,ih=ZW.Symbol,UC=JW("wks"),nB=tB?ih.for||ih:ih&&ih.withoutSetter||QW,bo=function(t){return XP(UC,t)||(UC[t]=eB&&XP(ih,t)?ih[t]:nB("Symbol."+t)),UC[t]},iB=yn,qP=mr,ZP=YE,rB=fg,oB=LW,sB=bo,aB=TypeError,lB=sB("toPrimitive"),uB=function(t,e){if(!qP(t)||ZP(t))return t;var n=rB(t,lB),i;if(n){if(e===void 0&&(e="default"),i=iB(n,t,e),!qP(i)||ZP(i))return i;throw new aB("Can't convert object to primitive value")}return e===void 0&&(e="number"),oB(t,e)},cB=uB,hB=YE,D1=function(t){var e=cB(t,"string");return hB(e)?e:e+""},dB=dn,JP=mr,sR=dB.document,fB=JP(sR)&&JP(sR.createElement),qE=function(t){return fB?sR.createElement(t):{}},gB=Wr,mB=fn,pB=qE,$1=!gB&&!mB(function(){return Object.defineProperty(pB("div"),"a",{get:function(){return 7}}).a!==7}),wB=Wr,vB=yn,CB=T1,yB=Ov,bB=hg,SB=D1,RB=pr,EB=$1,QP=Object.getOwnPropertyDescriptor;jE.f=wB?QP:function(e,n){if(e=bB(e),n=SB(n),EB)try{return QP(e,n)}catch{}if(RB(e,n))return yB(!vB(CB.f,e,n),e[n])};var oa={},TB=Wr,_B=fn,k1=TB&&_B(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),MB=mr,PB=String,IB=TypeError,bn=function(t){if(MB(t))return t;throw new IB(PB(t)+" is not an object")},AB=Wr,OB=$1,xB=k1,Kg=bn,eI=D1,HB=TypeError,zC=Object.defineProperty,NB=Object.getOwnPropertyDescriptor,YC="enumerable",GC="configurable",KC="writable";oa.f=AB?xB?function(e,n,i){if(Kg(e),n=eI(n),Kg(i),typeof e=="function"&&n==="prototype"&&"value"in i&&KC in i&&!i[KC]){var r=NB(e,n);r&&r[KC]&&(e[n]=i.value,i={configurable:GC in i?i[GC]:r[GC],enumerable:YC in i?i[YC]:r[YC],writable:!1})}return zC(e,n,i)}:zC:function(e,n,i){if(Kg(e),n=eI(n),Kg(i),OB)try{return zC(e,n,i)}catch{}if("get"in i||"set"in i)throw new HB("Accessors not supported");return"value"in i&&(e[n]=i.value),e};var DB=Wr,$B=oa,kB=Ov,$h=DB?function(t,e,n){return $B.f(t,e,kB(1,n))}:function(t,e,n){return t[e]=n,t},L1={exports:{}},aR=Wr,LB=pr,F1=Function.prototype,FB=aR&&Object.getOwnPropertyDescriptor,VB=LB(F1,"name"),WB=VB&&(!aR||aR&&FB(F1,"name").configurable),BB={CONFIGURABLE:WB},jB=gn,UB=In,lR=KE,zB=jB(Function.toString);UB(lR.inspectSource)||(lR.inspectSource=function(t){return zB(t)});var YB=lR.inspectSource,GB=dn,KB=In,tI=GB.WeakMap,XB=KB(tI)&&/native code/.test(String(tI)),qB=N1,ZB=XE,nI=qB("keys"),ZE=function(t){return nI[t]||(nI[t]=ZB(t))},JE={},JB=XB,V1=dn,QB=mr,ej=$h,XC=pr,qC=KE,tj=ZE,nj=JE,iI="Object already initialized",uR=V1.TypeError,ij=V1.WeakMap,ww,Vf,vw,rj=function(t){return vw(t)?Vf(t):ww(t,{})},oj=function(t){return function(e){var n;if(!QB(e)||(n=Vf(e)).type!==t)throw new uR("Incompatible receiver, "+t+" required");return n}};if(JB||qC.state){var To=qC.state||(qC.state=new ij);To.get=To.get,To.has=To.has,To.set=To.set,ww=function(t,e){if(To.has(t))throw new uR(iI);return e.facade=t,To.set(t,e),e},Vf=function(t){return To.get(t)||{}},vw=function(t){return To.has(t)}}else{var tc=tj("state");nj[tc]=!0,ww=function(t,e){if(XC(t,tc))throw new uR(iI);return e.facade=t,ej(t,tc,e),e},Vf=function(t){return XC(t,tc)?t[tc]:{}},vw=function(t){return XC(t,tc)}}var QE={set:ww,get:Vf,has:vw,enforce:rj,getterFor:oj},e0=gn,sj=fn,aj=In,Xg=pr,cR=Wr,lj=BB.CONFIGURABLE,uj=YB,W1=QE,cj=W1.enforce,hj=W1.get,rI=String,Wp=Object.defineProperty,dj=e0("".slice),fj=e0("".replace),gj=e0([].join),mj=cR&&!sj(function(){return Wp(function(){},"length",{value:8}).length!==8}),pj=String(String).split("String"),wj=L1.exports=function(t,e,n){dj(rI(e),0,7)==="Symbol("&&(e="["+fj(rI(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Xg(t,"name")||lj&&t.name!==e)&&(cR?Wp(t,"name",{value:e,configurable:!0}):t.name=e),mj&&n&&Xg(n,"arity")&&t.length!==n.arity&&Wp(t,"length",{value:n.arity});try{n&&Xg(n,"constructor")&&n.constructor?cR&&Wp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=cj(t);return Xg(i,"source")||(i.source=gj(pj,typeof e=="string"?e:"")),t};Function.prototype.toString=wj(function(){return aj(this)&&hj(this).source||uj(this)},"toString");var B1=L1.exports,vj=In,Cj=oa,yj=B1,bj=GE,t0=function(t,e,n,i){i||(i={});var r=i.enumerable,o=i.name!==void 0?i.name:e;if(vj(n)&&yj(n,o,i),i.global)r?t[e]=n:bj(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch{}r?t[e]=n:Cj.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},j1={},Sj=Math.ceil,Rj=Math.floor,Ej=Math.trunc||function(e){var n=+e;return(n>0?Rj:Sj)(n)},Tj=Ej,gg=function(t){var e=+t;return e!==e||e===0?0:Tj(e)},_j=gg,Mj=Math.max,Pj=Math.min,Ij=function(t,e){var n=_j(t);return n<0?Mj(n+e,0):Pj(n,e)},Aj=gg,Oj=Math.min,xj=function(t){var e=Aj(t);return e>0?Oj(e,9007199254740991):0},Hj=xj,kh=function(t){return Hj(t.length)},Nj=hg,Dj=Ij,$j=kh,kj=function(t){return function(e,n,i){var r=Nj(e),o=$j(r);if(o===0)return!t&&-1;var s=Dj(i,o),a;if(t&&n!==n){for(;o>s;)if(a=r[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},Lj={indexOf:kj(!1)},Fj=gn,ZC=pr,Vj=hg,Wj=Lj.indexOf,Bj=JE,oI=Fj([].push),U1=function(t,e){var n=Vj(t),i=0,r=[],o;for(o in n)!ZC(Bj,o)&&ZC(n,o)&&oI(r,o);for(;e.length>i;)ZC(n,o=e[i++])&&(~Wj(r,o)||oI(r,o));return r},n0=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],jj=U1,Uj=n0,zj=Uj.concat("length","prototype");j1.f=Object.getOwnPropertyNames||function(e){return jj(e,zj)};var z1={};z1.f=Object.getOwnPropertySymbols;var Yj=Nh,Gj=gn,Kj=j1,Xj=z1,qj=bn,Zj=Gj([].concat),Jj=Yj("Reflect","ownKeys")||function(e){var n=Kj.f(qj(e)),i=Xj.f;return i?Zj(n,i(e)):n},sI=pr,Qj=Jj,eU=jE,tU=oa,Y1=function(t,e,n){for(var i=Qj(e),r=tU.f,o=eU.f,s=0;s<i.length;s++){var a=i[s];!sI(t,a)&&!(n&&sI(n,a))&&r(t,a,o(e,a))}},nU=fn,iU=In,rU=/#|\.prototype\./,mg=function(t,e){var n=sU[oU(t)];return n===lU?!0:n===aU?!1:iU(e)?nU(e):!!e},oU=mg.normalize=function(t){return String(t).replace(rU,".").toLowerCase()},sU=mg.data={},aU=mg.NATIVE="N",lU=mg.POLYFILL="P",uU=mg,qg=dn,cU=jE.f,hU=$h,dU=t0,fU=GE,gU=Y1,mU=uU,St=function(t,e){var n=t.target,i=t.global,r=t.stat,o,s,a,l,u,c;if(i?s=qg:r?s=qg[n]||fU(n,{}):s=qg[n]&&qg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=cU(s,a),l=c&&c.value):l=s[a],o=mU(i?a:n+(r?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;gU(u,l)}(t.sham||l&&l.sham)&&hU(u,"sham",!0),dU(s,a,u,t)}},pU=Av,G1=Function.prototype,aI=G1.apply,lI=G1.call,pg=typeof Reflect=="object"&&Reflect.apply||(pU?lI.bind(aI):function(){return lI.apply(aI,arguments)}),wU=gn,vU=zi,K1=function(t,e,n){try{return wU(vU(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},CU=mr,yU=function(t){return CU(t)||t===null},bU=yU,SU=String,RU=TypeError,EU=function(t){if(bU(t))return t;throw new RU("Can't set "+SU(t)+" as a prototype")},TU=K1,_U=mr,MU=cg,PU=EU,X1=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=TU(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(r,o){return MU(r),PU(o),_U(r)&&(t?n(r,o):r.__proto__=o),r}}():void 0),IU=oa.f,AU=function(t,e,n){n in t||IU(t,n,{configurable:!0,get:function(){return e[n]},set:function(i){e[n]=i}})},OU=In,xU=mr,uI=X1,HU=function(t,e,n){var i,r;return uI&&OU(i=e.constructor)&&i!==n&&xU(r=i.prototype)&&r!==n.prototype&&uI(t,r),t},NU=bo,DU=NU("toStringTag"),q1={};q1[DU]="z";var $U=String(q1)==="[object z]",kU=$U,LU=In,Bp=Bu,FU=bo,VU=FU("toStringTag"),WU=Object,BU=Bp(function(){return arguments}())==="Arguments",jU=function(t,e){try{return t[e]}catch{}},Z1=kU?Bp:function(t){var e,n,i;return t===void 0?"Undefined":t===null?"Null":typeof(n=jU(e=WU(t),VU))=="string"?n:BU?Bp(e):(i=Bp(e))==="Object"&&LU(e.callee)?"Arguments":i},UU=Z1,zU=String,Nv=function(t){if(UU(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return zU(t)},YU=Nv,GU=function(t,e){return t===void 0?arguments.length<2?"":e:YU(t)},KU=mr,XU=$h,qU=function(t,e){KU(e)&&"cause"in e&&XU(t,"cause",e.cause)},ZU=gn,J1=Error,JU=ZU("".replace),QU=function(t){return String(new J1(t).stack)}("zxcasd"),Q1=/\n\s*at [^:]*:[^\n]*/,ez=Q1.test(QU),tz=function(t,e){if(ez&&typeof t=="string"&&!J1.prepareStackTrace)for(;e--;)t=JU(t,Q1,"");return t},nz=fn,iz=Ov,rz=!nz(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",iz(1,7)),t.stack!==7):!0}),oz=$h,sz=tz,az=rz,cI=Error.captureStackTrace,lz=function(t,e,n,i){az&&(cI?cI(t,e):oz(t,"stack",sz(n,i)))},hI=Nh,uz=pr,dI=$h,cz=dg,fI=X1,gI=Y1,mI=AU,hz=HU,dz=GU,fz=qU,gz=lz,mz=Wr,pz=function(t,e,n,i){var r="stackTraceLimit",o=i?2:1,s=t.split("."),a=s[s.length-1],l=hI.apply(null,s);if(l){var u=l.prototype;if(uz(u,"cause")&&delete u.cause,!n)return l;var c=hI("Error"),h=e(function(d,f){var m=dz(i?f:d,void 0),v=i?new l(d):new l;return m!==void 0&&dI(v,"message",m),gz(v,h,v.stack,2),this&&cz(u,this)&&hz(v,this,h),arguments.length>o&&fz(v,arguments[o]),v});h.prototype=u,a!=="Error"?fI?fI(h,c):gI(h,c,{name:!0}):mz&&r in l&&(mI(h,l,r),mI(h,l,"prepareStackTrace")),gI(h,l);try{u.name!==a&&dI(u,"name",a),u.constructor=h}catch{}return h}},eN=St,wz=dn,hs=pg,tN=pz,hR="WebAssembly",pI=wz[hR],Cw=new Error("e",{cause:7}).cause!==7,ju=function(t,e){var n={};n[t]=tN(t,e,Cw),eN({global:!0,constructor:!0,arity:1,forced:Cw},n)},i0=function(t,e){if(pI&&pI[t]){var n={};n[t]=tN(hR+"."+t,e,Cw),eN({target:hR,stat:!0,constructor:!0,arity:1,forced:Cw},n)}};ju("Error",function(t){return function(n){return hs(t,this,arguments)}});ju("EvalError",function(t){return function(n){return hs(t,this,arguments)}});ju("RangeError",function(t){return function(n){return hs(t,this,arguments)}});ju("ReferenceError",function(t){return function(n){return hs(t,this,arguments)}});ju("SyntaxError",function(t){return function(n){return hs(t,this,arguments)}});ju("TypeError",function(t){return function(n){return hs(t,this,arguments)}});ju("URIError",function(t){return function(n){return hs(t,this,arguments)}});i0("CompileError",function(t){return function(n){return hs(t,this,arguments)}});i0("LinkError",function(t){return function(n){return hs(t,this,arguments)}});i0("RuntimeError",function(t){return function(n){return hs(t,this,arguments)}});var vz=Bu,nN=Array.isArray||function(e){return vz(e)==="Array"},Cz=Wr,yz=nN,bz=TypeError,Sz=Object.getOwnPropertyDescriptor,Rz=Cz&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),iN=Rz?function(t,e){if(yz(t)&&!Sz(t,"length").writable)throw new bz("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Ez=TypeError,Tz=9007199254740991,rN=function(t){if(t>Tz)throw Ez("Maximum allowed index exceeded");return t},_z=St,Mz=Dh,Pz=kh,Iz=iN,Az=rN,Oz=fn,xz=Oz(function(){return[].push.call({length:4294967296},1)!==4294967297}),Hz=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Nz=xz||!Hz();_z({target:"Array",proto:!0,arity:1,forced:Nz},{push:function(e){var n=Mz(this),i=Pz(n),r=arguments.length;Az(i+r);for(var o=0;o<r;o++)n[i]=arguments[o],i++;return Iz(n,i),i}});var Dz=Bu,$z=gn,kz=function(t){if(Dz(t)==="Function")return $z(t)},wI=kz,Lz=zi,Fz=Av,Vz=wI(wI.bind),oN=function(t,e){return Lz(t),e===void 0?t:Fz?Vz(t,e):function(){return t.apply(e,arguments)}},sN={},Wz=bo,Bz=sN,jz=Wz("iterator"),Uz=Array.prototype,zz=function(t){return t!==void 0&&(Bz.Array===t||Uz[jz]===t)},Yz=Z1,vI=fg,Gz=UE,Kz=sN,Xz=bo,qz=Xz("iterator"),r0=function(t){if(!Gz(t))return vI(t,qz)||vI(t,"@@iterator")||Kz[Yz(t)]},Zz=yn,Jz=zi,Qz=bn,eY=Hv,tY=r0,nY=TypeError,iY=function(t,e){var n=arguments.length<2?tY(t):e;if(Jz(n))return Qz(Zz(n,t));throw new nY(eY(t)+" is not iterable")},rY=yn,CI=bn,oY=fg,Yi=function(t,e,n){var i,r;CI(t);try{if(i=oY(t,"return"),!i){if(e==="throw")throw n;return n}i=rY(i,t)}catch(o){r=!0,i=o}if(e==="throw")throw n;if(r)throw i;return CI(i),n},sY=oN,aY=yn,lY=bn,uY=Hv,cY=zz,hY=kh,yI=dg,dY=iY,fY=r0,bI=Yi,gY=TypeError,jp=function(t,e){this.stopped=t,this.result=e},SI=jp.prototype,Lh=function(t,e,n){var i=n&&n.that,r=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=sY(e,i),u,c,h,d,f,m,v,b=function(_){return u&&bI(u,"normal"),new jp(!0,_)},T=function(_){return r?(lY(_),a?l(_[0],_[1],b):l(_[0],_[1])):a?l(_,b):l(_)};if(o)u=t.iterator;else if(s)u=t;else{if(c=fY(t),!c)throw new gY(uY(t)+" is not iterable");if(cY(c)){for(h=0,d=hY(t);d>h;h++)if(f=T(t[h]),f&&yI(SI,f))return f;return new jp(!1)}u=dY(t,c)}for(m=o?t.next:u.next;!(v=aY(m,u)).done;){try{f=T(v.value)}catch(_){bI(u,"throw",_)}if(typeof f=="object"&&f&&yI(SI,f))return f}return new jp(!1)},mY=Wr,pY=oa,wY=Ov,aN=function(t,e,n){mY?pY.f(t,e,wY(0,n)):t[e]=n},vY=St,CY=Lh,yY=aN;vY({target:"Object",stat:!0},{fromEntries:function(e){var n={};return CY(e,function(i,r){yY(n,i,r)},{AS_ENTRIES:!0}),n}});var JC=gn,Zg=Set.prototype,ds={Set,add:JC(Zg.add),has:JC(Zg.has),remove:JC(Zg.delete),proto:Zg},bY=ds.has,Uu=function(t){return bY(t),t},SY=yn,zu=function(t,e,n){for(var i=n?t:t.iterator,r=t.next,o,s;!(o=SY(r,i)).done;)if(s=e(o.value),s!==void 0)return s},lN=gn,RY=zu,uN=ds,EY=uN.Set,cN=uN.proto,TY=lN(cN.forEach),hN=lN(cN.keys),_Y=hN(new EY).next,wg=function(t,e,n){return n?RY({iterator:hN(t),next:_Y},e):TY(t,e)},dN=ds,MY=wg,PY=dN.Set,IY=dN.add,o0=function(t){var e=new PY;return MY(t,function(n){IY(e,n)}),e},AY=K1,OY=ds,vg=AY(OY.proto,"size","get")||function(t){return t.size},fs=function(t){return{iterator:t,next:t.next,done:!1}},RI=zi,fN=bn,EI=yn,xY=gg,HY=fs,TI="Invalid size",NY=RangeError,DY=TypeError,$Y=Math.max,gN=function(t,e){this.set=t,this.size=$Y(e,0),this.has=RI(t.has),this.keys=RI(t.keys)};gN.prototype={getIterator:function(){return HY(fN(EI(this.keys,this.set)))},includes:function(t){return EI(this.has,this.set,t)}};var Yu=function(t){fN(t);var e=+t.size;if(e!==e)throw new DY(TI);var n=xY(e);if(n<0)throw new NY(TI);return new gN(t,n)},kY=Uu,mN=ds,LY=o0,FY=vg,VY=Yu,WY=wg,BY=zu,jY=mN.has,_I=mN.remove,UY=function(e){var n=kY(this),i=VY(e),r=LY(n);return FY(n)<=i.size?WY(n,function(o){i.includes(o)&&_I(r,o)}):BY(i.getIterator(),function(o){jY(r,o)&&_I(r,o)}),r},zY=Nh,MI=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},PI=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Gu=function(t,e){var n=zY("Set");try{new n()[t](MI(0));try{return new n()[t](MI(-1)),!1}catch{if(!e)return!0;try{return new n()[t](PI(-1/0)),!1}catch{var i=new n([1,2]);return e(i[t](PI(1/0)))}}}catch{return!1}},YY=St,GY=UY,KY=fn,XY=Gu,qY=!XY("difference",function(t){return t.size===0}),ZY=qY||KY(function(){var t={size:1,has:function(){return!0},keys:function(){var n=0;return{next:function(){var i=n++>1;return e.has(1)&&e.clear(),{done:i,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});YY({target:"Set",proto:!0,real:!0,forced:ZY},{difference:GY});var JY=Uu,s0=ds,QY=vg,eG=Yu,tG=wg,nG=zu,iG=s0.Set,II=s0.add,rG=s0.has,oG=function(e){var n=JY(this),i=eG(e),r=new iG;return QY(n)>i.size?nG(i.getIterator(),function(o){rG(n,o)&&II(r,o)}):tG(n,function(o){i.includes(o)&&II(r,o)}),r},sG=St,aG=fn,lG=oG,uG=Gu,cG=!uG("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||aG(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});sG({target:"Set",proto:!0,real:!0,forced:cG},{intersection:lG});var hG=Uu,dG=ds.has,fG=vg,gG=Yu,mG=wg,pG=zu,wG=Yi,vG=function(e){var n=hG(this),i=gG(e);if(fG(n)<=i.size)return mG(n,function(o){if(i.includes(o))return!1},!0)!==!1;var r=i.getIterator();return pG(r,function(o){if(dG(n,o))return wG(r,"normal",!1)})!==!1},CG=St,yG=vG,bG=Gu,SG=!bG("isDisjointFrom",function(t){return!t});CG({target:"Set",proto:!0,real:!0,forced:SG},{isDisjointFrom:yG});var RG=Uu,EG=vg,TG=wg,_G=Yu,MG=function(e){var n=RG(this),i=_G(e);return EG(n)>i.size?!1:TG(n,function(r){if(!i.includes(r))return!1},!0)!==!1},PG=St,IG=MG,AG=Gu,OG=!AG("isSubsetOf",function(t){return t});PG({target:"Set",proto:!0,real:!0,forced:OG},{isSubsetOf:IG});var xG=Uu,HG=ds.has,NG=vg,DG=Yu,$G=zu,kG=Yi,LG=function(e){var n=xG(this),i=DG(e);if(NG(n)<i.size)return!1;var r=i.getIterator();return $G(r,function(o){if(!HG(n,o))return kG(r,"normal",!1)})!==!1},FG=St,VG=LG,WG=Gu,BG=!WG("isSupersetOf",function(t){return!t});FG({target:"Set",proto:!0,real:!0,forced:BG},{isSupersetOf:VG});var jG=Uu,a0=ds,UG=o0,zG=Yu,YG=zu,GG=a0.add,KG=a0.has,XG=a0.remove,qG=function(e){var n=jG(this),i=zG(e).getIterator(),r=UG(n);return YG(i,function(o){KG(n,o)?XG(r,o):GG(r,o)}),r},pN=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}},ZG=St,JG=qG,QG=pN,e2=Gu,t2=!e2("symmetricDifference")||!QG("symmetricDifference");ZG({target:"Set",proto:!0,real:!0,forced:t2},{symmetricDifference:JG});var n2=Uu,i2=ds.add,r2=o0,o2=Yu,s2=zu,a2=function(e){var n=n2(this),i=o2(e).getIterator(),r=r2(n);return s2(i,function(o){i2(r,o)}),r},l2=St,u2=a2,c2=pN,h2=Gu,d2=!h2("union")||!c2("union");l2({target:"Set",proto:!0,real:!0,forced:d2},{union:u2});var f2=dg,g2=TypeError,m2=function(t,e){if(f2(e,t))return t;throw new g2("Incorrect invocation")},p2=fn,w2=!p2(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),v2=pr,C2=In,y2=Dh,b2=ZE,S2=w2,AI=b2("IE_PROTO"),dR=Object,R2=dR.prototype,wN=S2?dR.getPrototypeOf:function(t){var e=y2(t);if(v2(e,AI))return e[AI];var n=e.constructor;return C2(n)&&e instanceof n?n.prototype:e instanceof dR?R2:null},OI=B1,E2=oa,T2=function(t,e,n){return n.get&&OI(n.get,e,{getter:!0}),n.set&&OI(n.set,e,{setter:!0}),E2.f(t,e,n)},vN={},_2=U1,M2=n0,P2=Object.keys||function(e){return _2(e,M2)},I2=Wr,A2=k1,O2=oa,x2=bn,H2=hg,N2=P2;vN.f=I2&&!A2?Object.defineProperties:function(e,n){x2(e);for(var i=H2(n),r=N2(n),o=r.length,s=0,a;o>s;)O2.f(e,a=r[s++],i[a]);return e};var D2=Nh,CN=D2("document","documentElement"),$2=bn,k2=vN,xI=n0,L2=JE,F2=CN,V2=qE,W2=ZE,HI=">",NI="<",fR="prototype",gR="script",yN=W2("IE_PROTO"),QC=function(){},bN=function(t){return NI+gR+HI+t+NI+"/"+gR+HI},DI=function(t){t.write(bN("")),t.close();var e=t.parentWindow.Object;return t=null,e},B2=function(){var t=V2("iframe"),e="java"+gR+":",n;return t.style.display="none",F2.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(bN("document.F=Object")),n.close(),n.F},Jg,Up=function(){try{Jg=new ActiveXObject("htmlfile")}catch{}Up=typeof document<"u"?document.domain&&Jg?DI(Jg):B2():DI(Jg);for(var t=xI.length;t--;)delete Up[fR][xI[t]];return Up()};L2[yN]=!0;var SN=Object.create||function(e,n){var i;return e!==null?(QC[fR]=$2(e),i=new QC,QC[fR]=null,i[yN]=e):i=Up(),n===void 0?i:k2.f(i,n)},j2=fn,U2=In,z2=mr,$I=wN,Y2=t0,G2=bo,mR=G2("iterator"),Hu,ey,ty;[].keys&&(ty=[].keys(),"next"in ty&&(ey=$I($I(ty)),ey!==Object.prototype&&(Hu=ey)));var K2=!z2(Hu)||j2(function(){var t={};return Hu[mR].call(t)!==t});K2&&(Hu={});U2(Hu[mR])||Y2(Hu,mR,function(){return this});var RN={IteratorPrototype:Hu},X2=St,q2=dn,Z2=m2,J2=bn,Q2=In,eK=wN,tK=T2,nK=aN,iK=fn,l0=pr,rK=bo,rs=RN.IteratorPrototype,oK=Wr,ny="constructor",EN="Iterator",kI=rK("toStringTag"),TN=TypeError,iy=q2[EN],_N=!Q2(iy)||iy.prototype!==rs||!iK(function(){iy({})}),u0=function(){if(Z2(this,rs),eK(this)===rs)throw new TN("Abstract class Iterator not directly constructable")},MN=function(t,e){oK?tK(rs,t,{configurable:!0,get:function(){return e},set:function(n){if(J2(this),this===rs)throw new TN("You can't redefine this property");l0(this,t)?this[t]=n:nK(this,t,n)}}):rs[t]=e};l0(rs,kI)||MN(kI,EN);(_N||!l0(rs,ny)||rs[ny]===Object)&&MN(ny,u0);u0.prototype=rs;X2({global:!0,constructor:!0,forced:_N},{Iterator:u0});var sK=t0,aK=function(t,e,n){for(var i in e)sK(t,i,e[i],n);return t},lK=function(t,e){return{value:t,done:e}},uK=Yi,cK=function(t,e,n){for(var i=t.length-1;i>=0;i--)if(t[i]!==void 0)try{n=uK(t[i].iterator,e,n)}catch(r){e="throw",n=r}if(e==="throw")throw n;return n},hK=yn,dK=SN,fK=$h,gK=aK,mK=bo,PN=QE,pK=fg,wK=RN.IteratorPrototype,Qg=lK,em=Yi,vK=cK,CK=mK("toStringTag"),IN="IteratorHelper",AN="WrapForValidIterator",ry="normal",LI="throw",yK=PN.set,ON=function(t){var e=PN.getterFor(t?AN:IN);return gK(dK(wK),{next:function(){var i=e(this);if(t)return i.nextHandler();if(i.done)return Qg(void 0,!0);try{var r=i.nextHandler();return i.returnHandlerResult?r:Qg(r,i.done)}catch(o){throw i.done=!0,o}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var r=pK(i,"return");return r?hK(r,i):Qg(void 0,!0)}if(n.inner)try{em(n.inner.iterator,ry)}catch(o){return em(i,LI,o)}if(n.openIters)try{vK(n.openIters,ry)}catch(o){return em(i,LI,o)}return i&&em(i,ry),Qg(void 0,!0)}})},bK=ON(!0),xN=ON(!1);fK(xN,CK,"Iterator Helper");var c0=function(t,e,n){var i=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?AN:IN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,yK(this,s)};return i.prototype=e?bK:xN,i},SK=bn,RK=Yi,HN=function(t,e,n,i){try{return i?e(SK(n)[0],n[1]):e(n)}catch(r){RK(t,"throw",r)}},h0=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}},EK=dn,pl=function(t,e){var n=EK.Iterator,i=n&&n.prototype,r=i&&i[t],o=!1;if(r)try{r.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return r},TK=St,NN=yn,_K=zi,DN=bn,MK=fs,PK=c0,IK=HN,AK=Yi,OK=h0,xK=pl,$N=!OK("filter",function(){}),pR=!$N&&xK("filter",TypeError),HK=$N||pR,NK=PK(function(){for(var t=this.iterator,e=this.predicate,n=this.next,i,r,o;;){if(i=DN(NN(n,t)),r=this.done=!!i.done,r)return;if(o=i.value,IK(t,e,[o,this.counter++],!0))return o}});TK({target:"Iterator",proto:!0,real:!0,forced:HK},{filter:function(e){DN(this);try{_K(e)}catch(n){AK(this,"throw",n)}return pR?NN(pR,this,e):new NK(MK(this),{predicate:e})}});var DK=St,$K=yn,kK=Lh,LK=zi,FK=bn,VK=fs,WK=Yi,BK=pl,oy=BK("forEach",TypeError);DK({target:"Iterator",proto:!0,real:!0,forced:oy},{forEach:function(e){FK(this);try{LK(e)}catch(r){WK(this,"throw",r)}if(oy)return $K(oy,this,e);var n=VK(this),i=0;kK(n,function(r){e(r,i++)},{IS_RECORD:!0})}});var jK=St,kN=yn,UK=zi,LN=bn,zK=fs,YK=c0,GK=HN,KK=Yi,XK=h0,qK=pl,FN=!XK("map",function(){}),wR=!FN&&qK("map",TypeError),ZK=FN||wR,JK=YK(function(){var t=this.iterator,e=LN(kN(this.next,t)),n=this.done=!!e.done;if(!n)return GK(t,this.mapper,[e.value,this.counter++],!0)});jK({target:"Iterator",proto:!0,real:!0,forced:ZK},{map:function(e){LN(this);try{UK(e)}catch(n){KK(this,"throw",n)}return wR?kN(wR,this,e):new JK(zK(this),{mapper:e})}});var QK=gn,d0=QK([].slice),e3=TypeError,VN=function(t,e){if(t<e)throw new e3("Not enough arguments");return t},t3=xv,n3=/(?:ipad|iphone|ipod).*applewebkit/i.test(t3),Jh=dn,i3=xv,r3=Bu,tm=function(t){return i3.slice(0,t.length)===t},WN=function(){return tm("Bun/")?"BUN":tm("Cloudflare-Workers")?"CLOUDFLARE":tm("Deno/")?"DENO":tm("Node.js/")?"NODE":Jh.Bun&&typeof Bun.version=="string"?"BUN":Jh.Deno&&typeof Deno.version=="object"?"DENO":r3(Jh.process)==="process"?"NODE":Jh.window&&Jh.document?"BROWSER":"REST"}(),o3=WN,s3=o3==="NODE",dr=dn,a3=pg,l3=oN,FI=In,u3=pr,BN=fn,VI=CN,c3=d0,WI=qE,h3=VN,d3=n3,f3=s3,vR=dr.setImmediate,CR=dr.clearImmediate,g3=dr.process,sy=dr.Dispatch,m3=dr.Function,BI=dr.MessageChannel,p3=dr.String,ay=0,ff={},jI="onreadystatechange",Wf,bl,ly,uy;BN(function(){Wf=dr.location});var f0=function(t){if(u3(ff,t)){var e=ff[t];delete ff[t],e()}},cy=function(t){return function(){f0(t)}},UI=function(t){f0(t.data)},zI=function(t){dr.postMessage(p3(t),Wf.protocol+"//"+Wf.host)};(!vR||!CR)&&(vR=function(e){h3(arguments.length,1);var n=FI(e)?e:m3(e),i=c3(arguments,1);return ff[++ay]=function(){a3(n,void 0,i)},bl(ay),ay},CR=function(e){delete ff[e]},f3?bl=function(t){g3.nextTick(cy(t))}:sy&&sy.now?bl=function(t){sy.now(cy(t))}:BI&&!d3?(ly=new BI,uy=ly.port2,ly.port1.onmessage=UI,bl=l3(uy.postMessage,uy)):dr.addEventListener&&FI(dr.postMessage)&&!dr.importScripts&&Wf&&Wf.protocol!=="file:"&&!BN(zI)?(bl=zI,dr.addEventListener("message",UI,!1)):jI in WI("script")?bl=function(t){VI.appendChild(WI("script"))[jI]=function(){VI.removeChild(this),f0(t)}}:bl=function(t){setTimeout(cy(t),0)});var jN={set:vR,clear:CR},w3=St,v3=dn,YI=jN.clear;w3({global:!0,bind:!0,enumerable:!0,forced:v3.clearImmediate!==YI},{clearImmediate:YI});var UN=dn,C3=pg,y3=In,b3=WN,S3=xv,R3=d0,E3=VN,T3=UN.Function,_3=/MSIE .\./.test(S3)||b3==="BUN"&&function(){var t=UN.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),M3=function(t,e){var n=e?2:1;return _3?function(i,r){var o=E3(arguments.length,1)>n,s=y3(i)?i:T3(i),a=o?R3(arguments,n):[],l=o?function(){C3(s,this,a)}:s;return e?t(l,r):t(l)}:t},P3=St,zN=dn,GI=jN.set,I3=M3,KI=zN.setImmediate?I3(GI,!1):GI;P3({global:!0,bind:!0,enumerable:!0,forced:zN.setImmediate!==KI},{setImmediate:KI});/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:YN,setPrototypeOf:XI,isFrozen:A3,getPrototypeOf:O3,getOwnPropertyDescriptor:x3}=Object;let{freeze:Ri,seal:Fr,create:yR}=Object,{apply:bR,construct:SR}=typeof Reflect<"u"&&Reflect;Ri||(Ri=function(e){return e});Fr||(Fr=function(e){return e});bR||(bR=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return e.apply(n,r)});SR||(SR=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new e(...i)});const nm=Ei(Array.prototype.forEach),H3=Ei(Array.prototype.lastIndexOf),qI=Ei(Array.prototype.pop),Qh=Ei(Array.prototype.push),N3=Ei(Array.prototype.splice),zp=Ei(String.prototype.toLowerCase),hy=Ei(String.prototype.toString),dy=Ei(String.prototype.match),ed=Ei(String.prototype.replace),D3=Ei(String.prototype.indexOf),$3=Ei(String.prototype.trim),no=Ei(Object.prototype.hasOwnProperty),ci=Ei(RegExp.prototype.test),td=k3(TypeError);function Ei(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return bR(t,e,i)}}function k3(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return SR(t,n)}}function Xe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zp;XI&&XI(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const o=n(r);o!==r&&(A3(e)||(e[i]=o),r=o)}t[r]=!0}return t}function L3(t){for(let e=0;e<t.length;e++)no(t,e)||(t[e]=null);return t}function $s(t){const e=yR(null);for(const[n,i]of YN(t))no(t,n)&&(Array.isArray(i)?e[n]=L3(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=$s(i):e[n]=i);return e}function nd(t,e){for(;t!==null;){const i=x3(t,e);if(i){if(i.get)return Ei(i.get);if(typeof i.value=="function")return Ei(i.value)}t=O3(t)}function n(){return null}return n}const ZI=Ri(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),fy=Ri(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),gy=Ri(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F3=Ri(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),my=Ri(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),V3=Ri(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),JI=Ri(["#text"]),QI=Ri(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),py=Ri(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eA=Ri(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),im=Ri(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W3=Fr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),B3=Fr(/<%[\w\W]*|[\w\W]*%>/gm),j3=Fr(/\$\{[\w\W]*/gm),U3=Fr(/^data-[\-\w.\u00B7-\uFFFF]+$/),z3=Fr(/^aria-[\-\w]+$/),GN=Fr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y3=Fr(/^(?:\w+script|data):/i),G3=Fr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),KN=Fr(/^html$/i),K3=Fr(/^[a-z][.\w]*(-[.\w]+)+$/i);var tA=Object.freeze({__proto__:null,ARIA_ATTR:z3,ATTR_WHITESPACE:G3,CUSTOM_ELEMENT:K3,DATA_ATTR:U3,DOCTYPE_NAME:KN,ERB_EXPR:B3,IS_ALLOWED_URI:GN,IS_SCRIPT_OR_DATA:Y3,MUSTACHE_EXPR:W3,TMPLIT_EXPR:j3});const id={element:1,text:3,progressingInstruction:7,comment:8,document:9},X3=function(){return typeof window>"u"?null:window},q3=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},nA=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function XN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:X3();const e=ve=>XN(ve);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==id.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,v=nd(m,"cloneNode"),b=nd(m,"remove"),T=nd(m,"nextSibling"),_=nd(m,"childNodes"),D=nd(m,"parentNode");if(typeof s=="function"){const ve=n.createElement("template");ve.content&&ve.content.ownerDocument&&(n=ve.content.ownerDocument)}let P,W="";const{implementation:k,createNodeIterator:$,createDocumentFragment:G,getElementsByTagName:J}=n,{importNode:U}=i;let oe=nA();e.isSupported=typeof YN=="function"&&typeof D=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:B,ERB_EXPR:z,TMPLIT_EXPR:ee,DATA_ATTR:pe,ARIA_ATTR:gt,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:Ie}=tA;let{IS_ALLOWED_URI:Ee}=tA,we=null;const Xn=Xe({},[...ZI,...fy,...gy,...my,...JI]);let at=null;const X=Xe({},[...QI,...py,...eA,...im]);let g=Object.seal(yR(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),w=null,y=null;const A=Object.seal(yR(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let L=!0,p=!0,C=!1,S=!0,O=!1,E=!0,R=!1,N=!1,M=!1,x=!1,V=!1,F=!1,Y=!0,se=!1;const Q="user-content-";let be=!0,Ue=!1,Je={},_e=null;const Ge=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let it=null;const Xt=Xe({},["audio","video","img","source","image","track"]);let Wn=null;const vr=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qt="http://www.w3.org/1998/Math/MathML",Gi="http://www.w3.org/2000/svg",_t="http://www.w3.org/1999/xhtml";let Rt=_t,qe=!1,ha=null;const da=Xe({},[qt,Gi,_t],hy);let Ro=Xe({},["mi","mo","mn","ms","mtext"]),fa=Xe({},["annotation-xml"]);const Cr=Xe({},["title","style","font","a","script"]);let Bn=null;const Ug=["application/xhtml+xml","text/html"],zg="text/html";let On=null,Qu=null;const IV=n.createElement("form"),_P=function(H){return H instanceof RegExp||H instanceof Function},HC=function(){let H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Qu&&Qu===H)){if((!H||typeof H!="object")&&(H={}),H=$s(H),Bn=Ug.indexOf(H.PARSER_MEDIA_TYPE)===-1?zg:H.PARSER_MEDIA_TYPE,On=Bn==="application/xhtml+xml"?hy:zp,we=no(H,"ALLOWED_TAGS")?Xe({},H.ALLOWED_TAGS,On):Xn,at=no(H,"ALLOWED_ATTR")?Xe({},H.ALLOWED_ATTR,On):X,ha=no(H,"ALLOWED_NAMESPACES")?Xe({},H.ALLOWED_NAMESPACES,hy):da,Wn=no(H,"ADD_URI_SAFE_ATTR")?Xe($s(vr),H.ADD_URI_SAFE_ATTR,On):vr,it=no(H,"ADD_DATA_URI_TAGS")?Xe($s(Xt),H.ADD_DATA_URI_TAGS,On):Xt,_e=no(H,"FORBID_CONTENTS")?Xe({},H.FORBID_CONTENTS,On):Ge,w=no(H,"FORBID_TAGS")?Xe({},H.FORBID_TAGS,On):$s({}),y=no(H,"FORBID_ATTR")?Xe({},H.FORBID_ATTR,On):$s({}),Je=no(H,"USE_PROFILES")?H.USE_PROFILES:!1,L=H.ALLOW_ARIA_ATTR!==!1,p=H.ALLOW_DATA_ATTR!==!1,C=H.ALLOW_UNKNOWN_PROTOCOLS||!1,S=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,O=H.SAFE_FOR_TEMPLATES||!1,E=H.SAFE_FOR_XML!==!1,R=H.WHOLE_DOCUMENT||!1,x=H.RETURN_DOM||!1,V=H.RETURN_DOM_FRAGMENT||!1,F=H.RETURN_TRUSTED_TYPE||!1,M=H.FORCE_BODY||!1,Y=H.SANITIZE_DOM!==!1,se=H.SANITIZE_NAMED_PROPS||!1,be=H.KEEP_CONTENT!==!1,Ue=H.IN_PLACE||!1,Ee=H.ALLOWED_URI_REGEXP||GN,Rt=H.NAMESPACE||_t,Ro=H.MATHML_TEXT_INTEGRATION_POINTS||Ro,fa=H.HTML_INTEGRATION_POINTS||fa,g=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&_P(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(g.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&_P(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(g.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(g.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),O&&(p=!1),V&&(x=!0),Je&&(we=Xe({},JI),at=[],Je.html===!0&&(Xe(we,ZI),Xe(at,QI)),Je.svg===!0&&(Xe(we,fy),Xe(at,py),Xe(at,im)),Je.svgFilters===!0&&(Xe(we,gy),Xe(at,py),Xe(at,im)),Je.mathMl===!0&&(Xe(we,my),Xe(at,eA),Xe(at,im))),H.ADD_TAGS&&(typeof H.ADD_TAGS=="function"?A.tagCheck=H.ADD_TAGS:(we===Xn&&(we=$s(we)),Xe(we,H.ADD_TAGS,On))),H.ADD_ATTR&&(typeof H.ADD_ATTR=="function"?A.attributeCheck=H.ADD_ATTR:(at===X&&(at=$s(at)),Xe(at,H.ADD_ATTR,On))),H.ADD_URI_SAFE_ATTR&&Xe(Wn,H.ADD_URI_SAFE_ATTR,On),H.FORBID_CONTENTS&&(_e===Ge&&(_e=$s(_e)),Xe(_e,H.FORBID_CONTENTS,On)),be&&(we["#text"]=!0),R&&Xe(we,["html","head","body"]),we.table&&(Xe(we,["tbody"]),delete w.tbody),H.TRUSTED_TYPES_POLICY){if(typeof H.TRUSTED_TYPES_POLICY.createHTML!="function")throw td('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof H.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw td('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=H.TRUSTED_TYPES_POLICY,W=P.createHTML("")}else P===void 0&&(P=q3(f,r)),P!==null&&typeof W=="string"&&(W=P.createHTML(""));Ri&&Ri(H),Qu=H}},MP=Xe({},[...fy,...gy,...F3]),PP=Xe({},[...my,...V3]),AV=function(H){let Z=D(H);(!Z||!Z.tagName)&&(Z={namespaceURI:Rt,tagName:"template"});const de=zp(H.tagName),xt=zp(Z.tagName);return ha[H.namespaceURI]?H.namespaceURI===Gi?Z.namespaceURI===_t?de==="svg":Z.namespaceURI===qt?de==="svg"&&(xt==="annotation-xml"||Ro[xt]):!!MP[de]:H.namespaceURI===qt?Z.namespaceURI===_t?de==="math":Z.namespaceURI===Gi?de==="math"&&fa[xt]:!!PP[de]:H.namespaceURI===_t?Z.namespaceURI===Gi&&!fa[xt]||Z.namespaceURI===qt&&!Ro[xt]?!1:!PP[de]&&(Cr[de]||!MP[de]):!!(Bn==="application/xhtml+xml"&&ha[H.namespaceURI]):!1},Eo=function(H){Qh(e.removed,{element:H});try{D(H).removeChild(H)}catch{b(H)}},yl=function(H,Z){try{Qh(e.removed,{attribute:Z.getAttributeNode(H),from:Z})}catch{Qh(e.removed,{attribute:null,from:Z})}if(Z.removeAttribute(H),H==="is")if(x||V)try{Eo(Z)}catch{}else try{Z.setAttribute(H,"")}catch{}},IP=function(H){let Z=null,de=null;if(M)H="<remove></remove>"+H;else{const pn=dy(H,/^[\r\n\t ]+/);de=pn&&pn[0]}Bn==="application/xhtml+xml"&&Rt===_t&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");const xt=P?P.createHTML(H):H;if(Rt===_t)try{Z=new d().parseFromString(xt,Bn)}catch{}if(!Z||!Z.documentElement){Z=k.createDocument(Rt,"template",null);try{Z.documentElement.innerHTML=qe?W:xt}catch{}}const qn=Z.body||Z.documentElement;return H&&de&&qn.insertBefore(n.createTextNode(de),qn.childNodes[0]||null),Rt===_t?J.call(Z,R?"html":"body")[0]:R?Z.documentElement:qn},AP=function(H){return $.call(H.ownerDocument||H,H,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},NC=function(H){return H instanceof h&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof c)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},OP=function(H){return typeof a=="function"&&H instanceof a};function Cs(ve,H,Z){nm(ve,de=>{de.call(e,H,Z,Qu)})}const xP=function(H){let Z=null;if(Cs(oe.beforeSanitizeElements,H,null),NC(H))return Eo(H),!0;const de=On(H.nodeName);if(Cs(oe.uponSanitizeElement,H,{tagName:de,allowedTags:we}),E&&H.hasChildNodes()&&!OP(H.firstElementChild)&&ci(/<[/\w!]/g,H.innerHTML)&&ci(/<[/\w!]/g,H.textContent)||H.nodeType===id.progressingInstruction||E&&H.nodeType===id.comment&&ci(/<[/\w]/g,H.data))return Eo(H),!0;if(!(A.tagCheck instanceof Function&&A.tagCheck(de))&&(!we[de]||w[de])){if(!w[de]&&NP(de)&&(g.tagNameCheck instanceof RegExp&&ci(g.tagNameCheck,de)||g.tagNameCheck instanceof Function&&g.tagNameCheck(de)))return!1;if(be&&!_e[de]){const xt=D(H)||H.parentNode,qn=_(H)||H.childNodes;if(qn&&xt){const pn=qn.length;for(let _i=pn-1;_i>=0;--_i){const ys=v(qn[_i],!0);ys.__removalCount=(H.__removalCount||0)+1,xt.insertBefore(ys,T(H))}}}return Eo(H),!0}return H instanceof l&&!AV(H)||(de==="noscript"||de==="noembed"||de==="noframes")&&ci(/<\/no(script|embed|frames)/i,H.innerHTML)?(Eo(H),!0):(O&&H.nodeType===id.text&&(Z=H.textContent,nm([B,z,ee],xt=>{Z=ed(Z,xt," ")}),H.textContent!==Z&&(Qh(e.removed,{element:H.cloneNode()}),H.textContent=Z)),Cs(oe.afterSanitizeElements,H,null),!1)},HP=function(H,Z,de){if(Y&&(Z==="id"||Z==="name")&&(de in n||de in IV))return!1;if(!(p&&!y[Z]&&ci(pe,Z))){if(!(L&&ci(gt,Z))){if(!(A.attributeCheck instanceof Function&&A.attributeCheck(Z,H))){if(!at[Z]||y[Z]){if(!(NP(H)&&(g.tagNameCheck instanceof RegExp&&ci(g.tagNameCheck,H)||g.tagNameCheck instanceof Function&&g.tagNameCheck(H))&&(g.attributeNameCheck instanceof RegExp&&ci(g.attributeNameCheck,Z)||g.attributeNameCheck instanceof Function&&g.attributeNameCheck(Z,H))||Z==="is"&&g.allowCustomizedBuiltInElements&&(g.tagNameCheck instanceof RegExp&&ci(g.tagNameCheck,de)||g.tagNameCheck instanceof Function&&g.tagNameCheck(de))))return!1}else if(!Wn[Z]){if(!ci(Ee,ed(de,Te,""))){if(!((Z==="src"||Z==="xlink:href"||Z==="href")&&H!=="script"&&D3(de,"data:")===0&&it[H])){if(!(C&&!ci(Re,ed(de,Te,"")))){if(de)return!1}}}}}}}return!0},NP=function(H){return H!=="annotation-xml"&&dy(H,Ie)},DP=function(H){Cs(oe.beforeSanitizeAttributes,H,null);const{attributes:Z}=H;if(!Z||NC(H))return;const de={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:at,forceKeepAttr:void 0};let xt=Z.length;for(;xt--;){const qn=Z[xt],{name:pn,namespaceURI:_i,value:ys}=qn,ec=On(pn),DC=ys;let jn=pn==="value"?DC:$3(DC);if(de.attrName=ec,de.attrValue=jn,de.keepAttr=!0,de.forceKeepAttr=void 0,Cs(oe.uponSanitizeAttribute,H,de),jn=de.attrValue,se&&(ec==="id"||ec==="name")&&(yl(pn,H),jn=Q+jn),E&&ci(/((--!?|])>)|<\/(style|title|textarea)/i,jn)){yl(pn,H);continue}if(ec==="attributename"&&dy(jn,"href")){yl(pn,H);continue}if(de.forceKeepAttr)continue;if(!de.keepAttr){yl(pn,H);continue}if(!S&&ci(/\/>/i,jn)){yl(pn,H);continue}O&&nm([B,z,ee],kP=>{jn=ed(jn,kP," ")});const $P=On(H.nodeName);if(!HP($P,ec,jn)){yl(pn,H);continue}if(P&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!_i)switch(f.getAttributeType($P,ec)){case"TrustedHTML":{jn=P.createHTML(jn);break}case"TrustedScriptURL":{jn=P.createScriptURL(jn);break}}if(jn!==DC)try{_i?H.setAttributeNS(_i,pn,jn):H.setAttribute(pn,jn),NC(H)?Eo(H):qI(e.removed)}catch{yl(pn,H)}}Cs(oe.afterSanitizeAttributes,H,null)},OV=function ve(H){let Z=null;const de=AP(H);for(Cs(oe.beforeSanitizeShadowDOM,H,null);Z=de.nextNode();)Cs(oe.uponSanitizeShadowNode,Z,null),xP(Z),DP(Z),Z.content instanceof o&&ve(Z.content);Cs(oe.afterSanitizeShadowDOM,H,null)};return e.sanitize=function(ve){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Z=null,de=null,xt=null,qn=null;if(qe=!ve,qe&&(ve="<!-->"),typeof ve!="string"&&!OP(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw td("dirty is not a string, aborting")}else throw td("toString is not a function");if(!e.isSupported)return ve;if(N||HC(H),e.removed=[],typeof ve=="string"&&(Ue=!1),Ue){if(ve.nodeName){const ys=On(ve.nodeName);if(!we[ys]||w[ys])throw td("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof a)Z=IP("<!---->"),de=Z.ownerDocument.importNode(ve,!0),de.nodeType===id.element&&de.nodeName==="BODY"||de.nodeName==="HTML"?Z=de:Z.appendChild(de);else{if(!x&&!O&&!R&&ve.indexOf("<")===-1)return P&&F?P.createHTML(ve):ve;if(Z=IP(ve),!Z)return x?null:F?W:""}Z&&M&&Eo(Z.firstChild);const pn=AP(Ue?ve:Z);for(;xt=pn.nextNode();)xP(xt),DP(xt),xt.content instanceof o&&OV(xt.content);if(Ue)return ve;if(x){if(V)for(qn=G.call(Z.ownerDocument);Z.firstChild;)qn.appendChild(Z.firstChild);else qn=Z;return(at.shadowroot||at.shadowrootmode)&&(qn=U.call(i,qn,!0)),qn}let _i=R?Z.outerHTML:Z.innerHTML;return R&&we["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&ci(KN,Z.ownerDocument.doctype.name)&&(_i="<!DOCTYPE "+Z.ownerDocument.doctype.name+`>
`+_i),O&&nm([B,z,ee],ys=>{_i=ed(_i,ys," ")}),P&&F?P.createHTML(_i):_i},e.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};HC(ve),N=!0},e.clearConfig=function(){Qu=null,N=!1},e.isValidAttribute=function(ve,H,Z){Qu||HC({});const de=On(ve),xt=On(H);return HP(de,xt,Z)},e.addHook=function(ve,H){typeof H=="function"&&Qh(oe[ve],H)},e.removeHook=function(ve,H){if(H!==void 0){const Z=H3(oe[ve],H);return Z===-1?void 0:N3(oe[ve],Z,1)[0]}return qI(oe[ve])},e.removeHooks=function(ve){oe[ve]=[]},e.removeAllHooks=function(){oe=nA()},e}var Z3=XN();function J3(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var qN;function K(){return qN.apply(null,arguments)}function Q3(t){qN=t}function wo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Iu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function g0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(rt(t,e))return!1;return!0}function Di(t){return t===void 0}function ea(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Cg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ZN(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function qa(t,e){for(var n in e)rt(e,n)&&(t[n]=e[n]);return rt(e,"toString")&&(t.toString=e.toString),rt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function gs(t,e,n,i){return yD(t,e,n,i,!0).utc()}function eX(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ke(t){return t._pf==null&&(t._pf=eX()),t._pf}var RR;Array.prototype.some?RR=Array.prototype.some:RR=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function m0(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=ke(t),n=RR.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Dv(t){var e=gs(NaN);return t!=null?qa(ke(e),t):ke(e).userInvalidated=!0,e}var iA=K.momentProperties=[],wy=!1;function p0(t,e){var n,i,r,o=iA.length;if(Di(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Di(e._i)||(t._i=e._i),Di(e._f)||(t._f=e._f),Di(e._l)||(t._l=e._l),Di(e._strict)||(t._strict=e._strict),Di(e._tzm)||(t._tzm=e._tzm),Di(e._isUTC)||(t._isUTC=e._isUTC),Di(e._offset)||(t._offset=e._offset),Di(e._pf)||(t._pf=ke(e)),Di(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=iA[n],r=e[i],Di(r)||(t[i]=r);return t}function yg(t){p0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),wy===!1&&(wy=!0,K.updateOffset(this),wy=!1)}function vo(t){return t instanceof yg||t!=null&&t._isAMomentObject!=null}function JN(t){K.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Br(t,e){var n=!0;return qa(function(){if(K.deprecationHandler!=null&&K.deprecationHandler(null,t),n){var i=[],r,o,s,a=arguments.length;for(o=0;o<a;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(s in arguments[0])rt(arguments[0],s)&&(r+=s+": "+arguments[0][s]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}JN(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var rA={};function QN(t,e){K.deprecationHandler!=null&&K.deprecationHandler(t,e),rA[t]||(JN(e),rA[t]=!0)}K.suppressDeprecationWarnings=!1;K.deprecationHandler=null;function ms(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function tX(t){var e,n;for(n in t)rt(t,n)&&(e=t[n],ms(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ER(t,e){var n=qa({},t),i;for(i in e)rt(e,i)&&(Iu(t[i])&&Iu(e[i])?(n[i]={},qa(n[i],t[i]),qa(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)rt(t,i)&&!rt(e,i)&&Iu(t[i])&&(n[i]=qa({},n[i]));return n}function w0(t){t!=null&&this.set(t)}var TR;Object.keys?TR=Object.keys:TR=function(t){var e,n=[];for(e in t)rt(t,e)&&n.push(e);return n};var nX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function iX(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return ms(i)?i.call(e,n):i}function us(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var v0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,rm=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,vy={},gh={};function ye(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(gh[t]=r),e&&(gh[e[0]]=function(){return us(r.apply(this,arguments),e[1],e[2])}),n&&(gh[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function rX(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function oX(t){var e=t.match(v0),n,i;for(n=0,i=e.length;n<i;n++)gh[e[n]]?e[n]=gh[e[n]]:e[n]=rX(e[n]);return function(r){var o="",s;for(s=0;s<i;s++)o+=ms(e[s])?e[s].call(r,t):e[s];return o}}function Yp(t,e){return t.isValid()?(e=eD(e,t.localeData()),vy[e]=vy[e]||oX(e),vy[e](t)):t.localeData().invalidDate()}function eD(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(rm.lastIndex=0;n>=0&&rm.test(t);)t=t.replace(rm,i),rm.lastIndex=0,n-=1;return t}var sX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function aX(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(v0).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var lX="Invalid date";function uX(){return this._invalidDate}var cX="%d",hX=/\d{1,2}/;function dX(t){return this._ordinal.replace("%d",t)}var fX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function gX(t,e,n,i){var r=this._relativeTime[n];return ms(r)?r(t,e,n,i):r.replace(/%d/i,t)}function mX(t,e){var n=this._relativeTime[t>0?"future":"past"];return ms(n)?n(e):n.replace(/%s/i,e)}var oA={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function jr(t){return typeof t=="string"?oA[t]||oA[t.toLowerCase()]:void 0}function C0(t){var e={},n,i;for(i in t)rt(t,i)&&(n=jr(i),n&&(e[n]=t[i]));return e}var pX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function wX(t){var e=[],n;for(n in t)rt(t,n)&&e.push({unit:n,priority:pX[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var tD=/\d/,wr=/\d\d/,nD=/\d{3}/,y0=/\d{4}/,$v=/[+-]?\d{6}/,Ot=/\d\d?/,iD=/\d\d\d\d?/,rD=/\d\d\d\d\d\d?/,kv=/\d{1,3}/,b0=/\d{1,4}/,Lv=/[+-]?\d{1,6}/,Fh=/\d+/,Fv=/[+-]?\d+/,vX=/Z|[+-]\d\d:?\d\d/gi,Vv=/Z|[+-]\d\d(?::?\d\d)?/gi,CX=/[+-]?\d+(\.\d{1,3})?/,bg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vh=/^[1-9]\d?/,S0=/^([1-9]\d|\d)/,yw;yw={};function ue(t,e,n){yw[t]=ms(e)?e:function(i,r){return i&&n?n:e}}function yX(t,e){return rt(yw,t)?yw[t](e._strict,e._locale):new RegExp(bX(t))}function bX(t){return Js(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function Js(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Dr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ze(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Dr(e)),n}var _R={};function yt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),ea(e)&&(i=function(o,s){s[e]=Ze(o)}),r=t.length,n=0;n<r;n++)_R[t[n]]=i}function Sg(t,e){yt(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function SX(t,e,n){e!=null&&rt(_R,t)&&_R[t](e,n._a,n,t)}function Wv(t){return t%4===0&&t%100!==0||t%400===0}var ai=0,zs=1,Qo=2,Pn=3,go=4,Ys=5,vu=6,RX=7,EX=8;ye("Y",0,0,function(){var t=this.year();return t<=9999?us(t,4):"+"+t});ye(0,["YY",2],0,function(){return this.year()%100});ye(0,["YYYY",4],0,"year");ye(0,["YYYYY",5],0,"year");ye(0,["YYYYYY",6,!0],0,"year");ue("Y",Fv);ue("YY",Ot,wr);ue("YYYY",b0,y0);ue("YYYYY",Lv,$v);ue("YYYYYY",Lv,$v);yt(["YYYYY","YYYYYY"],ai);yt("YYYY",function(t,e){e[ai]=t.length===2?K.parseTwoDigitYear(t):Ze(t)});yt("YY",function(t,e){e[ai]=K.parseTwoDigitYear(t)});yt("Y",function(t,e){e[ai]=parseInt(t,10)});function gf(t){return Wv(t)?366:365}K.parseTwoDigitYear=function(t){return Ze(t)+(Ze(t)>68?1900:2e3)};var oD=Wh("FullYear",!0);function TX(){return Wv(this.year())}function Wh(t,e){return function(n){return n!=null?(sD(this,t,n),K.updateOffset(this,e),this):Bf(this,t)}}function Bf(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function sD(t,e,n){var i,r,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Wv(o)?28:a,r?i.setUTCFullYear(o,s,a):i.setFullYear(o,s,a)}}function _X(t){return t=jr(t),ms(this[t])?this[t]():this}function MX(t,e){if(typeof t=="object"){t=C0(t);var n=wX(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=jr(t),ms(this[t]))return this[t](e);return this}function PX(t,e){return(t%e+e)%e}var ln;Array.prototype.indexOf?ln=Array.prototype.indexOf:ln=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function R0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=PX(e,12);return t+=(e-n)/12,n===1?Wv(t)?29:28:31-n%7%2}ye("M",["MM",2],"Mo",function(){return this.month()+1});ye("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ye("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Ot,Vh);ue("MM",Ot,wr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});yt(["M","MM"],function(t,e){e[zs]=Ze(t)-1});yt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[zs]=r:ke(n).invalidMonth=t});var IX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),aD="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),lD=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,AX=bg,OX=bg;function xX(t,e){return t?wo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||lD).test(e)?"format":"standalone"][t.month()]:wo(this._months)?this._months:this._months.standalone}function HX(t,e){return t?wo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[lD.test(e)?"format":"standalone"][t.month()]:wo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function NX(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=gs([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=ln.call(this._shortMonthsParse,s),r!==-1?r:null):(r=ln.call(this._longMonthsParse,s),r!==-1?r:null):e==="MMM"?(r=ln.call(this._shortMonthsParse,s),r!==-1?r:(r=ln.call(this._longMonthsParse,s),r!==-1?r:null)):(r=ln.call(this._longMonthsParse,s),r!==-1?r:(r=ln.call(this._shortMonthsParse,s),r!==-1?r:null))}function DX(t,e,n){var i,r,o;if(this._monthsParseExact)return NX.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=gs([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function uD(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ze(e);else if(e=t.localeData().monthsParse(e),!ea(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,R0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function cD(t){return t!=null?(uD(this,t),K.updateOffset(this,!0),this):Bf(this,"Month")}function $X(){return R0(this.year(),this.month())}function kX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||hD.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(rt(this,"_monthsShortRegex")||(this._monthsShortRegex=AX),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function LX(t){return this._monthsParseExact?(rt(this,"_monthsRegex")||hD.call(this),t?this._monthsStrictRegex:this._monthsRegex):(rt(this,"_monthsRegex")||(this._monthsRegex=OX),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function hD(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,o,s,a;for(r=0;r<12;r++)o=gs([2e3,r]),s=Js(this.monthsShort(o,"")),a=Js(this.months(o,"")),e.push(s),n.push(a),i.push(a),i.push(s);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function FX(t,e,n,i,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,o,s),a}function jf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function bw(t,e,n){var i=7+e-n,r=(7+jf(t,0,i).getUTCDay()-e)%7;return-r+i-1}function dD(t,e,n,i,r){var o=(7+n-i)%7,s=bw(t,i,r),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=gf(l)+a):a>gf(t)?(l=t+1,u=a-gf(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Uf(t,e,n){var i=bw(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,s;return r<1?(s=t.year()-1,o=r+Qs(s,e,n)):r>Qs(t.year(),e,n)?(o=r-Qs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function Qs(t,e,n){var i=bw(t,e,n),r=bw(t+1,e,n);return(gf(t)-i+r)/7}ye("w",["ww",2],"wo","week");ye("W",["WW",2],"Wo","isoWeek");ue("w",Ot,Vh);ue("ww",Ot,wr);ue("W",Ot,Vh);ue("WW",Ot,wr);Sg(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Ze(t)});function VX(t){return Uf(t,this._week.dow,this._week.doy).week}var WX={dow:0,doy:6};function BX(){return this._week.dow}function jX(){return this._week.doy}function UX(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function zX(t){var e=Uf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ye("d",0,"do","day");ye("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ye("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ye("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ye("e",0,0,"weekday");ye("E",0,0,"isoWeekday");ue("d",Ot);ue("e",Ot);ue("E",Ot);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Sg(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:ke(n).invalidWeekday=t});Sg(["d","e","E"],function(t,e,n,i){e[i]=Ze(t)});function YX(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function GX(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function E0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var KX="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),fD="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),XX="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),qX=bg,ZX=bg,JX=bg;function QX(t,e){var n=wo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?E0(n,this._week.dow):t?n[t.day()]:n}function eq(t){return t===!0?E0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function tq(t){return t===!0?E0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function nq(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=gs([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=ln.call(this._weekdaysParse,s),r!==-1?r:null):e==="ddd"?(r=ln.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null):e==="dddd"?(r=ln.call(this._weekdaysParse,s),r!==-1||(r=ln.call(this._shortWeekdaysParse,s),r!==-1)?r:(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null)):e==="ddd"?(r=ln.call(this._shortWeekdaysParse,s),r!==-1||(r=ln.call(this._weekdaysParse,s),r!==-1)?r:(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null)):(r=ln.call(this._minWeekdaysParse,s),r!==-1||(r=ln.call(this._weekdaysParse,s),r!==-1)?r:(r=ln.call(this._shortWeekdaysParse,s),r!==-1?r:null))}function iq(t,e,n){var i,r,o;if(this._weekdaysParseExact)return nq.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=gs([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function rq(t){if(!this.isValid())return t!=null?this:NaN;var e=Bf(this,"Day");return t!=null?(t=YX(t,this.localeData()),this.add(t-e,"d")):e}function oq(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function sq(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=GX(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function aq(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||T0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(rt(this,"_weekdaysRegex")||(this._weekdaysRegex=qX),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function lq(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||T0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(rt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ZX),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function uq(t){return this._weekdaysParseExact?(rt(this,"_weekdaysRegex")||T0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(rt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=JX),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function T0(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],o,s,a,l,u;for(o=0;o<7;o++)s=gs([2e3,1]).day(o),a=Js(this.weekdaysMin(s,"")),l=Js(this.weekdaysShort(s,"")),u=Js(this.weekdays(s,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function _0(){return this.hours()%12||12}function cq(){return this.hours()||24}ye("H",["HH",2],0,"hour");ye("h",["hh",2],0,_0);ye("k",["kk",2],0,cq);ye("hmm",0,0,function(){return""+_0.apply(this)+us(this.minutes(),2)});ye("hmmss",0,0,function(){return""+_0.apply(this)+us(this.minutes(),2)+us(this.seconds(),2)});ye("Hmm",0,0,function(){return""+this.hours()+us(this.minutes(),2)});ye("Hmmss",0,0,function(){return""+this.hours()+us(this.minutes(),2)+us(this.seconds(),2)});function gD(t,e){ye(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}gD("a",!0);gD("A",!1);function mD(t,e){return e._meridiemParse}ue("a",mD);ue("A",mD);ue("H",Ot,S0);ue("h",Ot,Vh);ue("k",Ot,Vh);ue("HH",Ot,wr);ue("hh",Ot,wr);ue("kk",Ot,wr);ue("hmm",iD);ue("hmmss",rD);ue("Hmm",iD);ue("Hmmss",rD);yt(["H","HH"],Pn);yt(["k","kk"],function(t,e,n){var i=Ze(t);e[Pn]=i===24?0:i});yt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});yt(["h","hh"],function(t,e,n){e[Pn]=Ze(t),ke(n).bigHour=!0});yt("hmm",function(t,e,n){var i=t.length-2;e[Pn]=Ze(t.substr(0,i)),e[go]=Ze(t.substr(i)),ke(n).bigHour=!0});yt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Pn]=Ze(t.substr(0,i)),e[go]=Ze(t.substr(i,2)),e[Ys]=Ze(t.substr(r)),ke(n).bigHour=!0});yt("Hmm",function(t,e,n){var i=t.length-2;e[Pn]=Ze(t.substr(0,i)),e[go]=Ze(t.substr(i))});yt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Pn]=Ze(t.substr(0,i)),e[go]=Ze(t.substr(i,2)),e[Ys]=Ze(t.substr(r))});function hq(t){return(t+"").toLowerCase().charAt(0)==="p"}var dq=/[ap]\.?m?\.?/i,fq=Wh("Hours",!0);function gq(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var pD={calendar:nX,longDateFormat:sX,invalidDate:lX,ordinal:cX,dayOfMonthOrdinalParse:hX,relativeTime:fX,months:IX,monthsShort:aD,week:WX,weekdays:KX,weekdaysMin:XX,weekdaysShort:fD,meridiemParse:dq},kt={},rd={},zf;function mq(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function sA(t){return t&&t.toLowerCase().replace("_","-")}function pq(t){for(var e=0,n,i,r,o;e<t.length;){for(o=sA(t[e]).split("-"),n=o.length,i=sA(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Bv(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&mq(o,i)>=n-1)break;n--}e++}return zf}function wq(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Bv(t){var e=null,n;if(kt[t]===void 0&&typeof module<"u"&&module&&module.exports&&wq(t))try{e=zf._abbr,n=J3,n("./locale/"+t),il(e)}catch{kt[t]=null}return kt[t]}function il(t,e){var n;return t&&(Di(e)?n=sa(t):n=M0(t,e),n?zf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),zf._abbr}function M0(t,e){if(e!==null){var n,i=pD;if(e.abbr=t,kt[t]!=null)QN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=kt[t]._config;else if(e.parentLocale!=null)if(kt[e.parentLocale]!=null)i=kt[e.parentLocale]._config;else if(n=Bv(e.parentLocale),n!=null)i=n._config;else return rd[e.parentLocale]||(rd[e.parentLocale]=[]),rd[e.parentLocale].push({name:t,config:e}),null;return kt[t]=new w0(ER(i,e)),rd[t]&&rd[t].forEach(function(r){M0(r.name,r.config)}),il(t),kt[t]}else return delete kt[t],null}function vq(t,e){if(e!=null){var n,i,r=pD;kt[t]!=null&&kt[t].parentLocale!=null?kt[t].set(ER(kt[t]._config,e)):(i=Bv(t),i!=null&&(r=i._config),e=ER(r,e),i==null&&(e.abbr=t),n=new w0(e),n.parentLocale=kt[t],kt[t]=n),il(t)}else kt[t]!=null&&(kt[t].parentLocale!=null?(kt[t]=kt[t].parentLocale,t===il()&&il(t)):kt[t]!=null&&delete kt[t]);return kt[t]}function sa(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return zf;if(!wo(t)){if(e=Bv(t),e)return e;t=[t]}return pq(t)}function Cq(){return TR(kt)}function P0(t){var e,n=t._a;return n&&ke(t).overflow===-2&&(e=n[zs]<0||n[zs]>11?zs:n[Qo]<1||n[Qo]>R0(n[ai],n[zs])?Qo:n[Pn]<0||n[Pn]>24||n[Pn]===24&&(n[go]!==0||n[Ys]!==0||n[vu]!==0)?Pn:n[go]<0||n[go]>59?go:n[Ys]<0||n[Ys]>59?Ys:n[vu]<0||n[vu]>999?vu:-1,ke(t)._overflowDayOfYear&&(e<ai||e>Qo)&&(e=Qo),ke(t)._overflowWeeks&&e===-1&&(e=RX),ke(t)._overflowWeekday&&e===-1&&(e=EX),ke(t).overflow=e),t}var yq=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bq=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sq=/Z|[+-]\d\d(?::?\d\d)?/,om=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Cy=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Rq=/^\/?Date\((-?\d+)/i,Eq=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Tq={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function wD(t){var e,n,i=t._i,r=yq.exec(i)||bq.exec(i),o,s,a,l,u=om.length,c=Cy.length;if(r){for(ke(t).iso=!0,e=0,n=u;e<n;e++)if(om[e][1].exec(r[1])){s=om[e][0],o=om[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(Cy[e][1].exec(r[3])){a=(r[2]||" ")+Cy[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(r[4])if(Sq.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),A0(t)}else t._isValid=!1}function _q(t,e,n,i,r,o){var s=[Mq(t),aD.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&s.push(parseInt(o,10)),s}function Mq(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Pq(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Iq(t,e,n){if(t){var i=fD.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return ke(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Aq(t,e,n){if(t)return Tq[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function vD(t){var e=Eq.exec(Pq(t._i)),n;if(e){if(n=_q(e[4],e[3],e[2],e[5],e[6],e[7]),!Iq(e[1],n,t))return;t._a=n,t._tzm=Aq(e[8],e[9],e[10]),t._d=jf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ke(t).rfc2822=!0}else t._isValid=!1}function Oq(t){var e=Rq.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(wD(t),t._isValid===!1)delete t._isValid;else return;if(vD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:K.createFromInputFallback(t)}K.createFromInputFallback=Br("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Gc(t,e,n){return t??e??n}function xq(t){var e=new Date(K.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function I0(t){var e,n,i=[],r,o,s;if(!t._d){for(r=xq(t),t._w&&t._a[Qo]==null&&t._a[zs]==null&&Hq(t),t._dayOfYear!=null&&(s=Gc(t._a[ai],r[ai]),(t._dayOfYear>gf(s)||t._dayOfYear===0)&&(ke(t)._overflowDayOfYear=!0),n=jf(s,0,t._dayOfYear),t._a[zs]=n.getUTCMonth(),t._a[Qo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Pn]===24&&t._a[go]===0&&t._a[Ys]===0&&t._a[vu]===0&&(t._nextDay=!0,t._a[Pn]=0),t._d=(t._useUTC?jf:FX).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Pn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ke(t).weekdayMismatch=!0)}}function Hq(t){var e,n,i,r,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Gc(e.GG,t._a[ai],Uf(At(),1,4).year),i=Gc(e.W,1),r=Gc(e.E,1),(r<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Uf(At(),o,s),n=Gc(e.gg,t._a[ai],u.year),i=Gc(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o),i<1||i>Qs(n,o,s)?ke(t)._overflowWeeks=!0:l!=null?ke(t)._overflowWeekday=!0:(a=dD(n,i,r,o,s),t._a[ai]=a.year,t._dayOfYear=a.dayOfYear)}K.ISO_8601=function(){};K.RFC_2822=function(){};function A0(t){if(t._f===K.ISO_8601){wD(t);return}if(t._f===K.RFC_2822){vD(t);return}t._a=[],ke(t).empty=!0;var e=""+t._i,n,i,r,o,s,a=e.length,l=0,u,c;for(r=eD(t._f,t._locale).match(v0)||[],c=r.length,n=0;n<c;n++)o=r[n],i=(e.match(yX(o,t))||[])[0],i&&(s=e.substr(0,e.indexOf(i)),s.length>0&&ke(t).unusedInput.push(s),e=e.slice(e.indexOf(i)+i.length),l+=i.length),gh[o]?(i?ke(t).empty=!1:ke(t).unusedTokens.push(o),SX(o,i,t)):t._strict&&!i&&ke(t).unusedTokens.push(o);ke(t).charsLeftOver=a-l,e.length>0&&ke(t).unusedInput.push(e),t._a[Pn]<=12&&ke(t).bigHour===!0&&t._a[Pn]>0&&(ke(t).bigHour=void 0),ke(t).parsedDateParts=t._a.slice(0),ke(t).meridiem=t._meridiem,t._a[Pn]=Nq(t._locale,t._a[Pn],t._meridiem),u=ke(t).era,u!==null&&(t._a[ai]=t._locale.erasConvertYear(u,t._a[ai])),I0(t),P0(t)}function Nq(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Dq(t){var e,n,i,r,o,s,a=!1,l=t._f.length;if(l===0){ke(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)o=0,s=!1,e=p0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],A0(e),m0(e)&&(s=!0),o+=ke(e).charsLeftOver,o+=ke(e).unusedTokens.length*10,ke(e).score=o,a?o<i&&(i=o,n=e):(i==null||o<i||s)&&(i=o,n=e,s&&(a=!0));qa(t,n||e)}function $q(t){if(!t._d){var e=C0(t._i),n=e.day===void 0?e.date:e.day;t._a=ZN([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),I0(t)}}function kq(t){var e=new yg(P0(CD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function CD(t){var e=t._i,n=t._f;return t._locale=t._locale||sa(t._l),e===null||n===void 0&&e===""?Dv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),vo(e)?new yg(P0(e)):(Cg(e)?t._d=e:wo(n)?Dq(t):n?A0(t):Lq(t),m0(t)||(t._d=null),t))}function Lq(t){var e=t._i;Di(e)?t._d=new Date(K.now()):Cg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Oq(t):wo(e)?(t._a=ZN(e.slice(0),function(n){return parseInt(n,10)}),I0(t)):Iu(e)?$q(t):ea(e)?t._d=new Date(e):K.createFromInputFallback(t)}function yD(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Iu(t)&&g0(t)||wo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,kq(o)}function At(t,e,n,i){return yD(t,e,n,i,!1)}var Fq=Br("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Dv()}),Vq=Br("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Dv()});function bD(t,e){var n,i;if(e.length===1&&wo(e[0])&&(e=e[0]),!e.length)return At();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function Wq(){var t=[].slice.call(arguments,0);return bD("isBefore",t)}function Bq(){var t=[].slice.call(arguments,0);return bD("isAfter",t)}var jq=function(){return Date.now?Date.now():+new Date},od=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Uq(t){var e,n=!1,i,r=od.length;for(e in t)if(rt(t,e)&&!(ln.call(od,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[od[i]]){if(n)return!1;parseFloat(t[od[i]])!==Ze(t[od[i]])&&(n=!0)}return!0}function zq(){return this._isValid}function Yq(){return So(NaN)}function jv(t){var e=C0(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Uq(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=sa(),this._bubble()}function Gp(t){return t instanceof jv}function MR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Gq(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,s;for(s=0;s<i;s++)Ze(t[s])!==Ze(e[s])&&o++;return o+r}function SD(t,e){ye(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+us(~~(n/60),2)+e+us(~~n%60,2)})}SD("Z",":");SD("ZZ","");ue("Z",Vv);ue("ZZ",Vv);yt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=O0(Vv,t)});var Kq=/([\+\-]|\d\d)/gi;function O0(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(Kq)||["-",0,0],o=+(r[1]*60)+Ze(r[2]),o===0?0:r[0]==="+"?o:-o)}function x0(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(vo(t)||Cg(t)?t.valueOf():At(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),K.updateOffset(n,!1),n):At(t).local()}function PR(t){return-Math.round(t._d.getTimezoneOffset())}K.updateOffset=function(){};function Xq(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=O0(Vv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=PR(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?TD(this,So(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,K.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:PR(this)}function qq(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Zq(t){return this.utcOffset(0,t)}function Jq(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(PR(this),"m")),this}function Qq(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=O0(vX,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function e4(t){return this.isValid()?(t=t?At(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function t4(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function n4(){if(!Di(this._isDSTShifted))return this._isDSTShifted;var t={},e;return p0(t,this),t=CD(t),t._a?(e=t._isUTC?gs(t._a):At(t._a),this._isDSTShifted=this.isValid()&&Gq(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function i4(){return this.isValid()?!this._isUTC:!1}function r4(){return this.isValid()?this._isUTC:!1}function RD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var o4=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,s4=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function So(t,e){var n=t,i=null,r,o,s;return Gp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:ea(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=o4.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Ze(i[Qo])*r,h:Ze(i[Pn])*r,m:Ze(i[go])*r,s:Ze(i[Ys])*r,ms:Ze(MR(i[vu]*1e3))*r}):(i=s4.exec(t))?(r=i[1]==="-"?-1:1,n={y:Sl(i[2],r),M:Sl(i[3],r),w:Sl(i[4],r),d:Sl(i[5],r),h:Sl(i[6],r),m:Sl(i[7],r),s:Sl(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=a4(At(n.from),At(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new jv(n),Gp(t)&&rt(t,"_locale")&&(o._locale=t._locale),Gp(t)&&rt(t,"_isValid")&&(o._isValid=t._isValid),o}So.fn=jv.prototype;So.invalid=Yq;function Sl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function aA(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function a4(t,e){var n;return t.isValid()&&e.isValid()?(e=x0(e,t),t.isBefore(e)?n=aA(t,e):(n=aA(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function ED(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(QN(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=So(n,i),TD(this,r,t),this}}function TD(t,e,n,i){var r=e._milliseconds,o=MR(e._days),s=MR(e._months);t.isValid()&&(i=i??!0,s&&uD(t,Bf(t,"Month")+s*n),o&&sD(t,"Date",Bf(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&K.updateOffset(t,o||s))}var l4=ED(1,"add"),u4=ED(-1,"subtract");function _D(t){return typeof t=="string"||t instanceof String}function c4(t){return vo(t)||Cg(t)||_D(t)||ea(t)||d4(t)||h4(t)||t===null||t===void 0}function h4(t){var e=Iu(t)&&!g0(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,s=i.length;for(r=0;r<s;r+=1)o=i[r],n=n||rt(t,o);return e&&n}function d4(t){var e=wo(t),n=!1;return e&&(n=t.filter(function(i){return!ea(i)&&_D(t)}).length===0),e&&n}function f4(t){var e=Iu(t)&&!g0(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||rt(t,o);return e&&n}function g4(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function m4(t,e){arguments.length===1&&(arguments[0]?c4(arguments[0])?(t=arguments[0],e=void 0):f4(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||At(),i=x0(n,this).startOf("day"),r=K.calendarFormat(this,i)||"sameElse",o=e&&(ms(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,At(n)))}function p4(){return new yg(this)}function w4(t,e){var n=vo(t)?t:At(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function v4(t,e){var n=vo(t)?t:At(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function C4(t,e,n,i){var r=vo(t)?t:At(t),o=vo(e)?e:At(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function y4(t,e){var n=vo(t)?t:At(t),i;return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function b4(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function S4(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function R4(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=x0(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=jr(e),e){case"year":o=Kp(this,i)/12;break;case"month":o=Kp(this,i);break;case"quarter":o=Kp(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:Dr(o)}function Kp(t,e){if(t.date()<e.date())return-Kp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}K.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";K.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function E4(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function T4(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Yp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ms(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Yp(n,"Z")):Yp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function _4(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function M4(t){t||(t=this.isUtc()?K.defaultFormatUtc:K.defaultFormat);var e=Yp(this,t);return this.localeData().postformat(e)}function P4(t,e){return this.isValid()&&(vo(t)&&t.isValid()||At(t).isValid())?So({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function I4(t){return this.from(At(),t)}function A4(t,e){return this.isValid()&&(vo(t)&&t.isValid()||At(t).isValid())?So({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function O4(t){return this.to(At(),t)}function MD(t){var e;return t===void 0?this._locale._abbr:(e=sa(t),e!=null&&(this._locale=e),this)}var PD=Br("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function ID(){return this._locale}var Sw=1e3,mh=60*Sw,Rw=60*mh,AD=(365*400+97)*24*Rw;function ph(t,e){return(t%e+e)%e}function OD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-AD:new Date(t,e,n).valueOf()}function xD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-AD:Date.UTC(t,e,n)}function x4(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?xD:OD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ph(e+(this._isUTC?0:this.utcOffset()*mh),Rw);break;case"minute":e=this._d.valueOf(),e-=ph(e,mh);break;case"second":e=this._d.valueOf(),e-=ph(e,Sw);break}return this._d.setTime(e),K.updateOffset(this,!0),this}function H4(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?xD:OD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rw-ph(e+(this._isUTC?0:this.utcOffset()*mh),Rw)-1;break;case"minute":e=this._d.valueOf(),e+=mh-ph(e,mh)-1;break;case"second":e=this._d.valueOf(),e+=Sw-ph(e,Sw)-1;break}return this._d.setTime(e),K.updateOffset(this,!0),this}function N4(){return this._d.valueOf()-(this._offset||0)*6e4}function D4(){return Math.floor(this.valueOf()/1e3)}function $4(){return new Date(this.valueOf())}function k4(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function L4(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function F4(){return this.isValid()?this.toISOString():null}function V4(){return m0(this)}function W4(){return qa({},ke(this))}function B4(){return ke(this).overflow}function j4(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ye("N",0,0,"eraAbbr");ye("NN",0,0,"eraAbbr");ye("NNN",0,0,"eraAbbr");ye("NNNN",0,0,"eraName");ye("NNNNN",0,0,"eraNarrow");ye("y",["y",1],"yo","eraYear");ye("y",["yy",2],0,"eraYear");ye("y",["yyy",3],0,"eraYear");ye("y",["yyyy",4],0,"eraYear");ue("N",H0);ue("NN",H0);ue("NNN",H0);ue("NNNN",e6);ue("NNNNN",t6);yt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?ke(n).era=r:ke(n).invalidEra=t});ue("y",Fh);ue("yy",Fh);ue("yyy",Fh);ue("yyyy",Fh);ue("yo",n6);yt(["y","yy","yyy","yyyy"],ai);yt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[ai]=n._locale.eraYearOrdinalParse(t,r):e[ai]=parseInt(t,10)});function U4(t,e){var n,i,r,o=this._eras||sa("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=K(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=K(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function z4(t,e,n){var i,r,o=this.eras(),s,a,l;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(s=o[i].name.toUpperCase(),a=o[i].abbr.toUpperCase(),l=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[i];break;case"NNNN":if(s===t)return o[i];break;case"NNNNN":if(l===t)return o[i];break}else if([s,a,l].indexOf(t)>=0)return o[i]}function Y4(t,e){var n=t.since<=t.until?1:-1;return e===void 0?K(t.since).year():K(t.since).year()+(e-t.offset)*n}function G4(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function K4(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function X4(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function q4(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-K(r[t].since).year())*n+r[t].offset;return this.year()}function Z4(t){return rt(this,"_erasNameRegex")||N0.call(this),t?this._erasNameRegex:this._erasRegex}function J4(t){return rt(this,"_erasAbbrRegex")||N0.call(this),t?this._erasAbbrRegex:this._erasRegex}function Q4(t){return rt(this,"_erasNarrowRegex")||N0.call(this),t?this._erasNarrowRegex:this._erasRegex}function H0(t,e){return e.erasAbbrRegex(t)}function e6(t,e){return e.erasNameRegex(t)}function t6(t,e){return e.erasNarrowRegex(t)}function n6(t,e){return e._eraYearOrdinalRegex||Fh}function N0(){var t=[],e=[],n=[],i=[],r,o,s,a,l,u=this.eras();for(r=0,o=u.length;r<o;++r)s=Js(u[r].name),a=Js(u[r].abbr),l=Js(u[r].narrow),e.push(s),t.push(a),n.push(l),i.push(s),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ye(0,["gg",2],0,function(){return this.weekYear()%100});ye(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Uv(t,e){ye(0,[t,t.length],0,e)}Uv("gggg","weekYear");Uv("ggggg","weekYear");Uv("GGGG","isoWeekYear");Uv("GGGGG","isoWeekYear");ue("G",Fv);ue("g",Fv);ue("GG",Ot,wr);ue("gg",Ot,wr);ue("GGGG",b0,y0);ue("gggg",b0,y0);ue("GGGGG",Lv,$v);ue("ggggg",Lv,$v);Sg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Ze(t)});Sg(["gg","GG"],function(t,e,n,i){e[i]=K.parseTwoDigitYear(t)});function i6(t){return HD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function r6(t){return HD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function o6(){return Qs(this.year(),1,4)}function s6(){return Qs(this.isoWeekYear(),1,4)}function a6(){var t=this.localeData()._week;return Qs(this.year(),t.dow,t.doy)}function l6(){var t=this.localeData()._week;return Qs(this.weekYear(),t.dow,t.doy)}function HD(t,e,n,i,r){var o;return t==null?Uf(this,i,r).year:(o=Qs(t,i,r),e>o&&(e=o),u6.call(this,t,e,n,i,r))}function u6(t,e,n,i,r){var o=dD(t,e,n,i,r),s=jf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ye("Q",0,"Qo","quarter");ue("Q",tD);yt("Q",function(t,e){e[zs]=(Ze(t)-1)*3});function c6(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ye("D",["DD",2],"Do","date");ue("D",Ot,Vh);ue("DD",Ot,wr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Qo);yt("Do",function(t,e){e[Qo]=Ze(t.match(Ot)[0])});var ND=Wh("Date",!0);ye("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",kv);ue("DDDD",nD);yt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Ze(t)});function h6(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ye("m",["mm",2],0,"minute");ue("m",Ot,S0);ue("mm",Ot,wr);yt(["m","mm"],go);var d6=Wh("Minutes",!1);ye("s",["ss",2],0,"second");ue("s",Ot,S0);ue("ss",Ot,wr);yt(["s","ss"],Ys);var f6=Wh("Seconds",!1);ye("S",0,0,function(){return~~(this.millisecond()/100)});ye(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ye(0,["SSS",3],0,"millisecond");ye(0,["SSSS",4],0,function(){return this.millisecond()*10});ye(0,["SSSSS",5],0,function(){return this.millisecond()*100});ye(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ye(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ye(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ye(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",kv,tD);ue("SS",kv,wr);ue("SSS",kv,nD);var Za,DD;for(Za="SSSS";Za.length<=9;Za+="S")ue(Za,Fh);function g6(t,e){e[vu]=Ze(("0."+t)*1e3)}for(Za="S";Za.length<=9;Za+="S")yt(Za,g6);DD=Wh("Milliseconds",!1);ye("z",0,0,"zoneAbbr");ye("zz",0,0,"zoneName");function m6(){return this._isUTC?"UTC":""}function p6(){return this._isUTC?"Coordinated Universal Time":""}var q=yg.prototype;q.add=l4;q.calendar=m4;q.clone=p4;q.diff=R4;q.endOf=H4;q.format=M4;q.from=P4;q.fromNow=I4;q.to=A4;q.toNow=O4;q.get=_X;q.invalidAt=B4;q.isAfter=w4;q.isBefore=v4;q.isBetween=C4;q.isSame=y4;q.isSameOrAfter=b4;q.isSameOrBefore=S4;q.isValid=V4;q.lang=PD;q.locale=MD;q.localeData=ID;q.max=Vq;q.min=Fq;q.parsingFlags=W4;q.set=MX;q.startOf=x4;q.subtract=u4;q.toArray=k4;q.toObject=L4;q.toDate=$4;q.toISOString=T4;q.inspect=_4;typeof Symbol<"u"&&Symbol.for!=null&&(q[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});q.toJSON=F4;q.toString=E4;q.unix=D4;q.valueOf=N4;q.creationData=j4;q.eraName=G4;q.eraNarrow=K4;q.eraAbbr=X4;q.eraYear=q4;q.year=oD;q.isLeapYear=TX;q.weekYear=i6;q.isoWeekYear=r6;q.quarter=q.quarters=c6;q.month=cD;q.daysInMonth=$X;q.week=q.weeks=UX;q.isoWeek=q.isoWeeks=zX;q.weeksInYear=a6;q.weeksInWeekYear=l6;q.isoWeeksInYear=o6;q.isoWeeksInISOWeekYear=s6;q.date=ND;q.day=q.days=rq;q.weekday=oq;q.isoWeekday=sq;q.dayOfYear=h6;q.hour=q.hours=fq;q.minute=q.minutes=d6;q.second=q.seconds=f6;q.millisecond=q.milliseconds=DD;q.utcOffset=Xq;q.utc=Zq;q.local=Jq;q.parseZone=Qq;q.hasAlignedHourOffset=e4;q.isDST=t4;q.isLocal=i4;q.isUtcOffset=r4;q.isUtc=RD;q.isUTC=RD;q.zoneAbbr=m6;q.zoneName=p6;q.dates=Br("dates accessor is deprecated. Use date instead.",ND);q.months=Br("months accessor is deprecated. Use month instead",cD);q.years=Br("years accessor is deprecated. Use year instead",oD);q.zone=Br("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",qq);q.isDSTShifted=Br("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",n4);function w6(t){return At(t*1e3)}function v6(){return At.apply(null,arguments).parseZone()}function $D(t){return t}var ot=w0.prototype;ot.calendar=iX;ot.longDateFormat=aX;ot.invalidDate=uX;ot.ordinal=dX;ot.preparse=$D;ot.postformat=$D;ot.relativeTime=gX;ot.pastFuture=mX;ot.set=tX;ot.eras=U4;ot.erasParse=z4;ot.erasConvertYear=Y4;ot.erasAbbrRegex=J4;ot.erasNameRegex=Z4;ot.erasNarrowRegex=Q4;ot.months=xX;ot.monthsShort=HX;ot.monthsParse=DX;ot.monthsRegex=LX;ot.monthsShortRegex=kX;ot.week=VX;ot.firstDayOfYear=jX;ot.firstDayOfWeek=BX;ot.weekdays=QX;ot.weekdaysMin=tq;ot.weekdaysShort=eq;ot.weekdaysParse=iq;ot.weekdaysRegex=aq;ot.weekdaysShortRegex=lq;ot.weekdaysMinRegex=uq;ot.isPM=hq;ot.meridiem=gq;function Ew(t,e,n,i){var r=sa(),o=gs().set(i,e);return r[n](o,t)}function kD(t,e,n){if(ea(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ew(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Ew(t,i,n,"month");return r}function D0(t,e,n,i){typeof t=="boolean"?(ea(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,ea(e)&&(n=e,e=void 0),e=e||"");var r=sa(),o=t?r._week.dow:0,s,a=[];if(n!=null)return Ew(e,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=Ew(e,(s+o)%7,i,"day");return a}function C6(t,e){return kD(t,e,"months")}function y6(t,e){return kD(t,e,"monthsShort")}function b6(t,e,n){return D0(t,e,n,"weekdays")}function S6(t,e,n){return D0(t,e,n,"weekdaysShort")}function R6(t,e,n){return D0(t,e,n,"weekdaysMin")}il("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Ze(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});K.lang=Br("moment.lang is deprecated. Use moment.locale instead.",il);K.langData=Br("moment.langData is deprecated. Use moment.localeData instead.",sa);var bs=Math.abs;function E6(){var t=this._data;return this._milliseconds=bs(this._milliseconds),this._days=bs(this._days),this._months=bs(this._months),t.milliseconds=bs(t.milliseconds),t.seconds=bs(t.seconds),t.minutes=bs(t.minutes),t.hours=bs(t.hours),t.months=bs(t.months),t.years=bs(t.years),this}function LD(t,e,n,i){var r=So(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function T6(t,e){return LD(this,t,e,1)}function _6(t,e){return LD(this,t,e,-1)}function lA(t){return t<0?Math.floor(t):Math.ceil(t)}function M6(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=lA(IR(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Dr(t/1e3),i.seconds=r%60,o=Dr(r/60),i.minutes=o%60,s=Dr(o/60),i.hours=s%24,e+=Dr(s/24),l=Dr(FD(e)),n+=l,e-=lA(IR(l)),a=Dr(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function FD(t){return t*4800/146097}function IR(t){return t*146097/4800}function P6(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=jr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+FD(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(IR(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function aa(t){return function(){return this.as(t)}}var VD=aa("ms"),I6=aa("s"),A6=aa("m"),O6=aa("h"),x6=aa("d"),H6=aa("w"),N6=aa("M"),D6=aa("Q"),$6=aa("y"),k6=VD;function L6(){return So(this)}function F6(t){return t=jr(t),this.isValid()?this[t+"s"]():NaN}function Ku(t){return function(){return this.isValid()?this._data[t]:NaN}}var V6=Ku("milliseconds"),W6=Ku("seconds"),B6=Ku("minutes"),j6=Ku("hours"),U6=Ku("days"),z6=Ku("months"),Y6=Ku("years");function G6(){return Dr(this.days()/7)}var Vs=Math.round,rh={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function K6(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function X6(t,e,n,i){var r=So(t).abs(),o=Vs(r.as("s")),s=Vs(r.as("m")),a=Vs(r.as("h")),l=Vs(r.as("d")),u=Vs(r.as("M")),c=Vs(r.as("w")),h=Vs(r.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,K6.apply(null,d)}function q6(t){return t===void 0?Vs:typeof t=="function"?(Vs=t,!0):!1}function Z6(t,e){return rh[t]===void 0?!1:e===void 0?rh[t]:(rh[t]=e,t==="s"&&(rh.ss=e-1),!0)}function J6(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=rh,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},rh,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=X6(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var yy=Math.abs;function nc(t){return(t>0)-(t<0)||+t}function zv(){if(!this.isValid())return this.localeData().invalidDate();var t=yy(this._milliseconds)/1e3,e=yy(this._days),n=yy(this._months),i,r,o,s,a=this.asSeconds(),l,u,c,h;return a?(i=Dr(t/60),r=Dr(i/60),t%=60,i%=60,o=Dr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=nc(this._months)!==nc(a)?"-":"",c=nc(this._days)!==nc(a)?"-":"",h=nc(this._milliseconds)!==nc(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=jv.prototype;tt.isValid=zq;tt.abs=E6;tt.add=T6;tt.subtract=_6;tt.as=P6;tt.asMilliseconds=VD;tt.asSeconds=I6;tt.asMinutes=A6;tt.asHours=O6;tt.asDays=x6;tt.asWeeks=H6;tt.asMonths=N6;tt.asQuarters=D6;tt.asYears=$6;tt.valueOf=k6;tt._bubble=M6;tt.clone=L6;tt.get=F6;tt.milliseconds=V6;tt.seconds=W6;tt.minutes=B6;tt.hours=j6;tt.days=U6;tt.weeks=G6;tt.months=z6;tt.years=Y6;tt.humanize=J6;tt.toISOString=zv;tt.toString=zv;tt.toJSON=zv;tt.locale=MD;tt.localeData=ID;tt.toIsoString=Br("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",zv);tt.lang=PD;ye("X",0,0,"unix");ye("x",0,0,"valueOf");ue("x",Fv);ue("X",CX);yt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});yt("x",function(t,e,n){n._d=new Date(Ze(t))});//! moment.js
K.version="2.30.1";Q3(At);K.fn=q;K.min=Wq;K.max=Bq;K.now=jq;K.utc=gs;K.unix=w6;K.months=C6;K.isDate=Cg;K.locale=il;K.invalid=Dv;K.duration=So;K.isMoment=vo;K.weekdays=b6;K.parseZone=v6;K.localeData=sa;K.isDuration=Gp;K.monthsShort=y6;K.weekdaysMin=R6;K.defineLocale=M0;K.updateLocale=vq;K.locales=Cq;K.weekdaysShort=S6;K.normalizeUnits=jr;K.relativeTimeRounding=q6;K.relativeTimeThreshold=Z6;K.calendarFormat=g4;K.prototype=q;K.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Q6=St,e9=Lh,t9=zi,n9=bn,i9=fs,r9=Yi,o9=pl,s9=pg,a9=fn,WD=TypeError,BD=a9(function(){[].keys().reduce(function(){},void 0)}),by=!BD&&o9("reduce",WD);Q6({target:"Iterator",proto:!0,real:!0,forced:BD||by},{reduce:function(e){n9(this);try{t9(e)}catch(s){r9(this,"throw",s)}var n=arguments.length<2,i=n?void 0:arguments[1];if(by)return s9(by,this,n?[e]:[e,i]);var r=i9(this),o=0;if(e9(r,function(s){n?(n=!1,i=s):i=e(i,s,o),o++},{IS_RECORD:!0}),n)throw new WD("Reduce of empty iterator with no initial value");return i}});function jD(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function AR(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function mf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function Sn(t,e,n,i){let r=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i&&a&&(r+=1,s=o[r]),r+=1;r<a;)s=e(s,o[r],r,o),r+=1;return s}function ul(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(s+=1,o[s]=a),n+=1}return o}function Qe(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];s+=1,o[s]=e(a,n,i),n+=1}return o}function I(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function UD(t){return Sn(t,(e,n)=>e+n,0)}function l9(t){return Sn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function u9(t){return Sn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function c9(t){return t.length?UD(t)/t.length:0}function zD(t){return Sn(t,(e,n)=>e.concat(Array.isArray(n)?zD(n):n),[])}function YD(t){const e=[];return I(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function OR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return I(r,s=>{o=o.filter(a=>!s.includes(a))}),o}function h9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return I(r,s=>{o=o.filter(a=>s.includes(a))}),o}function d9(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e],o=new Set(i);return I(r,s=>{I(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function xR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const f9=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:c9,arrayEach:I,arrayFilter:ul,arrayFlatten:zD,arrayMap:Qe,arrayMax:l9,arrayMin:u9,arrayReduce:Sn,arraySum:UD,arrayUnique:YD,extendArray:AR,getDifferenceOfArrays:OR,getIntersectionOfArrays:h9,getUnionOfArrays:d9,pivot:mf,stringToArray:xR,to2dArray:jD},Symbol.toStringTag,{value:"Module"}));function et(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Sn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Eh(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=document.createElement("template");r.innerHTML=t.reduce((a,l,u)=>{var c;return a+l+((c=n[u])!==null&&c!==void 0?c:"")},"");const o=r.content.cloneNode(!0),s={};return o.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),s[l]=a}),{fragment:o,refs:s}}function Ct(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function te(t){return typeof t<"u"}function Tt(t){return typeof t>"u"}function Gt(t){return t===null||t===""||Tt(t)}function GD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const tf="length",pf=t=>parseInt(t,16),uA=t=>parseInt(t,10),Tw=(t,e,n)=>t.substr(e,n),wf=t=>t.codePointAt(0)-65,HR=t=>`${t}`.replace(/\-/g,""),g9=t=>pf(Tw(HR(t),pf("12"),wf("F")))/(pf(Tw(HR(t),wf("B"),~~![][tf]))||9),m9=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let cA=!1;const hA={invalid:()=>et`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return et`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>et`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},dA={invalid:()=>et`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return et`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>et`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function KD(t,e){const n=!Gt(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="16.2.0";let o,s="invalid",a="invalid";t=HR(t||"");const l=p9(t);if(n||i||l)if(l){const u=K("25/11/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=g9(t);o=K((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(m9()&&(s="valid",a="valid"),!cA&&s!=="valid"&&(hA[s]({keyValidityDate:o,hotVersion:r})&&console[s==="non_commercial"?"info":"warn"](hA[s]({keyValidityDate:o,hotVersion:r})),cA=!0),a!=="valid"&&e&&dA[a]({keyValidityDate:o,hotVersion:r})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=dA[a]({keyValidityDate:o,hotVersion:r}),e.appendChild(c)}}function p9(t){let e=[][tf],n=e;if(t[tf]!==wf("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=wf(r.shift());o;o=wf(r.shift()||"A"))--o<""[tf]?n=n|(uA(`${uA(pf(i)+(pf(Tw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Tw(t,o,o?r[tf]===1?9:8:6);return n===e}const w9=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:KD,isDefined:te,isEmpty:Gt,isRegExp:GD,isUndefined:Tt,stringify:Ct},Symbol.toStringTag,{value:"Module"}));function li(t){return t[0].toUpperCase()+t.substr(1)}function v9(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r=n.length;for(;r;){r-=1;const o=Ct(n[r]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function $0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function XD(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function k0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Yv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function os(t){return Gv(`${t}`,{ALLOWED_TAGS:[]})}function Gv(t,e){return Z3.sanitize(t,e)}const C9=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:v9,isJSON:XD,isPercentValue:k0,randomString:$0,sanitize:Gv,stripTags:os,substitute:Yv,toUpperCaseFirst:li},Symbol.toStringTag,{value:"Module"})),Co=t=>["tabindex",t],y9=()=>["role","treegrid"],Gs=()=>["role","presentation"],b9=()=>["role","gridcell"],S9=()=>["role","gridcell button"],R9=()=>["role","rowheader"],qD=()=>["role","rowgroup"],E9=()=>["role","columnheader"],ZD=()=>["role","row"],T9=()=>["role","menu"],_9=()=>["role","menuitem"],M9=()=>["role","menuitemcheckbox"],P9=()=>["role","combobox"],JD=()=>["role","listbox"],I9=()=>["role","option"],A9=()=>["role","checkbox"],O9=()=>["role","dialog"],x9=()=>["role","alertdialog"],H9=()=>["scope","col"],N9=()=>["scope","row"],D9=()=>["type","text"],hr=t=>["aria-label",t],$9=t=>["aria-labelledby",t],k9=t=>["aria-describedby",t],Xu=()=>["aria-hidden","true"],nf=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},L9=()=>["aria-multiselectable","true"],QD=t=>["aria-haspopup",t],e$=t=>["aria-rowcount",t],Kv=t=>["aria-colcount",t],t$=t=>["aria-rowindex",t],L0=t=>["aria-colindex",t],Lr=t=>["aria-expanded",t],F9=t=>["aria-sort",t],fA=()=>["aria-readonly","true"],gA=()=>["aria-invalid","true"],n$=t=>["aria-checked",t],F0=()=>["aria-selected","true"],V9=()=>["aria-autocomplete","list"],W9=t=>["aria-controls",t],B9=t=>["aria-activedescendant",t],j9=t=>["aria-live",t],U9=t=>["aria-relevant",t],z9=t=>["aria-setsize",t],Y9=t=>["aria-posinset",t],G9=()=>["aria-modal","true"];var K9=mr,X9=QE.get,q9=function(e){if(!K9(e))return!1;var n=X9(e);return!!n&&n.type==="RawJSON"},V0=gn,Z9=pr,sm=SyntaxError,J9=parseInt,Q9=String.fromCharCode,e5=V0("".charAt),mA=V0("".slice),pA=V0(/./.exec),wA={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},t5=/^[\da-f]{4}$/i,n5=/^[\u0000-\u001F]$/,i5=function(t,e){for(var n=!0,i="";e<t.length;){var r=e5(t,e);if(r==="\\"){var o=mA(t,e,e+2);if(Z9(wA,o))i+=wA[o],e+=2;else if(o==="\\u"){e+=2;var s=mA(t,e,e+4);if(!pA(t5,s))throw new sm("Bad Unicode escape at: "+e);i+=Q9(J9(s,16)),e+=4}else throw new sm('Unknown escape sequence: "'+o+'"')}else if(r==='"'){n=!1,e++;break}else{if(pA(n5,r))throw new sm("Bad control character in string literal at: "+e);i+=r,e++}}if(n)throw new sm("Unterminated string at: "+e);return{value:i,end:e}},r5=fn,o5=!r5(function(){var t="9007199254740993",e=JSON.rawJSON(t);return!JSON.isRawJSON(e)||JSON.stringify(e)!==t}),s5=St,i$=Nh,a5=pg,r$=yn,qu=gn,o$=fn,vA=nN,_w=In,l5=q9,CA=YE,yA=Bu,u5=Nv,c5=d0,h5=i5,d5=XE,f5=zE,Sy=o5,s$=String,rl=i$("JSON","stringify"),am=qu(/./.exec),NR=qu("".charAt),g5=qu("".charCodeAt),m5=qu("".replace),Ry=qu("".slice),DR=qu([].push),p5=qu(1.1.toString),w5=/[\uD800-\uDFFF]/g,bA=/^[\uD800-\uDBFF]$/,SA=/^[\uDC00-\uDFFF]$/,$R=d5(),RA=$R.length,a$=!f5||o$(function(){var t=i$("Symbol")("stringify detection");return rl([t])!=="[null]"||rl({a:t})!=="{}"||rl(Object(t))!=="{}"}),EA=o$(function(){return rl("\uDF06\uD834")!=='"\\udf06\\ud834"'||rl("\uDEAD")!=='"\\udead"'}),v5=a$?function(t,e){var n=c5(arguments),i=l$(e);if(!(!_w(i)&&(t===void 0||CA(t))))return n[1]=function(r,o){if(_w(i)&&(o=r$(i,this,s$(r),o)),!CA(o))return o},a5(rl,null,n)}:rl,C5=function(t,e,n){var i=NR(n,e-1),r=NR(n,e+1);return am(bA,t)&&!am(SA,r)||am(SA,t)&&!am(bA,i)?"\\u"+p5(g5(t,0),16):t},l$=function(t){if(_w(t))return t;if(vA(t)){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];typeof r=="string"?DR(n,r):(typeof r=="number"||yA(r)==="Number"||yA(r)==="String")&&DR(n,u5(r))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(vA(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}};rl&&s5({target:"JSON",stat:!0,arity:3,forced:a$||EA||!Sy},{stringify:function(e,n,i){var r=l$(n),o=[],s=v5(e,function(f,m){var v=_w(r)?r$(r,this,s$(f),m):m;return!Sy&&l5(v)?$R+(DR(o,v.rawJSON)-1):v},i);if(typeof s!="string"||(EA&&(s=m5(s,w5,C5)),Sy))return s;for(var a="",l=s.length,u=0;u<l;u++){var c=NR(s,u);if(c==='"'){var h=h5(s,++u).end-1,d=Ry(s,u,h);a+=Ry(d,0,RA)===$R?o[Ry(d,RA)]:'"'+d+'"',u=h}else a+=c}return a}});function Th(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Fe(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Th(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Th(n[0])]:e[i]=[]:e[i]=null)})),e}function u$(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function hn(t,e,n){const i=Array.isArray(n);return Fe(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function Rg(t,e){Fe(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Rg(t[i],e[i])):t[i]=e[i]})}function ui(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function yo(t){const e={};return Fe(t,(n,i)=>{e[i]=n}),e}function st(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return I(n,r=>{t.MIXINS.push(r.MIXIN_NAME),Fe(r,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let v=m;return(Array.isArray(v)||me(v))&&(v=ui(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Eg(t,e){return JSON.stringify(t)===JSON.stringify(e)}function me(t){return Object.prototype.toString.call(t)==="[object Object]"}function ps(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Fe(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Mw(t,e){const n=e.split(".");let i=t;return Fe(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function Xp(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==i.length-1?(zt(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function Xv(t){if(!me(t))return 0;const e=function(n){let i=0;return me(n)?Fe(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Ui(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function zt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vf(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(i=>{typeof e[i]=="object"&&e[i]!==null&&!Array.isArray(e[i])?n[i]=vf(t[i],e[i]):n[i]=zt(t,i)&&t[i]!==void 0?t[i]:e[i]}),Object.keys(t).forEach(i=>{zt(n,i)||(n[i]=t[i])}),n}const y5=Object.freeze(Object.defineProperty({__proto__:null,assignObjectDefaults:vf,clone:yo,createObjectPropListener:Ui,deepClone:ui,deepExtend:Rg,deepObjectSize:Xv,defineGetter:ps,duckSchema:Th,extend:hn,getProperty:Mw,hasOwnProperty:zt,inherit:u$,isObject:me,isObjectEqual:Eg,mixin:st,objectEach:Fe,setProperty:Xp},Symbol.toStringTag,{value:"Module"}));function Yf(t){return window.requestAnimationFrame(t)}function Gf(t){window.cancelAnimationFrame(t)}function W0(){return"ontouchstart"in window}function c$(){return typeof window<"u"}let ic;function h$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ic||(typeof Intl=="object"?ic=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ic=(n,i)=>`${n}`.localeCompare(i):ic=(n,i)=>n===i?0:n>i?-1:1,ic)}const b5=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Gf,getComparisonFunction:h$,isCSR:c$,isTouchSupported:W0,requestAnimationFrame:Yf},Symbol.toStringTag,{value:"Module"})),Ir=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},la={chrome:Ir((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Ir(t=>/CriOS/.test(t)),edge:Ir(t=>/Edge/.test(t)),edgeWebKit:Ir(t=>/EdgiOS/.test(t)),firefox:Ir(t=>/Firefox/.test(t)),firefoxWebKit:Ir(t=>/FxiOS/.test(t)),mobile:Ir(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Ir((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Bh={mac:Ir(t=>/^Mac/.test(t)),win:Ir(t=>/^Win/.test(t)),linux:Ir(t=>/^Linux/.test(t)),ios:Ir(t=>/iPhone|iPad|iPod/i.test(t))};function d$(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(la,n=>{let{test:i}=n;return void i(t,e)})}function f$(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(Bh,e=>{let{test:n}=e;return void n(t)})}c$()&&(d$(),f$());function B0(){return la.chrome.value}function g$(){return la.chromeWebKit.value}function qp(){return la.firefox.value}function m$(){return la.firefoxWebKit.value}function Tg(){return la.safari.value}function p$(){return la.edge.value}function S5(){return la.edgeWebKit.value}function mo(){return la.mobile.value}function j0(){return Bh.ios.value}function qv(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Bh.mac.value}function Pw(){return Bh.win.value}function Iw(){return Bh.mac.value}function R5(){return Bh.linux.value}const E5=Object.freeze(Object.defineProperty({__proto__:null,isChrome:B0,isChromeWebKit:g$,isEdge:p$,isEdgeWebKit:S5,isFirefox:qp,isFirefoxWebKit:m$,isIOS:j0,isIpadOS:qv,isLinuxOS:R5,isMacOS:Iw,isMobileBrowser:mo,isSafari:Tg,isWindowsOS:Pw,setBrowserMeta:d$,setPlatformMeta:f$},Symbol.toStringTag,{value:"Module"}));function w$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function Cf(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function v$(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ta(t){return v$(t)&&t.parent}function T5(t){return!!Object.getPrototypeOf(t.parent)}function cl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===i&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===r?o=l:o=o.parentNode}return null}function rf(t,e,n){const i=[];let r=t;for(;r&&(r=cl(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function C$(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function ol(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function y$(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function La(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function b$(t){return!t||!t.length?[]:t.filter(e=>!!e)}function S$(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),{regexFree:i,regexes:n}}function Ce(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function j(t,e){typeof e=="string"&&(e=e.split(" ")),e=b$(e),e.length>0&&t.classList.add(...e)}function ae(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=S$(e,!0);n=b$(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function le(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function ss(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=S$(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function U0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)U0(e[n])}}function cs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const R$=/(<(.*)>|&(.*);)/;function wl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R$.test(e)?t.innerHTML=n?Gv(e):e:hl(t,e)}function hl(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(cs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function dl(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return dl(i.host.impl);if(i.host)return dl(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function E$(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function Kn(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,s,a;for(o=r.offsetLeft,s=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,s+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,s+=n.pageYOffset||i.scrollTop),{left:o,top:s}}function z0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Zv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Jv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?z0(e):t.scrollTop}function Y0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Zv(e):t.scrollLeft}function Kf(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:s,overflowY:a}=r.style;if([o,s,a].includes("scroll"))return r;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(r),i.includes(o)||i.includes(s)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(s)||i.includes(o)))return r;r=r.parentNode}return n}function T$(t){return t.scrollHeight-t.clientHeight}function _$(t){return t.scrollWidth-t.clientWidth}function _h(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],s=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return i;i=i.parentNode}return n}function Xf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function _5(t,e){const{selectorText:n}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?i=t.msMatchesSelector(n):t.matches&&(i=t.matches(n))),i}function nn(t){return t.offsetWidth}function cn(t){return t.getBoundingClientRect().height}function wh(t){return t.clientHeight||t.innerHeight}function G0(t){return t.clientWidth||t.innerWidth}function M5(t,e,n){t.addEventListener(e,n,!1)}function P5(t,e,n){t.removeEventListener(e,n,!1)}function K0(t){return t.selectionStart?t.selectionStart:0}function M$(t){return t.selectionEnd?t.selectionEnd:0}function I5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function kR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function _g(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let Ey;function P$(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Pw()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function A5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Tg()&&!mo()&&!qv()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.getBoundingClientRect().width;n.style.overflow="scroll";let r=e.getBoundingClientRect().width;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((i-r).toFixed(3))}function rn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ey===void 0&&(Ey=A5(t)),Ey}function X0(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function q0(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Qv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function O5(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Mg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function yf(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function eC(t){return yf(t)&&t.hasAttribute("data-hot-input")===!1}function x5(t){const e=t.ownerDocument.activeElement;eC(e)||t.select()}function Z0(t){return!t.parentNode}function I$(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function J0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();le(t,"contenteditable",!0),n&&le(t,...Xu()),e&&j(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function Q0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ae(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function A$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;J0(t,n),e(),Q0(t,n)}function as(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const H5=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:R$,addClass:j,addEvent:M5,clearTextSelection:kR,closest:cl,closestDown:rf,empty:cs,fastInnerHTML:wl,fastInnerText:hl,findFirstParentWithClass:C$,getCaretPosition:K0,getCssTransform:O5,getFractionalScalingCompensation:P$,getFrameElement:v$,getMaximumScrollLeft:_$,getMaximumScrollTop:T$,getParent:w$,getParentWindow:ta,getScrollLeft:Y0,getScrollTop:Jv,getScrollableElement:Kf,getScrollbarWidth:rn,getSelectionEndPosition:M$,getSelectionText:I5,getStyle:Xf,getTrimmingContainer:_h,getWindowScrollLeft:Zv,getWindowScrollTop:z0,hasAccessToParentWindow:T5,hasClass:Ce,hasHorizontalScrollbar:q0,hasVerticalScrollbar:X0,hasZeroHeight:E$,index:y$,innerHeight:wh,innerWidth:G0,isChildOf:ol,isDetached:Z0,isHTMLElement:as,isInput:yf,isInternalElement:Cf,isOutsideInput:eC,isVisible:dl,makeElementContentEditableAndSelectItsContent:J0,matchesCSSRules:_5,observeVisibilityChangeOnce:I$,offset:Kn,outerHeight:cn,outerWidth:nn,overlayContainsElement:La,removeAttribute:ss,removeClass:ae,removeContentEditableFromElementAndDeselect:Q0,removeEvent:P5,removeTextNodes:U0,resetCssTransform:Mg,runWithSelectedContendEditableElement:A$,selectElementIfAllowed:x5,setAttribute:le,setCaretPosition:_g,setOverlayPosition:Qv},Symbol.toStringTag,{value:"Module"}));function nt(t){return typeof t=="function"}function O$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const i={lastCallThrottled:!0};let r=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;i.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),n=0,r=void 0},h)),i}return o}function N5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=O$(t,e);let r=n;function o(){r=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return r?(r-=1,t.apply(this,l)):i.apply(this,l)}return s.clearHits=o,s}function Pg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,s)},e),i}return r}function D5(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Sn(r,(u,c)=>c(u),i.apply(this,a))}}function eT(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function x$(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function $5(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Aw(t,e,n,i,r,o,s,a){return te(a)?t.call(e,n,i,r,o,s,a):te(s)?t.call(e,n,i,r,o,s):te(o)?t.call(e,n,i,r,o):te(r)?t.call(e,n,i,r):te(i)?t.call(e,n,i):te(n)?t.call(e,n):t.call(e)}const k5=Object.freeze(Object.defineProperty({__proto__:null,curry:x$,curryRight:$5,debounce:Pg,fastCall:Aw,isFunction:nt,partial:eT,pipe:D5,throttle:O$,throttleAfterHits:N5},Symbol.toStringTag,{value:"Module"})),ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:qp()?182:174,AUDIO_MUTE:qp()?181:173,AUDIO_UP:qp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},L5=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function H$(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function tT(t){return L5.includes(t)}function F5(t){const e=[];return Iw()?e.push(ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX):e.push(ge.CONTROL),e.includes(t)}function N$(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function Nu(t,e){const n=e.split("|");let i=!1;return I(n,r=>{if(t===ge[r])return i=!0,!1}),i}const V5=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ge,isCtrlKey:F5,isCtrlMetaKey:N$,isFunctionKey:tT,isKey:Nu,isPrintableChar:H$},Symbol.toStringTag,{value:"Module"}));function gr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ya(t){return t.isImmediatePropagationEnabled===!1}function fl(t){return t.button===2}function tC(t){return t.button===0}function D$(t){return typeof TouchEvent<"u"&&t instanceof TouchEvent}function $$(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!as(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}const W5=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ya,isLeftClick:tC,isRightClick:fl,isTouchEvent:D$,offsetRelativeTo:$$,stopImmediatePropagation:gr},Symbol.toStringTag,{value:"Module"}));function Le(){te(console)&&console.warn(...arguments)}function k$(t){te(console)&&console.warn(`Deprecated: ${t}`)}function nT(){te(console)&&console.error(...arguments)}const hu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Ty=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),_y=new Map([[]]);var B5=kh,j5=function(t,e,n){for(var i=0,r=arguments.length>2?n:B5(e),o=new t(r);r>i;)o[i]=e[i++];return o},U5=dn,z5=function(t,e){var n=U5[t],i=n&&n.prototype;return i&&i[e]},Y5=bo,G5=SN,K5=oa.f,LR=Y5("unscopables"),FR=Array.prototype;FR[LR]===void 0&&K5(FR,LR,{configurable:!0,value:G5(null)});var nC=function(t){FR[LR][t]=!0},X5=St,q5=gn,Z5=zi,J5=hg,Q5=j5,e8=z5,t8=nC,n8=Array,i8=q5(e8("Array","sort"));X5({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&Z5(e);var n=J5(this),i=Q5(n8,n);return i8(i,e)}});t8("toSorted");var r8=St,o8=yn,s8=Lh,a8=zi,l8=bn,u8=fs,c8=Yi,h8=pl,My=h8("find",TypeError);r8({target:"Iterator",proto:!0,real:!0,forced:My},{find:function(e){l8(this);try{a8(e)}catch(r){c8(this,"throw",r)}if(My)return o8(My,this,e);var n=u8(this),i=0;return s8(n,function(r,o){if(e(r,i++))return o(r)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function d8(t,e){L$(t,e),e.add(t)}function Py(t,e,n){L$(t,e),e.set(t,n)}function L$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TA(t,e,n){return t.set(Ow(t,e),n),n}function zn(t,e){return t.get(Ow(t,e))}function Ow(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const f8=100;var er=new WeakMap,Kc=new WeakMap,Iy=new WeakMap,Ay=new WeakSet;class _A{constructor(){d8(this,Ay),Py(this,er,new Map),Py(this,Kc,new Map),Py(this,Iy,new Set),hu.forEach(e=>Ow(Ay,this,MA).call(this,e))}getHooks(e){var n;return(n=zn(er,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};zn(er,this).has(e)||(Ow(Ay,this,MA).call(this,e),hu.push(e));const r=zn(er,this).get(e),o=r.find(c=>c.callback===n);if(o){o.skip===!0&&(o.skip=!1);return}const s=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,l=!!i.initialHook;let u=!1;if(l){const c=r.find(h=>h.initialHook);c&&(c.callback=n,u=!0)}if(!u){r.push({callback:n,orderIndex:s,runOnce:a,initialHook:l,skip:!1});let c=zn(Iy,this).has(e);!c&&s!==0&&(c=!0,zn(Iy,this).add(e)),c&&r.length>1&&zn(er,this).set(e,r.toSorted((h,d)=>h.orderIndex-d.orderIndex))}}has(e){return zn(er,this).has(e)&&zn(er,this).get(e).length>0}remove(e,n){if(!zn(er,this).has(e))return!1;const i=zn(er,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=zn(Kc,this).get(e);return r.skip=!0,o+=1,o>f8&&(zn(er,this).set(e,i.filter(s=>!s.skip)),o=0),zn(Kc,this).set(e,o),!0}return!1}destroy(){zn(er,this).clear(),zn(Kc,this).clear(),TA(er,this,null),TA(Kc,this,null)}}function MA(t){zn(er,this).set(t,[]),zn(Kc,this).set(t,0)}function g8(t,e,n){return(e=m8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:e+""}function p8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const w8=et`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class re{constructor(){g8(this,"globalBucket",new _A)}static getSingleton(){return C8()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new _A),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.add(e,o,i)):(Ty.has(e)&&Le(Yv(w8,{hookName:e,removedInVersion:Ty.get(e)})),_y.has(e)&&Le(_y.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?I(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Aw(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Aw(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||hu.push(e)}deregister(e){this.isRegistered(e)&&hu.splice(hu.indexOf(e),1)}isDeprecated(e){return _y.has(e)||Ty.has(e)}isRegistered(e){return hu.indexOf(e)>=0}getRegistered(){return hu}}const v8=new re;function C8(){return v8}const Cu=new Map;function Ur(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Cu.has(t)||Cu.set(t,new Map);const e=Cu.get(t);function n(l,u){e.set(l,u)}function i(l){return e.get(l)}function r(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Cu.delete(t),e.clear()}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:s,clear:a}}function y8(t,e){var n;return Cu==null||(n=Cu.get(t.guid))===null||n===void 0?void 0:n.get(e)}const VR=new WeakMap,{register:b8,getItem:F$,hasItem:V$,getNames:S8,getValues:MRe}=Ur("editors");function R8(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},re.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function W$(t,e){let n;if(typeof t=="function")VR.get(t)||$i(null,t),n=VR.get(t);else if(typeof t=="string")n=F$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function xw(t){if(typeof t=="function")return t;if(!V$(t))throw Error(`No registered editor found under "${t}" name`);return F$(t).getConstructor()}function $i(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new R8(e);typeof t=="string"&&b8(t,n),VR.set(e,n)}function E8(t,e,n){return(e=T8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T8(t){var e=_8(t,"string");return typeof e=="symbol"?e:e+""}function _8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Zp=0;class Vr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;E8(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){i.call(this,M8(s))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),Zp+=1,()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(i&&i!==s.callback||r&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Zp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),Zp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function M8(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),gr(this)},t}function P8(){return Zp}function I8(t,e){A8(t,e),e.add(t)}function A8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rl(t,e,n){return(e=O8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O8(t){var e=x8(t,"string");return typeof e=="symbol"?e:e+""}function x8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lm=new WeakSet;class WR{constructor(e,n,i){I8(this,lm),Rl(this,"hot",void 0),Rl(this,"tableMeta",void 0),Rl(this,"selection",void 0),Rl(this,"eventManager",void 0),Rl(this,"destroyed",!1),Rl(this,"activeEditor",void 0),Rl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new Vr(e),this.hot.addHook("afterDocumentKeyDown",r=>Oy(lm,this,PA).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>Oy(lm,this,PA).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,o,s)=>Oy(lm,this,H8).call(this,r,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let s=i,a=r;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=W$(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function PA(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ya(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!tT(n)&&!N$(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function H8(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const IA=new WeakMap;WR.getInstance=function(t,e,n){let i=IA.get(t);return i||(i=new WR(t,e,n),IA.set(t,i)),i};var N8=mr,D8=Bu,$8=bo,k8=$8("match"),L8=function(t){var e;return N8(t)&&((e=t[k8])!==void 0?!!e:D8(t)==="RegExp")},F8=dn,V8=fn,AA=F8.RegExp,W8=!V8(function(){var t=!0;try{AA(".","d")}catch{t=!1}var e={},n="",i=t?"dgimsy":"gimsy",r=function(l,u){Object.defineProperty(e,l,{get:function(){return n+=u,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(o.hasIndices="d");for(var s in o)r(s,o[s]);var a=Object.getOwnPropertyDescriptor(AA.prototype,"flags").get.call(e);return a!==i||n!==i}),B8={correct:W8},j8=bn,U8=function(){var t=j8(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},z8=yn,Y8=pr,G8=dg,OA=B8,K8=U8,X8=RegExp.prototype,q8=OA.correct?function(t){return t.flags}:function(t){return!OA.correct&&G8(X8,t)&&!Y8(t,"flags")?z8(K8,t):t.flags},iT=gn,Z8=Dh,J8=Math.floor,xy=iT("".charAt),Q8=iT("".replace),Hy=iT("".slice),e7=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,t7=/\$([$&'`]|\d{1,2})/g,n7=function(t,e,n,i,r,o){var s=n+t.length,a=i.length,l=t7;return r!==void 0&&(r=Z8(r),l=e7),Q8(o,l,function(u,c){var h;switch(xy(c,0)){case"$":return"$";case"&":return t;case"`":return Hy(e,0,n);case"'":return Hy(e,s);case"<":h=r[Hy(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=J8(d/10);return f===0?u:f<=a?i[f-1]===void 0?xy(c,1):i[f-1]+xy(c,1):u}h=i[d-1]}return h===void 0?"":h})},i7=St,r7=yn,rT=gn,xA=cg,o7=In,s7=mr,a7=L8,sd=Nv,l7=fg,u7=q8,c7=n7,h7=bo,d7=h7("replace"),f7=TypeError,Ny=rT("".indexOf);rT("".replace);var HA=rT("".slice),g7=Math.max;i7({target:"String",proto:!0},{replaceAll:function(e,n){var i=xA(this),r,o,s,a,l,u,c,h,d,f,m=0,v="";if(s7(e)){if(r=a7(e),r&&(o=sd(xA(u7(e))),!~Ny(o,"g")))throw new f7("`.replaceAll` does not allow non-global regexes");if(s=l7(e,d7),s)return r7(s,e,i,n)}for(a=sd(i),l=sd(e),u=o7(n),u||(n=sd(n)),c=l.length,h=g7(1,c),d=Ny(a,l);d!==-1;)f=u?sd(n(l,d,a)):c7(l,a,d,[],void 0,n),v+=HA(a,m,d)+f,m=d+c,d=d+h>a.length?-1:Ny(a,l,d+h);return m<a.length&&(v+=HA(a,m)),v}});const B$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},m7=new RegExp(Object.keys(B$).map(t=>`(${t})`).join("|"),"gi");function p7(t){return(t&&t.nodeName||"")==="TABLE"}function BR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,s=o>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let b=0;b<s;b+=1){const T=!f&&n&&b===0;let _="";if(f)_=`<th>${t.getColHeader(b-c)}</th>`;else if(T)_=`<th>${t.getRowHeader(d-h)}</th>`;else{const D=r[d][b],{hidden:P,rowspan:W,colspan:k}=t.getCellMeta(d-h,b-c);if(!P){const $=[];if(W&&$.push(`rowspan="${W}"`),k&&$.push(`colspan="${k}"`),Gt(D))_=`<td ${$.join(" ")}></td>`;else{const G=D.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${$.join(" ")}>${G}</td>`}}}m.push(_)}const v=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function jR(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,s=[];i===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=r[a],u=Gt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function UR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const D=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{const W=P.match(/<td\b[^>]*?>/g)[0],k=/<p.*?>/g,$=P.substring(W.length,P.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(k,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${W}${$}</td>`});r.insertAdjacentHTML("afterbegin",`${D}`),o=r.querySelector("table")}if(!o||!p7(o))return;const s=r.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((D,P)=>D+P.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const D=Array.from(o.tHead.rows).filter(P=>{const W=P.querySelector("td")!==null;return W&&h.push(P),!W});f=D.length,d=f>0,f>1?n.nestedHeaders=Array.from(D).reduce((P,W)=>{const k=Array.from(W.cells).reduce(($,G,J)=>{if(a&&J===0)return $;const{colSpan:U,innerHTML:oe}=G,B=U>1?{label:oe,colspan:U}:oe;return $.push(B),$},[]);return P.push(k),P},[]):d&&(n.colHeaders=Array.from(D[0].children).reduce((P,W,k)=>(a&&k===0||P.push(W.innerHTML),P),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((D,P)=>(D.push(...Array.from(P.rows)),D),[]),...c];m=v.length;const b=new Array(m);for(let D=0;D<m;D++)b[D]=new Array(u);const T=[],_=[];for(let D=0;D<m;D++){const P=v[D],W=Array.from(P.cells),k=W.length;for(let $=0;$<k;$++){const G=W[$],{nodeName:J,innerHTML:U,rowSpan:oe,colSpan:B}=G,z=b[D].findIndex(ee=>ee===void 0);if(J==="TD"){if(oe>1||B>1){for(let Re=D;Re<D+oe;Re++)if(Re<m)for(let Te=z;Te<z+B;Te++)b[Re][Te]=null;const pe=G.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||T.push({col:z,row:D,rowspan:oe,colspan:B})}let ee="";s&&/excel/gi.test(s.content)?ee=U.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=U.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[D][z]=ee.replace(m7,pe=>B$[pe])}else _.push(U)}}return T.length&&(n.mergeCells=T),_.length&&(n.rowHeaders=_),b.length&&(n.data=b),n}const w7=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:jR,htmlToGridSettings:UR,instanceToHTML:BR},Symbol.toStringTag,{value:"Module"}));function oi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function j$(t){return oi(t,[","])}function he(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function zR(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function oT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Be(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function U$(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function Au(t){return Number.isInteger(t)&&t>=0}const v7=Object.freeze(Object.defineProperty({__proto__:null,clamp:Be,getParsedNumber:U$,isNumeric:oi,isNumericLike:j$,isUnsignedNumber:Au,rangeEach:he,rangeEachReverse:zR,valueAccordingPercent:oT},Symbol.toStringTag,{value:"Module"})),YR="asc",C7="desc",NA=new Map([[YR,[-1,1]],[C7,[1,-1]]]),y7=t=>`The priority '${t}' is already declared in a map.`,b7=t=>`The priority '${t}' is not a number.`;function S7(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=nt(t)?t:y7,e=nt(e)?e:b7;function i(o,s){if(!oi(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YR;const[s,a]=NA.get(o)||NA.get(YR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:r}}const R7=t=>`The id '${t}' is already declared in a map.`;function Ig(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=nt(t)?t:R7;function n(c,h){if(u(c))throw new Error(t(c));e.set(c,h)}function i(c){return e.delete(c)}function r(){e.clear()}function o(c){const[h]=a().find(d=>{let[f,m]=d;return c===m?f:!1})||[null];return h}function s(c){return e.get(c)}function a(){return[...e]}function l(){return[...e.values()]}function u(c){return e.has(c)}return{addItem:n,clear:r,getId:o,getItem:s,getItems:a,getValues:l,hasItem:u,removeItem:i}}const E7=t=>`'${t}' value is already declared in a unique set.`;function T7(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=nt(t)?t:E7;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const sT=t=>`There is already registered "${t}" plugin.`,_7=t=>`There is already registered plugin on priority "${t}".`,M7=t=>`The priority "${t}" is not a number.`,z$=S7({errorPriorityExists:_7,errorPriorityNaN:M7}),Y$=T7({errorItemExists:sT}),GR=Ig({errorIdExists:sT});function aT(){return[...z$.getItems(),...Y$.getItems()]}function Ag(t){const e=li(t);return GR.getItem(e)}function P7(t){return!!Ag(t)}function ze(t,e,n){[t,e,n]=A7(t,e,n),Ag(t)===void 0&&I7(t,e,n)}function I7(t,e,n){const i=li(t);if(GR.hasItem(i))throw new Error(sT(i));n===void 0?Y$.addItem(i):z$.addItem(n,i),GR.addItem(i,e)}function A7(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:O7,getItem:x7,hasItem:G$,getNames:H7,getValues:PRe}=Ur("renderers");function Hw(t){if(typeof t=="function")return t;if(!G$(t))throw Error(`No registered renderer found under "${t}" name`);return x7(t)}function ir(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),O7(t,e)}const{register:N7,getItem:D7,hasItem:K$,getNames:$7,getValues:IRe}=Ur("validators");function lT(t){if(typeof t=="function")return t;if(!K$(t))throw Error(`No registered validator found under "${t}" name`);return D7(t)}function du(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),N7(t,e)}var k7=St,L7=Dh,F7=kh,V7=gg,W7=nC;k7({target:"Array",proto:!0},{at:function(e){var n=L7(this),i=F7(n),r=V7(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:n[o]}});W7("at");var B7=St,j7=gn,U7=cg,z7=gg,Y7=Nv,G7=fn,K7=j7("".charAt),X7=G7(function(){return"ð ®·".at(-2)!=="\uD842"});B7({target:"String",proto:!0,forced:X7},{at:function(e){var n=Y7(U7(this)),i=n.length,r=z7(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:K7(n,o)}});function ad(t,e,n){return(e=q7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q7(t){var e=Z7(t,"string");return typeof e=="symbol"?e:e+""}function Z7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J7{constructor(){ad(this,"count",0),ad(this,"startColumn",null),ad(this,"endColumn",null),ad(this,"startPosition",null),ad(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:s}=n,a=r>0?o+1:o;i>=r&&i+s<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=r&&(this.startColumn-=1),m>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ld(t,e,n){return(e=Q7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q7(t){var e=eZ(t,"string");return typeof e=="symbol"?e:e+""}function eZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tZ{constructor(){ld(this,"count",0),ld(this,"startRow",null),ld(this,"endRow",null),ld(this,"startPosition",null),ld(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:s}=n;i>=r&&i+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-o&&(this.startRow-=1),d>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ud(t,e,n){return(e=nZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nZ(t){var e=iZ(t,"string");return typeof e=="symbol"?e:e+""}function iZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X${constructor(){ud(this,"count",0),ud(this,"startColumn",null),ud(this,"endColumn",null),ud(this,"startPosition",null),ud(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const s=r>0?o+1:o;i>=r&&i<=r+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r;i+r-h<-1*o||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function cd(t,e,n){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:e+""}function oZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q${constructor(){cd(this,"count",0),cd(this,"startRow",null),cd(this,"endRow",null),cd(this,"startPosition",null),cd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function hd(t,e,n){return(e=sZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sZ(t){var e=aZ(t,"string");return typeof e=="symbol"?e:e+""}function aZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lZ{constructor(){hd(this,"count",0),hd(this,"startColumn",0),hd(this,"endColumn",0),hd(this,"startPosition",0),hd(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function dd(t,e,n){return(e=uZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uZ(t){var e=cZ(t,"string");return typeof e=="symbol"?e:e+""}function cZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hZ{constructor(){dd(this,"count",0),dd(this,"startRow",0),dd(this,"endRow",0),dd(this,"startPosition",0),dd(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function DA(t,e,n){return(e=dZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dZ(t){var e=fZ(t,"string");return typeof e=="symbol"?e:e+""}function fZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gZ extends X${constructor(){super(...arguments),DA(this,"columnStartOffset",0),DA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const s=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function $A(t,e,n){return(e=mZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mZ(t){var e=pZ(t,"string");return typeof e=="symbol"?e:e+""}function pZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wZ extends q${constructor(){super(...arguments),$A(this,"rowStartOffset",0),$A(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const s=this.startRow,a=this.endRow;i(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function kA(t,e,n){return(e=vZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vZ(t){var e=CZ(t,"string");return typeof e=="symbol"?e:e+""}function CZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z${constructor(e){kA(this,"calculationTypes",[]),kA(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Yr(t,e,n){return(e=yZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZ(t){var e=bZ(t,"string");return typeof e=="symbol"?e:e+""}function bZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mh=50;class SZ extends Z${constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Yr(this,"viewportWidth",0),Yr(this,"scrollOffset",0),Yr(this,"zeroBasedScrollOffset",0),Yr(this,"totalColumns",0),Yr(this,"columnWidthFn",null),Yr(this,"columnWidth",0),Yr(this,"overrideFn",null),Yr(this,"inlineStartOffset",0),Yr(this,"totalCalculatedWidth",0),Yr(this,"startPositions",[]),Yr(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Mh:n}}function yr(t,e,n){return(e=RZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RZ(t){var e=EZ(t,"string");return typeof e=="symbol"?e:e+""}function EZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TZ extends Z${constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),yr(this,"viewportHeight",0),yr(this,"scrollOffset",0),yr(this,"zeroBasedScrollOffset",0),yr(this,"totalRows",0),yr(this,"rowHeightFn",null),yr(this,"rowHeight",0),yr(this,"overrideFn",null),yr(this,"horizontalScrollbarHeight",0),yr(this,"innerViewportHeight",0),yr(this,"totalCalculatedHeight",0),yr(this,"startPositions",[]),yr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function _Z(t,e,n){MZ(t,e),e.set(t,n)}function MZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LA(t,e,n){return(e=PZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PZ(t){var e=IZ(t,"string");return typeof e=="symbol"?e:e+""}function IZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rc(t,e){return t.get(J$(t,e))}function FA(t,e,n){return t.set(J$(t,e),n),n}function J$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ss=new WeakMap;class Du{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;LA(this,"row",null),LA(this,"col",null),_Z(this,Ss,!1),FA(Ss,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return rc(Ss,this)}isSouthEastOf(e){return this.row>=e.row&&(rc(Ss,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(rc(Ss,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(rc(Ss,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(rc(Ss,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Du&&FA(Ss,this,e.isRtl()),this}clone(){return new Du(this.row,this.col,rc(Ss,this))}toObject(){return{row:this.row,col:this.col}}}function AZ(t,e,n){OZ(t,e),e.set(t,n)}function OZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dy(t,e,n){return(e=xZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:e+""}function HZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function br(t,e){return t.get(Q$(t,e))}function NZ(t,e,n){return t.set(Q$(t,e),n),n}function Q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mi=new WeakMap;class jh{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Dy(this,"highlight",null),Dy(this,"from",null),Dy(this,"to",null),AZ(this,Mi,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),NZ(Mi,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return br(Mi,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return br(Mi,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return br(Mi,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return br(Mi,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return br(Mi,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return br(Mi,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return br(Mi,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return br(Mi,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Du))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(br(Mi,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(br(Mi,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new jh(this.highlight,this.from,this.to,br(Mi,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Du(e,n,br(Mi,this))}}function _o(t,e,n){DZ(t,e),e.set(t,n)}function DZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(ek(t,e))}function ga(t,e,n){return t.set(ek(t,e),n),n}function ek(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sr=new WeakMap,$y=new WeakMap,xn=new WeakMap,oc=new WeakMap,um=new WeakMap,Gr=new WeakMap,ky=new WeakMap,fd=new WeakMap,El=new WeakMap,Mo=new WeakMap;let tk=class{constructor(e,n,i,r,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_o(this,Sr,void 0),_o(this,$y,void 0),_o(this,xn,void 0),_o(this,oc,void 0),_o(this,um,void 0),_o(this,Gr,void 0),_o(this,ky,void 0),_o(this,fd,void 0),_o(this,El,[null,null]),_o(this,Mo,[null,null]),ga(Sr,this,i),ga($y,this,n),ga(xn,this,o),ga(oc,this,s),ga(um,this,a),ga(Gr,this,r),ga(ky,this,e),this.registerEvents()}registerEvents(){fe(Gr,this).addEventListener(fe(xn,this).holder,"contextmenu",i=>this.onContextMenu(i)),fe(Gr,this).addEventListener(fe(xn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),fe(Gr,this).addEventListener(fe(xn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{fe(Gr,this).addEventListener(fe(xn,this).holder,"touchstart",i=>this.onTouchStart(i)),fe(Gr,this).addEventListener(fe(xn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),fe(Gr,this).addEventListener(fe(xn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(Sr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(Sr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(Gr,this).addEventListener(fe(xn,this).holder,"mouseup",i=>this.onMouseUp(i)),fe(Gr,this).addEventListener(fe(xn,this).holder,"mousedown",i=>this.onMouseDown(i))};mo()?e():(W0()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(fe(fd,this)&&i){const[r,o]=[i.row,fe(fd,this).from.row],[s,a]=[i.col,fe(fd,this).from.col];return r===o&&s===a}return!1}parentCell(e){const n={},i=fe(xn,this).TABLE,r=rf(e,["TD","TH"],i);return r?(n.coords=fe(xn,this).getCoords(r),n.TD=r):Ce(e,"wtBorder")&&Ce(e,"current")?(n.coords=fe(oc,this).getFocusSelection().cellRange.highlight,n.TD=fe(xn,this).getCell(n.coords)):Ce(e,"wtBorder")&&Ce(e,"area")&&fe(oc,this).getAreaSelection().cellRange&&(n.coords=fe(oc,this).getAreaSelection().cellRange.to,n.TD=fe(xn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe($y,this).rootDocument.activeElement,i=eT(w$,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);Ce(r,"corner")?fe(Sr,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&fe(Sr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(fe(Mo,this)[0]=o.TD,clearTimeout(fe(El,this)[0]),fe(El,this)[0]=setTimeout(()=>{fe(Mo,this)[0]=null},1e3))}onContextMenu(e){if(fe(Sr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(Sr,this).has("onCellMouseOver"))return;const n=fe(xn,this).TABLE,i=rf(e.target,["TD","TH"],n),r=fe(um,this)||this;i&&i!==r.lastMouseOver&&ol(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,fe(xn,this).getCoords(i),i))}onMouseOut(e){if(!fe(Sr,this).has("onCellMouseOut"))return;const n=fe(xn,this).TABLE,i=rf(e.target,["TD","TH"],n),r=rf(e.relatedTarget,["TD","TH"],n),o=fe(um,this)||this;i&&i!==r&&ol(i,n)&&(this.callListener("onCellMouseOut",e,fe(xn,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(Sr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(Mo,this)[0]&&n.TD===fe(Mo,this)[1]?(Ce(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(Mo,this)[0]=null,fe(Mo,this)[1]=null):n.TD===fe(Mo,this)[0]&&(fe(Mo,this)[1]=n.TD,clearTimeout(fe(El,this)[1]),fe(El,this)[1]=setTimeout(()=>{fe(Mo,this)[1]=null},500)))}onTouchStart(e){ga(fd,this,fe(oc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=te(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&fe(Sr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];j0()&&(g$()||m$())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=fe(Sr,this).getSettingPure(e);o&&o(n,i,r,fe(ky,this).call(this))}destroy(){clearTimeout(fe(El,this)[0]),clearTimeout(fe(El,this)[1]),fe(Gr,this).destroy()}};function Ly(t,e,n){return(e=$Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Z(t){var e=kZ(t,"string");return typeof e=="symbol"?e:e+""}function kZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LZ{constructor(e,n,i){Ly(this,"offset",void 0),Ly(this,"total",void 0),Ly(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Fy(t,e,n){return(e=FZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FZ(t){var e=VZ(t,"string");return typeof e=="symbol"?e:e+""}function VZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WZ{constructor(e,n,i){Fy(this,"offset",void 0),Fy(this,"total",void 0),Fy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function cm(t,e,n){return(e=BZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:e+""}function jZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UZ{constructor(){cm(this,"currentSize",0),cm(this,"nextSize",0),cm(this,"currentOffset",0),cm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const zZ=0,VA=1,KR=2;function Vy(t,e,n){return(e=YZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YZ(t){var e=GZ(t,"string");return typeof e=="symbol"?e:e+""}function GZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KZ{constructor(){Vy(this,"size",new UZ),Vy(this,"workingSpace",zZ),Vy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=VA,e.workingSpace=KR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=KR,e.workingSpace=VA,this.sharedSize=e.getViewSize()}}var WA=Hv,XZ=TypeError,qZ=function(t,e){if(!delete t[e])throw new XZ("Cannot delete property "+WA(e)+" of "+WA(t))},ZZ=St,JZ=Dh,QZ=kh,eJ=iN,tJ=qZ,nJ=rN,iJ=[].unshift(0)!==1,rJ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},oJ=iJ||!rJ();ZZ({target:"Array",proto:!0,arity:1,forced:oJ},{unshift:function(e){var n=JZ(this),i=QZ(n),r=arguments.length;if(r){nJ(i+r);for(var o=i;o--;){var s=o+r;o in n?n[s]=n[o]:tJ(n,s)}for(var a=0;a<r;a++)n[a]=arguments[a]}return eJ(n,i+r)}});function sJ(t,e,n){return(e=aJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aJ(t){var e=lJ(t,"string");return typeof e=="symbol"?e:e+""}function lJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BA{constructor(e,n){sJ(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function uJ(t,e,n){return(e=cJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cJ(t){var e=hJ(t,"string");return typeof e=="symbol"?e:e+""}function hJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dJ{constructor(e){uJ(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new BA(o,n),l=new BA(s,i),u=[];for(let c=0;c<r;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(KR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function sc(t,e,n){return(e=fJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fJ(t){var e=gJ(t,"string");return typeof e=="symbol"?e:e+""}function gJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nk{constructor(e,n){sc(this,"rootNode",void 0),sc(this,"nodesPool",void 0),sc(this,"sizeSet",new KZ),sc(this,"collectedNodes",[]),sc(this,"viewDiffer",new dJ(this.sizeSet)),sc(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,s]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class ik extends nk{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function jA(t,e,n){return(e=mJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:e+""}function pJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wJ{constructor(e){jA(this,"nodeType",void 0),jA(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function gd(t,e,n){return(e=vJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t){var e=CJ(t,"string");return typeof e=="symbol"?e:e+""}function CJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Og{constructor(e,n){gd(this,"nodesPool",null),gd(this,"nodeType",void 0),gd(this,"rootNode",void 0),gd(this,"table",null),gd(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new wJ(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function UA(t,e,n){return(e=yJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:e+""}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SJ extends Og{constructor(){super("TH"),UA(this,"orderViews",new WeakMap),UA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new ik(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(0).start();for(let h=i-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),ss(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&le(d,[R9(),N9(),L0(h+1),Co(-1)]),n[h](a,d,h)}u.end()}}}class RJ extends Og{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&cs(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&le(this.rootNode,[qD()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&le(s,[ZD(),t$(n+1)]);for(let a=-1*o;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),ss(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&le(u,[L0(a+1+this.table.rowHeadersCount),Co(-1),E9(),...a>=0?[H9()]:[S9(),hr("Select whole grid")]]),i[n](l,u,n)}}}}let zA=!1;class EJ extends Og{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!zA&&e>1e3&&(zA=!0,Le(et`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&j(i,"rowHeader")}}function TJ(t,e,n){return(e=_J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _J(t){var e=MJ(t,"string");return typeof e=="symbol"?e:e+""}function MJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ac={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let YA=!1;class PJ extends Og{constructor(e){super("TR",e),TJ(this,"orderView",void 0),this.orderView=new nk(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!YA&&e>1e3&&(YA=!0,Le(et`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&le(this.rootNode,[qD()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;le(o,[ZD(),t$(s+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Ce(o,ac.rowEven)||(ae(o,ac.rowOdd),j(o,ac.rowEven)):Ce(o,ac.rowOdd)||(ae(o,ac.rowEven),j(o,ac.rowOdd))}this.orderView.end()}}function GA(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:e+""}function AJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OJ extends Og{constructor(){super("TD"),GA(this,"orderViews",new WeakMap),GA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new ik(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(Ce(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),ss(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;le(m,[...m.hasAttribute("role")?[]:[b9()],Co(-1),L0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function wn(t,e,n){return(e=xJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xJ(t){var e=HJ(t,"string");return typeof e=="symbol"?e:e+""}function HJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NJ{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wn(this,"rootNode",void 0),wn(this,"rootDocument",void 0),wn(this,"rowHeaders",null),wn(this,"columnHeaders",null),wn(this,"colGroup",null),wn(this,"rows",null),wn(this,"cells",null),wn(this,"rowFilter",null),wn(this,"columnFilter",null),wn(this,"rowUtils",null),wn(this,"columnUtils",null),wn(this,"rowsToRender",0),wn(this,"columnsToRender",0),wn(this,"rowHeaderFunctions",[]),wn(this,"rowHeadersCount",0),wn(this,"columnHeaderFunctions",[]),wn(this,"columnHeadersCount",0),wn(this,"cellRenderer",void 0),wn(this,"activeOverlayName",void 0),wn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const s=this.renderedRowToSource(i),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-u}px`:r.firstChild.style.height=""}}}}class DJ{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new NJ(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new SJ,columnHeaders:new RJ(n),colGroup:new EJ(i),rows:new PJ(r),cells:new OJ}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Wy(t,e,n){return(e=$J(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LJ{constructor(e,n){Wy(this,"dataAccessObject",void 0),Wy(this,"wtSettings",void 0),Wy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let s=Array.isArray(n)?n[o]:n;s=s??r,this.headerWidths.set(o,s)}}}}function KA(t,e,n){return(e=FJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FJ(t){var e=VJ(t,"string");return typeof e=="symbol"?e:e+""}function VJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WJ{constructor(e,n){KA(this,"dataAccessObject",void 0),KA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Po(t,e,n){return(e=BJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BJ(t){var e=jJ(t,"string");return typeof e=="symbol"?e:e+""}function jJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uh{constructor(e,n,i,r,o){Po(this,"wtSettings",null),Po(this,"domBindings",void 0),Po(this,"TBODY",null),Po(this,"THEAD",null),Po(this,"COLGROUP",null),Po(this,"hasTableHeight",!0),Po(this,"hasTableWidth",!0),Po(this,"isTableVisible",!1),Po(this,"tableOffset",0),Po(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,U0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new WJ(this.dataAccessObject,this.wtSettings),this.columnUtils=new LJ(this.dataAccessObject,this.wtSettings),this.tableRenderer=new DJ({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&le(i,[Gs()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&le(i,[Gs()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&le(i,[Co(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&le(i.parentNode,[Gs()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&le(i,[Gs()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=Kn(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=Kn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new WZ(f,o,c),this.columnFilter=new LZ(m,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),v=b.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(es)||this.is(sl))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(es))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(es)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(a=wh(s),(!o&&r<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,s=r.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(es))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[r];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=cl(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let o=y$(i),s=n.cellIndex;La(Lu,n,this.wtRootElement)||La($u,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):La(sl,n,this.wtRootElement)||La(es,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),La(Lu,n,this.wtRootElement)||La(ku,n,this.wtRootElement)||La(sl,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),i=e*n.getDefaultRowHeight(),r=wh(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?cn:wh,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-m||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return nn(this.TABLE)}getHeight(){return cn(this.TABLE)}getTotalWidth(){const e=nn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=cn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return dl(this.TABLE)}_modifyRowHeaderWidth(e){let n=nt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const UJ="stickyRowsBottom",uT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ps(uT,"MIXIN_NAME",UJ,{writable:!1,enumerable:!1});const zJ="stickyColumnsStart",iC={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ps(iC,"MIXIN_NAME",zJ,{writable:!1,enumerable:!1});class cT extends Uh{constructor(e,n,i,r){super(e,n,i,r,sl)}}st(cT,uT);st(cT,iC);const $u="top",es="bottom",ku="inline_start",Lu="top_inline_start_corner",sl="bottom_inline_start_corner",rk=[$u,es,ku,Lu,sl],YJ=new Map([[$u,`ht_clone_${$u}`],[es,`ht_clone_${es}`],[ku,`ht_clone_${ku} ht_clone_left`],[Lu,`ht_clone_${Lu} ht_clone_top_left_corner`],[sl,`ht_clone_${sl} ht_clone_bottom_left_corner`]]);function GJ(t,e){KJ(t,e),e.add(t)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XJ(t,e,n){return(e=qJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:e+""}function ZJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var md=new WeakSet;class JJ{constructor(e){GJ(this,md),XJ(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=Ui(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=Ui(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>r-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return hm(md,this,qA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return hm(md,this,qA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return hm(md,this,XA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return hm(md,this,XA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function XA(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Kn(i.wtRootElement).left;const u=Math.abs(Y0(s,s));if(l>u){const c=G0(s);let h=r.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function qA(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Kn(n.wtRootElement),a=Jv(o,o);if(s.top>a){const l=wh(o);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Rr(t,e,n){return(e=QJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=eQ(t,"string");return typeof e=="symbol"?e:e+""}function eQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hT{get eventManager(){return new Vr(this)}constructor(e,n){Rr(this,"wtTable",void 0),Rr(this,"wtScroll",void 0),Rr(this,"wtViewport",void 0),Rr(this,"wtOverlays",void 0),Rr(this,"selectionManager",void 0),Rr(this,"wtEvent",void 0),Rr(this,"guid",`wt_${$0()}`),Rr(this,"drawInterrupted",!1),Rr(this,"drawn",!1),Rr(this,"activeOverlayName","master"),Rr(this,"domBindings",void 0),Rr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new JJ(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){hl(i,e[n])}])}}createCellCoords(e,n){return new Du(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new jh(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||E$(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function ZA(t,e,n){return(e=tQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tQ(t){var e=nQ(t,"string");return typeof e=="symbol"?e:e+""}function nQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iQ extends hT{constructor(e,n,i){super(e,n),ZA(this,"cloneSource",void 0),ZA(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new tk(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function rQ(t,e,n){return(e=oQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:e+""}function sQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xg{constructor(e,n,i,r,o){rQ(this,"wtSettings",null),ps(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=_h(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=_h(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Kf(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){Le(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=r.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+rn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(rk.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${YJ.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&le(o,[Gs()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===$u||u==="vertical"&&this.type===ku?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Kf(e.TABLE),new iQ(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class aQ extends xg{constructor(e,n,i,r,o,s){super(e,n,sl,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new cT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Mg(n),this.repositionOverlay();let i=cn(this.clone.wtTable.TABLE);const r=nn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=rn(i)),r.style.bottom=`${o}px`}}const lQ="calculatedColumns",rC={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ps(rC,"MIXIN_NAME",lQ,{writable:!1,enumerable:!1});class dT extends Uh{constructor(e,n,i,r){super(e,n,i,r,es)}}st(dT,uT);st(dT,rC);function uQ(t,e,n){return(e=cQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cQ(t){var e=hQ(t,"string");return typeof e=="symbol"?e:e+""}function hQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dQ extends xg{constructor(e,n,i,r){super(e,n,es,i,r),uQ(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new dT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=rn(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Zv(n),top),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=i.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=rn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=cn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=rn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ce(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(j(s,"innerBorderBottom"),o=!a):(ae(s,"innerBorderBottom"),o=a)}return o}}const fQ="calculatedRows",fT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ps(fT,"MIXIN_NAME",fQ,{writable:!1,enumerable:!1});class gT extends Uh{constructor(e,n,i,r){super(e,n,i,r,ku)}}st(gT,fT);st(gT,iC);const gQ="localHooks",An={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,i,r,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Aw(this._localHooks[t][l],this,e,n,i,r,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ps(An,"MIXIN_NAME",gQ,{writable:!1,enumerable:!1});let ok=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};st(ok,An);const sk="active-header",mT="header",pT="area",Nw="focus",mQ="fill",pQ="row",wQ="column",vQ="custom-selection",wT=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var CQ=nC;CQ("flat");function yQ(t,e){ak(t,e),e.add(t)}function JA(t,e,n){ak(t,e),e.set(t,n)}function ak(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(bf(t,e))}function QA(t,e,n){return t.set(bf(t,e),n),n}function bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qr=new WeakMap,ni=new WeakMap,dm=new WeakSet;class bQ{constructor(){yQ(this,dm),JA(this,Qr,void 0),JA(this,ni,void 0)}setActiveOverlay(e){return QA(ni,this,e),this}setActiveSelection(e){return QA(Qr,this,e),this}scan(){const e=Vt(Qr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=Vt(Qr,this).getCorners(),{wtTable:s}=Vt(ni,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>o)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let m=s.getColumnHeader(h,f);const v=Vt(ni,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Vt(Qr,this).settings.selectionType,columnCursor:u,selectionWidth:o-i+1});v!==null&&(v!==h&&(m=s.getColumnHeader(v,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=Vt(Qr,this).getCorners(),{wtTable:s}=Vt(ni,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const v=Vt(ni,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Vt(Qr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});v!==null&&(v!==h&&(m=s.getRowHeader(v,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Vt(ni,this);bf(dm,this,SQ).call(this,(i,r)=>{const o=n.getCell(Vt(ni,this).createCellCoords(i,r)),s=Vt(ni,this).getSetting("onAfterDrawSelection",i,r,Vt(Qr,this).settings.layerLevel);typeof s=="string"&&j(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,i]=Vt(Qr,this).getCorners(),{wtTable:r}=Vt(ni,this);bf(dm,this,eO).call(this,(o,s)=>{if(o>=n&&o<=i){const a=r.getCell(Vt(ni,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=Vt(Qr,this).getCorners(),{wtTable:r}=Vt(ni,this);bf(dm,this,eO).call(this,(o,s)=>{if(s>=n&&s<=i){const a=r.getCell(Vt(ni,this).createCellCoords(o,s));e(a)}})}}function SQ(t){let[e,n,i,r]=Vt(Qr,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=Vt(ni,this),s=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const a=o.getCell(Vt(ni,this).createCellCoords(e,n));if(!as(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function eO(t){const{wtTable:e}=Vt(ni,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let s=0;s<i;s+=1)t(o,e.columnFilter.renderedToSource(s))}}const tO="ht-border-style-",RQ="-vertical",EQ="-horizontal";class nO{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=wT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),gr(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div"),c=d=>this.settings[l]&&this.settings[l][d]?this.settings[l][d]:e.border[d];u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style;const h=c("style");h?(["start","end"].includes(l)?u.className+=` ${tO}${h}${RQ}`:u.className+=` ${tO}${h}${EQ}`,r.setProperty("--ht-custom-border-size",`${c("width")}px`),r.setProperty("--ht-custom-border-color",c("color"))):r.backgroundColor=c("color"),r.height=`${c("width")}px`,r.width=`${c("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),mo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,i=n.getSetting("stylesHandler"),r=i.getCSSVariableValue("cell-mobile-handle-size"),o=i.getCSSVariableValue("cell-mobile-handle-border-radius"),s=i.getCSSVariableValue("cell-mobile-handle-background-color"),a=i.getCSSVariableValue("cell-mobile-handle-border-width"),l=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Fe(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=i.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Fe(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),v=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(i-m-1,10)}px`,u[l]=`${parseInt(r-m-1,10)}px`,c.top=`${parseInt(i-v/4*3,10)}px`,c[l]=`${parseInt(r-v/4*3,10)}px`;const _=Math.min(parseInt(r+o,10),b-m-f*2),D=Math.min(parseInt(r+o-v/4,10),b-v-f*2);h[l]=`${_}px`,d[l]=`${D}px`;const P=Math.min(parseInt(i+s,10),T-m-f*2),W=Math.min(parseInt(i+s-v/4,10),T-v-f*2);h.top=`${P}px`,d.top=`${W}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==r||i!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),m=s.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let v;if(u){if(i=Math.max(i,f),o=Math.min(o,m),n=Math.max(n,h),r=Math.min(r,d),o<i||r<n){this.disappear();return}v=s.getCell(this.wot.createCellCoords(n,i))}else if(v=s.getCell(this.wot.createCellCoords(n,i)),!as(v)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(r,o)):v,T=Kn(v),_=u?Kn(b):T,D=Kn(s.TABLE),P=T.top,W=T.left,k=this.wot.wtSettings.getSetting("rtlMode");let $=0,G=0;if(k){const Te=nn(s.TABLE),Ie=nn(v),Ee=l.innerWidth-D.left-Te;G=W+Ie-_.left,$=l.innerWidth-W-Ie-Ee-1}else G=_.left+nn(b)-W,$=W-D.left-1;if(this.isEntireColumnSelected(n,r)){const Te=n,Ie=this.getDimensionsFromHeader("columns",i,o,Te,D);let Ee=null;Ie&&([Ee,$,G]=Ie),Ee&&(v=Ee)}let J=P-D.top-1,U=_.top+cn(b)-P;if(this.isEntireRowSelected(i,o)){const Te=i,Ie=this.getDimensionsFromHeader("rows",n,r,Te,D);let Ee=null;Ie&&([Ee,J,U]=Ie),Ee&&(v=Ee)}const oe=l.getComputedStyle(v);parseInt(oe.borderTopWidth,10)>0&&(J+=1,U=U>0?U-1:0),parseInt(oe[k?"borderRightWidth":"borderLeftWidth"],10)>0&&($+=1,G=G>0?G-1:0);const B=k?"right":"left",z=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${J}px`,this.topStyle[B]=`${$}px`,this.topStyle.width=`${G+z}px`,this.topStyle.display="block",this.startStyle.top=`${J}px`,this.startStyle[B]=`${$}px`,this.startStyle.height=`${U+z}px`,this.startStyle.display="block",this.bottomStyle.top=`${J+U-parseInt(this.bottomStyle.height,10)+z}px`,this.bottomStyle[B]=`${$}px`,this.bottomStyle.width=`${G+z}px`,this.bottomStyle.display="block",this.endStyle.top=`${J}px`,this.endStyle[B]=`${$+G-parseInt(this.endStyle.width,10)+z}px`,this.endStyle.height=`${U+z}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const pe=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[gt,Re]=[r,o];if(pe&&Array.isArray(pe)&&([,,gt,Re]=pe),mo()||!ee||this.isPartRange(gt,Re))this.cornerStyle.display="none";else{this.cornerStyle.top=`${J+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[B]=`${$+G+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Te=_h(s.TABLE);const Ie=Te===l;Ie&&(Te=a.documentElement);const Ee=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,we=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Xn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const at=Ie?b.getBoundingClientRect().left:b.offsetLeft;let X=!1,g=0;if(k?(g=at-parseInt(this.cornerDefaultStyle.width,10)/2,X=g<0):(g=at+nn(b)+parseInt(this.cornerDefaultStyle.width,10)/2,X=g>=G0(Te)),X){const w=Math.floor($+G+this.cornerCenterPointOffset-we-Ee);c?(this.cornerStyle[B]=`${w}px`,this.cornerStyle[k?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[B]=`${w-1}px`}}if(r===this.wot.getSetting("totalRows")-1&&(Ie?b.getBoundingClientRect().top:b.offsetTop)+cn(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=wh(Te)){const w=Math.floor(J+U+this.cornerCenterPointOffset-Xn-Ee);c?(this.cornerStyle.top=`${w}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${w-1}px`}this.cornerStyle.display="block"}mo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,J,$,G,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return cn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return nn(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(m=l(n,b-r),v=l(i,b-r),!m||!v)return!1;const T=Kn(m),_=Kn(v);return m&&v&&(h=T[f]-o[f]-1,d=_[f]+u(v)-T[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?j(this[e],"hidden"):(Ce(this[e],"hidden")&&ae(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?j(this[e],"hidden"):ae(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",mo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function TQ(t,e){lk(t,e),e.add(t)}function lc(t,e,n){lk(t,e),e.set(t,n)}function lk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function We(t,e){return t.get(vT(t,e))}function iO(t,e,n){return t.set(vT(t,e),n),n}function vT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ii=new WeakMap,ki=new WeakMap,By=new WeakMap,of=new WeakMap,jy=new WeakMap,Tl=new WeakMap,rO=new WeakSet;class _Q{constructor(e){TQ(this,rO),lc(this,ii,void 0),lc(this,ki,void 0),lc(this,By,new bQ),lc(this,of,new WeakMap),lc(this,jy,new WeakSet),lc(this,Tl,new Map),iO(ki,this,e)}setActiveOverlay(e){return iO(ii,this,e),We(By,this).setActiveOverlay(We(ii,this)),We(of,this).has(We(ii,this))||We(of,this).set(We(ii,this),new Set),this}getFocusSelection(){return We(ki,this)!==null?We(ki,this).getFocus():null}getAreaSelection(){return We(ki,this)!==null?We(ki,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(We(Tl,this).has(e)){const i=We(Tl,this).get(e);if(i.has(We(ii,this)))return i.get(We(ii,this));const r=new nO(We(ii,this),e.settings);return i.set(We(ii,this),r),r}const n=new nO(We(ii,this),e.settings);return We(Tl,this).set(e,new Map([[We(ii,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=We(Tl,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){We(Tl,this).get(e).forEach(n=>n.destroy()),We(Tl,this).delete(e)}render(e){if(We(ki,this)===null)return;e&&vT(rO,this,MQ).call(this);const n=Array.from(We(ki,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;We(jy,this).has(s)||(We(jy,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&We(By,this).setActiveSelection(s).scan().forEach(m=>{if(i.has(m)){const v=i.get(m);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else i.set(m,new Map([[a,1]]));l&&(r.has(m)||r.set(m,[]),m.nodeName==="TH"&&r.get(m).push(...l))});const d=s.getCorners();We(ii,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>We(of,this).get(We(ii,this)).add(u)),j(s,l),s.nodeName==="TD"&&Array.isArray((a=We(ki,this).options)===null||a===void 0?void 0:a.cellAttributes)&&le(s,We(ki,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{le(o,[...r.get(o)])})}}function MQ(){const t=We(of,this).get(We(ii,this)),e=We(ii,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=We(ii,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((i=We(ki,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=We(ki,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=We(ki,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...We(ki,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ae(o[a],n),ss(o[a],s)}),t.clear()}class PQ extends xg{constructor(e,n,i,r){super(e,n,ku,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new gT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Qv(i,`${o}px`,"0px")):(o=this.getScrollPosition(),Mg(i));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,z0(n)),i=o!==n.scrollX}else if(e!==r.scrollLeft){const o=r.scrollLeft;r.scrollLeft=e,i=o!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=rn(i)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=nn(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=wT(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&r.length>0&&!Ce(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=rn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,_$(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Y0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=r-o;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ae(i,"emptyRows"):j(i,"emptyRows");let l=!1;if(!a){if(o&&!r.length)j(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const u=Ce(i,"innerBorderInlineStart");e?(j(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(ae(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const IQ="stickyRowsTop",CT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ps(CT,"MIXIN_NAME",IQ,{writable:!1,enumerable:!1});class yT extends Uh{constructor(e,n,i,r){super(e,n,i,r,Lu)}}st(yT,CT);st(yT,iC);function oO(t,e,n){return(e=AQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:e+""}function OQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xQ extends xg{constructor(e,n,i,r,o,s){super(e,n,Lu,i,r),oO(this,"topOverlay",void 0),oO(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new yT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Qv(e,`${r}px`,`${o}px`)}else Mg(e);let n=cn(this.clone.wtTable.TABLE);const i=nn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class bT extends Uh{constructor(e,n,i,r){super(e,n,i,r,$u)}}st(bT,CT);st(bT,rC);function HQ(t,e,n){return(e=NQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:e+""}function DQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Q extends xg{constructor(e,n,i,r){super(e,n,$u,i,r),HQ(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new bT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,r=this.getOverlayOffset(),Qv(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Mg(e);const s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Zv(n),e),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,o=0;for(;r<n;){const s=this.wot.wtTable.getRowHeight(r);o+=s===void 0?i:s,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=rn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=cn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=wT(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!Ce(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=rn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,T$(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jv(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";o?ae(r,"emptyColumns"):j(r,"emptyColumns");let a=!1;if(!n&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Ce(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(j(r,"innerBorderTop"),a=!h):(ae(r,"innerBorderTop"),a=h)}}return a}}function fm(t,e,n){kQ(t,e),e.set(t,n)}function kQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rs(t,e,n){return(e=LQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LQ(t){var e=FQ(t,"string");return typeof e=="symbol"?e:e+""}function FQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _l(t,e,n){return t.set(uk(t,e),n),n}function Es(t,e){return t.get(uk(t,e))}function uk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uc=new WeakMap,gm=new WeakMap,cc=new WeakMap,mm=new WeakMap;class VQ{constructor(e,n,i,r,o,s){Rs(this,"wot",null),fm(this,uc,[]),Rs(this,"topOverlay",null),Rs(this,"bottomOverlay",null),Rs(this,"inlineStartOverlay",null),Rs(this,"topInlineStartCornerOverlay",null),Rs(this,"bottomInlineStartCornerOverlay",null),Rs(this,"browserLineHeight",void 0),Rs(this,"wtSettings",null),fm(this,gm,!1),fm(this,cc,0),fm(this,mm,null),Rs(this,"resizeObserver",new ResizeObserver(c=>{Yf(()=>{!Array.isArray(c)||!c.length||(_l(cc,this,Es(cc,this)+1),Es(cc,this)===300&&(Le("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Es(mm,this)!==null&&clearTimeout(Es(mm,this)),_l(mm,this,setTimeout(()=>{_l(cc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=rn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Kf(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Es(uc,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new $Q(...e),this.bottomOverlay=new dQ(...e),this.inlineStartOverlay=new PQ(...e),this.topInlineStartCornerOverlay=new xQ(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new aQ(...e,this.bottomOverlay,this.inlineStartOverlay),_l(uc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_l(gm,this,Es(uc,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Es(uc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Es(uc,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!B0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Yf(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{_l(cc,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==i&&s!==i&&!s.contains(o),l=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Nu(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Es(gm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),_l(gm,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Kf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),f=n.hider.style,m=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,c-n.holder.clientHeight),v=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,h-n.holder.clientWidth),b=m()?1:0,T=v()?1:0;f.width=`${h+T}px`,f.height=`${c+b}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return I(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function sO(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jQ{constructor(e){sO(this,"settings",{}),sO(this,"defaults",Object.freeze(this.getDefaults())),Fe(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);hl(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Fe(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class ST extends Uh{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=_h(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=Xf(e,"height",n),o=Xf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=dl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}st(ST,fT);st(ST,rC);class UQ{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new hZ:new wZ],["fullyVisible",()=>new tZ],["partiallyVisible",()=>new q$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new lZ:new gZ],["fullyVisible",()=>new J7],["partiallyVisible",()=>new X$]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=cn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const r=this.domBindings.rootDocument.documentElement;return r.scrollWidth>r.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,i=this.hasVerticalScroll()?rn():0;return n>this.getWorkspaceWidth()-i}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return Kn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=cn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=nn(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=rn(this.domBindings.rootDocument),new TZ({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=rn(this.domBindings.rootDocument)),new SZ({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible"),s=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:i,endRow:r}=e;const{startRow:o,endRow:s}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;i=o,r=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(u,d)),r=Math.min(h,r+Math.min(c,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(u/2)),r=Math.min(h,r+Math.ceil(c/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:i,endColumn:r}=e;const{startColumn:o,endColumn:s}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;i=o,r=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(u,d)),r=Math.min(h,r+Math.min(c,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(u/2)),r=Math.min(h,r+Math.ceil(c/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}resetHasOversizedColumnHeadersMarked(){Fe(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class zQ extends hT{constructor(e,n){super(e,new jQ(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new ST(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new UQ(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new _Q(this.wtSettings.getSetting("selections")),this.wtEvent=new tk(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new VQ(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];Fe(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),ae(this.wtTable.wtRootElement.parentNode,n),j(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!rk.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class RT{constructor(e){e instanceof hT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new RT(n);return()=>i},this._wot=new zQ(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function aO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?o.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!s.row?o.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!o.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!s.column?d&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?d&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?d&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function YQ(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(o(u-1,n.col)):s&&!r.row?i.setRangeEnd(o(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}function lO(t){let{isLeftClick:e,selection:n,cellRangeMapper:i}=t;if(!e||n.settings.selectionMode!=="multiple")return;const r=n.getSelectedRange(),o=r.clone().map(a=>i.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(r.pop(),n.refresh()):a.length>1&&(r.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const GQ=new Map([["touchstart",aO],["touchend",lO],["mousedown",aO],["mouseover",YQ],["mouseup",lO]]);function Uy(t,e){GQ.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:tC(t)||t.type==="touchstart",isRightClick:fl(t),...e})}const ck=new WeakMap,ET=Symbol("rootInstance");function KQ(t){ck.set(t,!0)}function XQ(t){return t===ET}function Uo(t){return ck.has(t)}function qQ(t,e){hk(t,e),e.add(t)}function ma(t,e,n){hk(t,e),e.set(t,n)}function hk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pa(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:e+""}function JQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sn(t,e){return t.get(vh(t,e))}function Pi(t,e,n){return t.set(vh(t,e),n),n}function vh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zy=new WeakMap,pm=new WeakMap,wm=new WeakMap,Ts=new WeakMap,Kr=new WeakMap,Yy=new WeakMap,Gy=new WeakMap,hc=new WeakMap,sf=new WeakSet;class QQ{constructor(e){qQ(this,sf),pa(this,"hot",void 0),pa(this,"eventManager",void 0),pa(this,"settings",void 0),pa(this,"THEAD",void 0),pa(this,"TBODY",void 0),pa(this,"_wt",void 0),pa(this,"activeWt",void 0),ma(this,zy,0),ma(this,pm,0),pa(this,"postponedAdjustElementsSize",!1),ma(this,wm,!1),ma(this,Ts,void 0),ma(this,Kr,void 0),ma(this,Yy,0),ma(this,Gy,0),ma(this,hc,null),this.hot=e,this.eventManager=new Vr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),vh(sf,this,tee).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),j(e,"handsontable"),Pi(Kr,this,n.createElement("TABLE")),j(sn(Kr,this),"htCore"),this.hot.getSettings().tableClassName&&j(sn(Kr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(le(sn(Kr,this),[Gs()]),le(e,[y9(),e$(-1),Kv(this.hot.countCols()),L9()])),this.THEAD=n.createElement("THEAD"),sn(Kr,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),sn(Kr,this).appendChild(this.TBODY),this.hot.table=sn(Kr,this),this.hot.container.insertBefore(sn(Kr,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:i,selection:r,rootWindow:o}=this.hot,s=i.documentElement;this.eventManager.addEventListener(n,"mousedown",l=>{Pi(wm,this,!0),this.isTextSelectionAllowed(l.target)||(kR(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{Pi(wm,this,!1)}),this.eventManager.addEventListener(n,"mousemove",l=>{sn(wm,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&kR(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{r.isInProgress()&&!l.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{r.isInProgress()&&tC(l)&&r.finish(),Pi(Ts,this,!1);const u=eC(i.activeElement);yf(i.activeElement)&&!u||(u||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!(e??n).contains(l.target)&&!fl(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{r.isInProgress()&&fl(l)&&(r.finish(),Pi(Ts,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),Pi(Ts,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(sn(Ts,this)||!n||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const v=rn(i);if(i.elementFromPoint(c+v,h)!==f||i.elementFromPoint(c,h+v)!==f)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===n)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=ta(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=ta(a);this.eventManager.addEventListener(sn(Kr,this),"selectstart",l=>{this.settings.fragmentSelection||yf(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&j(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&ae(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:sn(Kr,this),isDataViewInstance:()=>Uo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Pi(pm,this,o.length),this.hot.getSettings().ariaTags&&vh(sf,this,dk).call(this)===this.hot.countCols()&&vh(sf,this,eee).call(this,sn(pm,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Pi(zy,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,v,f),this.hot.runHooks("afterRenderer",a,l,u,m,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&dl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Pi(Ts,this,!0),Pi(hc,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ya(o)&&(Uy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Pi(Ts,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ya(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ya(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ya(o)&&(sn(Ts,this)&&(!sn(hc,this)||sn(hc,this).x!==o.clientX||sn(hc,this).y!==o.clientY)&&Uy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Pi(hc,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ya(o)||this.hot.isDestroyed)&&(Uy(o,{coords:u,selection:this.hot.selection,cellRangeMapper:y8(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,v,b,T]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new RT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,i;if(yf(e))return!0;const r=ol(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&r)return!0;const o=(n=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return sn(Ts,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!Ce(i,"relative")){cs(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ce(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,r),s.className="",j(s,["relative",...o()])):(cs(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(le(a,...Gs()),le(l,...Gs())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ce(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ce(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?wl(e,i(n,r)):(hl(e,"Â "),j(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){Pi(Yy,this,e),Pi(Gy,this,n)}getLastSize(){return{width:sn(Yy,this),height:sn(Gy,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return sn(zy,this)}getRowHeadersCount(){return sn(pm,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function dk(){return parseInt(this.hot.rootElement.getAttribute(Kv()[0]),10)}function eee(t){const e=vh(sf,this,dk).call(this)+t;le(this.hot.rootElement,...Kv(e))}function tee(){const t=this.hot.rootElement;this.hasVerticalScroll()?j(t,"htHasScrollY"):ae(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?j(t,"htVerticallyScrollableByWindow"):ae(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?j(t,"htHasScrollX"):ae(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?j(t,"htHorizontallyScrollableByWindow"):ae(t,"htHorizontallyScrollableByWindow")}var nee=St,iee=yn,ree=Lh,oee=zi,see=bn,aee=fs,lee=Yi,uee=pl,Ky=uee("every",TypeError);nee({target:"Iterator",proto:!0,real:!0,forced:Ky},{every:function(e){see(this);try{oee(e)}catch(r){lee(this,"throw",r)}if(Ky)return iee(Ky,this,e);var n=aee(this),i=0;return!ree(n,function(r,o){if(!e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const fk="ABCDEFGHIJKLMNOPQRSTUVWXYZ",XR=fk.length;function oC(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%XR,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/XR,10);return n}function cee(t){let e=0;if(t)for(let n=0,i=t.length-1;n<t.length;n+=1,i-=1)e+=XR**i*(fk.indexOf(t[n])+1);return e-=1,e}function hee(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const o=[];for(r=0;r<e;r++)o.push(oC(r)+(i+1));n.push(o)}return n}function dee(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const o={};for(r=0;r<e;r++)o[`prop${r}`]=oC(r)+(i+1);n.push(o)}return n}function fee(t,e){const n=[];let i;for(let r=0;r<t;r++){i=[];for(let o=0;o<e;o++)i.push("");n.push(i)}return n}function TT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((s,a)=>{i.push([o+e,a,s])}):Object.keys(r).forEach(s=>{i.push([o+e,s,r[s]])})}),i}function _T(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&me(t[0])&&(e=Xv(t[0]))),e}function gk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function mk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const gee=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:_T,createEmptySpreadsheetData:fee,createSpreadsheetData:hee,createSpreadsheetObjectData:dee,dataRowToChangesArray:TT,isArrayOfArrays:gk,isArrayOfObjects:mk,spreadsheetColumnIndex:cee,spreadsheetColumnLabel:oC},Symbol.toStringTag,{value:"Module"}));function pd(t,e,n){return(e=mee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:e+""}function pee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];pd(this,"hot",void 0),pd(this,"data",void 0),pd(this,"dataType","array"),pd(this,"colToProp",()=>{}),pd(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return I(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):he(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(me(a)||nt(a))if(r?l=[]:l={},!o||r){const c=this.countFirstRowKeys()-1;he(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):s?Xp(l,d,f):l[d]=f}})}else Fe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Xp(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Ui(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:Xp(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?Mw(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=Ui(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,s=null,a=null,l=null;e===null||n===null?(r=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return he(o,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}getCopyable(e,n){const i=this.propToCol(n);return this.hot.getCellMeta(e,i).copyable?this.getAtCell(this.hot.toPhysicalRow(e),i):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return _T(this.data)}destroy(){this.data=null,this.hot=null}}var vee=St,Cee=yn,yee=Lh,bee=zi,See=bn,Ree=fs,Eee=Yi,Tee=pl,Xy=Tee("some",TypeError);vee({target:"Iterator",proto:!0,real:!0,forced:Xy},{some:function(e){See(this);try{bee(e)}catch(r){Eee(this,"throw",r)}if(Xy)return Cee(Xy,this,e);var n=Ree(this),i=0;return yee(n,function(r,o){if(e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function uO(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;uO(this,"indexedValues",[]),uO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,nt(this.initValueOrFn)?he(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):he(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}st(Zu,An);function MT(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,s)=>nt(i)?i(o,s):i),...r===void 0?[]:t.slice(r)]}function PT(t,e){return ul(t,(n,i)=>e.includes(i)===!1)}class vl extends Zu{insert(e,n){this.indexedValues=MT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=PT(this.indexedValues,e),super.remove(e)}}class sC extends vl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Sn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function IT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function qf(t,e){return ul(t,n=>e.includes(n)===!1)}function AT(t,e){return Qe(t,n=>n-e.filter(i=>i<n).length)}function OT(t,e){const n=e[0],i=e.length;return Qe(t,r=>r>=n?r+i:r)}function Pee(t,e,n){return(e=Iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:e+""}function Aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aC extends Zu{constructor(){super(...arguments),Pee(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=qf(this.orderOfIndexes,[e]),nt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=MT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=OT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=PT(this.indexedValues,e),this.orderOfIndexes=qf(this.orderOfIndexes,e),this.orderOfIndexes=AT(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Hg extends vl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Sn(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const cO=new Map([["indexesSequence",{getListWithInsertedItems:IT,getListWithRemovedItems:qf}],["physicallyIndexed",{getListWithInsertedItems:MT,getListWithRemovedItems:PT}]]),pk=t=>{if(cO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return cO.get(t)};class wk extends Zu{constructor(){super(e=>e)}insert(e,n){const i=OT(this.indexedValues,n);this.indexedValues=IT(i,e,n),super.insert(e,n)}remove(e){const n=qf(this.indexedValues,e);this.indexedValues=AT(n,e),super.remove(e)}}const hO=new Map([["hiding",sC],["index",Zu],["linkedPhysicalIndexToValue",aC],["physicalIndexToValue",vl],["trimming",Hg]]);function Oee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!hO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(hO.get(t))(e)}function xee(t,e,n){return(e=Hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:e+""}function Nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let qR=0;class xT{constructor(){xee(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),qR+=1)}unregister(e){const n=this.collection.get(e);te(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),qR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Tt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}st(xT,An);function Dee(){return qR}function qy(t,e,n){return(e=$ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dO extends xT{constructor(e,n){super(),qy(this,"mergedValuesCache",[]),qy(this,"aggregationFunction",void 0),qy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Qe(this.get(),o=>o.getValues()),i=[],r=te(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);i.push(s)}return Qe(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return te(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Lee(t,e,n){Fee(t,e),e.set(t,n)}function Fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vee(t,e,n){return t.set(vk(t,e),n),n}function Wee(t,e){return t.get(vk(t,e))}function vk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zy=new WeakMap;class Ck{constructor(){Lee(this,Zy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Wee(Zy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Vee(Zy,this,e)}}st(Ck,An);function fO(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function wd(t,e,n){Bee(t,e),e.set(t,n)}function Bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Er(t,e){return t.get(yk(t,e))}function vm(t,e,n){return t.set(yk(t,e),n),n}function yk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cm=new WeakMap,vd=new WeakMap,ym=new WeakMap,bm=new WeakMap,Sm=new WeakMap;class jee{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wd(this,Cm,new Set),wd(this,vd,[]),wd(this,ym,[]),wd(this,bm,!1),wd(this,Sm,!1),vm(Sm,this,e??!1)}createObserver(){const e=new Ck;return Er(Cm,this).add(e),e.addLocalHook("unsubscribe",()=>{Er(Cm,this).delete(e)}),e._writeInitialChanges(fO(Er(vd,this),Er(ym,this))),e}emit(e){let n=Er(ym,this);(!Er(bm,this)||Er(vd,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Er(Sm,this)):vm(vd,this,new Array(e.length).fill(Er(Sm,this))),Er(bm,this)||(vm(bm,this,!0),n=Er(vd,this)));const i=fO(n,e);Er(Cm,this).forEach(r=>r._write(i)),vm(ym,this,e)}}function hi(t,e,n){return(e=Uee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:e+""}function zee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZR{constructor(){hi(this,"indexesSequence",new wk),hi(this,"trimmingMapsCollection",new dO(e=>e.some(n=>n===!0),!1)),hi(this,"hidingMapsCollection",new dO(e=>e.some(n=>n===!0),!1)),hi(this,"variousMapsCollection",new xT),hi(this,"hidingChangesObservable",new jee({initialIndexValue:!1})),hi(this,"notTrimmedIndexesCache",[]),hi(this,"notHiddenIndexesCache",[]),hi(this,"isBatched",!1),hi(this,"indexesSequenceChanged",!1),hi(this,"indexesChangeSource",void 0),hi(this,"trimmedIndexesChanged",!1),hi(this,"hiddenIndexesChanged",!1),hi(this,"renderablePhysicalIndexesCache",[]),hi(this,"fromPhysicalToVisualIndexesCache",new Map),hi(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,Oee(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Hg?this.trimmingMapsCollection.register(e,n):n instanceof sC?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return te(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return te(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return te(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return te(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Qe(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),o=e.length,s=qf(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<r){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(IT(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],o=te(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=Qe(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=i==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}st(ZR,An);function Yee(t,e){return Fe(e,(n,i)=>{Tt(t[i])&&(t[i]=n)}),t}function bk(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Sk(t){te(t)&&nT(et`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Gee(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function Rk(t,e){return Array.isArray(t)?t.map(n=>Rk(n,e)):Yv(t,e)}const{register:Kee,getValues:Xee}=Ur("phraseFormatters");function Ek(t,e){Kee(t,e)}function qee(){return Xee()}Ek("pluralize",Gee);Ek("substitute",Rk);const HT="Common:",Dw=`${HT}ok`,NT=`${HT}cancel`,Tk="ContextMenu:items",xe=Tk,DT=`${xe}.noItems`,$T=`${xe}.insertRowAbove`,kT=`${xe}.insertRowBelow`,LT=`${xe}.insertColumnOnTheLeft`,FT=`${xe}.insertColumnOnTheRight`,VT=`${xe}.removeRow`,WT=`${xe}.removeColumn`,BT=`${xe}.undo`,jT=`${xe}.redo`,$w=`${xe}.readOnly`,UT=`${xe}.clearColumn`,zT=`${xe}.copy`,YT=`${xe}.copyWithHeaders`,GT=`${xe}.copyWithGroupHeaders`,KT=`${xe}.copyHeadersOnly`,XT=`${xe}.cut`,qT=`${xe}.freezeColumn`,ZT=`${xe}.unfreezeColumn`,JT=`${xe}.mergeCells`,QT=`${xe}.unmergeCells`,e_=`${xe}.addComment`,t_=`${xe}.editComment`,n_=`${xe}.removeComment`,i_=`${xe}.readOnlyComment`,r_=`${xe}.align`,o_=`${xe}.align.left`,s_=`${xe}.align.center`,a_=`${xe}.align.right`,l_=`${xe}.align.justify`,u_=`${xe}.align.top`,c_=`${xe}.align.middle`,h_=`${xe}.align.bottom`,d_=`${xe}.borders`,f_=`${xe}.borders.top`,g_=`${xe}.borders.right`,m_=`${xe}.borders.bottom`,p_=`${xe}.borders.left`,w_=`${xe}.borders.remove`,v_=`${xe}.nestedHeaders.insertChildRow`,C_=`${xe}.nestedHeaders.detachFromParent`,y_=`${xe}.hideColumn`,b_=`${xe}.showColumn`,S_=`${xe}.hideRow`,R_=`${xe}.showRow`,Ti="Filters:",Kt=`${Ti}conditions`,lC=`${Kt}.none`,E_=`${Kt}.isEmpty`,T_=`${Kt}.isNotEmpty`,__=`${Kt}.isEqualTo`,M_=`${Kt}.isNotEqualTo`,P_=`${Kt}.beginsWith`,I_=`${Kt}.endsWith`,A_=`${Kt}.contains`,O_=`${Kt}.doesNotContain`,Zee=`${Kt}.byValue`,x_=`${Kt}.greaterThan`,H_=`${Kt}.greaterThanOrEqualTo`,N_=`${Kt}.lessThan`,D_=`${Kt}.lessThanOrEqualTo`,$_=`${Kt}.isBetween`,k_=`${Kt}.isNotBetween`,L_=`${Kt}.after`,F_=`${Kt}.before`,V_=`${Kt}.today`,W_=`${Kt}.tomorrow`,B_=`${Kt}.yesterday`,j_=`${Ti}labels.filterByCondition`,U_=`${Ti}labels.filterByValue`,z_=`${Ti}labels.conjunction`,uC=`${Ti}labels.disjunction`,kw=`${Ti}values.blankCells`,Y_=`${Ti}buttons.selectAll`,G_=`${Ti}buttons.clear`,K_=`${Ti}buttons.ok`,X_=`${Ti}buttons.cancel`,q_=`${Ti}buttons.placeholder.search`,Z_=`${Ti}buttons.placeholder.value`,J_=`${Ti}buttons.placeholder.secondValue`,ws="Pagination:",Q_=`${ws}section.pagination`,eM=`${ws}.pageSize.auto`,Lw=`${ws}section.pageSize`,tM=`${ws}section.counter`,nM=`${ws}section.navigation`,iM=`${ws}firstPage`,rM=`${ws}prevPage`,oM=`${ws}nextPage`,sM=`${ws}lastPage`,aM="CheckboxRenderer:",lM=`${aM}checked`,uM=`${aM}unchecked`,_k="Loading:",cM=`${_k}title`,zh="EmptyDataState:",hM=`${zh}title`,dM=`${zh}description`,fM=`${zh}title.filters`,gM=`${zh}description.filters`,mM=`${zh}buttons.filters.reset`,Jee=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:NT,CHECKBOX_CHECKED:lM,CHECKBOX_RENDERER_NAMESPACE:aM,CHECKBOX_UNCHECKED:uM,COMMON_NAMESPACE:HT,CONTEXTMENU_ITEMS_ADD_COMMENT:e_,CONTEXTMENU_ITEMS_ALIGNMENT:r_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:h_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:s_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:l_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:o_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:c_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:a_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:u_,CONTEXTMENU_ITEMS_BORDERS:d_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:m_,CONTEXTMENU_ITEMS_BORDERS_LEFT:p_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:g_,CONTEXTMENU_ITEMS_BORDERS_TOP:f_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:UT,CONTEXTMENU_ITEMS_COPY:zT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:KT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:GT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:YT,CONTEXTMENU_ITEMS_CUT:XT,CONTEXTMENU_ITEMS_EDIT_COMMENT:t_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:qT,CONTEXTMENU_ITEMS_HIDE_COLUMN:y_,CONTEXTMENU_ITEMS_HIDE_ROW:S_,CONTEXTMENU_ITEMS_INSERT_LEFT:LT,CONTEXTMENU_ITEMS_INSERT_RIGHT:FT,CONTEXTMENU_ITEMS_MERGE_CELLS:JT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:C_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:v_,CONTEXTMENU_ITEMS_NO_ITEMS:DT,CONTEXTMENU_ITEMS_READ_ONLY:$w,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:i_,CONTEXTMENU_ITEMS_REDO:jT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:w_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:WT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:n_,CONTEXTMENU_ITEMS_REMOVE_ROW:VT,CONTEXTMENU_ITEMS_ROW_ABOVE:$T,CONTEXTMENU_ITEMS_ROW_BELOW:kT,CONTEXTMENU_ITEMS_SHOW_COLUMN:b_,CONTEXTMENU_ITEMS_SHOW_ROW:R_,CONTEXTMENU_ITEMS_UNDO:BT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:ZT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:QT,CONTEXT_MENU_ITEMS_NAMESPACE:Tk,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:mM,EMPTY_DATA_STATE_DESCRIPTION:dM,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:gM,EMPTY_DATA_STATE_NAMESPACE:zh,EMPTY_DATA_STATE_TITLE:hM,EMPTY_DATA_STATE_TITLE_FILTERS:fM,FILTERS_BUTTONS_CANCEL:X_,FILTERS_BUTTONS_CLEAR:G_,FILTERS_BUTTONS_OK:K_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:q_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:J_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Z_,FILTERS_BUTTONS_SELECT_ALL:Y_,FILTERS_CONDITIONS_AFTER:L_,FILTERS_CONDITIONS_BEFORE:F_,FILTERS_CONDITIONS_BEGINS_WITH:P_,FILTERS_CONDITIONS_BETWEEN:$_,FILTERS_CONDITIONS_BY_VALUE:Zee,FILTERS_CONDITIONS_CONTAINS:A_,FILTERS_CONDITIONS_EMPTY:E_,FILTERS_CONDITIONS_ENDS_WITH:I_,FILTERS_CONDITIONS_EQUAL:__,FILTERS_CONDITIONS_GREATER_THAN:x_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:H_,FILTERS_CONDITIONS_LESS_THAN:N_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:D_,FILTERS_CONDITIONS_NAMESPACE:Kt,FILTERS_CONDITIONS_NONE:lC,FILTERS_CONDITIONS_NOT_BETWEEN:k_,FILTERS_CONDITIONS_NOT_CONTAIN:O_,FILTERS_CONDITIONS_NOT_EMPTY:T_,FILTERS_CONDITIONS_NOT_EQUAL:M_,FILTERS_CONDITIONS_TODAY:V_,FILTERS_CONDITIONS_TOMORROW:W_,FILTERS_CONDITIONS_YESTERDAY:B_,FILTERS_DIVS_FILTER_BY_CONDITION:j_,FILTERS_DIVS_FILTER_BY_VALUE:U_,FILTERS_LABELS_CONJUNCTION:z_,FILTERS_LABELS_DISJUNCTION:uC,FILTERS_NAMESPACE:Ti,FILTERS_VALUES_BLANK_CELLS:kw,LOADING_NAMESPACE:_k,LOADING_TITLE:cM,OK:Dw,PAGINATION_COUNTER_SECTION:tM,PAGINATION_FIRST_PAGE:iM,PAGINATION_LAST_PAGE:sM,PAGINATION_NAMESPACE:ws,PAGINATION_NAV_SECTION:nM,PAGINATION_NEXT_PAGE:oM,PAGINATION_PAGE_SIZE_AUTO:eM,PAGINATION_PAGE_SIZE_SECTION:Lw,PAGINATION_PREV_PAGE:rM,PAGINATION_SECTION:Q_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Mk={languageCode:"en-US",[Dw]:"OK",[NT]:"Cancel",[DT]:"No available options",[$T]:"Insert row above",[kT]:"Insert row below",[LT]:"Insert column left",[FT]:"Insert column right",[VT]:["Remove row","Remove rows"],[WT]:["Remove column","Remove columns"],[BT]:"Undo",[jT]:"Redo",[$w]:"Read only",[UT]:"Clear column",[r_]:"Alignment",[o_]:"Left",[s_]:"Center",[a_]:"Right",[l_]:"Justify",[u_]:"Top",[c_]:"Middle",[h_]:"Bottom",[qT]:"Freeze column",[ZT]:"Unfreeze column",[d_]:"Borders",[f_]:"Top",[g_]:"Right",[m_]:"Bottom",[p_]:"Left",[w_]:"Remove border(s)",[e_]:"Add comment",[t_]:"Edit comment",[n_]:"Delete comment",[i_]:"Read-only comment",[JT]:"Merge cells",[QT]:"Unmerge cells",[zT]:"Copy",[YT]:["Copy with header","Copy with headers"],[GT]:["Copy with group header","Copy with group headers"],[KT]:["Copy header only","Copy headers only"],[XT]:"Cut",[v_]:"Insert child row",[C_]:"Detach from parent",[y_]:["Hide column","Hide columns"],[b_]:["Show column","Show columns"],[S_]:["Hide row","Hide rows"],[R_]:["Show row","Show rows"],[lC]:"None",[E_]:"Is empty",[T_]:"Is not empty",[__]:"Is equal to",[M_]:"Is not equal to",[P_]:"Begins with",[I_]:"Ends with",[A_]:"Contains",[O_]:"Does not contain",[x_]:"Greater than",[H_]:"Greater than or equal to",[N_]:"Less than",[D_]:"Less than or equal to",[$_]:"Is between",[k_]:"Is not between",[L_]:"After",[F_]:"Before",[V_]:"Today",[W_]:"Tomorrow",[B_]:"Yesterday",[kw]:"Blank cells",[j_]:"Filter by condition",[U_]:"Filter by value",[z_]:"And",[uC]:"Or",[Y_]:"Select all",[G_]:"Clear",[K_]:"OK",[X_]:"Cancel",[q_]:"Search",[Z_]:"Value",[J_]:"Second value",[Q_]:"Pagination",[Lw]:"Page size",[eM]:"Auto",[tM]:"[start] - [end] of [total]",[nM]:"Page [currentPage] of [totalPages]",[iM]:"Go to first page",[rM]:"Go to previous page",[oM]:"Go to next page",[sM]:"Go to last page",[lM]:"Checked",[uM]:"Unchecked",[cM]:"Loading...",[hM]:"No data available",[dM]:"Thereâs nothing to display yet.",[fM]:"No results found",[gM]:"It looks like your current filters are hiding all results.",[mM]:"Reset filters"},Qee=Jee,JR=Mk.languageCode,{register:ete,getItem:Pk,hasItem:tte,getValues:nte}=Ur("languagesDictionaries");Ik(Mk);function Ik(t,e){let n=t,i=e;return me(t)&&(i=t,n=i.languageCode),ite(n,i),ete(n,ui(i)),ui(i)}function ite(t,e){t!==JR&&Yee(e,Pk(JR))}function Ak(t){return pM(t)?ui(Pk(t)):null}function pM(t){return tte(t)}function rte(){return nte()}function Ok(t,e,n){const i=Ak(t);if(i===null)return null;const r=i[e];if(Tt(r))return null;const o=ote(r,n);return Array.isArray(o)?o[0]:o}function ote(t,e){return qee().reduce((n,i)=>i(n,e),t)}function ste(t){let e=bk(t);return pM(e)||(e=JR,Sk(t)),e}function ate(t,e,n){return(e=lte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lte(t){var e=ute(t,"string");return typeof e=="symbol"?e:e+""}function ute(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ua extends ok{constructor(e,n){super(e,null),ate(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,i,r)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function Jy(t){let{activeHeaderClassName:e,...n}=t;return new ua({className:e,...n,selectionType:sk})}function cte(t){let{areaCornerVisible:e,...n}=t;return new ua({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:pT})}function hte(t){let{...e}=t;return new ua({className:"highlight",...e,selectionType:pT})}function dte(t){let{columnClassName:e,...n}=t;return new ua({className:e,...n,selectionType:wQ})}function fte(t){let{cellCornerVisible:e,...n}=t;return new ua({className:"current",headerAttributes:[F0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Nw})}function gte(t){let{border:e,visualCellRange:n,...i}=t;return new ua({...e,...i,selectionType:vQ},n)}function mte(t){let{...e}=t;return new ua({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:mQ})}function gO(t){let{headerClassName:e,...n}=t;return new ua({className:e,...n,selectionType:mT})}function pte(t){let{rowClassName:e,...n}=t;return new ua({className:e,...n,selectionType:pQ})}function wte(t,e){vte(t,e),e.add(t)}function vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ii(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _s(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Io=new WeakSet;class bte{constructor(e){wte(this,Io),Ii(this,"options",void 0),Ii(this,"layerLevel",0),Ii(this,"focus",void 0),Ii(this,"fill",void 0),Ii(this,"layeredAreas",new Map),Ii(this,"areas",new Map),Ii(this,"rowHeaders",new Map),Ii(this,"columnHeaders",new Map),Ii(this,"activeRowHeaders",new Map),Ii(this,"activeColumnHeaders",new Map),Ii(this,"activeCornerHeaders",new Map),Ii(this,"rowHighlights",new Map),Ii(this,"columnHighlights",new Map),Ii(this,"customSelections",[]),this.options=e,this.focus=fte(e),this.fill=mte(e)}isEnabledFor(e,n){let i=e;e===Nw&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _s(Io,this,Ms).call(this,this.layeredAreas,cte)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _s(Io,this,Ms).call(this,this.areas,hte)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _s(Io,this,Ms).call(this,this.rowHeaders,gO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _s(Io,this,Ms).call(this,this.columnHeaders,gO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _s(Io,this,Ms).call(this,this.activeRowHeaders,Jy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _s(Io,this,Ms).call(this,this.activeColumnHeaders,Jy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _s(Io,this,Ms).call(this,this.activeCornerHeaders,Jy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _s(Io,this,Ms).call(this,this.rowHighlights,pte)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _s(Io,this,Ms).call(this,this.columnHighlights,dte)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(gte({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),I(this.areas.values(),e=>void e.clear()),I(this.layeredAreas.values(),e=>void e.clear()),I(this.rowHeaders.values(),e=>void e.clear()),I(this.columnHeaders.values(),e=>void e.clear()),I(this.activeRowHeaders.values(),e=>void e.clear()),I(this.activeColumnHeaders.values(),e=>void e.clear()),I(this.activeCornerHeaders.values(),e=>void e.clear()),I(this.rowHighlights.values(),e=>void e.clear()),I(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ms(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function mO(t,e,n){return(e=Ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ste(t){var e=Rte(t,"string");return typeof e=="symbol"?e:e+""}function Rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wM{constructor(e){mO(this,"ranges",[]),mO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,r)=>i.includes(e)&&n(i,r))}findAll(e){const n=[];return this.ranges.forEach((i,r)=>{i.isEqual(e)&&n.push({range:i,layer:r})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(i=>i.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new wM(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,i)=>e(n,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Ete(t,e){xk(t,e),e.add(t)}function Tte(t,e,n){return(e=_te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=Mte(t,"string");return typeof e=="symbol"?e:e+""}function Mte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qy(t,e,n){xk(t,e),e.set(t,n)}function xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cn(t,e){return t.get(ut(t,e))}function oh(t,e,n){return t.set(ut(t,e),n),n}function ut(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ws=new WeakMap,fu=new WeakMap,fr=new WeakMap,ht=new WeakSet;class vM{constructor(e,n){Ete(this,ht),Qy(this,Ws,void 0),Qy(this,fu,0),Qy(this,fr,{x:0,y:0}),Tte(this,"tableApi",void 0),oh(Ws,this,e),this.tableApi=n}setActiveLayerIndex(e){oh(fu,this,e)}getCurrentSelection(){return Cn(Ws,this).peekByIndex(Cn(fu,this))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;oh(fr,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){let{width:u,height:c}=ut(ht,this,QR).call(this);const{row:h,col:d}=ut(ht,this,CO).call(this,o),f=this.tableApi.fixedRowsBottom(),m=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),b=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),_=this.tableApi.createCellCoords(h+r.row,d+r.col);if(_.row>=c){const W=Ui(i&&m>0&&f===0),k=_.col+1,$=k>=u,G=this.tableApi.createCellCoords(_.row-c,$?k-u:k);if(this.runLocalHooks("beforeColumnWrap",W,ut(ht,this,dc).call(this,G),$),W.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&$&&Cn(Ws,this).size()>1){ut(ht,this,pO).call(this);const J=ut(ht,this,Rm).call(this,"forward");J!==null&&G.assign(J)}_.assign(G)}}else if(_.row<0){const W=Ui(T),k=_.col-1,$=k<0,G=this.tableApi.createCellCoords(c+_.row,$?u+k:k);if(this.runLocalHooks("beforeColumnWrap",W,ut(ht,this,dc).call(this,G),$),T){if(this.shouldSwitchSelectionLayer()&&$&&Cn(Ws,this).size()>1){ut(ht,this,wO).call(this);const J=ut(ht,this,Rm).call(this,"backward");J!==null&&G.assign(J)}_.assign(G)}}if({width:u,height:c}=ut(ht,this,QR).call(this),_.col>=u){const W=Ui(i&&v>0),k=_.row+1,$=k>=c,G=this.tableApi.createCellCoords($?k-c:k,_.col-u);if(this.runLocalHooks("beforeRowWrap",W,ut(ht,this,dc).call(this,G),$),W.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(b){if(this.shouldSwitchSelectionLayer()&&$&&Cn(Ws,this).size()>1){ut(ht,this,pO).call(this);const J=ut(ht,this,Rm).call(this,"forward");J!==null&&G.assign(J)}_.assign(G)}}else if(_.col<0){const W=Ui(b),k=_.row-1,$=k<0,G=this.tableApi.createCellCoords($?c+k:k,u+_.col);if(this.runLocalHooks("beforeRowWrap",W,ut(ht,this,dc).call(this,G),$),b){if(this.shouldSwitchSelectionLayer()&&$&&Cn(Ws,this).size()>1){ut(ht,this,wO).call(this);const J=ut(ht,this,Rm).call(this,"backward");J!==null&&G.assign(J)}_.assign(G)}}const{rowDir:D,colDir:P}=ut(ht,this,vO).call(this,_);a=D,l=P,o=ut(ht,this,dc).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:Cn(fu,this),visualCoords:o}}transformEnd(e,n){oh(fr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n),r=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(r.highlight),s=ut(ht,this,Jp).call(this,r.to.row,r.from.row),a=ut(ht,this,Qp).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=ut(ht,this,CO).call(this,r.highlight),f=this.tableApi.createCellCoords(s+i.row,a+i.col),m=r.getTopStartCorner(),v=r.getTopEndCorner(),b=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const P=f.col-d;f.col=ut(ht,this,Qp).call(this,m.col,v.col)+P}else if(i.col>0&&a<=d&&f.col>d){const P=ut(ht,this,Qp).call(this,v.col,m.col),W=Math.max(f.col-P,1);f.col=P+W}if(i.row<0&&s>=h&&f.row<h){const P=f.row-h;f.row=ut(ht,this,Jp).call(this,m.row,b.row)+P}else if(i.row>0&&s<=h&&f.row>h){const P=ut(ht,this,Jp).call(this,b.row,m.row),W=Math.max(f.row-P,1);f.row=P+W}const{rowDir:T,colDir:_}=ut(ht,this,vO).call(this,f);u=T,c=_;const D=ut(ht,this,dc).call(this,f);i.row===0&&i.col!==0?l.col=D.col:i.row!==0&&i.col===0?l.row=D.row:(l.row=D.row,l.col=D.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:Cn(fu,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function pO(){const t=Cn(fu,this)+1;this.setActiveLayerIndex(t>=Cn(Ws,this).size()?0:t),oh(fr,this,this.calculateOffset())}function wO(){const t=Cn(fu,this)-1;this.setActiveLayerIndex(t<0?Cn(Ws,this).size()-1:t),oh(fr,this,this.calculateOffset())}function vO(t){const{width:e,height:n}=ut(ht,this,QR).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function QR(){return{width:Cn(fr,this).x+this.countRenderableColumns(),height:Cn(fr,this).y+this.countRenderableRows()}}function Rm(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[i,r,o,s]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],a=ut(ht,this,Jp).call(this,i,r),l=ut(ht,this,Qp).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Jp(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:Cn(fr,this).y+n}function Qp(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Cn(fr,this).x+n}function CO(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(Cn(fr,this).y+e,Cn(fr,this).x+n)}function dc(t){const e=t.clone();return e.col=t.col-Cn(fr,this).x,e.row=t.row-Cn(fr,this).y,this.tableApi.renderableToVisualCoords(e)}st(vM,An);class Pte extends vM{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class Ite extends vM{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:i}=e.getOuterTopStartCorner(),r=this.tableApi.countRenderableColumnsInRange(0,i-1),o=this.tableApi.countRenderableRowsInRange(0,n-1),s=e.highlight.isHeader(),a=s?Math.abs(i):0,l=s?Math.abs(n):0;return{x:i<0?a:-r,y:n<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const cC=0,hC=1,Hk=2,CM=3,Ate=[CM,Hk],Ote=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],eb=Symbol("root"),yO=Symbol("child");function Ph(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eb;if(e!==eb&&e!==yO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===eb;let r=cC;if(n){const o=t[0];t.length===0?r=hC:i&&o instanceof jh?r=CM:i&&Array.isArray(o)?r=Ph(o,yO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Ote[l].includes(typeof a))&&(r=Hk)}return r}function Zf(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ate.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===CM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),Tt(u)&&(u=a),Tt(c)&&(c=l),!i){const m=a,v=l,b=u,T=c;a=Math.min(m,b),l=Math.min(v,T),u=Math.max(m,b),c=Math.max(v,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),f=e(u,c);return n(h,d,f)}}function xte(t){const e=Ph(t.getSelected());if(e===cC||e===hC)return[];const n=Zf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return Sn(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Hte(t){const e=Ph(t.getSelected());if(e===cC||e===hC)return[];const n=Zf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return Sn(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Ml(t,e,n){Nte(t,e),e.set(t,n)}function Nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e,n){return(e=Dte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=$te(t,"string");return typeof e=="symbol"?e:e+""}function $te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ht(t,e){return t.get(Nk(t,e))}function Ki(t,e,n){return t.set(Nk(t,e),n),n}function Nk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xi=new WeakMap,fc=new WeakMap,Em=new WeakMap,wa=new WeakMap,Tm=new WeakMap,Cd=new WeakMap,_m=new WeakMap;class Dk{constructor(e,n){var i=this;Pl(this,"settings",void 0),Pl(this,"tableProps",void 0),Pl(this,"inProgress",!1),Pl(this,"selectedRange",new wM((r,o,s)=>this.tableProps.createCellRange(r,o,s))),Pl(this,"highlight",void 0),Ml(this,Xi,void 0),Ml(this,fc,void 0),Pl(this,"selectedByRowHeader",new Set),Pl(this,"selectedByColumnHeader",new Set),Ml(this,Em,!1),Ml(this,wa,!1),Ml(this,Tm,"unknown"),Ml(this,Cd,-1),Ml(this,_m,0),this.settings=e,this.tableProps=n,this.highlight=new bte({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[F0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,s)=>this.tableProps.createCellRange(r,o,s)}),Ki(Xi,this,new Pte(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ki(fc,this,new Ite(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ht(Xi,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...o)}),Ht(Xi,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...o)}),Ht(Xi,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),Ht(Xi,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...o)}),Ht(Xi,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...o)}),Ht(Xi,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertColRequire",...o)}),Ht(Xi,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...o)}),Ht(Xi,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...o)}),Ht(fc,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),Ht(fc,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Ht(_m,this))}getActiveSelectionLayerIndex(){return Ht(_m,this)}setActiveSelectionLayerIndex(e){Ki(_m,this,e)}markSource(e){Ki(Tm,this,e)}markEndSource(){Ki(Tm,this,"unknown")}getSelectionSource(){return Ht(Tm,this)}setExpectedLayers(e){Ki(Cd,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ki(Cd,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Tt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Ki(wa,this,!1),Ki(Em,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!o||o&&!s&&Tt(n))&&(this.selectedRange.clear(),I(this.highlight.getAreas(),l=>void l.clear()),I(this.highlight.getLayeredAreas(),l=>void l.clear()),I(this.highlight.getRowHeaders(),l=>void l.clear()),I(this.highlight.getColumnHeaders(),l=>void l.clear()),I(this.highlight.getActiveRowHeaders(),l=>void l.clear()),I(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),I(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),I(this.highlight.getRowHighlights(),l=>void l.clear()),I(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const i=e.clone(),r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((r>0||o>0)&&(r===0&&i.col<0&&!s||o===0&&i.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",i),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(i),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}r>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const l=Ht(Cd,this)===-1||this.selectedRange.size()===Ht(Cd,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(pT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(mT,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),_=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),D=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(_).commit(),d.add(b).commit(),f.add(_).commit()):(a.add(b).add(T).commit(),l.add(_).add(D).commit(),d.add(b).add(T).commit(),f.add(_).add(D).commit())}const m=!Ht(wa,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),v=!Ht(wa,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Ht(Xi,this).setActiveLayerIndex(n),Ht(fc,this).setActiveLayerIndex(n);const i=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),i.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Nw,i.highlight)&&r.add(i.highlight).commit().syncWith(i),this.inProgress||(Ki(Em,this,!0),this.runLocalHooks("afterSetFocus",i.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:r}=Ht(Xi,this).transformStart(e,n,i);this.setRangeStart(r)}transformEnd(e,n){const{visualCoords:i,selectionLayer:r}=Ht(Xi,this).transformEnd(e,n);this.setRangeEnd(i,r)}transformFocus(e,n){const{selectionLayer:i,visualCoords:r}=Ht(fc,this).transformStart(e,n);this.setRangeFocus(r.normalize(),i)}shiftRows(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Be(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(Be(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Be(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,Be(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Be(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Be(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=Ui(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Ht(Em,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Be(d.row,u,o-1),Be(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",m,v,h),this.setRangeStartOnly(m,void 0,h),Ki(wa,this,f),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",m,v,h),this.finish()}selectCells(e){var n=this;const i=Ph(e);if(i===hC)return!1;if(i===cC)throw new Error(et`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=Zf(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),I(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(f=Be(i.row,u,s-1),m=Be(i.col,Math.min(r,o),Math.max(r,o))):(f=Be(i,u,s-1),m=r);const v=this.tableProps.createCellCoords(f,m),b=l===0?0:Be(v.row,u,-1),T=s-1,_=this.tableProps.createCellCoords(b,r),D=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",_,D,v),this.setRangeStartOnly(_,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(D),this.runLocalHooks("afterSelectColumns",_,D,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=Be(i.row,Math.min(e,n),Math.max(e,n)),d=Be(i.col,a,o-1)):(h=e,d=Be(i,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:Be(f.col,a,-1),v=o-1,b=this.tableProps.createCellCoords(e,m),T=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",b,T,f),this.setRangeStartOnly(b,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",b,T,f),this.finish()}return c}importSelection(e){let{ranges:n,activeRange:i,activeSelectionLayer:r,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,Ki(wa,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),n.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(i.highlight,r),Ki(wa,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Ht(wa,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:Be(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Be(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Be(a.row,-1/0,c),col:Be(a.col,-1/0,h)}),l.assign({row:Be(l.row,-1/0,c),col:Be(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.getActiveSelectedRange();this.highlight.isEnabledFor(Nw,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}st(Dk,An);const bO=/^(\r\n|\n\r|\r|\n)/,kte=/^[^\t\r\n]+/,SO=/^\t/;function Lte(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(SO))t=t.replace(SO,""),n+=1,e[i][n]="";else if(t.match(bO))t=t.replace(bO,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(kte);o=s?s[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function Fw(t){let e,n,i,r,o="",s;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),s=t[e][i],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function tb(t,e){const{instance:n,visualRow:i,visualCol:r,valueSetter:o}=e;return nt(o)?o.call(n,t,i,r,e):t}function Fte(t,e){const{instance:n,visualRow:i,visualCol:r,valueGetter:o}=e;return nt(o)?o.call(n,t,i,r,e):t}function Il(t,e,n){return(e=Vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:e+""}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sh{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){Il(this,"hot",void 0),Il(this,"metaManager",void 0),Il(this,"tableMeta",void 0),Il(this,"dataSource",void 0),Il(this,"duckSchema",void 0),Il(this,"colToPropCache",void 0),Il(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,s=!1;if(typeof n=="function"){const a=Xv(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=s?n(i):n[i];if(me(a)){if(typeof a.data<"u"){const l=s?o:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return _T(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,s;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Fe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&te(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(te(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Th(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=ui(this.getSchema()):(m=[],he(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Rg(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,i)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=r==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<n&&l+f<s;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const l=o.length;if(this.filterData(r,l,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=te(this.tableMeta.columns)||te(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,o,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];AR(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return jD(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];AR(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&zt(r,n))a=r[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let c=r;if(!c)return null;const h=n.split(".");for(let d=0,f=h.length;d<f;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));const l=this.propToCol(n),u=this.hot.toPhysicalColumn(l);if(Au(i)&&Au(u)&&(a=Fte(a,this.metaManager.getCellMeta(i,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=Ui(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Ui(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&zt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,s=n,a;for(;o<i&&s;)a=this.hot.toPhysicalRow(o),r.push(a),s-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,s=n;for(;o<i&&s;){const a=this.hot.toPhysicalColumn(o);r.push(a),s-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,sh.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===sh.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&r.push(a)}return r}getText(e,n){return Fw(this.getRange(e,n,sh.DESTINATION_RENDERER))}getCopyableText(e,n){return Fw(this.getRange(e,n,sh.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Bte,getItem:jte,hasItem:$k,getNames:Ute,getValues:xRe}=Ur("cellTypes");function yM(t){if(!$k(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return jte(t)}function _r(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&$i(t,n),i&&ir(t,i),r&&du(t,r),Bte(t,e)}function zte(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!zt(e,t)}function dC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?yM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Fe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!me(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};Fe(i,(o,s)=>{if(zte(s,n)){var a;r[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),hn(t,r)}function Yte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}u$(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function ew(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function af(t){return t==null}const kk=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),Gt(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),Gt(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),Eg(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function RO(t,e,n){return(e=Gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:e+""}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xte(){return class{}}class qte{constructor(e){RO(this,"metaCtor",Xte()),RO(this,"meta",void 0),this.meta=this.metaCtor.prototype,hn(this.meta,kk()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;hn(this.meta,e),dC(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Zte(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:e+""}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ene{constructor(e){Zte(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){hn(this.meta,e),dC(this.meta,e,e)}}function Mm(t,e,n){return(e=tne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tne(t){var e=nne(t,"string");return typeof e=="symbol"?e:e+""}function nne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vw{constructor(e){Mm(this,"valueFactory",void 0),Mm(this,"data",[]),Mm(this,"index",[]),Mm(this,"holes",new Set),this.valueFactory=e}obtain(e){ew(()=>Au(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ew(()=>Au(e)||af(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let s=0;s<n;s++)i.push(r+s),this.data.push(void 0);const o=af(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ew(()=>Au(e)||af(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(af(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function EO(t,e,n){return(e=ine(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ine(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const one=["data","width"];class sne{constructor(e){EO(this,"globalMeta",void 0),EO(this,"metas",new Vw(()=>this._createMeta())),this.globalMeta=e,this.metas=new Vw(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);hn(i,n),dC(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Yte(this.globalMeta.getMetaConstructor(),one).prototype}}function TO(t,e,n){return(e=ane(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ane(t){var e=lne(t,"string");return typeof e=="symbol"?e:e+""}function lne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class une{constructor(e){TO(this,"columnMeta",void 0),TO(this,"metas",new Vw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);hn(r,i),dC(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)te(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){ew(()=>Au(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Vw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Lk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new qte(e),this.tableMeta=new ene(this.globalMeta),this.columnMeta=new sne(this.globalMeta),this.cellMeta=new une(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}st(Lk,An);function _O(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=li(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":nt(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new sh(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let v,b=0,T=0;for(b=0,T=d.startRows;b<T;b++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)v=ui(m),t.push(v);else if(r.dataType==="array")v=ui(m[0]),t.push(v);else{v=[];for(let _=0,D=d.startCols;_<D;_++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=r.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.view.adjustElementsSize(),r.render()),r.getSettings().ariaTags&&le(r.rootElement,[e$(-1),Kv(r.countCols()+(r.view?r.countRowHeaders():0))])}function MO(t,e,n){return(e=cne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cne(t){var e=hne(t,"string");return typeof e=="symbol"?e:e+""}function hne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dne{constructor(e){var n=this;MO(this,"metaManager",void 0),MO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),re.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=zt(e,"type")?e.type:null;let c=nt(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function fne(t,e,n){gne(t,e),e.set(t,n)}function gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nb(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wne(t,e){return t.get(vne(t,e))}function vne(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var PO=new WeakMap;class Cne{constructor(e){nb(this,"metaManager",void 0),nb(this,"usageTracker",new Set),nb(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),fne(this,PO,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,s=typeof r=="string",a=s?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(r,l,o)):i&&(this.installPropWatcher(n,l,wne(PO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}function yne(t,e){Fk(t,e),e.add(t)}function IO(t,e,n){Fk(t,e),e.set(t,n)}function Fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AO(t,e){return t.get(Ih(t,e))}function OO(t,e,n){return t.set(Ih(t,e),n),n}function Ih(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eE=new WeakMap,tE=new WeakMap,Sf=new WeakSet;class bne{constructor(e){let{rowIndexMapper:n,columnIndexMapper:i}=e;yne(this,Sf),IO(this,eE,void 0),IO(this,tE,void 0),OO(eE,this,n),OO(tE,this,i)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,r=Ih(Sf,this,xO).call(this,e.from,n,i);if(r===null)return null;const o=Ih(Sf,this,xO).call(this,e.to,-n,-i);if(o===null)return null;const s=e.clone();return s.from=r,s.to=o,s.includes(e.highlight)||(s.highlight=r),s}}function xO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=Ih(Sf,this,HO).call(this,AO(eE,this),t.row,e);if(i===null)return null;const r=Ih(Sf,this,HO).call(this,AO(tE,this),t.col,n);return r===null?null:t.clone().assign({row:i,col:r})}function HO(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}function Yh(t){as(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function fC(t){const{selection:e,view:n}=t,i=t.getSelectedRangeActive(),r=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,m=i.getBottomEndCorner().row,v=f<=h,b=m>=d;return{getComputedColumnTarget(T){return r==="mouse"||r==="keyboard"?T.col:u&&c?i.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return r==="mouse"||r==="keyboard"?T.row:v&&b?i.highlight.row:v?f:b?m:T.row}}}function Sne(t){return e=>{const n=fC(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;Yh(t.getCell(i?-1:0,n,!0))})}}function Rne(){return()=>{}}function Ene(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:i,col:r}=n.highlight;Yh(t.getCell(i,r,!0))})}}function Tne(t){return e=>{const n=fC(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Yh(t.getCell(r,o,!0))})}}function _ne(t){return e=>{const n=fC(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Yh(t.getCell(r,o,!0))})}}function Mne(t){return e=>{const n=fC(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;Yh(t.getCell(n,i?-1:0,!0))})}}function Pne(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,o=()=>{Yh(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},o);else if(r<0&&i>=0)t.scrollViewportTo({row:i},o);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},o)}}}function Ine(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let s;e.isFocusSelectionChanged()?s=Ene(t):e.isSelectedByCorner()?s=Rne():e.isSelectedByRowHeader()?s=Mne(t):e.isSelectedByColumnHeader()?s=Sne(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Tne(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=Pne(t):e.getSelectedRange().size()>1&&(s=_ne(t)),(o=s)===null||o===void 0||o(r)}}}const Ane=Object.freeze({INLINE:"inline",MODAL:"modal"}),yu=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),One="grid";function xne(t,e){const n=NO(t,yu.TAB_FROM_ABOVE),i=NO(t,yu.TAB_FROM_BELOW);return e.prepend(n),e.append(i),{activate(){n.tabIndex=0,i.tabIndex=0},deactivate(){n.tabIndex=-1,i.tabIndex=-1},destroy(){n.remove(),i.remove()}}}function NO(t,e){const i=t.rootDocument.createElement("input");return i.type="text",i.name="htFocusCatcher",i.classList.add("htFocusCatcher"),i.dataset.htFocusSource=e,t.getSettings().ariaTags&&le(i,[hr("Focus catcher")]),i}function Hne(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={shortcutsContextName:One,type:Ane.INLINE,contains:f=>f===e||e.contains(f),runOnlyIf:()=>!0,...n},r=xne(t,e);return{getType:()=>i.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>i.shortcutsContextName,runOnlyIf:()=>i.runOnlyIf(),contains:f=>i.contains(f),activate:function(){var f;let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yu.UNKNOWN;(f=i.onActivate)===null||f===void 0||f.call(i,m)},deactivate:()=>{var f;(f=i.onDeactivate)===null||f===void 0||f.call(i)},activateFocusCatchers:()=>{r==null||r.activate()},deactivateFocusCatchers:()=>{r==null||r.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{r==null||r.destroy()}}}function Nne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=!1;function i(c){if(!n){var h;(h=e.onFocus)===null||h===void 0||h.call(e,c)}}function r(c){var h;(h=e.onClick)===null||h===void 0||h.call(e,c)}function o(c){if(c.key==="Tab"){var h;(h=e.onTabKeyDown)===null||h===void 0||h.call(e,c)}}function s(){n=!0}function a(){n=!1}return{mount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.addEventListener("focusin",i),h.addEventListener("click",r),h.addEventListener("keydown",o),h.addEventListener("mousedown",s),h.addEventListener("mouseup",a),c=ta(c)}},unmount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.removeEventListener("focusin",i),h.removeEventListener("click",r),h.removeEventListener("keydown",o),h.removeEventListener("mousedown",s),h.removeEventListener("mouseup",a),c=ta(c)}}}}function Dne(t){const e=Ig({errorIdExists:m=>`The "${m}" focus scope is already registered.`}),n=t.getShortcutManager();let i=null;function r(){return i?e.getId(i):null}function o(m,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(m))throw new Error(`Scope with id "${m}" already registered`);const T=Hne(t,v,b);e.addItem(m,T),n.getOrCreateContext(T.getShortcutsContextName())}function s(m){if(!e.hasItem(m))throw new Error(`Scope with id "${m}" not found`);e.getItem(m).destroy(),e.removeItem(m)}function a(m){if(!e.hasItem(m))throw new Error(`Scope with id "${m}" not found`);u(e.getItem(m))}function l(m){if(!e.hasItem(m))throw new Error(`Scope with id "${m}" not found`);c(e.getItem(m))}function u(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yu.UNKNOWN;i!==m&&(i!==null&&c(i),i=m,i.activate(v),n.setActiveContextName(m.getShortcutsContextName()))}function c(m){h(),i===m&&(i=null,m.deactivate())}function h(){const m=e.getValues(),v=m.filter(b=>b.runOnlyIf()&&b.getType()==="modal");m.forEach(b=>{v.length>0&&v.includes(b)||v.length===0||b.hasContainerDetached()?b.enable():b.disable(),b===i?b.contains(t.rootDocument.activeElement)?b.deactivateFocusCatchers():b.activateFocusCatchers():b.runOnlyIf()?b.activateFocusCatchers():b.deactivateFocusCatchers()})}function d(m,v){if(!m.isConnected||!dl(m))return;const b=e.getValues().filter(_=>_.runOnlyIf());let T=!1;b.forEach(_=>{!T&&_.contains(m)&&(T=!0,v!==yu.UNKNOWN&&t.listen(),u(_,v))}),!T&&i&&(c(i),t.unlisten())}const f=Nne(t.rootWindow,{onFocus:m=>{var v;d(m.target,(v=m.target.dataset.htFocusSource)!==null&&v!==void 0?v:yu.UNKNOWN)},onClick:m=>{d(m.target,yu.CLICK)},onTabKeyDown:()=>{h()}});return f.mount(),{getActiveScopeId:r,registerScope:o,unregisterScope:s,activateScope:m=>a(m),deactivateScope:m=>l(m),destroy:()=>f.unmount()}}function $ne(t,e){Vk(t,e),e.add(t)}function gc(t,e,n){Vk(t,e),e.set(t,n)}function Vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(fo(t,e))}function gu(t,e,n){return t.set(fo(t,e),n),n}function fo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ch=Object.freeze({CELL:"cell",MIXED:"mixed"});var Jt=new WeakMap,Pm=new WeakMap,Im=new WeakMap,Am=new WeakMap,Om=new WeakMap,Ww=new WeakMap,Zo=new WeakSet;class kne{constructor(e){$ne(this,Zo),gc(this,Jt,void 0),gc(this,Pm,void 0),gc(this,Im,1),gc(this,Am,null),gc(this,Om,new Map),gc(this,Ww,!1),gu(Jt,this,e)}init(){var e=this;const n=vt(Jt,this).getSettings();gu(Pm,this,n.imeFastEdit?Ch.MIXED:Ch.CELL),vt(Jt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return fo(Zo,e,Wne).call(e,...r)}),vt(Jt,this).addHook("afterSelection",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return fo(Zo,e,DO).call(e,...r)}),vt(Jt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return fo(Zo,e,DO).call(e,...r)}),vt(Jt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return fo(Zo,e,Fne).call(e,...r)}),vt(Jt,this).addHook("afterRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return fo(Zo,e,Vne).call(e,...r)})}getFocusMode(){return vt(Pm,this)}setFocusMode(e){Object.values(Ch).includes(e)?gu(Pm,this,e):Le(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(Im,this)}setRefocusDelay(e){gu(Im,this,e)}setRefocusElementGetter(e){gu(Am,this,e)}getRefocusElement(){var e;return typeof vt(Am,this)=="function"?vt(Am,this).call(this):(e=vt(Jt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const s=(r=vt(Jt,this).getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=vt(Jt,this).runHooks("modifyFocusedElement",s.row,s.col,i);as(a)||(a=i),a&&!((o=vt(Jt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):fo(Zo,this,bM).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(Im,this);if(vt(Jt,this).getSettings().imeFastEdit&&!((e=vt(Jt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=vt(Jt,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),vt(Om,this).has(n)||vt(Om,this).set(n,Pg(()=>{if(!vt(Jt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),vt(Om,this).get(n)()}}}function bM(t){var e;const n=(e=vt(Jt,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!vt(Jt,this).selection.isCellVisible(n)){t(null);return}const i=vt(Jt,this).getCell(n.row,n.col,!0);i===null?vt(Jt,this).addHookOnce("afterScroll",()=>{t(vt(Jt,this).getCell(n.row,n.col,!0))}):t(i)}function Lne(){fo(Zo,this,bM).call(this,t=>{const{activeElement:e}=vt(Jt,this).rootDocument;e&&eC(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Fne(){fo(Zo,this,bM).call(this,t=>{this.getFocusMode()===Ch.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function DO(){gu(Ww,this,!0)}function Vne(){vt(Ww,this)&&(gu(Ww,this,!1),fo(Zo,this,Lne).call(this))}function Wne(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Ch.MIXED:Ch.CELL)}function Bne(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:i}=t;if(n.isHidden(e.row)||i.isHidden(e.col))return null;const r=nE(t),o=iE(t);return r===null||o===null?null:(e.row=Be(e.row,r.row,o.row),e.col=Be(e.col,r.col,o.col),e)}}function nE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function iE(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let s=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const Rf="gridDefault",SM="grid",Bw="grid.tabNavigation",Cl="editorManager.handlingEditor",jne="editor",Une={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},zne="hooksRefRegisterer",Wk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){I(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Fe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ps(Wk,"MIXIN_NAME",zne,{writable:!1,enumerable:!1});function Xr(t,e,n){return(e=Yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:e+""}function Gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kne="base",Qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Gh{static get EDITOR_TYPE(){return Kne}constructor(e){Xr(this,"hot",void 0),Xr(this,"state",Qt.VIRGIN),Xr(this,"_opened",!1),Xr(this,"_fullEditMode",!1),Xr(this,"_closeCallback",null),Xr(this,"TD",null),Xr(this,"row",null),Xr(this,"col",null),Xr(this,"prop",null),Xr(this,"originalValue",null),Xr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,s){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,s;if(n){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();i=u.row,r=u.col,o=c.row,s=c.col}else[i,r,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Qt.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Qt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Ct(l);this.setValue(u)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Qt.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Qt.FINISHED,this.discardEditor(s)}):(this.state=Qt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=Kn(n),a=nn(n),l=Kn(this.hot.rootElement),u=nn(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:v}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,b=v.name,T=["master","inline_start"].includes(b)?d:0,_=["master","top","bottom"].includes(b)?f:0,D=s.top===l.top?0:1;let P=s.top-l.top-D-T,W=0;this.hot.isRtl()?W=o.innerWidth-s.left-a-m-1+_:W=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(b)&&(P+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(W+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const k=this.hot.hasColHeaders(),$=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),G=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(k&&$<=0||$===U)&&(P+=1),G<=0&&(W+=1);const oe=r.rowsRenderCalculator.startPosition,B=r.columnsRenderCalculator.startPosition,z=Math.abs(i.inlineStartOverlay.getScrollPosition()),ee=i.topOverlay.getScrollPosition(),pe=rn(this.hot.rootDocument);let gt=n.offsetTop;if(["inline_start","master"].includes(b)&&(gt+=oe-ee),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:A,wtTable:L}=i.bottomOverlay.clone;gt+=A.getWorkspaceHeight()-L.getHeight()-pe}let Re=n.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-n.offsetLeft:Re=Math.abs(Re),Re+=B-z-a):["top","master","bottom"].includes(b)&&(Re+=B-z);const Te=o.getComputedStyle(this.TD),Ie=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Ee=parseInt(Te[Ie],10)>0?0:1,we=parseInt(Te.borderTopWidth,10)>0?0:1,Xn=nn(n)+Ee,at=cn(n)+we,X=X0(c)?pe:0,g=q0(h)?pe:0,w=this.hot.view.maximumVisibleElementWidth(Re)-X+Ee,y=Math.max(this.hot.view.maximumVisibleElementHeight(gt)-g+we,this.hot.stylesHandler.getDefaultRowHeight());return{top:P,start:W,height:at,maxHeight:y,width:Xn,maxWidth:w}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}st(Gh,Wk);const Xne={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Qt.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},qne={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},Zne={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Jne={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Qne={name:"editorOpen",callback(t,e,n){const{selection:i}=t,r=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>i.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;n.includes("shift")?i.transformFocus(-u.row,-u.col):i.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),gr(e))}};function eie(){return[Une,Xne,qne,Zne,Jne,Qne]}const tie={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},nie={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(r,-1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},iie={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},rie={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},oie={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},sie={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},aie={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},lie={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},uie={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},cie={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},hie={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},die={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},fie={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},gie={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.max(i.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(r,1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function mie(){return[tie,nie,iie,rie,oie,sie,aie,lie,uie,cie,hie,die,fie,gie]}const pie={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},wie={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?1:o,r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},vie={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-s.row,-s.col):n.transformStart(-s.row,-s.col),n.markEndSource()}},Cie={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(s.row,s.col):n.transformStart(s.row,s.col),n.markEndSource()}},yie={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},bie={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Sie={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},Rie={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Eie={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Tie={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,o)),e.markEndSource()}},_ie={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeActive().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Mie={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeActive().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Pie={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},Iie={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Aie={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Oie={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?-1:-o,r===-i?o=-1:r+o<i&&(o=-(r+i)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function xie(){return[pie,wie,vie,Cie,yie,bie,Sie,Rie,Eie,Tie,_ie,Mie,Pie,Iie,Aie,Oie]}const Hie={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Nie={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),a=t._createCellCoords(r,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Die={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},$ie={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},kie={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(o.values()))}},Lie={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let n=!1,i=!1;return t.addHook("afterSelection",(r,o,s,a,l)=>{n&&(e.wrapped&&e.flipped||i)&&(i=!1,l.value=!0)}),t.addHook("beforeRowWrap",(r,o,s)=>{e.wrapped=!0,e.flipped=s}),{before(){const{tabNavigation:r}=t.getSettings();n=!0,r||(i=!0)},after(r){const{tabNavigation:o,autoWrapRow:s}=t.getSettings();if(n=!1,!o||!t.selection.isSelected()||s&&e.wrapped&&e.flipped||!s&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;r.preventDefault()}}}},Fie=[...eie(),...mie(),...xie(),Hie,Nie,Die,$ie,kie,Lie];function Bk(t){const e={};return Fie.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r(t,...s)}}),e}function Vie(t){const e=t.getShortcutManager().addContext(jne),n=Bk(t),i={group:Cl};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(SM),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function Wie(t){const e=t.getShortcutManager().addContext(SM),n=Bk(t),i={runOnlyIf:()=>{const{navigableHeaders:o}=t.getSettings();return te(t.getSelected())&&(o||!o&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Rf};e.addShortcuts([{keys:[["F2"]],callback:o=>n.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>n.editorOpen(o,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Cl,runOnlyIf:()=>te(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var o;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var o,s;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())&&((s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>n.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>n.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i);const r=n.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Rf,group:Bw,position:"before",callback:o=>r.before(o)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Rf,group:Bw,callback:o=>r.after(o),position:"after"}])}function Bie(t){[Wie,Vie].forEach(e=>e(t))}function jie(t){var e;const n=Bne(t),i={wrapped:!1,flipped:!1};let r,o=!0,s=!1;t.addHook("afterSelection",()=>{if(o){var u;r=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{i.wrapped=!0,i.flipped=h}),t.addHook("beforeEmptyDataStateShow",()=>{s=!0}),t.addHook("beforeEmptyDataStateHide",()=>{s=!1}),t.getShortcutManager().getContext(SM).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Rf,group:Bw,position:"before",callback(){const{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(o=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Rf,group:Bw,callback(u){const{tabNavigation:c,autoWrapRow:h}=t.getSettings();o=!0,(!c||!t.selection.isSelected()||h&&i.wrapped&&i.flipped||!h&&i.wrapped)&&(h&&i.wrapped&&i.flipped&&(r=u.shiftKey?nE(t):iE(t)),i.wrapped=!1,i.flipped=!1)},position:"after"}]);const l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:u=>l===u||l.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{const{navigableHeaders:u}=t.getSettings();return(s||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var c;const d=(c=n(r))!==null&&c!==void 0?c:nE(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_above",d)!==!1&&t.selectCell(d.row,d.col)}else if(u==="tab_from_below"){var h;const d=(h=n(r))!==null&&h!==void 0?h:iE(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_below",d)!==!1&&t.selectCell(d.row,d.col)}}})}function Uie(t){[jie].forEach(e=>e(t))}const $O=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),xm=t=>t.map(e=>{const n=e.toLowerCase();return $O.has(n)?$O.get(n):n}).sort().join("+"),zie=t=>t.split("+"),kO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),ib=t=>{let{which:e,key:n}=t;if(kO.has(e))return kO.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},jk=Symbol("shortcut-context");function rE(t){return me(t)&&t.__kindOf===jk}const Yie=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=Ig({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:v=!1,relativeToGroup:b,position:T,forwardToContext:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Tt(h))throw new Error("You need to define the shortcut's group.");if(nt(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(et`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const D={callback:c,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:v};te(b)&&(D.relativeToGroup=b,D.position=T),rE(_)&&(D.forwardToContext=_),u.forEach(P=>{const W=xm(P);if(n.hasItem(W)){const $=n.getItem(W);let G=$.findIndex(J=>J.group===b);G!==-1?T==="before"?G-=1:G+=1:G=$.length,$.splice(G,0,D)}else n.addItem(W,[D])})},r=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Fe(c,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=c[f])}),i(h)})},o=u=>{const c=xm(u);n.removeItem(c)};return{__kindOf:jk,scope:e,addShortcut:i,addShortcuts:r,getShortcuts:u=>{const c=xm(u),h=n.getItem(c);return te(h)?h.slice():[]},hasShortcut:u=>{const c=xm(u);return n.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{n.getItems().forEach(h=>{let[d,f]=h;const m=f.filter(v=>v.group!==u);m.length===0?o(zie(d)):(f.length=0,f.push(...m))})}}};function Gie(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Kie=["meta","alt","shift","control"],yd=Gie(),bd=[];let Hm=0;function Xie(t,e,n,i,r){const o=f=>Kie.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),m&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ya(f))return;const v=ib(f);let b=[];o(v)||(b=s(f));const T=[v].concat(b);!r(f,T)&&(Iw()&&b.includes("meta")||!Iw()&&b.includes("control"))&&r(f,[v].concat(s(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const m=ib(f);o(m)&&yd.press(m)}},u=f=>{if(typeof f.key=="string"){const m=ib(f);o(m)&&yd.release(m)}},c=()=>{yd.releaseAll()};return{mount:()=>{let f=t;for(Hm+=1;f;)Hm===1&&(f.document.documentElement.addEventListener("keydown",l),bd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),bd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=ta(f)},unmount:()=>{let f=t;for(Hm-=1;f;){if(Hm===0){for(let m=0;m<bd.length;m++){const{event:v,listener:b}=bd[m];f.document.documentElement.removeEventListener(v,b)}bd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=ta(f)}},isPressed:f=>yd.isPressed(f),releasePressedKeys:()=>yd.releaseAll()}}const qie=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=Ig({errorIdExists:b=>`The "${b}" context name is already registered.`});let s="grid";const a=function(b){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const _=Yie(b,T);return o.addItem(b,_),_},l=()=>s,u=b=>o.getItem(b),c=function(b){var T;let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(T=u(b))!==null&&T!==void 0?T:a(b,_)},h=b=>{if(!o.hasItem(b))throw new Error(et`You've tried to activate the "${b}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=b};let d=!1;const f=function(b,T){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const D=rE(_)?_:u(_);let P=!1;if(!D.hasShortcut(T))return P;const W=D.getShortcuts(T);for(let k=0;k<W.length;k++){const{callback:$,runOnlyIf:G,preventDefault:J,stopPropagation:U,captureCtrl:oe,forwardToContext:B}=W[k];if(G(b)===!0){if(d=oe,P=$(b,T)===!1,d=!1,J&&b.preventDefault(),U&&(gr(b),b.stopPropagation()),P)break;B&&f(b,T,B)}}return P},v=Xie(e,b=>{const T=l(),_=rE(T)?T:u(T);return n(b,_.scope)},i,r,f);return v.mount(),{addContext:a,getActiveContextName:l,getContext:u,getOrCreateContext:c,setActiveContextName:h,isCtrlPressed:()=>!d&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};function LO(t){const{classNames:e}=C$(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function Zie(t,e){Uk(t,e),e.add(t)}function Ps(t,e,n){Uk(t,e),e.set(t,n)}function Uk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e){return t.get(uo(t,e))}function Li(t,e,n){return t.set(uo(t,e),n),n}function uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FO=23;var rb=new WeakMap,Ao=new WeakMap,jw=new WeakMap,RM=new WeakMap,oE=new WeakMap,Fa=new WeakMap,lf=new WeakMap,Jf=new WeakMap,Sd=new WeakMap,Go=new WeakSet;class Jie{constructor(e){let{hot:n,rootElement:i,rootDocument:r,onThemeChange:o=()=>{}}=e;Zie(this,Go),Ps(this,rb,void 0),Ps(this,Ao,void 0),Ps(this,jw,void 0),Ps(this,RM,void 0),Ps(this,oE,void 0),Ps(this,Fa,!0),Ps(this,lf,{}),Ps(this,Jf,{}),Ps(this,Sd,void 0),Li(rb,this,n),Li(jw,this,i),Li(oE,this,r),Li(Sd,this,o)}isClassicTheme(){return Wt(Fa,this)}getCSSVariableValue(e){var n;if(Wt(Fa,this))return null;if(Wt(lf,this)[`--ht-${e}`])return Wt(lf,this)[`--ht-${e}`];const i=(n=uo(Go,this,tre).call(this,`--ht-${e}`))!==null&&n!==void 0?n:uo(Go,this,zk).call(this,`--ht-${e}`);if(i!==null)return Wt(lf,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Wt(Jf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(e){if(Wt(Fa,this))return FO;const n=uo(Go,this,Qie).call(this);return n?e!==void 0&&e===Wt(rb,this).view.getFirstRenderedVisibleRow()?n+1:n:FO}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Li(Ao,this,void 0),Li(Fa,this,!0),Wt(Sd,this).call(this,Wt(Ao,this)),uo(Go,this,ob).call(this);return}if(e&&e!==Wt(Ao,this)){if(!/ht-theme-.*/.test(e)){Le(`Invalid theme name: ${e}. Please provide a valid theme name.`),Li(Ao,this,void 0),Li(Fa,this,!1),Wt(Sd,this).call(this,Wt(Ao,this)),uo(Go,this,ob).call(this);return}Wt(Ao,this)&&uo(Go,this,nre).call(this),Li(Ao,this,e),Li(Fa,this,!1),Wt(Sd,this).call(this,Wt(Ao,this)),uo(Go,this,ob).call(this)}}getThemeName(){return Wt(Ao,this)}}function Qie(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function ob(){this.isClassicTheme()||Li(RM,this,getComputedStyle(Wt(jw,this)));const t=uo(Go,this,ere).call(this,["box-sizing","border-bottom-width"]);Wt(Jf,this).td={...Wt(Jf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function ere(t){const e=Wt(oE,this),n=Wt(jw,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),r.appendChild(o),r.appendChild(s),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(i),u}function tre(t){const e=Math.ceil(parseFloat(uo(Go,this,zk).call(this,t)));return Number.isNaN(e)?null:e}function zk(t){const e=Wt(RM,this).getPropertyValue(t);return e===""?null:e}function nre(){Li(Jf,this,{}),Li(lf,this,{}),Li(Fa,this,!0)}let cr=null,tw=0;function ire(t){const e=t.ownerDocument;if(!cr){cr=e.createElement("div"),cr.setAttribute("role","status"),cr.setAttribute("aria-live","assertive"),cr.setAttribute("aria-atomic","true");const n=cr.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(cr)}tw+=1}function rre(){tw!==0&&(tw===1&&(cr.remove(),cr=null),tw-=1)}function ore(t){cr&&(cr.textContent="",setTimeout(()=>{cr&&(cr.textContent=t)},100))}let sb=null;const Nm=new WeakSet,ab=new Map;function Yk(t,e){var n,i,r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Vr(s);let l,u,c,h,d,f,m=!0;const v={...e.initialState,...e};XQ(o)&&KQ(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Uo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Uo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),j(this.rootElement,["ht-wrapper","handsontable"]),j(this.rootWrapperElement,"ht-root-wrapper"),j(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),j(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(n=v==null?void 0:v.layoutDirection)!==null&&n!==void 0?n:"inherit",T=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(i=this.rootWrapperElement)===null||i===void 0||i.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new Jie({hot:s,rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:g=>{Uo(this)&&(ae(this.rootWrapperElement,/ht-theme-.*/g),ae(this.rootPortalElement,/ht-theme-.*/g),g&&(j(this.rootWrapperElement,g),j(this.rootPortalElement,g),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Le(`The "${g}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=ste(v.language);const _=Object.fromEntries(Object.entries(v).filter(g=>{let[w]=g;return!(re.getSingleton().isRegistered(w)||re.getSingleton().isDeprecated(w))})),D=new Lk(s,_,[dne,Cne]),P=D.getTableMeta(),W=D.getGlobalMeta(),k=Ig();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${$0()}`,ab.set(this.guid,this),this.columnIndexMapper=new ZR,this.rowIndexMapper=new ZR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{s.runHooks("beforeCompositionStart",g)}),u=new wee(s);const $=Ur(this.guid);$.register("cellRangeMapper",new bne({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const G=g=>{const{row:w,col:y}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,y>=0?s.columnIndexMapper.getRenderableFromVisualIndex(y):y)},J=g=>{const{row:w,col:y}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,y>=0?s.columnIndexMapper.getVisualFromRenderableIndex(y):y)},U=(g,w)=>{const y=w>g?1:-1,A=Math.min(g,w),L=Math.max(g,w),p=s.rowIndexMapper.getNearestNotHiddenIndex(g,y);return p===null||y===1&&p>L||y===-1&&p<A?null:p>=0?s.rowIndexMapper.getRenderableFromVisualIndex(p):p},oe=(g,w)=>{const y=w>g?1:-1,A=Math.min(g,w),L=Math.max(g,w),p=s.columnIndexMapper.getNearestNotHiddenIndex(g,y);return p===null||y===1&&p>L||y===-1&&p<A?null:p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p};let B=new Dk(P,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,y)=>s._createCellRange(g,w,y),visualToRenderableCoords:G,renderableToVisualCoords:J,findFirstNonHiddenRenderableRow:U,findFirstNonHiddenRenderableColumn:oe,isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=B;const z=g=>{let{hiddenIndexesChanged:w}=g;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",g=>{z(g),this.runHooks("afterColumnSequenceCacheUpdate",g)}),this.rowIndexMapper.addLocalHook("cacheUpdated",g=>{z(g),this.runHooks("afterRowSequenceCacheUpdate",g)}),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const y=Ui(!1),A=this.selection.getSelectedRange(),{from:L,to:p}=A.current(),C=A.size()-1;this.runHooks("afterSelection",L.row,L.col,p.row,p.col,y,C),this.runHooks("afterSelectionByProp",L.row,s.colToProp(L.col),p.row,s.colToProp(p.col),y,C),w&&(!y.isTouched()||y.isTouched()&&!y.value)&&f.scrollTo(g);const S=B.isSelectedByRowHeader(),O=B.isSelectedByColumnHeader();S&&O?j(this.rootElement,["ht__selection--rows","ht__selection--columns"]):S?(ae(this.rootElement,"ht__selection--columns"),j(this.rootElement,"ht__selection--rows")):O?(ae(this.rootElement,"ht__selection--rows"),j(this.rootElement,"ht__selection--columns")):ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(B.getSelectionSource())||h.closeEditor(null),B.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=Ui(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&f.scrollTo(g),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:y,to:A}=g[w];this.runHooks("afterSelectionEnd",y.row,y.col,A.row,A.col,w),this.runHooks("afterSelectionEndByProp",y.row,s.colToProp(y.col),A.row,s.colToProp(A.col),w),B.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeSelectAll",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectAll",...w)}).addLocalHook("afterSelectAll",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectAll",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;const p=C=>{if(C.length===0)return[];const S=[...C];return S.sort((E,R)=>{let[N]=E,[M]=R;return N===M?0:N>M?1:-1}),Sn(S,(E,R)=>{let[N,M]=R;const x=E[E.length-1],[V,F]=x,Y=V+F;if(N<=Y){const se=Math.max(M-(Y-N),0);x[1]+=se}else E.push([N,M]);return E},[S[0]])};switch(g){case"insert_row_below":case"insert_row_above":const C=s.countSourceRows();if(P.maxRows===C)return;const S=g==="insert_row_below"?"below":"above";w=w??(S==="below"?C:0);const{delta:O,startPhysicalIndex:E}=l.createRow(w,y,{source:A,mode:S});B.shiftRows(s.toVisualRow(E),O);break;case"insert_col_start":case"insert_col_end":const R=g==="insert_col_end"?"end":"start";w=w??(R==="end"?s.countSourceCols():0);const{delta:N,startPhysicalIndex:M}=l.createCol(w,y,{source:A,mode:R});if(N){if(Array.isArray(P.colHeaders)){const F=[s.toVisualColumn(M),0];F.length+=N,Array.prototype.splice.apply(P.colHeaders,F)}B.shiftColumns(s.toVisualColumn(M),N)}break;case"remove_row":const x=F=>{let Y=0;I(F,se=>{let[Q,be]=se;const Ue=Gt(Q)?s.countRows()-1:Math.max(Q-Y,0);if(Number.isInteger(Q)&&(Q=Math.max(Q-Y,0)),!l.removeRow(Q,be,A))return;if(B.isSelected()){const{row:Xt}=s.getSelectedRangeActive().highlight;Xt>=Q&&Xt<=Q+be-1&&h.closeEditor(!0)}const _e=s.countRows(),Ge=P.fixedRowsTop;Ge>=Ue+1&&(P.fixedRowsTop-=Math.min(be,Ge-Ue));const it=P.fixedRowsBottom;if(it&&Ue>=_e-it&&(P.fixedRowsBottom-=Math.min(be,it)),_e===0)B.deselect();else if(A==="ContextMenu.removeRow"){const Xt=B.getSelectedRange(),Wn=Xt.pop();Xt.clear().set(Wn.from).current().setTo(Wn.to),B.refresh()}else B.shiftRows(Q,-be);Y+=be})};Array.isArray(w)?x(p(w)):x([[w,y]]);break;case"remove_col":const V=F=>{let Y=0;I(F,se=>{let[Q,be]=se;const Ue=Gt(Q)?s.countCols()-1:Math.max(Q-Y,0);let Je=s.toPhysicalColumn(Ue);if(Number.isInteger(Q)&&(Q=Math.max(Q-Y,0)),!l.removeCol(Q,be,A))return;if(B.isSelected()){const{col:Xt}=s.getSelectedRangeActive().highlight;Xt>=Q&&Xt<=Q+be-1&&h.closeEditor(!0)}if(s.countCols()===0)B.deselect();else if(A==="ContextMenu.removeColumn"){const Xt=B.getSelectedRange(),Wn=Xt.pop();Xt.clear().set(Wn.from).current().setTo(Wn.to),B.refresh()}else B.shiftColumns(Q,-be);const it=P.fixedColumnsStart;it>=Ue+1&&(P.fixedColumnsStart-=Math.min(be,it-Ue)),Array.isArray(P.colHeaders)&&(typeof Je>"u"&&(Je=-1),P.colHeaders.splice(Je,be)),Y+=be})};Array.isArray(w)?V(p(w)):V([[w,y]]);break;default:throw new Error(`There is no such action "${g}"`)}L||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const g=P.minRows,w=P.minSpareRows,y=P.minCols,A=P.minSpareCols;if(g){const L=s.countRows();L<g&&l.createRow(L,g-L,{source:"auto"})}if(w){const L=s.countEmptyRows(!0);if(L<w){const p=w-L,C=Math.min(p,P.maxRows-s.countSourceRows());l.createRow(s.countRows(),C,{source:"auto"})}}{let L;(y||A)&&(L=s.countEmptyCols(!0));let p=s.countCols();if(y&&!P.columns&&p<y){const C=y-p;L+=C,l.createCol(p,C,{source:"auto"})}if(A&&!P.columns&&s.dataType==="array"&&L<A){p=s.countCols();const C=A-L,S=Math.min(C,P.maxCols-p);l.createCol(p,S,{source:"auto"})}}},populateFromArray(g,w,y,A,L){let p,C,S,O;const E=[],R={},N=[],M=g.row,x=g.col;if(C=w.length,C===0)return!1;let V=0,F=0;switch(me(y)&&(V=y.col-x+1,F=y.row-M+1),L){case"shift_down":const se=mf(w),Q=se.length,be=Math.max(Q,V),Ue=s.getData().slice(M),Je=mf(Ue).slice(x,x+be);for(S=0;S<be;S+=1)if(S<Q){for(p=0,C=se[S].length;p<F-C;p+=1)se[S].push(se[S][p%C]);S<Je.length?N.push(se[S].concat(Je[S])):N.push(se[S].concat(new Array(Ue.length).fill(null)))}else N.push(se[S%Q].concat(Je[S]));s.populateFromArray(M,x,mf(N));break;case"shift_right":const _e=w.length,Ge=Math.max(_e,F),it=s.getData().slice(M).map(qe=>qe.slice(x));for(p=0;p<Ge;p+=1)if(p<_e){for(S=0,O=w[p].length;S<V-O;S+=1)w[p].push(w[p][S%O]);if(p<it.length)for(let qe=0;qe<it[p].length;qe+=1)w[p].push(it[p][qe]);else w[p].push(...new Array(it[0].length).fill(null))}else w.push(w[p%C].slice(0,Ge).concat(it[p]));s.populateFromArray(M,x,w);break;case"overwrite":default:R.row=g.row,R.col=g.col;let Xt=0,Wn=0,vr=!0,qt;const Gi=function(ha){let da=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ro=w[ha%w.length];return da!==null?Ro[da%Ro.length]:Ro},_t=w.length,Rt=y?y.row-g.row+1:0;for(y?C=Rt:C=Math.max(_t,Rt),p=0;p<C&&!(y&&R.row>y.row&&Rt>_t||!P.allowInsertRow&&R.row>s.countRows()-1||R.row>=P.maxRows);p++){const qe=p-Xt,ha=Gi(qe).length,da=y?y.col-g.col+1:0;if(y?O=da:O=Math.max(ha,da),R.col=g.col,qt=s.getCellMeta(R.row,R.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&qt.skipRowOnPaste){Xt+=1,R.row+=1,C+=1;continue}for(Wn=0,S=0;S<O;S++){var Y;if(y&&R.col>y.col&&da>ha||!P.allowInsertColumn&&R.col>s.countCols()-1||R.col>=P.maxCols)break;if(qt=s.getCellMeta(R.row,R.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&qt.skipColumnOnPaste){Wn+=1,R.col+=1,O+=1;continue}if(qt.readOnly&&A!=="UndoRedo.undo"){R.col+=1;continue}const Ro=S-Wn,fa=!!qt.valueSetter;let Cr=Gi(qe,Ro),Bn=(Y=s.getSourceDataAtCell(R.row,R.col))!==null&&Y!==void 0?Y:null;if(Cr!==null&&typeof Cr=="object"){if(Array.isArray(Cr)&&Bn===null&&(Bn=[]),!fa&&(typeof Bn!="object"||Bn===null))vr=!1;else if(Bn!==null){const Ug=Th(Array.isArray(Bn)?Bn:Bn[0]||Bn),zg=Th(Array.isArray(Cr)?Cr:Cr[0]||Cr);fa||Eg(Ug,zg)||Array.isArray(Ug)&&Array.isArray(zg)?Cr=ui(Cr):vr=!1}}else!fa&&Bn!==null&&typeof Bn=="object"&&(vr=!1);vr&&E.push([R.row,R.col,Cr]),vr=!0,R.col+=1}R.row+=1}s.setDataAtCell(E,null,null,A||"populateFromArray");break}}};function ee(g){const w=bk(g);pM(w)?(s.runHooks("beforeLanguageChange",w),W.language=w,s.runHooks("afterLanguageChange",w)):Sk(g)}function pe(g,w){const y=g==="className"?s.rootElement:s.table;if(m)j(y,w);else{let A=[],L=[];W[g]&&(A=Array.isArray(W[g])?W[g]:xR(W[g])),w&&(L=Array.isArray(w)?w:xR(w));const p=OR(A,L),C=OR(L,A);p.length&&ae(y,p),C.length&&j(y,C)}W[g]=w}this.init=function(){u.setData(P.data),s.runHooks("beforeInit"),(mo()||qv())&&j(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new QQ(this),h=WR.getInstance(s,P,B),f=Ine(s),d.init(),Uo(this)&&(ire(s.rootPortalElement),KD(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),m&&s.rootElement.offsetParent===null&&I$(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof m=="object"&&(s.runHooks("afterChange",m[0],m[1]),m=!1),s.runHooks("afterInit")};function gt(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function Re(g,w,y){if(!g.length){y();return}const A=s.getActiveEditor(),L=new gt;let p=!0;L.onQueueEmpty=()=>{A&&p&&A.cancelChanges(),y()};for(let C=g.length-1;C>=0;C--){const[S,O,,E]=g[C],R=l.propToCol(O);let N;Number.isInteger(R)?N=s.getCellMeta(S,R):N={...Object.getPrototypeOf(P),...P},s.getCellValidator(N)&&(L.addValidatorToQueue(),s.validateCell(E,N,function(M,x){return function(V){if(typeof V!="boolean")throw new Error("Validation error: result is not boolean");V===!1&&x.allowInvalid===!1&&(p=!1,g.splice(M,1),x.valid=!0),L.removeValidatorFormQueue()}}(C,N),w))}L.checkIfQueueIsEmpty()}function Te(g,w){for(let A=g.length-1;A>=0;A--){let L=!1;if(g[A]===null){g.splice(A,1);continue}if(!((g[A][2]===null||g[A][2]===void 0)&&(g[A][3]===null||g[A][3]===void 0))){if(P.allowInsertRow)for(;g[A][0]>s.countRows()-1;){const{delta:p}=l.createRow(void 0,void 0,{source:"auto"});if(p===0){L=!0;break}}if(s.dataType==="array"&&(!P.columns||P.columns.length===0)&&P.allowInsertColumn)for(;l.propToCol(g[A][1])>s.countCols()-1;){const{delta:p}=l.createCol(void 0,void 0,{source:"auto"});if(p===0){L=!0;break}}L||l.set(g[A][0],g[A][1],g[A][3])}}if(g.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",g,w||"edit");const A=s.getActiveEditor();A&&te(A.refreshValue)&&A.refreshValue()}else s.render()}this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,y){return s.view._wt.createCellRange(g,w,y)},this.validateCell=function(g,w,y,A){let L=s.getCellValidator(w);function p(C){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){y(C);return}const O=w.visualCol,E=w.visualRow,R=s.getCell(E,O,!0);if(R&&R.nodeName!=="TH"){const N=s.rowIndexMapper.getRenderableFromVisualIndex(E),M=s.columnIndexMapper.getRenderableFromVisualIndex(O);s.view._wt.getSetting("cellRenderer",N,M,R)}y(C)}GD(L)&&(L=function(C){return function(S,O){O(C.test(S))}}(L)),nt(L)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,A),s._registerImmediate(()=>{L.call(w,g,C=>{s&&(C=s.runHooks("afterValidate",C,g,w.visualRow,w.prop,A),w.valid=C,p(C),s.runHooks("postAfterValidate",C,g,w.visualRow,w.prop,A))})})):s._registerImmediate(()=>{w.valid=!0,p(w.valid,!1)})};function Ie(g,w,y){return Array.isArray(g)?g:[[g,w,y]]}function Ee(g,w){const y=s.runHooks("beforeChange",g,w||"edit"),A=g.filter(p=>p!==null);if(y===!1||A.length===0){var L;return(L=s.getActiveEditor())===null||L===void 0||L.cancelChanges(),[]}for(let p=A.length-1;p>=0;p--){const[C,S,,O]=A[p],E=l.propToCol(S);let R;Number.isInteger(E)?R=s.getCellMeta(C,E):R={...Object.getPrototypeOf(P),...P},A[p][3]=tb(O,R)}return A}this.setDataAtCell=function(g,w,y,A){const L=Ie(g,w,y),p=[];let C=A,S,O,E;for(S=0,O=L.length;S<O;S++){const[N,M,x]=L[S];if(typeof L[S]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M>=this.countCols()?E=M:E=l.colToProp(M),p.push([N,E,u.getAtCell(this.toPhysicalRow(N),M),x])}!C&&typeof g=="object"&&(C=w);const R=Ee(p,C);s.runHooks("afterSetDataAtCell",R,C),Re(R,C,()=>{Te(R,C)})},this.setDataAtRowProp=function(g,w,y,A){const L=Ie(g,w,y),p=[];let C=A,S,O;for(S=0,O=L.length;S<O;S++){const[R,N,M]=L[S];p.push([R,N,u.getAtCell(this.toPhysicalRow(R),N),M])}!C&&typeof g=="object"&&(C=w);const E=Ee(p,A);s.runHooks("afterSetDataAtRowProp",E,C),Re(E,C,()=>{Te(E,C)})},this.listen=function(){s&&!s.isListening()&&(ab.forEach(g=>{s!==g&&g.unlisten()}),sb=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(sb=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return sb===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(g),s.view.render(),w&&B.isSelected()&&h.prepareEditor()},this.populateFromArray=function(g,w,y,A,L,p,C){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const S=typeof A=="number"?s._createCellCoords(A,L):null;return c.populateFromArray(s._createCellCoords(g,w),y,S,p,C)},this.spliceCol=function(g,w,y){for(var A=arguments.length,L=new Array(A>3?A-3:0),p=3;p<A;p++)L[p-3]=arguments[p];return l.spliceCol(g,w,y,...L)},this.spliceRow=function(g,w,y){for(var A=arguments.length,L=new Array(A>3?A-3:0),p=3;p<A;p++)L[p-3]=arguments[p];return l.spliceRow(g,w,y,...L)},this.getSelected=function(){if(B.isSelected())return Qe(B.getSelectedRange(),g=>{let{from:w,to:y}=g;return[w.row,w.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedActive=function(){const g=this.getSelectedRangeActive();if(!g)return;const{from:w,to:y}=g;return[w.row,w.col,y.row,y.col]},this.getSelectedRange=function(){if(B.isSelected())return Array.from(B.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRangeActive=function(){return B.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return B.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(g){if(!B.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];I(B.getSelectedRange(),y=>{if(y.isSingleHeader())return;const A=y.getTopStartCorner(),L=y.getBottomEndCorner();he(A.row,L.row,p=>{he(A.col,L.col,C=>{this.getCellMeta(p,C).readOnly||w.push([p,C,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(w),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const g=s.view,{width:w,height:y}=g.getLastSize(),{width:A,height:L}=s.rootElement.getBoundingClientRect(),p=A!==w||L!==y;s.runHooks("beforeRefreshDimensions",{width:w,height:y},{width:A,height:L},p)!==!1&&((p||g._wt.wtOverlays.scrollableElement===s.rootWindow)&&(g.setLastSize(A,L),g.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:y},{width:A,height:L},p))},this.updateData=function(g,w){_O(g,y=>{l=y},y=>{l=y,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),B.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:w,metaManager:D,firstRun:m})},this.loadData=function(g,w){_O(g,y=>{l=y},()=>{D.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),B.refresh(),m&&(m=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:w,metaManager:D,firstRun:m})},this.getInitialColumnCount=function(){const g=P.columns;let w=0;if(Array.isArray(g))w=g.length;else if(nt(g))if(s.dataType==="array"){const y=this.countSourceCols();for(let A=0;A<y;A+=1)g(A)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=l.colToPropCache.length);else if(te(P.dataSchema)){const y=l.getSchema();w=Array.isArray(y)?y.length:Xv(y)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,y,A){return Tt(g)?l.getAll():l.getRange(s._createCellCoords(g,w),s._createCellCoords(y,A),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,y,A){return l.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(y,A))},this.getCopyableData=function(g,w){return l.getCopyable(g,l.colToProp(w))},this.getCopyableSourceData=function(g,w){return u.getCopyable(g,l.colToProp(w))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(m?s.loadData:s.updateData).bind(this);let A=!1,L,p;if(te(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(te(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(te(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');te(g.rowHeights)&&te(g.minRowHeights)&&Le("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(L in g)if(!(L==="data"||L==="language"))if(L==="className")pe("className",g.className);else if(L==="tableClassName"&&s.table)pe("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(re.getSingleton().isRegistered(L)||re.getSingleton().isDeprecated(L)){const R=g[L];nt(R)?(re.getSingleton().addAsFixed(L,R,s),P[L]=R):Array.isArray(R)&&(re.getSingleton().add(L,R,s),P[L]=R)}else!w&&zt(g,L)&&(W[L]=g[L]);if(w)s.useTheme(P.themeName||LO(s.rootContainer));else{const R=s.getCurrentThemeName();zt(g,"themeName")&&R!==g.themeName&&s.useTheme(g.themeName)}Nm.has(s)&&s.stylesHandler.getThemeName()!==void 0&&Nm.delete(s),Uo(s)&&!Nm.has(s)&&s.stylesHandler.isClassicTheme()&&(k$("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),Nm.add(s)),g.data===void 0&&P.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!m&&g.language&&ee(g.language);const C=s.countCols(),S=P.columns;if(S&&nt(S)&&(A=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&D.clearCache(),C>0)for(L=0,p=0;L<C;L++){if(S){const R=A?S(L):S[p];R&&D.updateColumnMeta(p,R)}p+=1}te(g.cell)&&Fe(g.cell,R=>{s.setCellMetaObject(R.row,R.col,R)}),s.runHooks("afterCellMetaReset");let O=s.rootElement.style.height;O!==""&&(O=parseInt(s.rootElement.style.height,10)),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let E=g.height;if(typeof g.height<"u")if(nt(E)&&(E=E()),E=s.runHooks("beforeHeightChange",E),E===null){const R=s.rootElement.getAttribute("data-initialstyle");R&&(R.indexOf("height")>-1||R.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",R):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else E!==void 0&&(s.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let R=g.width;nt(R)&&(R=R()),R=s.runHooks("beforeWidthChange",R),s.rootElement.style.width=isNaN(R)?`${R}`:`${R}px`}w||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!m&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(O===""||E===""||E===void 0)&&O!==E&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedRangeActive();if(P.getValue){if(nt(P.getValue))return P.getValue.call(s);if(g)return s.getData()[g.highlight.row][P.getValue]}else if(g)return s.getDataAtCell(g.highlight.row,g.highlight.col);return null},this.getSettings=function(){return P},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,y,A,L){c.alter(g,w,y,A,L)},this.getCell=function(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=w,L=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;L=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return L===null||A===null||L===void 0||A===void 0?null:s.view.getCellAtCoords(s._createCellCoords(L,A),y)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:y,col:A}=w;let L=y,p=A;return y>=0&&(L=this.rowIndexMapper.getVisualFromRenderableIndex(y)),A>=0&&(p=this.columnIndexMapper.getVisualFromRenderableIndex(A)),s._createCellCoords(L,p)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return l.get(g,l.colToProp(w))},this.getDataAtRowProp=function(g,w){return l.get(g,w)},this.getDataAtCol=function(g){const w=[],y=l.getRange(s._createCellCoords(0,g),s._createCellCoords(P.data.length-1,g),l.DESTINATION_RENDERER);for(let A=0;A<y.length;A+=1)for(let L=0;L<y[A].length;L+=1)w.push(y[A][L]);return w},this.getDataAtProp=function(g){const w=[],y=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(P.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let A=0;A<y.length;A+=1)for(let L=0;L<y[A].length;L+=1)w.push(y[A][L]);return w},this.getSourceData=function(g,w,y,A){let L;return g===void 0?L=u.getData():L=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(y,A)),L},this.getSourceDataArray=function(g,w,y,A){let L;return g===void 0?L=u.getData(!0):L=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(y,A),!0),L},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,y,A){const L=Ie(g,w,y),p=this.hasHook("afterSetSourceDataAtCell"),C=[],S=(E,R)=>{const N=this.toVisualRow(E),M=this.toVisualColumn(R);return Number.isInteger(M)?this.getCellMeta(N,M):{...Object.getPrototypeOf(P),...P}};p&&I(L,E=>{let[R,N,M]=E;const x=tb(M,S(R,N));C.push([R,N,u.getAtCell(R,N),x])}),I(L,E=>{let[R,N,M]=E;const x=tb(M,S(R,N));u.setAtCell(R,N,x)}),p&&this.runHooks("afterSetSourceDataAtCell",C,A),this.render();const O=s.getActiveEditor();O&&te(O.refreshValue)&&O.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return u.getAtCell(g,w)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,y,A){const L=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,y,A],[p,C]=L;let[,,S,O]=L,E=null,R=null;S===void 0&&(S=p),O===void 0&&(O=C);let N="mixed";return he(Math.max(Math.min(p,S),0),Math.max(p,S),M=>{let x=!0;return he(Math.max(Math.min(C,O),0),Math.max(C,O),V=>(R=this.getCellMeta(M,V).type,E?x=E===R:E=R,x)),N=x?R:"mixed",x}),N},this.removeCellMeta=function(g,w,y){const[A,L]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let p=D.getCellMetaKeyValue(A,L,y);s.runHooks("beforeRemoveCellMeta",g,w,y,p)!==!1&&(D.removeCellMeta(A,L,y),s.runHooks("afterRemoveCellMeta",g,w,y,p)),p=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,A=new Array(y>2?y-2:0),L=2;L<y;L++)A[L-2]=arguments[L];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&D.removeRow(this.toPhysicalRow(g),w),A.length>0&&I(A.reverse(),p=>{D.createRow(this.toPhysicalRow(g)),I(p,(C,S)=>this.setCellMetaObject(g,S,C))}),s.render()},this.setCellMetaObject=function(g,w,y){typeof y=="object"&&Fe(y,(A,L)=>{this.setCellMeta(g,w,L,A)})},this.setCellMeta=function(g,w,y,A){if(s.runHooks("beforeSetCellMeta",g,w,y,A)===!1)return;let p=g,C=w;g<this.countRows()&&(p=this.toPhysicalRow(g)),w<this.countCols()&&(C=this.toPhysicalColumn(w)),D.setCellMeta(p,C,y,A),s.runHooks("afterSetCellMeta",g,w,y,A)},this.getCellsMeta=function(){return D.getCellsMeta()},this.getCellMeta=function(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(g),L=this.toPhysicalColumn(w);return A===null&&(A=g),L===null&&(L=w),D.getCellMeta(A,L,{visualRow:g,visualColumn:w,...y})},this.getColumnMeta=function(g){return D.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return D.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||P.columns)},this.getCellRenderer=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).renderer:g.renderer;return typeof y=="string"?Hw(y):Tt(y)?Hw("text"):y},this.getCellEditor=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).editor:g.editor;return typeof y=="string"?xw(y):Tt(y)?xw("text"):y},this.getCellValidator=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).validator:g.validator;return typeof y=="string"?lT(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,y){const A=new gt;g&&(A.onQueueEmpty=g);let L=s.countRows()-1;for(;L>=0;){if(w!==void 0&&w.indexOf(L)===-1){L-=1;continue}let p=s.countCols()-1;for(;p>=0;){if(y!==void 0&&y.indexOf(p)===-1){p-=1;continue}A.addValidatorToQueue(),s.validateCell(s.getDataAtCell(L,p),s.getCellMeta(L,p),C=>{if(typeof C!="boolean")throw new Error("Validation error: result is not boolean");C===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),p-=1}L-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=P.rowHeaders,y=g;return y!==void 0&&(y=s.runHooks("modifyRowHeader",y)),y===void 0?(w=[],he(s.countRows()-1,A=>{w.push(s.getRowHeader(A))})):Array.isArray(w)&&w[y]!==void 0?w=w[y]:nt(w)?w=w(y):w&&typeof w!="string"&&typeof w!="number"&&(w=y+1),w},this.hasRowHeaders=function(){return!!P.rowHeaders},this.hasColHeaders=function(){if(P.colHeaders!==void 0&&P.colHeaders!==null)return!!P.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=s.runHooks("modifyColHeader",g);if(y===void 0){const S=[],O=s.countCols();for(let E=0;E<O;E++)S.push(s.getColHeader(E));return S}let A=P.colHeaders;const L=function(S){const O=[],E=s.countCols();let R=0;for(;R<E;R++)nt(P.columns)&&P.columns(R)&&O.push(R);return O[S]},p=s.toPhysicalColumn(y),C=L(p);return P.colHeaders===!1?A=null:P.columns&&nt(P.columns)&&P.columns(C)&&P.columns(C).title?A=P.columns(C).title:P.columns&&P.columns[p]&&P.columns[p].title?A=P.columns[p].title:Array.isArray(P.colHeaders)&&P.colHeaders[p]!==void 0?A=P.colHeaders[p]:nt(P.colHeaders)?A=P.colHeaders(p):P.colHeaders&&typeof P.colHeaders!="string"&&typeof P.colHeaders!="number"&&(A=oC(y)),A=s.runHooks("modifyColumnHeaderValue",A,g,w),A},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(w===void 0||w===P.width)&&(w=P.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=Number.parseInt(w,10))}return w},this.getColWidth=function(g,w){let y=s._getColWidthFromSettings(g);return y=s.runHooks("modifyColWidth",y,g,w),y===void 0&&(y=Mh),y},this._getRowHeightFromSettings=function(g){var w;const y=s.stylesHandler.getDefaultRowHeight(g);let A=(w=P.rowHeights)!==null&&w!==void 0?w:P.minRowHeights;if(A!=null){switch(typeof A){case"object":A=A[g];break;case"function":A=A(g);break}typeof A=="string"&&(A=Number.parseInt(A,10))}return A!=null&&A<y?y:A},this.getRowHeight=function(g,w){let y=s._getRowHeightFromSettings(g);return y=s.runHooks("modifyRowHeight",y,g,w),y},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=P.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return zR(s.countRows()-1,y=>{if(s.isEmptyRow(y))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return zR(s.countCols()-1,y=>{if(s.isEmptyCol(y))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return P.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return P.isEmptyCol.call(s,g)},this.selectCell=function(g,w,y,A){let L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,p=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Tt(g)||Tt(w)?!1:this.selectCells([[g,w,y,A]],L,p)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&f.suspend();const A=B.selectCells(g);return A&&y&&s.listen(),f.resume(),A},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return B.selectColumns(g,w,y)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return B.selectRows(g,w,y)},this.deselectCell=function(){B.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),B.selectAll(g,w,y)};const we=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g,w){if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:A,col:L,considerHiddenIndexes:p}=g??{};let C=A,S=L;if(nt(w)&&this.addHookOnce("afterScroll",w),p===void 0||p){const N=Number.isInteger(A)&&A>=0,M=Number.isInteger(L)&&L>=0,x=N?we(this.rowIndexMapper,A):void 0,V=M?we(this.columnIndexMapper,L):void 0;if(x===null||V===null)return!1;C=N?s.rowIndexMapper.getRenderableFromVisualIndex(x):A,S=M?s.columnIndexMapper.getRenderableFromVisualIndex(V):L}const O=Number.isInteger(C),E=Number.isInteger(S);let R=!1;return O&&C>=0&&E&&S>=0?R=s.view.scrollViewport(s._createCellCoords(C,S),g.horizontalSnap,g.verticalSnap):O&&C>=0&&(E&&S<0||!E)?R=s.view.scrollViewportVertically(C,g.verticalSnap):E&&S>=0&&(O&&C<0||!O)&&(R=s.view.scrollViewportHorizontally(S,g.horizontalSnap)),nt(w)&&(R?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),R},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;nt(g)&&this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeActive(),y=this.scrollViewportTo(w.toObject());return y?this.view.render():nt(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),y},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,Uo(this)&&(rre(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),$.clear(),D.clearCache(),ab.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&cs(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),k.getItems().forEach(g=>{let[,w]=g;w.destroy()}),k.clear(),s.runHooks("afterDestroy")},!0),re.getSingleton().destroy(s),Fe(s,(g,w,y)=>{nt(g)?y[w]=Xn(w):w!=="guid"&&(y[w]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,B=null,h=null,s=null};function Xn(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return k.getItem(li(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:k.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w,y){re.getSingleton().add(g,w,s,y)},this.hasHook=function(g){return re.getSingleton().has(g,s)||re.getSingleton().has(g)},this.addHookOnce=function(g,w,y){re.getSingleton().once(g,w,s,y)},this.removeHook=function(g,w){re.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,y,A,L,p,C){return re.getSingleton().run(s,g,w,y,A,L,p,C)},this.getTranslatedPhrase=function(g,w){return Ok(P.language,g,w)},this.toHTML=()=>BR(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",BR(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const w=!!m;this.stylesHandler.useTheme(g);const y=this.stylesHandler.getThemeName();w||(s.render(),s.scrollViewportTo(0,0),LO(this.rootContainer)&&(ae(this.rootContainer,/ht-theme-.*/g),y&&j(this.rootContainer,y))),this.runHooks("afterSetTheme",y,w)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,w)),this.timeouts.push(y)},this._clearTimeouts=function(){I(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){I(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return h};const at=qie({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&at.releasePressedKeys()}),this.getShortcutManager=function(){return at},d=new kne(s);const X=Uo(this)?Dne(s):null;this.getFocusManager=function(){return d},this.getFocusScopeManager=function(){if(!Uo(s))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return X},aT().forEach(g=>{const w=Ag(g);k.addItem(g,new w(this))}),Bie(s),Uo(this)&&Uie(s),at.setActiveContextName("grid"),re.getSingleton().run(s,"construct")}function VO(t,e,n){t.addEventListener(e,n,!1)}function WO(t,e,n){t.removeEventListener(e,n,!1)}function Dm(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},i=t.body,r=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;r.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Dm(s).fontSize,o.style.fontFamily=Dm(s).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const f=parseInt(((h=Dm(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=Dm(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+m+1;i.removeChild(o);const b=s.style;b.height=`${n.minHeight}px`,n.minWidth>v?b.width=`${n.minWidth}px`:v>n.maxWidth?b.width=`${n.maxWidth}px`:b.width=`${v}px`;const T=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>T?b.height=`${n.minHeight}px`:n.maxHeight<T?(b.height=`${n.maxHeight}px`,b.overflowY="visible"):b.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(VO(s,"input",a),VO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){WO(s,"input",a),WO(s,"keydown",l)}}}function BO(t,e){const n=K0(e),i=e.value.split(`
`);let r=n,o=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(o+=i[s-1].length+1);const l=o+a.length;if(t==="home"?r=o:t==="end"&&(r=l),n<=l)break}_g(e,r)}function Al(t,e,n){return(e=sre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sre(t){var e=are(t,"string");return typeof e=="symbol"?e:e+""}function are(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lre="ht_editor_visible",$m="ht_editor_hidden",jO="textEditor",ure="text";class Ju extends Gh{static get EDITOR_TYPE(){return ure}constructor(e){super(e),Al(this,"eventManager",new Vr(this)),Al(this,"autoResize",Gk(this.hot.rootDocument)),Al(this,"TEXTAREA",void 0),Al(this,"textareaStyle",void 0),Al(this,"TEXTAREA_PARENT",void 0),Al(this,"textareaParentStyle",void 0),Al(this,"layerClass",void 0),this.eventManager=new Vr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Cf(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,s){const a=this.state;if(super.prepare(e,n,i,r,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Qt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),_g(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),le(this.TEXTAREA,[["data-hot-input",""],Co(-1)]),j(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),j(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ce(this.TEXTAREA_PARENT,this.layerClass)&&ae(this.TEXTAREA_PARENT,this.layerClass),j(this.TEXTAREA_PARENT,$m),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){p$()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ae(this.TEXTAREA_PARENT,this.layerClass),j(this.TEXTAREA_PARENT,$m)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;he(e.length-1,i=>{const r=e[i];if(Ce(r,"handsontableEditor"))return n=!0,!1}),Ce(this.TEXTAREA_PARENT,$m)&&ae(this.TEXTAREA_PARENT,$m),n?(this.layerClass=lre,j(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),j(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){j0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>te(this.hot.getSelected()),group:jO},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;BO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;BO(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(jO)}}const cre="base",hre="htTextEllipsis";function Ng(t,e,n,i,r,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&j(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(fA())):a&&c.push(fA()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(gA())):(u.push(s.invalidCellClassName),a&&c.push(gA()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(hre),ae(e,u),j(e,l),ss(e,c),le(e,h)}Ng.RENDERER_TYPE=cre;const dre="text";function ca(t,e,n,i,r,o,s){Ng.apply(this,[t,e,n,i,r,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ct(a),s.trimWhitespace&&(a=a.trim()),hl(e,a)}ca.RENDERER_TYPE=dre;const fre="text",Kk={CELL_TYPE:fre,editor:Ju,renderer:ca};_r(Kk);Pe.editors={BaseEditor:Gh};function Pe(t,e){const n=new Yk(t,e||{},ET);return n.init(),n}Pe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Yk(t,e,ET)};Pe.DefaultSettings=kk();Pe.hooks=re.getSingleton();Pe.CellCoords=Du;Pe.CellRange=jh;Pe.packageName="handsontable";Pe.buildDate="20/11/2025 13:26:54";Pe.version="16.2.0";Pe.languages={dictionaryKeys:Qee,getLanguageDictionary:Ak,getLanguagesDictionaries:rte,registerLanguageDictionary:Ik,getTranslatedPhrase:Ok};function UO(t,e,n){return(e=gre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gre(t){var e=mre(t,"string");return typeof e=="symbol"?e:e+""}function mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zO="handsontableEditor",pre="handsontable";class EM extends Ju{constructor(){super(...arguments),UO(this,"isFlippedVertically",!1),UO(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return pre}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),_g(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&hn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getDropdownHeight(),o=e.getWorkspaceHeight()-i-n.height,s=r>o&&i>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:i,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+a,0)}const r=this.getDropdownWidth(),o=e.getWorkspaceWidth()-i+n.width,s=r>o&&i>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:i,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:zO,relativeToGroup:Cl,position:"before"},r=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),gr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedActive()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedActive()&&(this.isFlippedVertically?(l=s.getSelectedActive()[0],a=Math.max(0,l-1)):(l=s.getSelectedActive()[0],a=l-1)),r(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(s.getSelectedActive()){if(this.isFlippedVertically)a=s.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedActive()[0],a=Math.min(u,l+1)}}return r(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zO)}}function wre(t,e){Xk(t,e),e.add(t)}function YO(t,e,n){Xk(t,e),e.set(t,n)}function Xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lb(t,e,n){return(e=vre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vre(t){var e=Cre(t,"string");return typeof e=="symbol"?e:e+""}function Cre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ub(t,e){return t.get(Va(t,e))}function Va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yre="autocomplete";var cb=new WeakMap,GO=new WeakMap,va=new WeakSet;class TM extends EM{constructor(){super(...arguments),wre(this,va),lb(this,"query",null),lb(this,"strippedChoices",[]),lb(this,"rawChoices",[]),YO(this,cb,this.hot.guid.slice(0,9)),YO(this,GO,Pg(()=>{this.focus()},100))}static get EDITOR_TYPE(){return yre}getValue(){const e=this.rawChoices.find(n=>{const i=this.stripValueIfNeeded(n);return(Va(va,this,Rd).call(this,i)?i.value:i)===this.TEXTAREA.value});return te(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),j(this.htContainer,"autocompleteEditor"),j(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[D9(),P9(),QD("listbox"),V9()])}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[Lr("false"),W9(`${ub(cb,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:a=>Va(va,this,Rd).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",ub(GO,this)),this.htEditor.updateSettings({colWidths:e?[nn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ca(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:v,locale:b}=this.cellProperties,T=this.query;let _=Ct(d),D,P;_&&!v&&(D=m===!0?_.indexOf(T):_.toLocaleLowerCase(b).indexOf(T.toLocaleLowerCase(b)),D!==-1&&(P=_.substr(D,T.length),_=_.replace(P,`<strong>${P}</strong>`))),n&&le(l,[I9(),...i?[z9(r)]:[],...i?[Y9(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=_},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{le(h,[F0()]),le(this.TEXTAREA,...B9(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(le(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Gs()),le(this.htEditor.rootElement,[JD(),j9("polite"),U9("text"),["id",`${ub(cb,this)}-listbox-${o}-${s}`]]),le(this.TEXTAREA,...Lr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[Lr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}finishEditing(e,n,i){if(this.isOpened()){const r=this.hot.getSelectedRangeActive();(Tt(r)||te(r)&&!r.includes(this.hot._createCellCoords(this.row,this.col)))&&(e=!0)}super.finishEditing(e,n,i)}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=K0(this.TEXTAREA),i=M$(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=this.stripValueIfNeeded(this.getValue()),a=Va(va,this,Rd).call(this,s)?s.value:s;let l=null,u=e;r||(u=u.toSorted());const c=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let m=0;m<u.length;m++){const v=Va(va,this,Rd).call(this,u[m])?os(Ct(u[m].value)):os(Ct(u[m]));if((d?v:v.toLocaleLowerCase(h)).indexOf(f)!==-1&&(c.push(m),o===!1))break}o===!1?s.length>0&&(l=c[0]):(u=c.map(m=>u[m]),l=u.indexOf(f)>-1?u.indexOf(f):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(mf([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),_g(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:i,spaceBelow:r}=e;return this.limitDropdownIfNeeded(n?i:r),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let i=0,r=0,o=null;do r=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=r;while(i<e);o=i-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(i-r)}}updateDropdownDimensions(){const e=P$(),n=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:i}),Va(va,this,KO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Va(va,this,KO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(r,o)=>o).reduce((r,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return r+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=r=>Ct(n?r:os(r));return e.every(r=>Va(va,this,Rd).call(this,r))?e.map(r=>({key:i(r.key),value:i(r.value)})):e.map(r=>i(r))}onBeforeKeyDown(e){if(H$(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function KO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+rn(this.hot.rootDocument)})}function Rd(t){return me(t)&&te(t.key)&&te(t.value)}const bre="checkbox";class qk extends Gh{static get EDITOR_TYPE(){return bre}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Ce(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ja=()=>window,Hr=()=>window.document,sE=(t,e)=>window.setTimeout(t,e),zo=function(t,e,n,i){t.addEventListener(e,n,!!i)},Is=function(t,e,n,i){t.removeEventListener(e,n,!!i)},Sre=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},tr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},hb=function(t,e){tr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},db=function(t,e){t.className=Sre((" "+t.className+" ").replace(" "+e+" "," "))},_M=function(t){return/Array/.test(Object.prototype.toString.call(t))},or=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Rre=function(t){let e=t.getDay();return e===0||e===6},Ere=function(t){return t%4===0&&t%100!==0||t%400===0},XO=function(t,e){return[31,Ere(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},km=function(t){or(t)&&t.setHours(0,0,0,0)},Lm=function(t,e){return t.getTime()===e.getTime()},Uw=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?or(e[i])?n&&(t[i]=new Date(e[i].getTime())):_M(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=Uw({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},qO=function(t,e,n){let i=Hr().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Uw(i,n),t.dispatchEvent(i)},ZO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Oo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},JO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Tre=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},_re=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},Mre=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():_re(o,r))+"</td>"},Pre=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Ire=function(t){return"<tbody>"+t.join("")+"</tbody>"},Are=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+JO(t,e)+'">'+JO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Ore=function(t,e,n,i,r,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,v=!0,b=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===r?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",_M(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(i===0||u.minMonth>=i)&&(v=!1),h&&(i===11||u.maxMonth<=i)&&(b=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},xre=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Are(t)+Ire(e)+"</table>"};function aE(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||Ja().event;let o=r.target||r.srcElement;if(o)if(tr(o,"is-disabled")||(tr(o,"pika-button")&&!tr(o,"is-empty")&&!tr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&sE(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):tr(o,"pika-prev")?e.prevMonth():tr(o,"pika-next")&&e.nextMonth()),tr(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||Ja().event;let o=r.target||r.srcElement;o&&(tr(o,"pika-select-month")?e.gotoMonth(o.value):tr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||Ja().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),or(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=Hr().activeElement;do if(tr(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=sE(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||Ja().event;let o=r.target||r.srcElement,s=o;if(o){!hasEventListeners&&tr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),zo(o,"change",e._onChange)));do if(tr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Hr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),zo(e.el,"mousedown",e._onMouseDown,!0),zo(e.el,"touchend",e._onMouseDown,!0),zo(e.el,"change",e._onChange),n.keyboardInput&&zo(Hr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Hr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),zo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;or(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",zo(n.trigger,"click",e._onInputClick),zo(n.trigger,"focus",e._onInputFocus),zo(n.trigger,"blur",e._onInputBlur)):this.show()}aE.prototype={config:function(t){this._o||(this._o=Uw({},Oo,!0));let e=Uw(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,or(e.minDate)||(e.minDate=!1),or(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),_M(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Oo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,or(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return or(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",qO(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!or(t))return;let n=this._o.minDate,i=this._o.maxDate;or(n)&&t<n?t=n:or(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),km(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),qO(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(or(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=ZO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=ZO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(km(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Oo.minDate,this._o.minYear=Oo.minYear,this._o.minMonth=Oo.minMonth,this._o.startRange=Oo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(km(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Oo.maxDate,this._o.maxYear=Oo.maxYear,this._o.maxMonth=Oo.maxMonth,this._o.endRange=Oo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Ore(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&sE(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=Ja().innerWidth||Hr().documentElement.clientWidth,r=Ja().innerHeight||Hr().documentElement.clientHeight,o=Hr().body.scrollTop||Hr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ja().pageXOffset,a=l.bottom+Ja().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",hb(this.el,u?"left-aligned":"right-aligned"),hb(this.el,c?"bottom-aligned":"top-aligned"),db(this.el,u?"right-aligned":"left-aligned"),db(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=XO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];km(r),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=XO(h,u),m=o+s,v=m;for(;v>7;)v-=7;m+=7-v;let b=!1;for(let T=0,_=0;T<m;T++){let D=new Date(t,e,1+(T-s)),P=or(this._d)?Lm(D,this._d):!1,W=Lm(D,r),k=i.events.indexOf(D.toDateString())!==-1,$=T<s||T>=o+s,G=1+(T-s),J=e,U=t,oe=i.startRange&&Lm(i.startRange,D),B=i.endRange&&Lm(i.endRange,D),z=i.startRange&&i.endRange&&i.startRange<D&&D<i.endRange,ee=i.minDate&&D<i.minDate||i.maxDate&&D>i.maxDate||i.disableWeekends&&Rre(D)||i.disableDayFn&&i.disableDayFn(D);$&&(T<s?(G=f+G,J=u,U=h):(G=G-o,J=c,U=d));let pe={day:G,month:J,year:U,hasEvent:k,isSelected:P,isToday:W,isDisabled:ee,isEmpty:$,isStartRange:oe,isEndRange:B,isInRange:z,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&P&&(b=!0),l.push(Tre(pe)),++_===7&&(i.showWeekNumber&&l.unshift(Mre(this,T-s,e,t,i.firstWeekOfYearMinDays)),a.push(Pre(l,i.isRTL,i.pickWholeWeek,b)),l=[],_=0,b=!1)}return xre(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),db(this.el,"is-hidden"),this._o.bound&&(zo(Hr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Is(Hr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),hb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Is(this.el,"mousedown",this._onMouseDown,!0),Is(this.el,"touchend",this._onMouseDown,!0),Is(this.el,"change",this._onChange),t.keyboardInput&&Is(Hr(),"keydown",this._onKeyChange),t.field&&(Is(t.field,"change",this._onInputChange),t.bound&&(Is(t.trigger,"click",this._onInputClick),Is(t.trigger,"focus",this._onInputFocus),Is(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Hre(t,e){Nre(t,e),e.add(t)}function Nre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QO(t,e,n){return(e=Dre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dre(t){var e=$re(t,"string");return typeof e=="symbol"?e:e+""}function $re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zk="date",ex="dateEditor",kre="DD/MM/YYYY";var Fm=new WeakSet;class Jk extends Ju{constructor(){super(...arguments),Hre(this,Fm),QO(this,"parentDestroyed",!1),QO(this,"$datePicker",null)}static get EDITOR_TYPE(){return Zk}init(){if(typeof K!="function")throw new Error("You need to include moment.js to your project.");if(typeof aE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),j(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ce(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:ex})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ex),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=fb(Fm,this,gb).call(this),i=this.hot.view.isMouseDown(),r=e?tT(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new aE(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(K),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Rg(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:fb(Fm,this,gb).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=K(a).format(fb(Fm,this,gb).call(this))),this.setValue(a),r&&r(),mo()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+cn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-nn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function gb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:kre}const Lre="dropdown";class Qk extends TM{static get EDITOR_TYPE(){return Lre}prepare(e,n,i,r,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,i,r,o,s)}}const Fre="numeric";class eL extends Ju{static get EDITOR_TYPE(){return Fre}}function Vre(t,e,n){return(e=Wre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:e+""}function Bre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jre="password";class tL extends Ju{constructor(){super(...arguments),Vre(this,"autoResize",Gk(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return jre}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,cs(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Co(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const mb="ht_editor_visible",tx="selectEditor",Ure="select";class nL extends Gh{static get EDITOR_TYPE(){return Ure}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Xu()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),j(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ce(this.selectWrapper,mb)&&ae(this.selectWrapper,mb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),cs(this.select),Fe(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,wl(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",j(this.selectWrapper,mb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:tx};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tx)}}const zre="time";class iL extends Ju{static get EDITOR_TYPE(){return zre}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.TEXTAREA.dir="ltr"}}function Yre(){$i(Gh),$i(TM),$i(qk),$i(Jk),$i(Qk),$i(EM),$i(eL),$i(tL),$i(nL),$i(Ju),$i(iL)}const Gre="html";function MM(t,e,n,i,r,o,s){Ng.apply(this,[t,e,n,i,r,o,s]),wl(e,o??"",!1)}MM.RENDERER_TYPE=Gre;const Kre="autocomplete";function Kh(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=s.allowHtml?MM:ca,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Xu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,i,r,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),j(e,"htAutocomplete"),!t.acArrowListener){const h=new Vr(t);t.acArrowListener=function(d){Ce(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Kh.RENDERER_TYPE=Kre;const Xre="dropdown";function PM(t,e,n,i,r,o,s){Kh.apply(this,[t,e,n,i,r,o,s])}PM.RENDERER_TYPE=Xre;const nx=new WeakMap,ix=new WeakMap,qre="htBadValue",Ah="data-row",Oh="data-col",Zre="checkboxRenderer",rL="checkbox";re.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:s,prop:a}=e;if(r!==rL||!i)return;const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}return`${Ct(c).length}`});function IM(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Ng.apply(this,[t,e,n,i,r,o,s]),Jre(t);let u=Qre(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),cs(e),o===s.checkedTemplate||Ct(o).toLocaleLowerCase(s.locale)===Ct(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ct(o).toLocaleLowerCase(s.locale)===Ct(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Gt(o)?j(u,"noValue"):(u.style.display="none",j(u,qre),h=!0),le(u,[[Ah,n],[Oh,i]]),l&&le(u,[hr(u.checked?t.getTranslatedPhrase(lM):t.getTranslatedPhrase(uM)),n$(u.checked),A9()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,i,r,o):c.value;else if(c.property){const T=t.getDataAtRowProp(n,c.property);v=T!==null?T:""}const b=eoe(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),nx.has(t)||(nx.set(t,!0),d());function d(){const b=t.getShortcutManager().getContext("grid"),T={group:Zre,relativeToGroup:Cl,position:"before"};b.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeActive())===null||_===void 0?void 0:_.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const _=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&(_==null?void 0:_.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeActive())===null||_===void 0?void 0:_.highlight.isCell()}}],T)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange(),T=[],_=new Map;let D=[],P=0;if(b){for(let W=0;W<b.length;W++){const{row:k,col:$}=b[W].getTopStartCorner(),{row:G,col:J}=b[W].getBottomEndCorner();for(let U=k;U<=G;U+=1)for(let oe=$;oe<=J;oe+=1){const B=t.getCellMeta(U,oe);if(B.hidden)continue;const z={checkedTemplate:B.checkedTemplate,uncheckedTemplate:B.uncheckedTemplate};if(B.type!=="checkbox"){v===!0&&!B.readOnly&&(_.has(T.length)?_.set(T.length,[..._.get(T.length),[U,oe,null]]):_.set(T.length,[[U,oe,null]]));continue}if(B.readOnly===!0)continue;typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);const ee=t.getDataAtCell(U,oe);v===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(ee)?D.push([U,oe,B.uncheckedTemplate,z]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(ee)&&D.push([U,oe,B.checkedTemplate,z]):D.push([U,oe,B.uncheckedTemplate,z]),P+=1}T.push(P),P=0}D.every(W=>{let[,,k]=W;return k===D[0][2]})?D=D.map(W=>{let[k,$,G]=W;return[k,$,G]}):D=D.map(W=>{let[k,$,,G]=W;return[k,$,G.checkedTemplate]}),D.length>0&&T.forEach((W,k)=>{let $=D.splice(0,W);_.size&&_.has(k)&&($=[...$,..._.get(k)]),t.setDataAtCell($)})}}function m(){const v=t.getSelectedRange();if(v){for(let b=0;b<v.length;b++){const T=v[b].getTopStartCorner(),_=v[b].getBottomEndCorner();for(let D=T.row;D<=_.row;D++)for(let P=T.col;P<=_.col;P++){if(t.getCellMeta(D,P).readOnly)continue;const k=t.getCell(D,P);if(as(k)&&k.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}IM.RENDERER_TYPE=rL;function Jre(t){let e=ix.get(t);if(!e){const{rootElement:n}=t;e=new Vr(t),e.addEventListener(n,"click",i=>noe(i,t)),e.addEventListener(n,"mouseup",i=>toe(i,t)),e.addEventListener(n,"change",i=>ioe(i,t)),ix.set(t,e)}return e}function Qre(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function eoe(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function toe(t,e){const{target:n}=t;AM(n)&&(!n.hasAttribute(Ah)||!n.hasAttribute(Oh)||setTimeout(e.listen,10))}function noe(t,e){const{target:n}=t;if(!AM(n)||!n.hasAttribute(Ah)||!n.hasAttribute(Oh))return;const i=parseInt(n.getAttribute(Ah),10),r=parseInt(n.getAttribute(Oh),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function ioe(t,e){const{target:n}=t;if(!AM(n)||!n.hasAttribute(Ah)||!n.hasAttribute(Oh))return;const i=parseInt(n.getAttribute(Ah),10),r=parseInt(n.getAttribute(Oh),10),o=e.getCellMeta(i,r);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,s)}}function AM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const roe="handsontable";function OM(t,e,n,i,r,o,s){Kh.apply(this,[t,e,n,i,r,o,s])}OM.RENDERER_TYPE=roe;var ooe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function soe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var pb,rx;function aoe(){return rx||(rx=1,pb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),pb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var wb,ox;function oL(){if(ox)return wb;ox=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let v="",b=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==l)return-1*n(b,u,c,h,d,f);for(let k=0;k<t.length;k++){let $=t[k];if(v=l.replace(RegExp(`([0-9 ])(${$.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*$.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let T=parseFloat(l);if(isNaN(T))return;let _=h(T);if(_&&_!=="."&&(v=l.replace(new RegExp(`${e(_)}$`),""),v!==l))return n(v,u,c,h,d,f);let D={};Object.keys(f).forEach(k=>{D[f[k]]=k});let P=Object.keys(D).sort().reverse(),W=P.length;for(let k=0;k<W;k++){let $=P[k],G=D[$];if(v=l.replace($,""),v!==l){let J;switch(G){case"thousand":J=Math.pow(10,3);break;case"million":J=Math.pow(10,6);break;case"billion":J=Math.pow(10,9);break;case"trillion":J=Math.pow(10,12);break}return n(v,u,c,h,d,f)*J}}}function i(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function r(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let v=i(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=NM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),v=c.currentAbbreviations(),b;if(typeof l=="string")o(l,h)?b=s(l):b=r(l,h,d,f,m,v);else if(typeof l=="number")b=l;else return;if(b!==void 0)return b}return wb={unformat:a},wb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var vb,sx;function xM(){if(sx)return vb;sx=1;let t=oL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(b,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:b=>b.output==="byte"},characteristic:{type:"number",restriction:b=>b>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(b,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:b=>b>=0,message:"value must be positive"},{restriction:(b,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:b=>b>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(b,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:b=>b.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(b,T){let _=d(b),D=m(T);return _&&D}function d(b){return t.unformat(b)!==void 0}function f(b,T,_,D=!1){let P=Object.keys(b).map(W=>{if(!T[W])return console.error(`${_} Invalid key: ${W}`),!1;let k=b[W],$=T[W];if(typeof $=="string"&&($={type:$}),$.type==="format"){if(!f(k,u,`[Validate ${W}]`,!0))return!1}else if(typeof k!==$.type)return console.error(`${_} ${W} type mismatched: "${$.type}" expected, "${typeof k}" provided`),!1;if($.restrictions&&$.restrictions.length){let G=$.restrictions.length;for(let J=0;J<G;J++){let{restriction:U,message:oe}=$.restrictions[J];if(!U(k,b))return console.error(`${_} ${W} invalid value: ${oe}`),!1}}return $.restriction&&!$.restriction(k,b)?(console.error(`${_} ${W} invalid value: ${$.message}`),!1):$.validValues&&$.validValues.indexOf(k)===-1?(console.error(`${_} ${W} invalid value: must be among ${JSON.stringify($.validValues)}, "${k}" provided`),!1):!($.children&&!f(k,$.children,`[Validate ${W}]`))});return D||P.push(...Object.keys(T).map(W=>{let k=T[W];if(typeof k=="string"&&(k={type:k}),k.mandatory){let $=k.mandatory;if(typeof $=="function"&&($=$(b)),$&&b[W]===void 0)return console.error(`${_} Missing mandatory key "${W}"`),!1}return!0})),P.reduce((W,k)=>W&&k,!0)}function m(b){return f(b,u,"[Validate format]")}function v(b){return f(b,c,"[Validate language]")}return vb={validate:h,validateFormat:m,validateInput:d,validateLanguage:v},vb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function loe(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function uoe(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function coe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function hoe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function doe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function foe(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function goe(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function moe(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function poe(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function woe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function voe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function Coe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function yoe(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function boe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Soe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function Roe(t,e={}){return typeof t!="string"?t:(t=loe(t,e),t=uoe(t,e),coe(t,e),foe(t,e),goe(t,e),yoe(t,e),woe(t,e),voe(t,e),moe(t,e),Coe(t,e),poe(t,e),hoe(t,e),doe(t,e),boe(t,e),Soe(t,e),e)}var HM={parseFormat:Roe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Cb,ax;function NM(){if(ax)return Cb;ax=1;const t=aoe(),e=xM(),n=HM;let i={},r,o={},s=null,a={};function l(c){r=c}function u(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>u().bytes||{},i.currentCurrency=()=>u().currency,i.currentAbbreviations=()=>u().abbreviations,i.currentDelimiters=()=>u().delimiters,i.currentOrdinal=()=>u().ordinal,i.currentDefaults=()=>Object.assign({},u().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().timeFormat),i.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},i.getZeroFormat=()=>s,i.setZeroFormat=c=>s=typeof c=="string"?c:null,i.hasZeroFormat=()=>s!==null,i.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},i.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},i.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},i.registerLanguage(t),r=t.languageTag,Cb=i,Cb}function Eoe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Toe(t,e){t.forEach(n=>{let i;try{i=Eoe(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var _oe=t=>({loadLanguagesInNode:e=>Toe(e,t)}),sL={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(k){var $,G,J,U=X.prototype={constructor:X,toString:null,valueOf:null},oe=new X(1),B=20,z=4,ee=-7,pe=21,gt=-1e7,Re=1e7,Te=!1,Ie=1,Ee=0,we={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Xn="0123456789abcdefghijklmnopqrstuvwxyz",at=!0;function X(p,C){var S,O,E,R,N,M,x,V,F=this;if(!(F instanceof X))return new X(p,C);if(C==null){if(p&&p._isBigNumber===!0){F.s=p.s,!p.c||p.e>Re?F.c=F.e=null:p.e<gt?F.c=[F.e=0]:(F.e=p.e,F.c=p.c.slice());return}if((M=typeof p=="number")&&p*0==0){if(F.s=1/p<0?(p=-p,-1):1,p===~~p){for(R=0,N=p;N>=10;N/=10,R++);R>Re?F.c=F.e=null:(F.e=R,F.c=[p]);return}V=String(p)}else{if(!i.test(V=String(p)))return J(F,V,M);F.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(R=V.indexOf("."))>-1&&(V=V.replace(".","")),(N=V.search(/e/i))>0?(R<0&&(R=N),R+=+V.slice(N+1),V=V.substring(0,N)):R<0&&(R=V.length)}else{if(_(C,2,Xn.length,"Base"),C==10&&at)return F=new X(p),A(F,B+F.e+1,z);if(V=String(p),M=typeof p=="number"){if(p*0!=0)return J(F,V,M,C);if(F.s=1/p<0?(V=V.slice(1),-1):1,X.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+p)}else F.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(S=Xn.slice(0,C),R=N=0,x=V.length;N<x;N++)if(S.indexOf(O=V.charAt(N))<0){if(O=="."){if(N>R){R=x;continue}}else if(!E&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){E=!0,N=-1,R=0;continue}return J(F,String(p),M,C)}M=!1,V=G(V,C,10,F.s),(R=V.indexOf("."))>-1?V=V.replace(".",""):R=V.length}for(N=0;V.charCodeAt(N)===48;N++);for(x=V.length;V.charCodeAt(--x)===48;);if(V=V.slice(N,++x)){if(x-=N,M&&X.DEBUG&&x>15&&(p>c||p!==o(p)))throw Error(a+F.s*p);if((R=R-N-1)>Re)F.c=F.e=null;else if(R<gt)F.c=[F.e=0];else{if(F.e=R,F.c=[],N=(R+1)%u,R<0&&(N+=u),N<x){for(N&&F.c.push(+V.slice(0,N)),x-=u;N<x;)F.c.push(+V.slice(N,N+=u));N=u-(V=V.slice(N)).length}else N-=x;for(;N--;V+="0");F.c.push(+V)}}else F.c=[F.e=0]}X.clone=m,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(p){var C,S;if(p!=null)if(typeof p=="object"){if(p.hasOwnProperty(C="DECIMAL_PLACES")&&(S=p[C],_(S,0,f,C),B=S),p.hasOwnProperty(C="ROUNDING_MODE")&&(S=p[C],_(S,0,8,C),z=S),p.hasOwnProperty(C="EXPONENTIAL_AT")&&(S=p[C],S&&S.pop?(_(S[0],-f,0,C),_(S[1],0,f,C),ee=S[0],pe=S[1]):(_(S,-f,f,C),ee=-(pe=S<0?-S:S))),p.hasOwnProperty(C="RANGE"))if(S=p[C],S&&S.pop)_(S[0],-f,-1,C),_(S[1],1,f,C),gt=S[0],Re=S[1];else if(_(S,-f,f,C),S)gt=-(Re=S<0?-S:S);else throw Error(s+C+" cannot be zero: "+S);if(p.hasOwnProperty(C="CRYPTO"))if(S=p[C],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=S;else throw Te=!S,Error(s+"crypto unavailable");else Te=S;else throw Error(s+C+" not true or false: "+S);if(p.hasOwnProperty(C="MODULO_MODE")&&(S=p[C],_(S,0,9,C),Ie=S),p.hasOwnProperty(C="POW_PRECISION")&&(S=p[C],_(S,0,f,C),Ee=S),p.hasOwnProperty(C="FORMAT"))if(S=p[C],typeof S=="object")we=S;else throw Error(s+C+" not an object: "+S);if(p.hasOwnProperty(C="ALPHABET"))if(S=p[C],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))at=S.slice(0,10)=="0123456789",Xn=S;else throw Error(s+C+" invalid: "+S)}else throw Error(s+"Object expected: "+p);return{DECIMAL_PLACES:B,ROUNDING_MODE:z,EXPONENTIAL_AT:[ee,pe],RANGE:[gt,Re],CRYPTO:Te,MODULO_MODE:Ie,POW_PRECISION:Ee,FORMAT:we,ALPHABET:Xn}},X.isBigNumber=function(p){if(!p||p._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var C,S,O=p.c,E=p.e,R=p.s;e:if({}.toString.call(O)=="[object Array]"){if((R===1||R===-1)&&E>=-f&&E<=f&&E===o(E)){if(O[0]===0){if(E===0&&O.length===1)return!0;break e}if(C=(E+1)%u,C<1&&(C+=u),String(O[0]).length==C){for(C=0;C<O.length;C++)if(S=O[C],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(O===null&&E===null&&(R===null||R===1||R===-1))return!0;throw Error(s+"Invalid BigNumber: "+p)},X.maximum=X.max=function(){return w(arguments,-1)},X.minimum=X.min=function(){return w(arguments,1)},X.random=function(){var p=9007199254740992,C=Math.random()*p&2097151?function(){return o(Math.random()*p)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var O,E,R,N,M,x=0,V=[],F=new X(oe);if(S==null?S=B:_(S,0,f),N=r(S/u),Te)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(N*=2));x<N;)M=O[x]*131072+(O[x+1]>>>11),M>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),O[x]=E[0],O[x+1]=E[1]):(V.push(M%1e14),x+=2);x=N/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(N*=7);x<N;)M=(O[x]&31)*281474976710656+O[x+1]*1099511627776+O[x+2]*4294967296+O[x+3]*16777216+(O[x+4]<<16)+(O[x+5]<<8)+O[x+6],M>=9e15?crypto.randomBytes(7).copy(O,x):(V.push(M%1e14),x+=7);x=N/7}else throw Te=!1,Error(s+"crypto unavailable");if(!Te)for(;x<N;)M=C(),M<9e15&&(V[x++]=M%1e14);for(N=V[--x],S%=u,N&&S&&(M=h[u-S],V[x]=o(N/M)*M);V[x]===0;V.pop(),x--);if(x<0)V=[R=0];else{for(R=-1;V[0]===0;V.splice(0,1),R-=u);for(x=1,M=V[0];M>=10;M/=10,x++);x<u&&(R-=u-x)}return F.e=R,F.c=V,F}}(),X.sum=function(){for(var p=1,C=arguments,S=new X(C[0]);p<C.length;)S=S.plus(C[p++]);return S},G=function(){var p="0123456789";function C(S,O,E,R){for(var N,M=[0],x,V=0,F=S.length;V<F;){for(x=M.length;x--;M[x]*=O);for(M[0]+=R.indexOf(S.charAt(V++)),N=0;N<M.length;N++)M[N]>E-1&&(M[N+1]==null&&(M[N+1]=0),M[N+1]+=M[N]/E|0,M[N]%=E)}return M.reverse()}return function(S,O,E,R,N){var M,x,V,F,Y,se,Q,be,Ue=S.indexOf("."),Je=B,_e=z;for(Ue>=0&&(F=Ee,Ee=0,S=S.replace(".",""),be=new X(O),se=be.pow(S.length-Ue),Ee=F,be.c=C(W(b(se.c),se.e,"0"),10,E,p),be.e=be.c.length),Q=C(S,O,E,N?(M=Xn,p):(M=p,Xn)),V=F=Q.length;Q[--F]==0;Q.pop());if(!Q[0])return M.charAt(0);if(Ue<0?--V:(se.c=Q,se.e=V,se.s=R,se=$(se,be,Je,_e,E),Q=se.c,Y=se.r,V=se.e),x=V+Je+1,Ue=Q[x],F=E/2,Y=Y||x<0||Q[x+1]!=null,Y=_e<4?(Ue!=null||Y)&&(_e==0||_e==(se.s<0?3:2)):Ue>F||Ue==F&&(_e==4||Y||_e==6&&Q[x-1]&1||_e==(se.s<0?8:7)),x<1||!Q[0])S=Y?W(M.charAt(1),-Je,M.charAt(0)):M.charAt(0);else{if(Q.length=x,Y)for(--E;++Q[--x]>E;)Q[x]=0,x||(++V,Q=[1].concat(Q));for(F=Q.length;!Q[--F];);for(Ue=0,S="";Ue<=F;S+=M.charAt(Q[Ue++]));S=W(S,V,M.charAt(0))}return S}}(),$=function(){function p(O,E,R){var N,M,x,V,F=0,Y=O.length,se=E%d,Q=E/d|0;for(O=O.slice();Y--;)x=O[Y]%d,V=O[Y]/d|0,N=Q*x+V*se,M=se*x+N%d*d+F,F=(M/R|0)+(N/d|0)+Q*V,O[Y]=M%R;return F&&(O=[F].concat(O)),O}function C(O,E,R,N){var M,x;if(R!=N)x=R>N?1:-1;else for(M=x=0;M<R;M++)if(O[M]!=E[M]){x=O[M]>E[M]?1:-1;break}return x}function S(O,E,R,N){for(var M=0;R--;)O[R]-=M,M=O[R]<E[R]?1:0,O[R]=M*N+O[R]-E[R];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,E,R,N,M){var x,V,F,Y,se,Q,be,Ue,Je,_e,Ge,it,Xt,Wn,vr,qt,Gi,_t=O.s==E.s?1:-1,Rt=O.c,qe=E.c;if(!Rt||!Rt[0]||!qe||!qe[0])return new X(!O.s||!E.s||(Rt?qe&&Rt[0]==qe[0]:!qe)?NaN:Rt&&Rt[0]==0||!qe?_t*0:_t/0);for(Ue=new X(_t),Je=Ue.c=[],V=O.e-E.e,_t=R+V+1,M||(M=l,V=v(O.e/u)-v(E.e/u),_t=_t/u|0),F=0;qe[F]==(Rt[F]||0);F++);if(qe[F]>(Rt[F]||0)&&V--,_t<0)Je.push(1),Y=!0;else{for(Wn=Rt.length,qt=qe.length,F=0,_t+=2,se=o(M/(qe[0]+1)),se>1&&(qe=p(qe,se,M),Rt=p(Rt,se,M),qt=qe.length,Wn=Rt.length),Xt=qt,_e=Rt.slice(0,qt),Ge=_e.length;Ge<qt;_e[Ge++]=0);Gi=qe.slice(),Gi=[0].concat(Gi),vr=qe[0],qe[1]>=M/2&&vr++;do{if(se=0,x=C(qe,_e,qt,Ge),x<0){if(it=_e[0],qt!=Ge&&(it=it*M+(_e[1]||0)),se=o(it/vr),se>1)for(se>=M&&(se=M-1),Q=p(qe,se,M),be=Q.length,Ge=_e.length;C(Q,_e,be,Ge)==1;)se--,S(Q,qt<be?Gi:qe,be,M),be=Q.length,x=1;else se==0&&(x=se=1),Q=qe.slice(),be=Q.length;if(be<Ge&&(Q=[0].concat(Q)),S(_e,Q,Ge,M),Ge=_e.length,x==-1)for(;C(qe,_e,qt,Ge)<1;)se++,S(_e,qt<Ge?Gi:qe,Ge,M),Ge=_e.length}else x===0&&(se++,_e=[0]);Je[F++]=se,_e[0]?_e[Ge++]=Rt[Xt]||0:(_e=[Rt[Xt]],Ge=1)}while((Xt++<Wn||_e[0]!=null)&&_t--);Y=_e[0]!=null,Je[0]||Je.splice(0,1)}if(M==l){for(F=1,_t=Je[0];_t>=10;_t/=10,F++);A(Ue,R+(Ue.e=F+V*u-1)+1,N,Y)}else Ue.e=V,Ue.r=+Y;return Ue}}();function g(p,C,S,O){var E,R,N,M,x;if(S==null?S=z:_(S,0,8),!p.c)return p.toString();if(E=p.c[0],N=p.e,C==null)x=b(p.c),x=O==1||O==2&&(N<=ee||N>=pe)?P(x,N):W(x,N,"0");else if(p=A(new X(p),C,S),R=p.e,x=b(p.c),M=x.length,O==1||O==2&&(C<=R||R<=ee)){for(;M<C;x+="0",M++);x=P(x,R)}else if(C-=N,x=W(x,R,"0"),R+1>M){if(--C>0)for(x+=".";C--;x+="0");}else if(C+=R-M,C>0)for(R+1==M&&(x+=".");C--;x+="0");return p.s<0&&E?"-"+x:x}function w(p,C){for(var S,O,E=1,R=new X(p[0]);E<p.length;E++)O=new X(p[E]),(!O.s||(S=T(R,O))===C||S===0&&R.s===C)&&(R=O);return R}function y(p,C,S){for(var O=1,E=C.length;!C[--E];C.pop());for(E=C[0];E>=10;E/=10,O++);return(S=O+S*u-1)>Re?p.c=p.e=null:S<gt?p.c=[p.e=0]:(p.e=S,p.c=C),p}J=function(){var p=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,S=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,N,M,x){var V,F=M?N:N.replace(E,"");if(O.test(F))R.s=isNaN(F)?null:F<0?-1:1;else{if(!M&&(F=F.replace(p,function(Y,se,Q){return V=(Q=Q.toLowerCase())=="x"?16:Q=="b"?2:8,!x||x==V?se:Y}),x&&(V=x,F=F.replace(C,"$1").replace(S,"0.$1")),N!=F))return new X(F,V);if(X.DEBUG)throw Error(s+"Not a"+(x?" base "+x:"")+" number: "+N);R.s=null}R.c=R.e=null}}();function A(p,C,S,O){var E,R,N,M,x,V,F,Y=p.c,se=h;if(Y){e:{for(E=1,M=Y[0];M>=10;M/=10,E++);if(R=C-E,R<0)R+=u,N=C,x=Y[V=0],F=o(x/se[E-N-1]%10);else if(V=r((R+1)/u),V>=Y.length)if(O){for(;Y.length<=V;Y.push(0));x=F=0,E=1,R%=u,N=R-u+1}else break e;else{for(x=M=Y[V],E=1;M>=10;M/=10,E++);R%=u,N=R-u+E,F=N<0?0:o(x/se[E-N-1]%10)}if(O=O||C<0||Y[V+1]!=null||(N<0?x:x%se[E-N-1]),O=S<4?(F||O)&&(S==0||S==(p.s<0?3:2)):F>5||F==5&&(S==4||O||S==6&&(R>0?N>0?x/se[E-N]:0:Y[V-1])%10&1||S==(p.s<0?8:7)),C<1||!Y[0])return Y.length=0,O?(C-=p.e+1,Y[0]=se[(u-C%u)%u],p.e=-C||0):Y[0]=p.e=0,p;if(R==0?(Y.length=V,M=1,V--):(Y.length=V+1,M=se[u-R],Y[V]=N>0?o(x/se[E-N]%se[N])*M:0),O)for(;;)if(V==0){for(R=1,N=Y[0];N>=10;N/=10,R++);for(N=Y[0]+=M,M=1;N>=10;N/=10,M++);R!=M&&(p.e++,Y[0]==l&&(Y[0]=1));break}else{if(Y[V]+=M,Y[V]!=l)break;Y[V--]=0,M=1}for(R=Y.length;Y[--R]===0;Y.pop());}p.e>Re?p.c=p.e=null:p.e<gt&&(p.c=[p.e=0])}return p}function L(p){var C,S=p.e;return S===null?p.toString():(C=b(p.c),C=S<=ee||S>=pe?P(C,S):W(C,S,"0"),p.s<0?"-"+C:C)}return U.absoluteValue=U.abs=function(){var p=new X(this);return p.s<0&&(p.s=1),p},U.comparedTo=function(p,C){return T(this,new X(p,C))},U.decimalPlaces=U.dp=function(p,C){var S,O,E,R=this;if(p!=null)return _(p,0,f),C==null?C=z:_(C,0,8),A(new X(R),p+R.e+1,C);if(!(S=R.c))return null;if(O=((E=S.length-1)-v(this.e/u))*u,E=S[E])for(;E%10==0;E/=10,O--);return O<0&&(O=0),O},U.dividedBy=U.div=function(p,C){return $(this,new X(p,C),B,z)},U.dividedToIntegerBy=U.idiv=function(p,C){return $(this,new X(p,C),0,1)},U.exponentiatedBy=U.pow=function(p,C){var S,O,E,R,N,M,x,V,F,Y=this;if(p=new X(p),p.c&&!p.isInteger())throw Error(s+"Exponent not an integer: "+L(p));if(C!=null&&(C=new X(C)),M=p.e>14,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!p.c||!p.c[0])return F=new X(Math.pow(+L(Y),M?p.s*(2-D(p)):+L(p))),C?F.mod(C):F;if(x=p.s<0,C){if(C.c?!C.c[0]:!C.s)return new X(NaN);O=!x&&Y.isInteger()&&C.isInteger(),O&&(Y=Y.mod(C))}else{if(p.e>9&&(Y.e>0||Y.e<-1||(Y.e==0?Y.c[0]>1||M&&Y.c[1]>=24e7:Y.c[0]<8e13||M&&Y.c[0]<=9999975e7)))return R=Y.s<0&&D(p)?-0:0,Y.e>-1&&(R=1/R),new X(x?1/R:R);Ee&&(R=r(Ee/u+2))}for(M?(S=new X(.5),x&&(p.s=1),V=D(p)):(E=Math.abs(+L(p)),V=E%2),F=new X(oe);;){if(V){if(F=F.times(Y),!F.c)break;R?F.c.length>R&&(F.c.length=R):O&&(F=F.mod(C))}if(E){if(E=o(E/2),E===0)break;V=E%2}else if(p=p.times(S),A(p,p.e+1,1),p.e>14)V=D(p);else{if(E=+L(p),E===0)break;V=E%2}Y=Y.times(Y),R?Y.c&&Y.c.length>R&&(Y.c.length=R):O&&(Y=Y.mod(C))}return O?F:(x&&(F=oe.div(F)),C?F.mod(C):R?A(F,Ee,z,N):F)},U.integerValue=function(p){var C=new X(this);return p==null?p=z:_(p,0,8),A(C,C.e+1,p)},U.isEqualTo=U.eq=function(p,C){return T(this,new X(p,C))===0},U.isFinite=function(){return!!this.c},U.isGreaterThan=U.gt=function(p,C){return T(this,new X(p,C))>0},U.isGreaterThanOrEqualTo=U.gte=function(p,C){return(C=T(this,new X(p,C)))===1||C===0},U.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},U.isLessThan=U.lt=function(p,C){return T(this,new X(p,C))<0},U.isLessThanOrEqualTo=U.lte=function(p,C){return(C=T(this,new X(p,C)))===-1||C===0},U.isNaN=function(){return!this.s},U.isNegative=function(){return this.s<0},U.isPositive=function(){return this.s>0},U.isZero=function(){return!!this.c&&this.c[0]==0},U.minus=function(p,C){var S,O,E,R,N=this,M=N.s;if(p=new X(p,C),C=p.s,!M||!C)return new X(NaN);if(M!=C)return p.s=-C,N.plus(p);var x=N.e/u,V=p.e/u,F=N.c,Y=p.c;if(!x||!V){if(!F||!Y)return F?(p.s=-C,p):new X(Y?N:NaN);if(!F[0]||!Y[0])return Y[0]?(p.s=-C,p):new X(F[0]?N:z==3?-0:0)}if(x=v(x),V=v(V),F=F.slice(),M=x-V){for((R=M<0)?(M=-M,E=F):(V=x,E=Y),E.reverse(),C=M;C--;E.push(0));E.reverse()}else for(O=(R=(M=F.length)<(C=Y.length))?M:C,M=C=0;C<O;C++)if(F[C]!=Y[C]){R=F[C]<Y[C];break}if(R&&(E=F,F=Y,Y=E,p.s=-p.s),C=(O=Y.length)-(S=F.length),C>0)for(;C--;F[S++]=0);for(C=l-1;O>M;){if(F[--O]<Y[O]){for(S=O;S&&!F[--S];F[S]=C);--F[S],F[O]+=l}F[O]-=Y[O]}for(;F[0]==0;F.splice(0,1),--V);return F[0]?y(p,F,V):(p.s=z==3?-1:1,p.c=[p.e=0],p)},U.modulo=U.mod=function(p,C){var S,O,E=this;return p=new X(p,C),!E.c||!p.s||p.c&&!p.c[0]?new X(NaN):!p.c||E.c&&!E.c[0]?new X(E):(Ie==9?(O=p.s,p.s=1,S=$(E,p,0,3),p.s=O,S.s*=O):S=$(E,p,0,Ie),p=E.minus(S.times(p)),!p.c[0]&&Ie==1&&(p.s=E.s),p)},U.multipliedBy=U.times=function(p,C){var S,O,E,R,N,M,x,V,F,Y,se,Q,be,Ue,Je,_e=this,Ge=_e.c,it=(p=new X(p,C)).c;if(!Ge||!it||!Ge[0]||!it[0])return!_e.s||!p.s||Ge&&!Ge[0]&&!it||it&&!it[0]&&!Ge?p.c=p.e=p.s=null:(p.s*=_e.s,!Ge||!it?p.c=p.e=null:(p.c=[0],p.e=0)),p;for(O=v(_e.e/u)+v(p.e/u),p.s*=_e.s,x=Ge.length,Y=it.length,x<Y&&(be=Ge,Ge=it,it=be,E=x,x=Y,Y=E),E=x+Y,be=[];E--;be.push(0));for(Ue=l,Je=d,E=Y;--E>=0;){for(S=0,se=it[E]%Je,Q=it[E]/Je|0,N=x,R=E+N;R>E;)V=Ge[--N]%Je,F=Ge[N]/Je|0,M=Q*V+F*se,V=se*V+M%Je*Je+be[R]+S,S=(V/Ue|0)+(M/Je|0)+Q*F,be[R--]=V%Ue;be[R]=S}return S?++O:be.splice(0,1),y(p,be,O)},U.negated=function(){var p=new X(this);return p.s=-p.s||null,p},U.plus=function(p,C){var S,O=this,E=O.s;if(p=new X(p,C),C=p.s,!E||!C)return new X(NaN);if(E!=C)return p.s=-C,O.minus(p);var R=O.e/u,N=p.e/u,M=O.c,x=p.c;if(!R||!N){if(!M||!x)return new X(E/0);if(!M[0]||!x[0])return x[0]?p:new X(M[0]?O:E*0)}if(R=v(R),N=v(N),M=M.slice(),E=R-N){for(E>0?(N=R,S=x):(E=-E,S=M),S.reverse();E--;S.push(0));S.reverse()}for(E=M.length,C=x.length,E-C<0&&(S=x,x=M,M=S,C=E),E=0;C;)E=(M[--C]=M[C]+x[C]+E)/l|0,M[C]=l===M[C]?0:M[C]%l;return E&&(M=[E].concat(M),++N),y(p,M,N)},U.precision=U.sd=function(p,C){var S,O,E,R=this;if(p!=null&&p!==!!p)return _(p,1,f),C==null?C=z:_(C,0,8),A(new X(R),p,C);if(!(S=R.c))return null;if(E=S.length-1,O=E*u+1,E=S[E]){for(;E%10==0;E/=10,O--);for(E=S[0];E>=10;E/=10,O++);}return p&&R.e+1>O&&(O=R.e+1),O},U.shiftedBy=function(p){return _(p,-c,c),this.times("1e"+p)},U.squareRoot=U.sqrt=function(){var p,C,S,O,E,R=this,N=R.c,M=R.s,x=R.e,V=B+4,F=new X("0.5");if(M!==1||!N||!N[0])return new X(!M||M<0&&(!N||N[0])?NaN:N?R:1/0);if(M=Math.sqrt(+L(R)),M==0||M==1/0?(C=b(N),(C.length+x)%2==0&&(C+="0"),M=Math.sqrt(+C),x=v((x+1)/2)-(x<0||x%2),M==1/0?C="5e"+x:(C=M.toExponential(),C=C.slice(0,C.indexOf("e")+1)+x),S=new X(C)):S=new X(M+""),S.c[0]){for(x=S.e,M=x+V,M<3&&(M=0);;)if(E=S,S=F.times(E.plus($(R,E,V,1))),b(E.c).slice(0,M)===(C=b(S.c)).slice(0,M))if(S.e<x&&--M,C=C.slice(M-3,M+1),C=="9999"||!O&&C=="4999"){if(!O&&(A(E,E.e+B+2,0),E.times(E).eq(R))){S=E;break}V+=4,M+=4,O=1}else{(!+C||!+C.slice(1)&&C.charAt(0)=="5")&&(A(S,S.e+B+2,1),p=!S.times(S).eq(R));break}}return A(S,S.e+B+1,z,p)},U.toExponential=function(p,C){return p!=null&&(_(p,0,f),p++),g(this,p,C,1)},U.toFixed=function(p,C){return p!=null&&(_(p,0,f),p=p+this.e+1),g(this,p,C)},U.toFormat=function(p,C,S){var O,E=this;if(S==null)p!=null&&C&&typeof C=="object"?(S=C,C=null):p&&typeof p=="object"?(S=p,p=C=null):S=we;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(O=E.toFixed(p,C),E.c){var R,N=O.split("."),M=+S.groupSize,x=+S.secondaryGroupSize,V=S.groupSeparator||"",F=N[0],Y=N[1],se=E.s<0,Q=se?F.slice(1):F,be=Q.length;if(x&&(R=M,M=x,x=R,be-=R),M>0&&be>0){for(R=be%M||M,F=Q.substr(0,R);R<be;R+=M)F+=V+Q.substr(R,M);x>0&&(F+=V+Q.slice(R)),se&&(F="-"+F)}O=Y?F+(S.decimalSeparator||"")+((x=+S.fractionGroupSize)?Y.replace(new RegExp("\\d{"+x+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Y):F}return(S.prefix||"")+O+(S.suffix||"")},U.toFraction=function(p){var C,S,O,E,R,N,M,x,V,F,Y,se,Q=this,be=Q.c;if(p!=null&&(M=new X(p),!M.isInteger()&&(M.c||M.s!==1)||M.lt(oe)))throw Error(s+"Argument "+(M.isInteger()?"out of range: ":"not an integer: ")+L(M));if(!be)return new X(Q);for(C=new X(oe),V=S=new X(oe),O=x=new X(oe),se=b(be),R=C.e=se.length-Q.e-1,C.c[0]=h[(N=R%u)<0?u+N:N],p=!p||M.comparedTo(C)>0?R>0?C:V:M,N=Re,Re=1/0,M=new X(se),x.c[0]=0;F=$(M,C,0,1),E=S.plus(F.times(O)),E.comparedTo(p)!=1;)S=O,O=E,V=x.plus(F.times(E=V)),x=E,C=M.minus(F.times(E=C)),M=E;return E=$(p.minus(S),O,0,1),x=x.plus(E.times(V)),S=S.plus(E.times(O)),x.s=V.s=Q.s,R=R*2,Y=$(V,O,R,z).minus(Q).abs().comparedTo($(x,S,R,z).minus(Q).abs())<1?[V,O]:[x,S],Re=N,Y},U.toNumber=function(){return+L(this)},U.toPrecision=function(p,C){return p!=null&&_(p,1,f),g(this,p,C,2)},U.toString=function(p){var C,S=this,O=S.s,E=S.e;return E===null?O?(C="Infinity",O<0&&(C="-"+C)):C="NaN":(p==null?C=E<=ee||E>=pe?P(b(S.c),E):W(b(S.c),E,"0"):p===10&&at?(S=A(new X(S),B+E+1,z),C=W(b(S.c),S.e,"0")):(_(p,2,Xn.length,"Base"),C=G(W(b(S.c),E,"0"),10,p,O,!0)),O<0&&S.c[0]&&(C="-"+C)),C},U.valueOf=U.toJSON=function(){return L(this)},U._isBigNumber=!0,k!=null&&X.set(k),X}function v(k){var $=k|0;return k>0||k===$?$:$-1}function b(k){for(var $,G,J=1,U=k.length,oe=k[0]+"";J<U;){for($=k[J++]+"",G=u-$.length;G--;$="0"+$);oe+=$}for(U=oe.length;oe.charCodeAt(--U)===48;);return oe.slice(0,U+1||1)}function T(k,$){var G,J,U=k.c,oe=$.c,B=k.s,z=$.s,ee=k.e,pe=$.e;if(!B||!z)return null;if(G=U&&!U[0],J=oe&&!oe[0],G||J)return G?J?0:-z:B;if(B!=z)return B;if(G=B<0,J=ee==pe,!U||!oe)return J?0:!U^G?1:-1;if(!J)return ee>pe^G?1:-1;for(z=(ee=U.length)<(pe=oe.length)?ee:pe,B=0;B<z;B++)if(U[B]!=oe[B])return U[B]>oe[B]^G?1:-1;return ee==pe?0:ee>pe^G?1:-1}function _(k,$,G,J){if(k<$||k>G||k!==o(k))throw Error(s+(J||"Argument")+(typeof k=="number"?k<$||k>G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(k))}function D(k){var $=k.c.length-1;return v(k.e/u)==$&&k.c[$]%2!=0}function P(k,$){return(k.length>1?k.charAt(0)+"."+k.slice(1):k)+($<0?"e":"e+")+$}function W(k,$,G){var J,U;if($<0){for(U=G+".";++$;U+=G);k=U+k}else if(J=k.length,++$>J){for(U=G,$-=J;--$;U+=G);k+=U}else $<J&&(k=k.slice(0,$)+"."+k.slice($));return k}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(ooe)})(sL);var aL=sL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const io=NM(),Moe=xM(),Poe=HM,Ioe=aL,Un={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Dg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:lL,decimalSuffixes:zw}=io.currentBytes(),DM={general:{scale:1024,suffixes:zw},binary:{scale:1024,suffixes:lL},decimal:{scale:1e3,suffixes:zw}};function Aoe(t,e={},n){if(typeof e=="string"&&(e=Poe.parseFormat(e)),!Moe.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",s=Ooe(t,e,n);return s=qoe(s,r),s=Zoe(s,o),s}function Ooe(t,e,n){switch(e.output){case"currency":return e=Xc(e,io.currentCurrencyDefaultFormat()),Foe(t,e,io);case"percent":return e=Xc(e,io.currentPercentageDefaultFormat()),Loe(t,e,io,n);case"byte":return e=Xc(e,io.currentByteDefaultFormat()),Doe(t,e,io,n);case"time":return e=Xc(e,io.currentTimeDefaultFormat()),koe(t);case"ordinal":return e=Xc(e,io.currentOrdinalDefaultFormat()),$oe(t,e,io);case"number":default:return $g({instance:t,providedFormat:e})}}function xoe(t){let e=DM.decimal;return gC(t._value,e.suffixes,e.scale).suffix}function Hoe(t){let e=DM.binary;return gC(t._value,e.suffixes,e.scale).suffix}function Noe(t){let e=DM.general;return gC(t._value,e.suffixes,e.scale).suffix}function gC(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(r>=s&&r<a){i=e[o],t=t/s;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function Doe(t,e,n,i){let r=e.base||"binary",o=Object.assign({},Dg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||zw,marker:"bd"},binary:{scale:1024,suffixes:s||lL,marker:"b"},decimal:{scale:1e3,suffixes:a||zw,marker:"d"}}[r],{value:c,suffix:h}=gC(t._value,u.suffixes,u.scale);return`${$g({instance:i(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function $oe(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Dg,e),o=$g({instance:t,providedFormat:e,state:n}),s=i(t._value);return`${o}${r.spaceSeparated?" ":""}${s}`}function koe(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function Loe(t,e,n,i){let r=e.prefixSymbol,o=$g({instance:i(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Dg,e);return r?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function Foe(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},Dg,r),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=$g({instance:t,providedFormat:r,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Voe({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&i[e]&&Un[e]?(a=i[e],t=t/Un[e]):l>=Un.trillion||n&&s(l/Un.trillion)===1?(a=i.trillion,t=t/Un.trillion):l<Un.trillion&&l>=Un.billion||n&&s(l/Un.billion)===1?(a=i.billion,t=t/Un.billion):l<Un.billion&&l>=Un.million||n&&s(l/Un.million)===1?(a=i.million,t=t/Un.million):(l<Un.million&&l>=Un.thousand||n&&s(l/Un.thousand)===1)&&(a=i.thousand,t=t/Un.thousand),a&&(a=(r?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function Woe({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function Vm(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Boe(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,s=""]=i.split(".");if(+r>0)n=o+s+Vm(r-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Vm(-r-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Vm(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${Vm(e)}`),n}function joe(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Boe(t,e):new Ioe(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Uoe(t,e,n,i,r,o){if(i===-1)return t;let s=joe(e,i,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let u=l.match(/0+$/);return r&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function zoe(t,e,n,i){let r=t,[o,s]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),r=r.slice(1)),o.length<i){let l=i-o.length;for(let u=0;u<l;u++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function Yoe(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function Goe(t,e,n,i,r){let o=i.currentDelimiters(),s=o.thousands;r=r||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),Yoe(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+r+c:l=u,l}function Koe(t,e){return t+e}function Xoe(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function qoe(t,e){return e+t}function Zoe(t,e){return t+e}function $g({instance:t,providedFormat:e,state:n=io,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Dg,r,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,b=s.thousandSeparated,T=s.spaceSeparated,_=s.negative,D=s.forceSign,P=s.exponential,W=s.roundingFunction,k="";if(d){let G=Voe({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:T,roundingFunction:W,totalLength:a});o=G.value,k+=G.abbreviation,a&&(f=G.mantissaPrecision)}if(P){let G=Woe({value:o,characteristicPrecision:l});o=G.value,k=G.abbreviation+k}let $=Uoe(o.toString(),o,m,f,v,W);return $=zoe($,o,u,l),$=Goe($,o,b,n,i),(d||P)&&($=Koe($,k)),(D||o<0)&&($=Xoe($,o,_)),$}function Xc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Joe=t=>({format:(...e)=>Aoe(...e,t),getByteUnit:(...e)=>Noe(...e,t),getBinaryByteUnit:(...e)=>Hoe(...e,t),getDecimalByteUnit:(...e)=>xoe(...e,t),formatOrDefault:Xc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const na=aL;function Qoe(t,e,n){let i=new na(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new na(r),t._value=i.plus(r).toNumber(),t}function uL(t,e,n){let i=new na(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new na(r),t._value=i.minus(r).toNumber(),t}function ese(t,e,n){let i=new na(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new na(r),t._value=i.times(r).toNumber(),t}function tse(t,e,n){let i=new na(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new na(r),t._value=i.dividedBy(r).toNumber(),t}function nse(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function ise(t,e,n){let i=n(t._value);return uL(i,e,n),Math.abs(i._value)}var rse=t=>({add:(e,n)=>Qoe(e,n,t),subtract:(e,n)=>uL(e,n,t),multiply:(e,n)=>ese(e,n,t),divide:(e,n)=>tse(e,n,t),set:(e,n)=>nse(e,n,t),difference:(e,n)=>ise(e,n,t),BigNumber:na});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ose="2.5.0",vs=NM(),sse=xM(),ase=_oe(on),lse=oL();let Ol=Joe(on),au=rse(on);const use=HM;class cL{constructor(e){this._value=e}clone(){return on(this._value)}format(e={}){return Ol.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=use.parseFormat(e)),e=Ol.formatOrDefault(e,vs.currentCurrencyDefaultFormat()),e.output="currency",Ol.format(this,e)}formatTime(e={}){return e.output="time",Ol.format(this,e)}binaryByteUnits(){return Ol.getBinaryByteUnit(this)}decimalByteUnits(){return Ol.getDecimalByteUnit(this)}byteUnits(){return Ol.getByteUnit(this)}difference(e){return au.difference(this,e)}add(e){return au.add(this,e)}subtract(e){return au.subtract(this,e)}multiply(e){return au.multiply(this,e)}divide(e){return au.divide(this,e)}set(e){return au.set(this,hL(e))}value(){return this._value}valueOf(){return this._value}}function hL(t){let e=t;return on.isNumbro(t)?e=t._value:typeof t=="string"?e=on.unformat(t):isNaN(t)&&(e=NaN),e}function on(t){return new cL(hL(t))}on.version=ose;on.isNumbro=function(t){return t instanceof cL};on.language=vs.currentLanguage;on.registerLanguage=vs.registerLanguage;on.setLanguage=vs.setLanguage;on.languages=vs.languages;on.languageData=vs.languageData;on.zeroFormat=vs.setZeroFormat;on.defaultFormat=vs.currentDefaults;on.setDefaults=vs.setDefaults;on.defaultCurrencyFormat=vs.currentCurrencyDefaultFormat;on.validate=sse.validate;on.loadLanguagesInNode=ase.loadLanguagesInNode;on.unformat=lse.unformat;on.BigNumber=au.BigNumber;var cse=on,xl=soe(cse);const hse="numeric";function dL(t,e){if(oi(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!xl.languages()[i]){const o=i.replace("-",""),s=xl.allLanguages?xl.allLanguages[i]:xl[o];s&&xl.registerLanguage(s)}xl.setLanguage(i),t=xl(t).format(r||"0")}return t}function $M(t,e,n,i,r,o,s){let a=o;if(oi(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=dL(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ca(t,e,n,i,r,a,s)}$M.RENDERER_TYPE=hse;const dse="password";function kM(t,e,n,i,r,o,s){ca.apply(this,[t,e,n,i,r,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";he(a-1,()=>{u+=l}),wl(e,u)}kM.RENDERER_TYPE=dse;const fse="select";function LM(t,e,n,i,r,o,s){ca.apply(this,[t,e,n,i,r,o,s])}LM.RENDERER_TYPE=fse;const gse="time";function FM(t,e,n,i,r,o,s){ca.apply(this,[t,e,n,i,r,o,s]),e.dir="ltr"}FM.RENDERER_TYPE=gse;function mse(){ir(Kh),ir(Ng),ir(IM),ir(PM),ir(OM),ir(MM),ir($M),ir(kM),ir(LM),ir(ca),ir(FM)}const pse="autocomplete";function mC(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,lx(n,e)):lx(n,e)(this.source):e(!0)}mC.VALIDATOR_TYPE=pse;function lx(t,e){const n=t;return function(i){let r=!1;for(let o=0,s=i.length;o<s;o++)if(Eg(n,i[o])){r=!0;break}e(r)}}function fL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const wse=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:fL},Symbol.toStringTag,{value:"Module"})),vse="date";function VM(t,e){const n=W$(Zk,this.instance);let i=t,r=!0;i==null&&(i="");let o=K(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=K(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(s=!0,o=!0),s||(r=!1),!s&&o&&(r=!0),s&&!o)if(this.correctFormat===!0){const a=Cse(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}VM.VALIDATOR_TYPE=vse;function Cse(t,e){const n=K(fL(t)),i=K(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const yse="dropdown";function WM(t,e){mC.apply(this,[t,e])}WM.VALIDATOR_TYPE=yse;const bse="numeric";function BM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:oi(t))}BM.VALIDATOR_TYPE=bse;const Sse=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Rse="time";function jM(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const s=K(r,Sse,!0).isValid()?K(r):K(r,n);let a=s.isValid(),l=K(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}jM.VALIDATOR_TYPE=Rse;function Ese(){du(mC),du(WM),du(VM),du(BM),du(jM)}function gL(t){return me(t)&&t.value!==void 0?t.value:t}function mL(t,e,n){const i=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),r=o=>me(o)&&te(o.key)&&te(o.value);return r(i)?r(t)?t:{key:t,value:t}:t}const Tse="autocomplete",_se={CELL_TYPE:Tse,editor:TM,renderer:Kh,validator:mC,valueGetter:gL,valueSetter:mL};function Mse(t,e,n){const{checkedTemplate:i,uncheckedTemplate:r}=this.getCellMeta(e,n),o=Ct(t),s=o===Ct(i),a=o===Ct(r);return s||a?s?i:r:t}const Pse="checkbox",Ise={CELL_TYPE:Pse,editor:qk,renderer:IM,valueSetter:Mse},Ase="date";function pL(t,e,n,i,r,o,s){Kh.apply(this,[t,e,n,i,r,o,s])}pL.RENDERER_TYPE=Ase;const Ose="date",xse={CELL_TYPE:Ose,editor:Jk,renderer:pL,validator:VM};function Hse(t){return gL.call(this,t)}function Nse(t,e,n,i){return mL.call(this,t,e,n,i)}const Dse="dropdown",$se={CELL_TYPE:Dse,editor:Qk,renderer:PM,validator:WM,filter:!1,strict:!0,valueGetter:Hse,valueSetter:Nse},kse="handsontable",Lse={CELL_TYPE:kse,editor:EM,renderer:OM};function Fse(t){if(typeof t=="string"&&j$(t)){const e=U$(t);return af(e)?t:e}return t}const Vse="numeric",Wse={CELL_TYPE:Vse,editor:eL,renderer:$M,validator:BM,dataType:"number",valueSetter:Fse},Bse="password",jse={CELL_TYPE:Bse,editor:tL,renderer:kM,copyable:!1},Use="select",zse={CELL_TYPE:Use,editor:nL,renderer:LM},Yse="time",Gse={CELL_TYPE:Yse,editor:iL,renderer:FM,validator:jM};function Kse(){_r(_se),_r(Ise),_r(xse),_r($se),_r(Lse),_r(Wse),_r(jse),_r(zse),_r(Kk),_r(Gse)}function Xse(t,e){wL(t,e),e.add(t)}function mc(t,e,n){return(e=qse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:e+""}function Zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ux(t,e,n){wL(t,e),e.set(t,n)}function wL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wm(t,e,n){return t.set(UM(t,e),n),n}function Zt(t,e){return t.get(UM(t,e))}function UM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cx=new Map([["plugin",P7],["cell-type",$k],["editor",V$],["renderer",G$],["validator",K$]]),vL=Symbol("mainSetting"),Jse="base",Bm=[];let Hl=null;var an=new WeakMap,Nl=new WeakMap,hx=new WeakSet;class Ye{static get PLUGIN_KEY(){return Jse}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Xse(this,hx),ux(this,an,null),mc(this,"eventManager",new Vr(this)),mc(this,"pluginName",null),mc(this,"pluginsInitializedCallbacks",[]),mc(this,"isPluginsReady",!1),mc(this,"enabled",!1),mc(this,"initialized",!1),ux(this,Nl,{}),ps(this,"hot",e,{writable:!1}),Hl=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!cx.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);cx.get(s)(a)||r.push(` - ${a} (${s})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Bm.push(o)}}if(Hl||(Hl=aT()),Hl.indexOf(this.pluginName)>=0&&Hl.splice(Hl.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Hl.length===0){if(Bm.length>0){const r=[`${Bm.join(`
`)}
`,"You have to import and register them manually."].join("");throw Bm.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var n=this;const i=this.constructor.DEFAULT_SETTINGS,r=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return me(Zt(an,this))?vf(Zt(an,this),i):Zt(an,this);let o;if((Array.isArray(Zt(an,this))||me(Zt(an,this)))&&i[vL]===e)if(Array.isArray(Zt(an,this)))o=Zt(an,this);else{var s;o=(s=Zt(an,this)[e])!==null&&s!==void 0?s:i[e]}else if(e.includes(".")){const a=Mw(Zt(an,this),e),l=Mw(i,e);me(a)?o=vf(a,l):o=a!==void 0?a:l}else me(Zt(an,this))?o=vf(Zt(an,this),i)[e]:o=i[e];if(typeof o=="function"&&r&&typeof r=="object"){const a=r[e];if(a&&typeof a=="function")return function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];const h=o(...u);if(a(h)===!1){const f=u.map(v=>typeof v=="string"?`"${v}"`:"").join(", "),m=u.length>0?f:"";Le(`${n.pluginName} Plugin: "${e}" function (${m}) result                is not valid and will be ignored.`);return}return h}}return o}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){Le(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Wm(an,this,e),Zt(an,this)}return n&&typeof n=="object"&&typeof e=="object"?((Zt(an,this)===null||typeof Zt(an,this)!="object")&&Wm(an,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(i=>{if(!(i in e))return;const r=n[i];if((r?r(e[i]):!0)===!1){Le(`${this.pluginName} Plugin: "${i}" option is not valid and it will be ignored.`);return}Zt(an,this)[i]=e[i]}),Zt(an,this)):(Wm(an,this,e),e)}addHook(e,n,i){Zt(Nl,this)[e]=Zt(Nl,this)[e]||[];const r=Zt(Nl,this)[e];this.hot.addHook(e,n,i),r.push(n),Zt(Nl,this)[e]=r}removeHooks(e){I(Zt(Nl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Zt(Nl,this);Fe(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){I(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=UM(hx,this,Qse).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Wm(an,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Fe(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function Qse(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Dl(t,e,n){return(e=eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eae(t){var e=tae(t,"string");return typeof e=="symbol"?e:e+""}function tae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let zM=class{constructor(e){Dl(this,"hot",null),Dl(this,"container",null),Dl(this,"injected",!1),Dl(this,"rows",[]),Dl(this,"columns",[]),Dl(this,"samples",null),Dl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),I(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),I(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{I(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{I(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{I(r.strings,o=>{const s=o.col,a=e.createElement("th");i.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),I(i,r=>{const[o,s]=r;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{I(r.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let s=e+1;s<e+r;s++)o+=this.hot.getColWidth(s);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(l),r.appendChild(s),j(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return j(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Ed(t,e,n){return(e=nae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pC{static get SAMPLE_COUNT(){return 3}constructor(e){Ed(this,"samples",null),Ed(this,"dataFactory",null),Ed(this,"customSampleCount",null),Ed(this,"allowDuplicates",!1),Ed(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:pC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:s}=typeof i=="number"?{from:i,to:i}:i;return he(o,s,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",s=[];return he(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a,this):this.dataFactory(a,i,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:me(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Ct(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),r}}function rae(t,e){CL(t,e),e.add(t)}function yb(t,e,n){CL(t,e),e.set(t,n)}function CL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Td(t,e,n){return(e=oae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oae(t){var e=sae(t,"string");return typeof e=="symbol"?e:e+""}function sae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qa(t,e){return t.get(Vi(t,e))}function Yw(t,e,n){return t.set(Vi(t,e),n),n}function Vi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutoColumnSizeSeed");const bb="autoColumnSize",aae=10,lae="autoColumnSize";var YM=new WeakMap,qc=new WeakMap,xh=new WeakMap,rr=new WeakSet;class Ef extends Ye{static get PLUGIN_KEY(){return bb}static get PLUGIN_PRIORITY(){return aae}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),rae(this,rr),Td(this,"ghostTable",new zM(this.hot)),Td(this,"samplesGenerator",new pC((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,i);let a="";s.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Td(this,"inProgress",!1),Td(this,"measuredColumns",0),Td(this,"columnWidthsMap",new vl),yb(this,YM,!1),yb(this,qc,[]),yb(this,xh,[]),this.hot.columnIndexMapper.registerMap(lae,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>Vi(rr,this,dx).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[bb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Vi(rr,e,hae).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Vi(rr,e,dae).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Vi(rr,e,gae).call(e,...r)}),this.addHook("beforeRender",()=>Vi(rr,this,cae).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>Vi(rr,this,fae).call(this)),super.enablePlugin()}updatePlugin(){Yw(xh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>Vi(rr,this,dx).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;he(r.from,r.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Vi(rr,this,yL).call(this,s,o)}),this.ghostTable.columns.length&&(Vi(rr,this,bL).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Gf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Ef.CALCULATION_STEP,r)},e,n),i=i+Ef.CALCULATION_STEP+1,i<r?o=Yf(s):(Gf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[bb];let n=Ef.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return me(e)&&(n=e.syncLimit,k0(n)?n=oT(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Mh))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const s=Qa(qc,this).length;return(s-1<o||Qa(qc,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),s-1<o?Qa(qc,this).push(r):Qa(qc,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function uae(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||Vi(rr,this,yL).call(this,n,e))}),this.ghostTable.columns.length&&(Vi(rr,this,bL).call(this),this.ghostTable.clean())}function yL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function bL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function cae(){this.calculateVisibleColumnsWidth(),this.inProgress||(Vi(rr,this,uae).call(this,Qa(xh,this)),Yw(xh,this,[]))}function hae(t,e){e||this.recalculateAllColumnsWidth()}function dae(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Qa(xh,this).push(...e)}function dx(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function fae(){Yw(qc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Yw(YM,this,!0)}function gae(t){if(!Qa(YM,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Qa(xh,this).push(...e)}const bu={horizontal:"horizontal",vertical:"vertical"};function mae(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function pae(t){const e={};return t===!0?(e.directions=Object.keys(bu),e.autoInsertRow=!0):me(t)?(te(t.autoInsertRow)?t.direction===bu.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,te(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(bu)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function wae(t,e){vae(t,e),e.add(t)}function vae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=yae(t,"string");return typeof e=="symbol"?e:e+""}function yae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutofillRange");re.getSingleton().register("beforeAutofill");re.getSingleton().register("afterAutofill");const fx="autofill",bae=20,Sae=["fillHandle"],Rae="insert_row_below",Eae=200;var $l=new WeakSet;class Tae extends Ye{constructor(){super(...arguments),wae(this,$l),pc(this,"addingStarted",!1),pc(this,"mouseDownOnCellCorner",!1),pc(this,"mouseDragOutside",!1),pc(this,"handleDraggedCells",0),pc(this,"directions",[]),pc(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return fx}static get PLUGIN_PRIORITY(){return bae}static get SETTING_KEYS(){return[fx,...Sae]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>wc($l,this,Pae).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>wc($l,this,Mae).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>wc($l,this,Iae).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:i,col:r}=n.getTopStartCorner(),{row:o,col:s}=n.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:i,startCol:r,endRow:o,endCol:s}]),l=[],u=[],c=[];return I(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)u.indexOf(d)===-1&&u.push(d)}),I(l,h=>{const d=[];I(u,f=>{const m=e?this.hot.getSourceDataAtCell(h,f):null;e&&me(m)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=mae(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=this.getSelectionData(!0),v=o.clone(),b=this.hot._createCellRange(h,h,d),T=this.hot.runHooks("beforeAutofill",f,v,b,c);if(T===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let _=T;const D=T;if(["up","left"].indexOf(c)>-1&&!(D.length===1&&D[0].length===0))if(_=[],c==="up"){const P=d.row-h.row+1,W=P%D.length;for(let k=0;k<P;k++)_.push(D[(k+(D.length-W))%D.length])}else{const P=d.col-h.col+1,W=P%D[0].length;for(let k=0;k<D.length;k++){_.push([]);for(let $=0;$<P;$++)_[k].push(D[k][($+(D[k].length-W))%D[k].length])}}if(m.some(P=>P.some(W=>me(W)))){const P=wc($l,this,_ae).call(this,_,m,h,d,c);P.length&&(_=P)}this.hot.populateFromArray(h.row,h.col,_,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",_,v,b,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(bu.vertical)&&this.directions.includes(bu.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(bu.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(bu.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Rae,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Eae)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Gt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Gt(s)||!Gt(a))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Qe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=Kn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+cn(this.hot.table),r=Kn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+nn(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>wc($l,this,Aae).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>wc($l,this,Oae).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=pae(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function _ae(t,e,n,i){const r=[];for(let o=Math.min(n.row,i.row);o<=Math.max(n.row,i.row);o+=1){r.push([]);for(let s=Math.min(n.col,i.col);s<=Math.max(n.col,i.col);s+=1){const a=this.hot.getSourceDataAtCell(o,s),l=o-Math.min(n.row,i.row),u=s-Math.min(n.col,i.col),c=l%e.length,h=u%e[0].length;me(a)?r[l][u]=e[c][h]:r[l][u]=t[c][h]}}return r}function Mae(){this.selectAdjacent()&&this.fillIn()}function Pae(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Iae(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Aae(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Oae(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function xae(t,e){SL(t,e),e.add(t)}function gx(t,e,n){SL(t,e),e.set(t,n)}function SL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vc(t,e,n){return(e=Hae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hae(t){var e=Nae(t,"string");return typeof e=="symbol"?e:e+""}function Nae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RL(t,e,n){return t.set(sr(t,e),n),n}function Gw(t,e){return t.get(sr(t,e))}function sr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sb="autoRowSize",Dae=40,$ae="autoRowSize",mx="htFirstDatasetColumnNotRendered",px="htAutoRowSize";var Qf=new WeakMap,GM=new WeakMap,Mr=new WeakSet;class Tf extends Ye{static get PLUGIN_KEY(){return Sb}static get PLUGIN_PRIORITY(){return Dae}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),xae(this,Mr),vc(this,"headerHeight",null),vc(this,"ghostTable",new zM(this.hot)),vc(this,"samplesGenerator",new pC((n,i)=>{const r=this.hot.toPhysicalColumn(i);if(this.hot.columnIndexMapper.isHidden(r)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,i):n===-1&&(o=this.hot.getColHeader(i)),{value:o}})),vc(this,"inProgress",!1),vc(this,"measuredRows",0),vc(this,"rowHeightsMap",new vl),gx(this,Qf,[]),gx(this,GM,!1),this.hot.rowIndexMapper.registerMap($ae,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>sr(Mr,this,wx).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[Sb];return e===!0||me(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return sr(Mr,e,Vae).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return sr(Mr,e,Wae).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return sr(Mr,e,jae).call(e,...r)}),this.addHook("beforeViewRender",()=>sr(Mr,this,Lae).call(this)),this.addHook("beforeRender",()=>sr(Mr,this,Fae).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>sr(Mr,this,Bae).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),j(this.hot.rootElement,px),super.enablePlugin()}disablePlugin(){this.headerHeight=null,ae(this.hot.rootElement,px),super.disablePlugin(),sr(Mr,this,EL).call(this,!1),this.addHook("beforeRowResize",(e,n,i)=>sr(Mr,this,wx).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}he(r.from,r.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Gf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Tf.CALCULATION_STEP,r)},e,n),i=i+Tf.CALCULATION_STEP+1,i<r?o=Yf(s):(Gf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Sb];let n=Tf.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return me(e)&&(n=e.syncLimit,k0(n)?n=oT(i,n):n>>=0),Math.min(n,i)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(e);if(e<0){var i;return(i=this.headerHeight)!==null&&i!==void 0?i:n}const r=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(r))return n;const o=this.rowHeightsMap.getValueAtIndex(r);let s=n;return o!==null&&o>n&&(s=o,!this.hot.stylesHandler.isClassicTheme()&&e===this.hot.view.getFirstRenderedVisibleRow()&&(s+=1)),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{he(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function kae(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function EL(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?ae(this.hot.rootElement,mx):j(this.hot.rootElement,mx)}function Lae(){sr(Mr,this,EL).call(this)}function Fae(){this.calculateVisibleRowsHeight(),this.inProgress||(sr(Mr,this,kae).call(this,Gw(Qf,this)),RL(Qf,this,[]))}function wx(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Vae(t,e){e||this.recalculateAllRowsHeight()}function Wae(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);Gw(Qf,this).push(...e)}function Bae(){this.recalculateAllRowsHeight(),RL(GM,this,!0)}function jae(t){if(!Gw(GM,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Gw(Qf,this).push(...e)}const{getListWithInsertedItems:Uae,getListWithRemovedItems:zae}=pk("physicallyIndexed");class Yae extends Zu{constructor(){super(e=>e)}insert(e,n){const i=OT(this.indexedValues,n);this.indexedValues=Uae(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=zae(this.indexedValues,e);this.indexedValues=AT(n,e),super.remove(e)}}const{getListWithInsertedItems:Gae,getListWithRemovedItems:Kae}=pk("physicallyIndexed");class Xae extends Zu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Gae(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=Kae(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function qae(t,e){Zae(t,e),e.add(t)}function Zae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jae(t,e,n){return(e=Qae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qae(t){var e=ele(t,"string");return typeof e=="symbol"?e:e+""}function ele(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tle(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vx="bindRowsWithHeaders",nle=210,ile="loose",Cx=new Map([["loose",Yae],["strict",Xae]]);var yx=new WeakSet;class rle extends Ye{constructor(){super(...arguments),qae(this,yx),Jae(this,"headerIndexes",null)}static get PLUGIN_KEY(){return vx}static get PLUGIN_PRIORITY(){return nle}isEnabled(){return!!this.hot.getSettings()[vx]}enablePlugin(){var e;if(this.enabled)return;const n=(e=Cx.get(this.getSetting()))!==null&&e!==void 0?e:Cx.get(ile);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>tle(yx,this,ole).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ole(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function sle(t,e){TL(t,e),e.add(t)}function ale(t,e,n){TL(t,e),e.set(t,n)}function TL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bx(t,e,n){return(e=lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lle(t){var e=ule(t,"string");return typeof e=="symbol"?e:e+""}function ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sx(t,e){return t.get(ah(t,e))}function Rb(t,e,n){return t.set(ah(t,e),n),n}function ah(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nw="collapsibleColumns",cle=290,hle=["nestedHeaders"],yh="collapsibleIndicator",Rx=nw,Ex=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Cc=new WeakMap,_d=new WeakSet;class dle extends Ye{constructor(){super(...arguments),sle(this,_d),bx(this,"nestedHeadersPlugin",null),bx(this,"headerStateManager",null),ale(this,Cc,null)}static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return cle}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[nw,...hle]}isEnabled(){return!!this.hot.getSettings()[nw]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Le("You need to configure the Nested Headers plugin in order to use collapsible headers."),Rb(Cc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ah(_d,this,mle).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ah(_d,e,ple).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ah(_d,e,fle).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>ah(_d,this,gle).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Rb(Cc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeActive().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:Rx,relativeToGroup:Cl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Rx)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};he(0,e-1,s=>{const a=n.childNodes[s],l=i.childNodes[s],u=r?r.childNodes[s]:null;he(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${yh}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${yh}`),o(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${yh}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(r===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!Ex.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=ul(e,f=>{let{row:m}=f;return m<0});let r=i.length>0;I(i,f=>{var m;let{row:v,col:b}=f;const{collapsible:T,isCollapsed:_}=(m=this.headerStateManager.getHeaderSettings(v,b))!==null&&m!==void 0?m:{};if(!T||_&&n==="collapse"||!_&&n==="expand")return r=!1,!1});const o=[],s=[];r&&I(i,f=>{let{row:m,col:v}=f;const{colspanCompensation:b,affectedColumns:T,rollbackModification:_}=this.headerStateManager.triggerNodeModification(n,m,v);b>0&&(s.push(...T),o.push(_))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=YD([...a,...s]):n==="expand"&&(l=ul(a,f=>!s.includes(f)));const u=Ex.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){I(o,f=>{f()});return}this.hot.batchExecution(()=>{I(s,f=>{Sx(Cc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const b=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,T=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;b!==null&&T!==null&&this.hot.selectCell(b,T)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return Sx(Cc,this).getHiddenIndexes()}destroy(){Rb(Cc,this,null),super.destroy()}}function fle(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${yh}`);if(ss(e,[Lr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),j(u,yh),e.querySelector("div:first-child").appendChild(u)),ae(u,["collapsed","expanded"]),s?(j(u,"collapsed"),hl(u,"+"),l&&le(e,...Lr(!1))):(j(u,"expanded"),hl(u,"-"),l&&le(e,...Lr(!0))),l&&le(u,...Xu());else{var c;(c=u)===null||c===void 0||c.remove()}}function gle(t,e){Ce(t.target,yh)&&(Ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),gr(t))}function mle(){this.updatePlugin()}function ple(t,e){e||this.updatePlugin()}function kl(t,e,n){return(e=wle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wle(t){var e=vle(t,"string");return typeof e=="symbol"?e:e+""}function vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cle=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],yle=!1,ble=!0,Sle=!0;class Rle{constructor(e,n){kl(this,"hot",void 0),kl(this,"sortingStates",new aC),kl(this,"sortEmptyCells",yle),kl(this,"indicator",ble),kl(this,"headerAction",Sle),kl(this,"compareFunctionFactory",void 0),kl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){me(e)&&Fe(e,(n,i)=>{Cle.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return me(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(te(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function _L(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:s}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?ls:Gt(r)?Gt(o)?ls:s&&t==="asc"?jt:Ut:Gt(o)?s&&t==="asc"?Ut:jt:isNaN(r)&&!isNaN(o)?t==="asc"?Ut:jt:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?jt:Ut:r>o?t==="asc"?Ut:jt:ls}}const ML="default";function Ele(t,e,n){return function(i,r){const o=parseFloat(i),s=parseFloat(r),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ls;if(a){if(Gt(i))return t==="asc"?jt:Ut;if(Gt(r))return t==="asc"?Ut:jt}return isNaN(o)?Ut:isNaN(s)?jt:o<s?t==="asc"?jt:Ut:o>s?t==="asc"?Ut:jt:ls}}const Tle="numeric";function _le(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Gt(s),u=Gt(a),c=l?r:s,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(o===!1){if(l&&u===!1)return Ut;if(l===!1&&u)return jt}return d===!1&&f?t==="asc"?jt:Ut:d&&f===!1?t==="asc"?Ut:jt:d===!1&&f===!1?_L(t,e,n)(s,a):c===r&&h===i?t==="asc"?jt:Ut:c===i&&h===r?t==="asc"?Ut:jt:ls}}const Mle="checkbox";function Ple(t,e,n){return HL(t,e.dateFormat,n)}const Ile="date";function Ale(t,e,n){return HL(t,e.timeFormat,n)}const Ole="time",{register:kg,getItem:Tx,hasItem:xle}=Ur("sorting.compareFunctionFactory"),{register:PL,getItem:Hle}=Ur("sorting.mainSortComparator");function IL(t){return xle(t)?Tx(t):Tx(ML)}kg(Mle,_le);kg(Ile,Ple);kg(ML,_L);kg(Tle,Ele);kg(Ole,Ale);const ls=0,jt=-1,Ut=1;function Nle(t,e){const n=Hle(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const Kw="asc",Xw="desc",AL="colHeader";function Dle(t){if(me(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Kw,Xw].includes(n)}function $le(t){if(t.some(n=>Dle(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function _x(t){if(t!==Xw)return t===Kw?Xw:Kw}function OL(t){return t.querySelector(`.${AL}`)}function xL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function KM(t,e,n){return t===-1&&e>=0&&fl(n)===!1}function HL(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return ls;if(Gt(i))return Gt(r)?ls:o&&t==="asc"?jt:Ut;if(Gt(r))return o&&t==="asc"?Ut:jt;const s=K(i,e),a=K(r,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?jt:Ut:a.isBefore(s)?t==="asc"?Ut:jt:ls:jt:Ut}}function kle(t,e){Le(et`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Lle="ascending",Fle="descending",NL="indicatorDisabled",DL="columnSorting",$L="sortAction",kL=new Map([[Kw,Lle],[Xw,Fle]]);function Vle(t,e,n,i){const r=[DL];if(i&&r.push($L),n===!1)return r.push(NL),r;const o=t.getSortOrderOfColumn(e);return te(o)&&r.push(kL.get(o)),r}function Wle(){return Array.from(kL.values()).concat($L,NL,DL)}function Ble(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:IL(u.type))(l,u,d)(c,h)}(0)}}function jle(t,e){Ule(t,e),e.add(t)}function Ule(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jm(t,e,n){return(e=zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qw="columnSorting",Gle=50,Zw="append",Kle="replace",Mx=qw;PL(qw,Ble);re.getSingleton().register("beforeColumnSort");re.getSingleton().register("afterColumnSort");const Md=new WeakMap;var lu=new WeakSet;class LL extends Ye{constructor(){super(...arguments),jle(this,lu),jm(this,"columnStatesManager",null),jm(this,"columnMetaCache",null),jm(this,"pluginKey",qw),jm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return qw}static get PLUGIN_PRIORITY(){return Gle}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Md.has(this.hot)&&Md.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),kle(Md.get(this.hot),this.pluginKey);return}this.enabled||(Md.set(this.hot,this.pluginKey),this.columnStatesManager=new Rle(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new vl(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>Zc(lu,this,Xle).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zc(lu,e,Zle).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>Zc(lu,this,lE).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Zc(lu,e,qle).call(e,...i)}),this.hot.view&&Zc(lu,this,lE).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=OL(i);xL(n,i)===!1||r===null||this.updateHeaderClasses(r)};Md.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Cl,position:"before",group:Mx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Mx)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new wk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return te(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return $le(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...s}=r;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Qe(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...s}=r;return{column:this.hot.toVisualColumn(o),...s}};return te(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Qe(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(te(n)){const r=_x(n);return te(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:_x()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zw;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(r){if(Tt(s))return[...o.slice(0,i),...o.slice(i+1)];if(n===Zw)return[...o.slice(0,i),...o.slice(i+1),s];if(n===Kle)return[...o.slice(0,i),s,...o.slice(i+1)]}return te(s)?o.concat(s):o}getPluginColumnConfig(e){if(me(e)){const n=e[this.pluginKey];if(me(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):nt(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>Qe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const o=Qe(n,u=>u[0]);Nle(n,this.pluginKey,Qe(e,u=>u.sortOrder),Qe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const s=Qe(n,u=>u[0]),a=new Map(Qe(o,(u,c)=>[u,s[c]])),l=Qe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(me(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||me(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ae(e,Wle()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];j(e,Vle(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),te(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ce(e.target,AL)}onAfterOnCellMouseDown(e,n){if(KM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function lE(){const t=this.getAllSavedSortSettings();if(me(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Xle(t,e){const n=OL(e);if(xL(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);le(e,...F9(s?`${s}ending`:"none"))}}function qle(t){t===!0&&this.hot.view&&Zc(lu,this,lE).call(this)}function Zle(t,e,n,i){KM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Eb(t){return t==null||isNaN(t)}function Jle(t,e){if(typeof t!="number")return t;const n=i=>i.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const i=Math.round(t).toString().length;return n(t.toFixed(8-i))}return t;default:return t}}function Ll(t,e,n){return(e=Qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qle(t){var e=eue(t,"string");return typeof e=="symbol"?e:e+""}function eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tue{constructor(e,n){Ll(this,"plugin",void 0),Ll(this,"hot",void 0),Ll(this,"endpoints",[]),Ll(this,"settings",void 0),Ll(this,"settingsType","array"),Ll(this,"currentEndpoint",null),Ll(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),I(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();I(o,s=>{r==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),r==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(o==="auto")return;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;I(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?I(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):I(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){I(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];I(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));r.push(s)}),I(r,o=>{let s=[];I(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),i.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,I(e.ranges,i=>{I(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,s=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],I(e,r=>{this.resetEndpointValue(r,n)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],I(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],I(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&I(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[r][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),I(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.result=Jle(e.result,e.roundFloat),i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Le("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function nue(t,e){iue(t,e),e.add(t)}function iue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rue(t,e,n){return(e=oue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oue(t){var e=sue(t,"string");return typeof e=="symbol"?e:e+""}function sue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Tb="columnSummary",aue=220;var Fl=new WeakSet;class lue extends Ye{constructor(){super(...arguments),nue(this,Fl),rue(this,"endpoints",null)}static get PLUGIN_KEY(){return Tb}static get PLUGIN_PRIORITY(){return aue}isEnabled(){return!!this.hot.getSettings()[Tb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Tb],this.endpoints=new tue(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,uue).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,hue).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,cue).call(e,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,due).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,fue).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yc(Fl,e,gue).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Fe(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(r,n),o=Eb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**s)/10**s}calculateMinMax(e,n){let i=null;return Fe(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Eb(s)?null:s,r===null)r=s;else if(s!==null)switch(i){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=Eb(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return Fe(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,s=this.countEmpty(r,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(i!==null&&r!==null&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(et`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function uue(){this.endpoints.initEndpoints()}function cue(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function hue(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function due(t,e){e||this.endpoints.refreshAllEndpoints()}function fue(t,e){e||this.endpoints.refreshAllEndpoints()}function gue(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function mue(t,e){FL(t,e),e.add(t)}function _b(t,e,n){FL(t,e),e.set(t,n)}function FL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jc(t,e){return t.get(XM(t,e))}function uE(t,e,n){return t.set(XM(t,e),n),n}function XM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jw=new WeakMap,Um=new WeakMap,zm=new WeakMap,Px=new WeakSet;class VL{constructor(){mue(this,Px),_b(this,Jw,!0),_b(this,Um,null),_b(this,zm,new ResizeObserver(e=>XM(Px,this,pue).call(this,e)))}setObservedElement(e){uE(Um,this,e)}unobserve(){Jc(zm,this).unobserve(Jc(Um,this))}observe(){uE(Jw,this,!0),Jc(zm,this).observe(Jc(Um,this))}destroy(){Jc(zm,this).disconnect()}}function pue(t){if(Jc(Jw,this)||!Array.isArray(t)||!t.length){uE(Jw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}st(VL,An);function Ca(t,e,n){wue(t,e),e.set(t,n)}function wue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(WL(t,e))}function xo(t,e,n){return t.set(WL(t,e),n),n}function WL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bc=new WeakMap,Mb=new WeakMap,Pb=new WeakMap,As=new WeakMap,ya=new WeakMap,ba=new WeakMap,Ym=new WeakMap,Sc=new WeakMap;class Su{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,i){var r=this;Ca(this,bc,void 0),Ca(this,Mb,void 0),Ca(this,Pb,!1),Ca(this,As,null),Ca(this,ya,void 0),Ca(this,ba,void 0),Ca(this,Ym,!0),Ca(this,Sc,new VL),xo(bc,this,e),xo(Mb,this,i),xo(Pb,this,n),xo(ya,this,this.createEditor()),xo(ba,this,mt(ya,this).style),mt(Sc,this).setObservedElement(this.getInputElement()),mt(Sc,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){mt(ba,this).left=`${e}px`,mt(ba,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:nn(this.getInputElement()),height:cn(this.getInputElement())}}observeSize(){mt(Sc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(ba,this).display="block",xo(Ym,this,!1)}hide(){mt(Sc,this).unobserve(),mt(Ym,this)||(mt(ba,this).display="none"),xo(Ym,this,!0)}isVisible(){return mt(ba,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(bc,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(bc,this).createElement("div"),n=mt(bc,this).createElement("textarea");return e.style.display="none",xo(As,this,mt(bc,this).createElement("div")),mt(As,this).setAttribute("dir",mt(Pb,this)?"rtl":"ltr"),j(mt(As,this),Su.CLASS_EDITOR_CONTAINER),mt(Mb,this).appendChild(mt(As,this)),j(e,Su.CLASS_EDITOR),j(n,Su.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(As,this).appendChild(e),e}getInputElement(){return mt(ya,this).querySelector(`.${Su.CLASS_INPUT}`)}getEditorElement(){return mt(ya,this)}destroy(){const e=mt(As,this)?mt(As,this).parentNode:null;mt(ya,this).parentNode.removeChild(mt(ya,this)),xo(ya,this,null),xo(ba,this,null),mt(Sc,this).destroy(),e&&e.removeChild(mt(As,this))}}st(Su,An);function Ib(t,e,n){return(e=vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vue(t){var e=Cue(t,"string");return typeof e=="symbol"?e:e+""}function Cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yue=250,bue=250;class BL{constructor(e){Ib(this,"wasLastActionShow",!0),Ib(this,"showDebounced",null),Ib(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},bue)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yue;this.showDebounced=Pg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}st(BL,An);function Sue(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Rue(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Vl(t,e){const n={};return I(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function Wa(t,e,n,i,r){I(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Eue(s,a,e,n,i,r)})})}function Eue(t,e,n,i,r,o){const s=r(t,e);let a=i;s.className&&(n==="vertical"?a=Sue(s.className,i):a=Rue(s.className,i)),o(t,e,"className",a)}function jL(t){return`<span class="selected">â</span>${t}`}function iw(t,e){let n=!1;return Array.isArray(t)&&I(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function wC(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const je="---------";function Tue(){return{name:je}}const Ar="alignment";function _ue(){return{key:Ar,name(){return this.getTranslatedPhrase(r_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ar}:left`,name(){return this.getTranslatedPhrase(o_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:center`,name(){return this.getTranslatedPhrase(s_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:right`,name(){return this.getTranslatedPhrase(a_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:justify`,name(){return this.getTranslatedPhrase(l_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{name:je},{key:`${Ar}:top`,name(){return this.getTranslatedPhrase(u_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:middle`,name(){return this.getTranslatedPhrase(c_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:bottom`,name(){return this.getTranslatedPhrase(h_)},callback(){const t=this.getSelectedRange(),e=Vl(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),Wa(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1}]}}}const vC="clear_column";function Mue(){return{key:vC,name(){return this.getTranslatedPhrase(UT)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const Lg="col_left";function Pue(){return{key:Lg,name(){return this.getTranslatedPhrase(LT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Fg="col_right";function Iue(){return{key:Fg,name(){return this.getTranslatedPhrase(FT)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Vg="make_read_only";function Aue(){return{key:Vg,checkable:!0,ariaChecked(){return iw(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase($w)},name(){let t=this.getTranslatedPhrase($w);return iw(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=jL(t)),t},callback(){const t=this.getSelectedRange(),e=iw(t,(n,i)=>this.getCellMeta(n,i).readOnly);I(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const CC="redo";function Oue(){return{key:CC,name(){return this.getTranslatedPhrase(jT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Wg="remove_col";function xue(){return{key:Wg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(WT,e)},callback(){this.alter("remove_col",xte(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const yC="remove_row";function Hue(){return{key:yC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(VT,e)},callback(){this.alter("remove_row",Hte(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const bC="row_above";function Nue(){return{key:bC,name(){return this.getTranslatedPhrase($T)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const SC="row_below";function Due(){return{key:SC,name(){return this.getTranslatedPhrase(kT)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const eg="no_items";function $ue(){return{key:eg,name(){return this.getTranslatedPhrase(DT)},disabled:!0,isCommand:!1}}const RC="undo";function kue(){return{key:RC,name(){return this.getTranslatedPhrase(BT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Lue=[bC,SC,Lg,Fg,vC,yC,Wg,RC,CC,Vg,Ar,je,eg],Fue={[je]:Tue,[eg]:$ue,[bC]:Nue,[SC]:Due,[Lg]:Pue,[Fg]:Iue,[vC]:Mue,[yC]:Hue,[Wg]:xue,[RC]:kue,[CC]:Oue,[Vg]:Aue,[Ar]:_ue};function UL(){const t={};return Fe(Fue,(e,n)=>{t[n]=e()}),t}function Vue(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(t_):this.getTranslatedPhrase(e_)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Wue(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(n_)},callback(){this.getSelectedRangeActive().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Bue(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(i_);return iw(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,rw))?jL(e):e},callback(){this.getSelectedRangeActive().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,rw);t.updateCommentMeta(n,i,{[rw]:!r})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function jue(t,e){zL(t,e),e.add(t)}function Wl(t,e,n){zL(t,e),e.set(t,n)}function zL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uue(t,e,n){return(e=zue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zue(t){var e=Yue(t,"string");return typeof e=="symbol"?e:e+""}function Yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ts(t,e,n){return t.set(_n(t,e),n),n}function $e(t,e){return t.get(_n(t,e))}function _n(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qw="comments",Gue=60,Bs="comment",uf="value",YL="style",rw="readOnly",Pd=Qw,cE=`plugin:${Qw}`;var wt=new WeakMap,Ko=new WeakMap,EC=new WeakMap,ow=new WeakMap,ev=new WeakMap,hE=new WeakMap,tv=new WeakMap,$n=new WeakSet;class Kue extends Ye{constructor(){super(...arguments),jue(this,$n),Uue(this,"range",{}),Wl(this,wt,null),Wl(this,Ko,null),Wl(this,EC,!1),Wl(this,ow,!1),Wl(this,ev,!1),Wl(this,hE,null),Wl(this,tv,"")}static get PLUGIN_KEY(){return Qw}static get PLUGIN_PRIORITY(){return Gue}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Qw]}enablePlugin(){var e=this;this.enabled||($e(wt,this)||(ts(wt,this,new Su(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),$e(wt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return _n($n,e,nce).call(e,...i)}),this.hot.addHook("afterSetTheme",(n,i)=>{i||this.hide()})),$e(Ko,this)||ts(Ko,this,new BL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,s,a)=>_n($n,this,Que).call(this,n,a)),this.addHook("afterScroll",()=>_n($n,this,ice).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>_n($n,this,Ix).call(this,n)),this.addHook("beforeCompositionStart",n=>_n($n,this,Ix).call(this,n)),$e(Ko,this).addLocalHook("hide",()=>this.hide()),$e(Ko,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){$e(Ko,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(cE);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeActive();ts(ow,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(cE),this.hot._registerTimeout(()=>{ts(ow,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isCell()},group:Pd}),i.addShortcut({keys:[["Escape"]],callback:()=>{$e(wt,this).setValue($e(tv,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>$e(wt,this).isVisible()&&$e(wt,this).isFocused(),group:Pd}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>$e(wt,this).isVisible()&&$e(wt,this).isFocused(),group:Pd}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{ts(ev,this,!0),$e(wt,this).setValue($e(wt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Pd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Pd)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>_n($n,this,Zue).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_n($n,this,Xue).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_n($n,this,Jue).call(this)),this.eventManager.addEventListener(n,"focus",()=>_n($n,this,tce).call(this)),this.eventManager.addEventListener(n,"blur",()=>_n($n,this,ece).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>_n($n,this,que).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=cl(e.target,"TD","TBODY");return!!(n&&Ce(n,"htCommentCell")&&cl(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=$e(wt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const{row:r,col:o}=_n($n,this,Qc).call(this);this.updateCommentMeta(r,o,{[uf]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=_n($n,this,Qc).call(this);this.hot.setCellMeta(n,i,Bs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const{row:e,col:n}=_n($n,this,Qc).call(this);return this.getCommentMeta(e,n,uf)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,uf)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=_n($n,this,Qc).call(this);if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(n,i);return $e(Ko,this).cancelHiding(),$e(wt,this).setValue((e=r[Bs]?r[Bs][uf]:null)!==null&&e!==void 0?e:""),$e(wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){$e(wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!$e(wt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=_n($n,this,Qc).call(this);let s=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(o);const l=s===null;$e(wt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(r,o,YL);v?$e(wt,this).setSize(v.width,v.height):$e(wt,this).resetSize();const b=c?0:f.getColumnWidth(a),T=l&&!u?cn(m):0,{left:_,top:D,width:P,height:W}=m.getBoundingClientRect(),{width:k,height:$}=$e(wt,this).getSize(),{innerWidth:G,innerHeight:J}=this.hot.rootWindow,U=this.hot.rootDocument.documentElement,oe=rn(this.hot.rootDocument),B=X0(this.hot.rootWindow)?oe:0,z=q0(this.hot.rootWindow)?oe:0;let ee=_+h.scrollX+b,pe=D+h.scrollY+T;this.hot.isRtl()&&(ee-=k+b),this.hot.isLtr()&&_+P+k>G-B?ee=_+h.scrollX-k-1:this.hot.isRtl()&&ee<-(U.scrollWidth-U.clientWidth)&&(ee=_+h.scrollX+b+1),D+$>J-z&&(pe-=$-W+1),$e(wt,this).setPosition(ee,pe),$e(wt,this).setReadOnlyState(this.getCommentMeta(r,o,rw)),$e(wt,this).observeSize()}focusEditor(){$e(wt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[Bs];let o;r?(o=ui(r),Rg(o,i)):o=i,this.hot.setCellMeta(e,n,Bs,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[Bs])return r[Bs][i]}addToContextMenu(e){e.items.push({name:je},Vue(this),Wue(this),Bue(this))}getEditorInputElement(){return $e(wt,this).getInputElement()}destroy(){var e,n;(e=$e(wt,this))===null||e===void 0||e.destroy(),(n=$e(Ko,this))===null||n===void 0||n.destroy(),super.destroy()}}function Xue(t){if(!(!this.hot.view||!this.hot.view._wt)&&!$e(EC,this)&&!this.targetIsCommentTextArea(t)){const e=cl(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function que(t){t.stopPropagation()}function Zue(t){const{rootDocument:e}=this.hot;if(!($e(EC,this)||$e(wt,this).isFocused()||Ce(t.target,"wtBorder")||$e(hE,this)===t.target||!$e(wt,this)))if(ts(hE,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));$e(Ko,this).show(n)}else ol(t.target,e)&&!this.targetIsCommentTextArea(t)&&$e(Ko,this).hide()}function Jue(){ts(EC,this,!1)}function Que(t,e){e[Bs]&&e[Bs][uf]&&j(t,e.commentedCellClassName)}function ece(){if($e(ev,this)){ts(ev,this,!1);return}ts(tv,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function tce(){ts(tv,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(cE)}function nce(t,e){const{row:n,col:i}=_n($n,this,Qc).call(this);this.updateCommentMeta(n,i,{[YL]:{width:t,height:e}})}function Ix(t){$e(wt,this).isFocused()&&gr(t)}function ice(){$e(ow,this)||this.hide()}function Qc(){return this.range instanceof jh?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function Ab(t,e,n){return(e=rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rce(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GL{constructor(e){Ab(this,"hot",void 0),Ab(this,"commands",{}),Ab(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=sce(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||zt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(o.join(":")),I(u,c=>c.apply(this.hot,i))}}function sce(t,e){let n;return I(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function Ob(t,e,n){return(e=ace(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ace(t){var e=lce(t,"string");return typeof e=="symbol"?e:e+""}function lce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ob(this,"hot",void 0),Ob(this,"predefinedItems",UL()),Ob(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Fe(e,(i,r)=>{let o="";i.name===je?(n[je]=i,o=je):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return uce(e,this.defaultOrderPattern,this.predefinedItems)}}function uce(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),me(r)?Fe(r,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),me(o)?hn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):I(r,(o,s)=>{let a=n[o];!a&&Lue.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),me(o)&&hn(a,o),a.key===void 0&&(a.key=s),i.push(a))}),i}function Sa(t,e,n){return(e=cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cce(t){var e=hce(t,"string");return typeof e=="symbol"?e:e+""}function hce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dce{constructor(e,n){Sa(this,"top",void 0),Sa(this,"topRelative",void 0),Sa(this,"left",void 0),Sa(this,"leftRelative",void 0),Sa(this,"scrollTop",void 0),Sa(this,"scrollLeft",void 0),Sa(this,"cellHeight",void 0),Sa(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=i,a+=r):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-i,l=a-r),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Id(t,e,n){fce(t,e),e.set(t,n)}function fce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function He(t,e){return t.get(XL(t,e))}function Gm(t,e,n){return t.set(XL(t,e),n),n}function XL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var di=new WeakMap,Ai=new WeakMap,Oi=new WeakMap,xb=new WeakMap,Rc=new WeakMap;class gce{constructor(e){Id(this,di,void 0),Id(this,Ai,void 0),Id(this,Oi,void 0),Id(this,xb,!1),Id(this,Rc,{above:0,below:0,left:0,right:0}),Gm(xb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return He(Rc,this)[e]=n,this}setElement(e){return Gm(di,this,e),this}setParentElement(e){return Gm(Ai,this,e),this}updatePosition(e){Gm(Oi,this,new dce(e,He(di,this).ownerDocument.defaultView)),He(xb,this)?(He(Oi,this).fitsBelow(He(di,this))?this.setPositionBelowCursor():He(Oi,this).fitsAbove(He(di,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){He(di,this).dir==="rtl"?He(Oi,this).fitsOnLeft(He(di,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():He(Oi,this).fitsOnRight(He(di,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=He(Rc,this).above+He(Oi,this).top-He(di,this).offsetHeight;if(He(Ai,this)){const i=He(Ai,this).ownerDocument.defaultView.getComputedStyle(He(Ai,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=He(Oi,this).top+He(Oi,this).cellHeight-He(di,this).scrollHeight+r+o}He(di,this).style.top=`${e}px`}setPositionBelowCursor(){let e=He(Rc,this).below+He(Oi,this).top+1;if(He(Ai,this)){const i=He(Ai,this).ownerDocument.defaultView.getComputedStyle(He(Ai,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=He(Oi,this).top-r-o}He(di,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=He(Oi,this).left;if(He(Ai,this)){const n=He(Ai,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(He(Ai,this).querySelector(".htCore")).borderRightWidth,10);e+=He(Oi,this).cellWidth+i}else e+=He(Rc,this).right;He(di,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=He(Rc,this).left+He(Oi,this).left-He(di,this).offsetWidth;if(He(Ai,this)){const n=He(Ai,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(He(Ai,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}He(di,this).style.left=`${e}px`}}function qL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let s=Be(e,-1,v()-1);function a(T,_){const D=v()-1;return T<0&&(T=D),T>D&&(T=0),o.has(T)?-1:(o.add(T),i(T,!1)===!1&&(T=a(_===1?++T:--T,_)),T)}function l(T){T>-1&&T<v()&&i(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<v()&&(s=T)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function f(){v()>0&&(o.clear(),s=a(++s,1))}function m(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(n(),0)}function b(){o.clear(),s=e,r()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:v,clear:b}}function mce(t){return Qe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function dE(t){return zt(t,"submenu")}function fE(t){return new RegExp(je,"i").test(t.name)}function sw(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function Ax(t){return zt(t,"disableSelection")}function pce(t){return Ce(t,"htSeparator")}function wce(t){return Ce(t,"htSubmenu")}function vce(t){return Ce(t,"htDisabled")}function Cce(t){return Ce(t,"htSelectionDisabled")}function yce(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function ZL(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function bce(t,e){let n=t.slice(0);return n.reverse(),n=ZL(n,e),n.reverse(),n}function Sce(t){const e=[];return I(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Rce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=t.slice(0);return n=ZL(n,e),n=bce(n,e),n=Sce(n),n}function Ece(t){return t.checkable===!0}function Tce(t){return qL({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||pce(i)||vce(i)||Cce(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function _ce(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedActive();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedActive();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const JL="menu",Ox=JL;function Mce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(_ce(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:JL})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function o(){return[...n]}function s(u){return u?`${Ox}:${u}`:Ox}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:a,listen:l}}function Pce(t){return(e,n,i,r,o,s)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(cs(n),j(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!sw(a,t)&&!Ax(a)&&!fE(a);le(n,[...Ece(a)?[M9(),hr(c),n$(h)]:[_9(),hr(u)],...d?[Co(-1)]:[],...sw(a,t)?[nf()]:[],...dE(a)?[Lr(!1)]:[]])}n.className="",n.appendChild(l),fE(a)?j(n,"htSeparator"):typeof a.renderer=="function"?(j(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,o,u))):wl(l,u),sw(a,t)?j(n,"htDisabled"):Ax(a)?j(n,"htSelectionDisabled"):dE(a)&&j(n,"htSubmenu")}}function Hb(t,e,n){Ice(t,e),e.set(t,n)}function Ice(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return(e=Ace(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ace(t){var e=Oce(t,"string");return typeof e=="symbol"?e:e+""}function Oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nb(t,e,n){return t.set(QL(t,e),n),n}function Ra(t,e){return t.get(QL(t,e))}function QL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xx=215;var Ec=new WeakMap,Km=new WeakMap,Xm=new WeakMap;class Xh{get tableBorderWidth(){return Ra(Xm,this)===void 0&&this.hotMenu&&Nb(Xm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ra(Xm,this)}constructor(e,n){var i=this;Ho(this,"hot",void 0),Ho(this,"options",void 0),Ho(this,"eventManager",new Vr(this)),Ho(this,"container",void 0),Ho(this,"positioner",void 0),Ho(this,"hotMenu",null),Ho(this,"hotSubMenus",{}),Ho(this,"parentMenu",void 0),Ho(this,"menuItems",null),Ho(this,"origOutsideClickDeselects",null),Hb(this,Ec,void 0),Hb(this,Km,void 0),Hb(this,Xm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:xx,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new gce(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{this.options.container!==this.hot.rootPortalElement&&(ae(this.options.container,/ht-theme-.*/g),j(this.options.container,r)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=ta(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ra(Ec,this)}getKeyboardShortcutsCtrl(){return Ra(Km,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Pg(a=>this.openSubMenu(a),300),n=this.options.minWidth||xx;let i=!1,r=ul(this.menuItems,a=>(a.key===eg&&(i=!0),yce(a,this.hot)));if(r.length<1&&!i)r.push(UL()[eg]);else if(r.length===0)return;r=Rce(r,je);let o=!1;const s={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return te(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Pce(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Ra(Ec,this).setCurrentPage(l.row):Ra(Ec,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Pw()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Pw()||!fl(a))&&o&&this.hasSelectedItem()&&(mo()||qv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Nb(Ec,this,Tce(this.hotMenu)),Nb(Km,this,Mce(this)),Ra(Km,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ra(Ec,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);le(i,[Lr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!wce(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Xh(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&le(n,[Lr(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&le(r,[Lr(!1)])}}closeAllSubMenus(){I(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?mce(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||fE(e)||sw(e,this.hot)||dE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,o=parseInt(i.width,10),s=Sn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?cn(this.hotMenu.getCell(u,0)):0;return a+(l.name===je?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width=`${o+3}px`,r.height=`${s+3}px`):(r.width=`${o}px`,r.height=`${s}px`),i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(nt(i)&&(i=i.call(this.hot),i===null||Tt(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),j(r,`htMenu handsontable ${this.options.className}`),i&&j(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&le(this.hotMenu.rootElement,[T9(),Co(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ol(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ol(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ce(e.target,"htCore")&&ol(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}st(Xh,An);function xce(t,e){Hce(t,e),e.add(t)}function Hce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Db(t,e,n){return(e=Nce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nce(t){var e=Dce(t,"string");return typeof e=="symbol"?e:e+""}function Dce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cf="contextMenu",$ce=70,Hx=cf;re.getSingleton().register("afterContextMenuDefaultOptions");re.getSingleton().register("beforeContextMenuShow");re.getSingleton().register("afterContextMenuShow");re.getSingleton().register("afterContextMenuHide");re.getSingleton().register("afterContextMenuExecute");var Ad=new WeakSet;class TC extends Ye{constructor(){super(...arguments),xce(this,Ad),Db(this,"commandExecutor",new GL(this.hot)),Db(this,"itemsFactory",null),Db(this,"menu",null)}static get PLUGIN_KEY(){return cf}static get PLUGIN_PRIORITY(){return $ce}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[bC,SC,je,Lg,Fg,je,yC,Wg,je,RC,CC,je,Vg,je,Ar]}isEnabled(){return!!this.hot.getSettings()[cf]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[cf];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Xh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>qm(Ad,this,Lce).call(this)),this.menu.addLocalHook("afterOpen",()=>qm(Ad,this,Fce).call(this)),this.menu.addLocalHook("afterClose",()=>qm(Ad,this,Vce).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>qm(Ad,this,kce).call(this,i)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=wC(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:Hx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hx)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Fe(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new KL(this.hot,TC.DEFAULT_ITEMS);const e=this.hot.getSettings()[cf],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),I(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function kce(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ce(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(Ce(o,"current")&&Ce(o,"wtBorder"))))return;const s=wC(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Lce(){this.hot.runHooks("beforeContextMenuShow",this)}function Fce(){this.hot.runHooks("afterContextMenuShow",this)}function Vce(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}TC.SEPARATOR={name:je};function Wce(t){return{key:"copy",name(){return this.getTranslatedPhrase(zT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Bce(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(KT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function jce(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(GT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Uce(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?Be(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(YT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function zce(t){return{key:"cut",name(){return this.getTranslatedPhrase(XT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Yce{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Gce{constructor(){this.clipboardData=new Yce}preventDefault(){}composedPath(){return[]}}function Kce(t,e){eF(t,e),e.add(t)}function Tc(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mi(t,e){return t.get(lh(t,e))}function _c(t,e,n){return t.set(lh(t,e),n),n}function lh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ea=new WeakMap,$b=new WeakMap,Od=new WeakMap,gE=new WeakMap,mE=new WeakMap,xd=new WeakMap,Hd=new WeakSet;class Xce{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=e;Kce(this,Hd),Tc(this,Ea,void 0),Tc(this,$b,void 0),Tc(this,Od,void 0),Tc(this,gE,void 0),Tc(this,mE,void 0),Tc(this,xd,void 0),_c($b,this,n),_c(Od,this,i),_c(gE,this,r),_c(mE,this,o),_c(xd,this,s)}setSelectedRange(e){_c(Ea,this,e)}getCellsRange(){if(mi($b,this).call(this)===0||mi(Od,this).call(this)===0)return null;const{row:e,col:n}=mi(Ea,this).getTopStartCorner(),{row:i,col:r}=mi(Ea,this).getBottomEndCorner(),o=lh(Hd,this,qce).call(this,e,i),s=lh(Hd,this,kb).call(this,n,r);return{isRangeTrimmed:i!==o||r!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(mi(Od,this).call(this)===0||mi(xd,this).call(this)===0)return null;const{col:e}=mi(Ea,this).getTopStartCorner(),{col:n}=mi(Ea,this).getBottomEndCorner(),i=lh(Hd,this,kb).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(mi(Od,this).call(this)===0||mi(xd,this).call(this)===0)return null;const{col:e}=mi(Ea,this).getTopStartCorner(),{col:n}=mi(Ea,this).getBottomEndCorner(),i=lh(Hd,this,kb).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-mi(xd,this).call(this),startCol:e,endRow:-1,endCol:i}}}function kb(t,e){return Math.min(e,Math.max(t+mi(mE,this).call(this)-1,t))}function qce(t,e){return Math.min(e,Math.max(t+mi(gE,this).call(this)-1,t))}function tF(t){const e=[],n=[];return I(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);he(r,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);he(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Zce(t,e){nF(t,e),e.add(t)}function Ta(t,e,n){nF(t,e),e.set(t,n)}function nF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nd(t,e,n){return(e=Jce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jce(t){var e=Qce(t,"string");return typeof e=="symbol"?e:e+""}function Qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fi(t,e){return t.get(ri(t,e))}function eo(t,e,n){return t.set(ri(t,e),n),n}function ri(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterCopyLimit");re.getSingleton().register("modifyCopyableRange");re.getSingleton().register("beforeCut");re.getSingleton().register("afterCut");re.getSingleton().register("beforePaste");re.getSingleton().register("afterPaste");re.getSingleton().register("beforeCopy");re.getSingleton().register("afterCopy");const Lb="copyPaste",ehe=80,the=["fragmentSelection"],iF="application/ht-source-data-json-html",Nx=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var pE=new WeakMap,wE=new WeakMap,vE=new WeakMap,Mc=new WeakMap,Zm=new WeakMap,Jm=new WeakMap,Pc=new WeakMap,nv=new WeakMap,pi=new WeakSet;class nhe extends Ye{constructor(){super(...arguments),Zce(this,pi),Nd(this,"columnsLimit",1/0),Nd(this,"rowsLimit",1/0),Nd(this,"pasteMode","overwrite"),Nd(this,"uiContainer",this.hot.rootDocument.body),Ta(this,pE,!1),Ta(this,wE,!1),Ta(this,vE,!1),Ta(this,Mc,"cells-only"),Ta(this,Zm,!1),Ta(this,Jm,!1),Ta(this,Pc,new Xce({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ta(this,nv,!1),Nd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Lb}static get SETTING_KEYS(){return[Lb,...the]}static get PLUGIN_PRIORITY(){return ehe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Lb]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),eo(pE,this,this.getSetting("copyColumnHeaders")),eo(wE,this,this.getSetting("copyColumnGroupHeaders")),eo(vE,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>ri(pi,this,ohe).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ri(pi,i,she).call(i,...o)}),this.addHook("afterSelectionEnd",()=>ri(pi,this,ahe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),Tg()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ri(pi,i,lhe).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ri(pi,i,uhe).call(i,...o)}),this.addHook("afterSelection",()=>ri(pi,this,che).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";eo(Mc,this,e),eo(Zm,this,!0),ri(pi,this,Dx).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){eo(Jm,this,!0),ri(pi,this,Dx).call(this,"cut")}getRangedCopyableData(e){return Fw(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=[],{rows:r,columns:o}=tF(e);return I(r,s=>{const a=[];I(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=n?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);n&&me(u)&&(u=JSON.stringify(u)),a.push(u)}}),i.push(a)}),i}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new Gce;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Fi(Pc,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Fi(Mc,this)==="column-headers-only"?n.set("headers",Fi(Pc,this).getMostBottomColumnHeadersRange()):(Fi(Mc,this)==="with-column-headers"?n.set("headers",Fi(Pc,this).getMostBottomColumnHeadersRange()):Fi(Mc,this)==="with-column-group-headers"&&n.set("headers",Fi(Pc,this).getAllColumnHeadersRange()),n.set("cells",Fi(Pc,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=r;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const r=e.length,o=e[0].length,s=[],{row:a,col:l}=i.getTopStartCorner(),{row:u,col:c}=i.getBottomEndCorner();let h=a,d=l,f=a,m=l;for(;s.length<r||h<=u;){const{skipRowOnPaste:b,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,b===!0)continue;f=T,d=l;const _=[],D=s.length%r;for(;_.length<o||d<=c;){var v;const{skipColumnOnPaste:P,visualCol:W}=this.hot.getCellMeta(T,d),k=this.hot.getSourceDataAtCell(T,d),$=_.length%o;if(d=W+1,P===!0)continue;m=W;const G=n==null||(v=n[D])===null||v===void 0?void 0:v[$];let J=e[D][$];if(n&&XD(G)){const U=JSON.parse(G);(me(k)||k===null)&&(J=U)}_.push(J)}s.push(_)}return eo(nv,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,m]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Fi(Zm,this)||this.isEditorOpened()||as(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Cf(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),eo(Zm,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=ri(pi,this,ihe).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(ri(pi,this,$x).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),eo(Mc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Fi(Jm,this)||this.isEditorOpened()||as(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Cf(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),eo(Jm,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(ri(pi,this,$x).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||as(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Cf(n,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(iF);h&&(s=UR(h,this.hot.rootDocument).data);const d=Gv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=UR(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Lte(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function Dx(t){if(Tg()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&A$(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function ihe(t){const{rows:e}=tF(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function rhe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&J0(i)}}}function rF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&Q0(i)}}}function $x(t,e,n){const i=Fw(e);if(t&&t.clipboardData){const r=jR(e),o=jR(n);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[Nx,r].join("")),t.clipboardData.setData(iF,[Nx,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i)}function ohe(t){t.items.push({name:"---------"},Wce(this)),Fi(pE,this)&&t.items.push(Uce(this)),Fi(wE,this)&&t.items.push(jce(this)),Fi(vE,this)&&t.items.push(Bce(this)),t.items.push(zce(this))}function she(t,e,n,i,r){Fi(nv,this)&&(r.value=!0),eo(nv,this,!1)}function ahe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function lhe(){ri(pi,this,rF).call(this)}function uhe(){ri(pi,this,rhe).call(this)}function che(){ri(pi,this,rF).call(this)}function oF(t,e){return`border_row${t}col${e}`}function hf(){return{width:1,color:"#000"}}function Ks(){return{hide:!0}}function hhe(){return{width:1,color:"#000",cornerVisible:!1}}function Fb(t){if(te(t.start)||te(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(te(t.end)||te(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Dd(t){return te(t.start)&&(t.left=t.start),te(t.end)&&(t.right=t.end),t}function Vb(t,e){return{id:oF(t,e),border:hhe(),row:t,col:e,top:Ks(),bottom:Ks(),start:Ks(),end:Ks()}}function dhe(t,e){return zt(e,"border")&&e.border&&(t.border=e.border),zt(e,"top")&&te(e.top)&&(e.top?(me(e.top)||(e.top=hf()),t.top=e.top):(e.top=Ks(),t.top=e.top)),zt(e,"bottom")&&te(e.bottom)&&(e.bottom?(me(e.bottom)||(e.bottom=hf()),t.bottom=e.bottom):(e.bottom=Ks(),t.bottom=e.bottom)),zt(e,"start")&&te(e.start)&&(e.start?(me(e.start)||(e.start=hf()),t.start=e.start):(e.start=Ks(),t.start=e.start)),zt(e,"end")&&te(e.end)&&(e.end?(me(e.end)||(e.end=hf()),t.end=e.end):(e.end=Ks(),t.end=e.end)),t}function ia(t,e){let n=!1;return I(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const s=t.getCellMeta(r,o).borders;if(s)if(e){if(!zt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function _C(t){return`<span class="selected">â</span>${t}`}function fhe(t){return t.some(e=>te(e.left)||te(e.right))}function ghe(t){return t.some(e=>te(e.start)||te(e.end))}const mhe=new Map([["left","start"],["right","end"]]);function phe(t){var e;return(e=mhe.get(t))!==null&&e!==void 0?e:t}function whe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(m_);return ia(this,"bottom")&&(e=_C(e)),e},callback(e,n){const i=ia(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function vhe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(p_);return ia(this,e)&&(n=_C(n)),n},callback(n,i){const r=ia(this,e);t.prepareBorder(i,e,r)}}}function Che(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(w_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ia(this)}}}function yhe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(g_);return ia(this,e)&&(n=_C(n)),n},callback(n,i){const r=ia(this,e);t.prepareBorder(i,e,r)}}}function bhe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(f_);return ia(this,"top")&&(e=_C(e)),e},callback(e,n){const i=ia(this,"top");t.prepareBorder(n,"top",i)}}}function She(t,e){Rhe(t,e),e.add(t)}function Rhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ehe(t,e,n){return(e=The(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function The(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aw="customBorders",Mhe=90,kx=["dashed","dotted","solid"];var Qm=new WeakSet;class Phe extends Ye{constructor(){super(...arguments),She(this,Qm),Ehe(this,"savedBorders",[])}static get PLUGIN_KEY(){return aw}static get PLUGIN_PRIORITY(){return Mhe}isEnabled(){return!!this.hot.getSettings()[aw]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Wb(Qm,this,Ahe).call(this,e)),this.addHook("init",()=>Wb(Qm,this,Ohe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=Fb(n));const o=Ph(e),s=Zf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});I(e,a=>{s(a).forAll((l,u)=>{I(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,phe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Ph(e),i=Zf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return I(e,o=>{i(o).forAll((s,a)=>{I(this.savedBorders,l=>{l.row===s&&l.col===a&&r.push(Dd(l))})})}),r}clearBorders(e){e?this.setBorders(e):(I(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Vb(e,n);i&&(a=dhe(a,i),I(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Dd(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);he(e.from.row,i,o=>{he(e.from.col,r,s=>{const a=Vb(o,s);let l=0;o===e.from.row&&zt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&zt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&zt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&zt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Dd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=oF(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Vb(e,n):o=Fb(o),r?(o[i]=Ks(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Dd(o)))):(o[i]=hf(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Dd(o)))}prepareBorder(e,n,i){I(e,r=>{let{start:o,end:s}=r;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":he(o.col,s.col,a=>{he(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":he(o.col,s.col,a=>{this.setBorder(o.row,a,n,i)});break;case"bottom":he(o.col,s.col,a=>{this.setBorder(s.row,a,n,i)});break;case"start":he(o.row,s.row,a=>{this.setBorder(a,o.col,n,i)});break;case"end":he(o.row,s.row,a=>{this.setBorder(a,s.col,n,i)});break}})}createCustomBorders(e){I(e,n=>{const i=Fb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return Sn([n,i,r,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Qe(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){I(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){I(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Qe(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):I(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return I(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return I(s,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):I(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);I(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[aw];if(Array.isArray(e)){const n=ui(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=fhe(e),i=ghe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');Wb(Qm,this,Ihe).call(this,e)}destroy(){super.destroy()}}function Ihe(t){t.forEach(e=>{Object.keys(e).forEach(n=>{const i=e[n].style;te(i)&&!kx.includes(i)?(Le(`The "${i}" border style is not supported. Please use one of the following styles: ${kx.join(", ")}.
The border style will be ignored.`),delete e[n].style):te(i)&&i==="solid"&&delete e[n].style})})}function Ahe(t){this.hot.getSettings()[aw]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(d_)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[bhe(this),yhe(this),whe(this),vhe(this),Che(this)]}})}function Ohe(){this.changeBorderSettings()}function xhe(t,e){Hhe(t,e),e.add(t)}function Hhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bb(t,e,n){return(e=Nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nhe(t){var e=Dhe(t,"string");return typeof e=="symbol"?e:e+""}function Dhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fx="dragToScroll",$he=100;var jb=new WeakSet;class khe extends Ye{constructor(){super(...arguments),xhe(this,jb),Bb(this,"boundaries",null),Bb(this,"callback",null),Bb(this,"listening",!1)}static get PLUGIN_KEY(){return Fx}static get PLUGIN_PRIORITY(){return $he}isEnabled(){return!!this.hot.getSettings()[Fx]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Lx(jb,this,Vx).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Lx(jb,this,Vx).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=ta(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Vx(t){if(fl(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const s=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function Lhe(t,e){sF(t,e),e.add(t)}function Fhe(t,e,n){sF(t,e),e.set(t,n)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ub(t,e,n){return(e=Vhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vhe(t){var e=Whe(t,"string");return typeof e=="symbol"?e:e+""}function Whe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bhe(t,e){return t.get(Or(t,e))}function aF(t,e,n){return t.set(Or(t,e),n),n}function Or(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterDropdownMenuDefaultOptions");re.getSingleton().register("beforeDropdownMenuShow");re.getSingleton().register("afterDropdownMenuShow");re.getSingleton().register("afterDropdownMenuHide");re.getSingleton().register("afterDropdownMenuExecute");const lw="dropdownMenu",jhe=230,tg="changeType",zb=lw;var MC=new WeakMap,ro=new WeakSet;class PC extends Ye{static get PLUGIN_KEY(){return lw}static get PLUGIN_PRIORITY(){return jhe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Lg,Fg,je,Wg,je,vC,je,Vg,je,Ar]}constructor(e){super(e),Lhe(this,ro),Ub(this,"commandExecutor",new GL(this.hot)),Ub(this,"itemsFactory",null),Ub(this,"menu",null),Fhe(this,MC,!1),this.hot.addHook("afterGetColHeader",(n,i)=>Or(ro,this,zhe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[lw]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new KL(this.hot,PC.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Or(ro,e,Zhe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Or(ro,e,qhe).call(e,...o)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[lw],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Xh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>Or(ro,this,Yhe).call(this)),this.menu.addLocalHook("afterOpen",()=>Or(ro,this,Ghe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Or(ro,this,Khe).call(this,o)),this.menu.addLocalHook("afterClose",()=>Or(ro,this,Xhe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),I(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeActive();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeActive(),o=wC(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,r.col,!0).querySelector(`.${tg}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:zb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:zb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Or(ro,this,Uhe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Fe(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Uhe(t){if(Ce(t.target,tg)){const e=wC(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),aF(MC,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function zhe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${tg}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=tg,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(le(s,[Xu(),hr(" ")]),le(e,[QD("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Yhe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Ghe(){this.hot.runHooks("afterDropdownMenuShow",this),Or(ro,this,lF).call(this,this.menu)}function Khe(t){Or(ro,this,lF).call(this,t)}function Xhe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function qhe(t){return Bhe(MC,this)?null:t}function Zhe(t){Ce(t.target,tg)&&aF(MC,this,!0)}PC.SEPARATOR={name:je};function Wx(t,e,n){return(e=Jhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jhe(t){var e=Qhe(t,"string");return typeof e=="symbol"?e:e+""}function Qhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ede{constructor(e){Wx(this,"hot",void 0),Wx(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return he(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(he(n,r,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();he(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();he(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,s=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:i,startCol:r,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function Bx(t,e,n){return(e=tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tde(t){var e=nde(t,"string");return typeof e=="symbol"?e:e+""}function nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){Bx(this,"dataProvider",void 0),Bx(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=yo(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=hn(yo(qM.DEFAULT_OPTIONS),n),n=hn(n,e),n.filename=Yv(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function ide(t,e){rde(t,e),e.add(t)}function rde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uF="\r",ode='"',sde=`
`,ade="=",lde="+",ude="-",cde="@",hde="	";var Yb=new WeakSet;class dde extends qM{constructor(){super(...arguments),ide(this,Yb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=Qe(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),I(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Ct(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=jx(Yb,this,gde).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=jx(Yb,this,fde).call(this,r)),(n||r.indexOf(uF)>=0||r.indexOf(ode)>=0||r.indexOf(sde)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function fde(t){return t.startsWith(ade)||t.startsWith(lde)||t.startsWith(ude)||t.startsWith(cde)||t.startsWith(hde)||t.startsWith(uF)?`'${t}`:t}function gde(t,e){return e.test(t)?`'${t}`:t}const mde="csv",CE={[mde]:dde};function pde(t,e,n){return typeof CE[t]=="function"?new CE[t](e,n):null}const wde="exportFile",vde=240;class Cde extends Ye{static get PLUGIN_KEY(){return wde}static get PLUGIN_PRIORITY(){return vde}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!CE[e])throw new Error(`Export format type "${e}" is not supported.`);return pde(e,new ede(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ic(t,e,n){return(e=yde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yde(t){var e=bde(t,"string");return typeof e=="symbol"?e:e+""}function bde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bg{constructor(e,n){let{id:i,stateless:r=!0}=n;Ic(this,"hot",void 0),Ic(this,"id",void 0),Ic(this,"elements",[]),Ic(this,"hidden",!1),Ic(this,"stateId",""),Ic(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new aC)}getElements(){return this.elements}reset(){I(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}st(Bg,An);const ng={};function gl(t,e){if(!ng[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=ng[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function Ru(t){if(!ng[t])throw Error(`Filter condition "${t}" does not exist.`);return ng[t].descriptor}function mn(t,e,n){n.key=t,ng[t]={condition:e,descriptor:n}}const Vn="none";function Sde(){return!0}mn(Vn,Sde,{name:lC,inputsCount:0,showOperators:!1});const _f="empty";function Rde(t){return Gt(t.value)}mn(_f,Rde,{name:E_,inputsCount:0,showOperators:!0});const uw="not_empty";function Ede(t,e){return!gl(_f,e)(t)}mn(uw,Ede,{name:T_,inputsCount:0,showOperators:!0});const Mf="eq";function Tde(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale)===Ct(n)}mn(Mf,Tde,{name:__,inputsCount:1,showOperators:!0});const cw="neq";function _de(t,e){return!gl(Mf,e)(t)}mn(cw,_de,{name:M_,inputsCount:1,showOperators:!0});const cF="gt";function Mde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}mn(cF,Mde,{name:x_,inputsCount:1,showOperators:!0});const hF="gte";function Pde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}mn(hF,Pde,{name:H_,inputsCount:1,showOperators:!0});const dF="lt";function Ide(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}mn(dF,Ide,{name:N_,inputsCount:1,showOperators:!0});const fF="lte";function Ade(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}mn(fF,Ade,{name:D_,inputsCount:1,showOperators:!0});const ZM="date_after";function Ode(t,e){let[n]=e;const i=K(t.value,t.meta.dateFormat),r=K(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}mn(ZM,Ode,{name:L_,inputsCount:1,showOperators:!0});const JM="date_before";function xde(t,e){let[n]=e;const i=K(t.value,t.meta.dateFormat),r=K(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}mn(JM,xde,{name:F_,inputsCount:1,showOperators:!0});const iv="between";function Hde(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const s=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=gl(JM,[o]),a=gl(ZM,[r]);return s(t)&&a(t)}return t.value>=r&&t.value<=o}mn(iv,Hde,{name:$_,inputsCount:2,showOperators:!0});const gF="not_between";function Nde(t,e){return!gl(iv,e)(t)}mn(gF,Nde,{name:k_,inputsCount:2,showOperators:!0});const mF="begins_with";function Dde(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ct(n))}mn(mF,Dde,{name:P_,inputsCount:1,showOperators:!0});const pF="ends_with";function $de(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ct(n))}mn(pF,$de,{name:I_,inputsCount:1,showOperators:!0});const QM="contains";function kde(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ct(n))>=0}mn(QM,kde,{name:A_,inputsCount:1,showOperators:!0});const wF="not_contains";function Lde(t,e){return!gl(QM,e)(t)}mn(wF,Lde,{name:O_,inputsCount:1,showOperators:!0});const vF="date_tomorrow";function Fde(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(-1,"days").startOf("day"),"d"):!1}mn(vF,Fde,{name:W_,inputsCount:0});const CF="date_today";function Vde(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().startOf("day"),"d"):!1}mn(CF,Vde,{name:V_,inputsCount:0});const yF="date_yesterday";function Wde(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(1,"days").startOf("day"),"d"):!1}mn(yF,Wde,{name:B_,inputsCount:0});h$();function Bde(t,e){let n=t;return n===""&&(n=`(${e})`),n}function jg(t){const e=new Set(t);return function(n){return e.has(n)}}function eP(t){return t??""}function yE(t){return Array.from(new Set(t)).map(e=>eP(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function Ux(t,e,n,i){const r=[],o=t===e;let s;return o||(s=jg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Bde(a,n)};i&&i(u),r.push(u)}),r}const Eu="by_value";function jde(t,e){let[n]=e;return n(t.value)}mn(Eu,jde,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[jg(e)]},showOperators:!1});const ig={};function Ude(t){if(!ig[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ig[t].func;return function(n,i){return e(n,i)}}function zde(t){return ig[t].name}function tP(t,e,n){ig[t]={name:e,func:n}}const al="conjunction",Yde=z_;function Gde(t,e){return t.every(n=>n.func(e))}tP(al,Yde,Gde);const rv="disjunction",Kde=uC;function Xde(t,e){return t.some(n=>n.func(e))}tP(rv,Kde,Xde);const nP="disjunctionWithExtraCondition",qde=uC;function Zde(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}tP(nP,qde,Zde);const Jde="numeric",bF="text",Qde="date",zx={[Jde]:[Vn,je,_f,uw,je,Mf,cw,je,cF,hF,dF,fF,iv,gF],[bF]:[Vn,je,_f,uw,je,Mf,cw,je,mF,pF,je,QM,wF],[Qde]:[Vn,je,_f,uw,je,Mf,cw,je,JM,ZM,iv,je,vF,CF,yF]};function efe(t){const e=[];let n=t;return zx[n]||(n=bF),I(zx[n],i=>{let r;i===je?r={name:je}:r=yo(Ru(i)),e.push(r)}),e}function $d(t,e,n){return(e=tfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tfe(t){var e=nfe(t,"string");return typeof e=="symbol"?e:e+""}function nfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gb="built",Kb="building",Yx=["click","input","keydown","keypress","keyup","focus","blur","change"];let po=class SF{static get DEFAULTS(){return yo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){$d(this,"hot",void 0),$d(this,"eventManager",new Vr(this)),$d(this,"options",void 0),$d(this,"_element",void 0),$d(this,"buildState",void 0),this.hot=e,this.options=hn(SF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Kb?this._element:this.buildState===Gb?(this.update(),this._element):(this.buildState=Kb,this.build(),this.buildState=Gb,this._element)}isBuilt(){return this.buildState===Gb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Ti)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=Kb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&j(this._element,this.options.className),this.options.children.length)I(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Fe(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),I(Yx,i=>e(n,i))}else I(Yx,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};st(po,An);function ife(t,e){RF(t,e),e.add(t)}function rfe(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ep(t,e){return t.get(iP(t,e))}function ofe(t,e,n){return t.set(iP(t,e),n),n}function iP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ac=new WeakMap,Gx=new WeakSet;class ll extends po{static get DEFAULTS(){return yo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,hn(ll.DEFAULTS,n)),ife(this,Gx),rfe(this,Ac,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>iP(Gx,this,sfe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");ofe(Ac,this,this._element.firstChild),j(this._element,"htUIInput"),j(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ep(Ac,this).type=this.options.type,ep(Ac,this).placeholder=this.translateIfPossible(this.options.placeholder),ep(Ac,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ep(Ac,this).focus()}}function sfe(t){this.options.value=t.target.value}function afe(t,e){EF(t,e),e.add(t)}function kd(t,e,n){EF(t,e),e.set(t,n)}function EF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e,n){return t.set(Pf(t,e),n),n}function Lt(t,e){return t.get(Pf(t,e))}function Pf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rn=new WeakMap,tp=new WeakMap,np=new WeakMap,Xb=new WeakMap,ip=new WeakMap,rp=new WeakSet;class rg extends po{static get DEFAULTS(){return yo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,hn(rg.DEFAULTS,n)),afe(this,rp),kd(this,Rn,null),kd(this,tp,[]),kd(this,np,void 0),kd(this,Xb,void 0),kd(this,ip,void 0),this.registerHooks()}getMenu(){return Lt(Rn,this)}registerHooks(){this.addLocalHook("click",()=>Pf(rp,this,cfe).call(this))}setItems(e){Oc(tp,this,this.translateNames(e)),Lt(Rn,this)&&Lt(Rn,this).setMenuItems(Lt(tp,this))}translateNames(e){return I(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Oc(Rn,this,new Xh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Lt(Rn,this).setMenuItems(Lt(tp,this));const e=new po(this.hot,{className:"htUISelectCaption"}),n=new po(this.hot,{className:"htUISelectDropdown"});Oc(np,this,e),Oc(Xb,this,e.element),Oc(ip,this,n),this.hot.getSettings().ariaTags&&(le(n.element,[Xu()]),le(this._element,[JD()])),I([e,n],i=>this._element.appendChild(i.element)),Lt(Rn,this).addLocalHook("select",i=>Pf(rp,this,lfe).call(this,i)),Lt(Rn,this).addLocalHook("afterClose",()=>Pf(rp,this,ufe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Lt(Rn,this).hot.getTranslatedPhrase(lC),Lt(Xb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Lt(Rn,this)&&(Lt(Rn,this).open(),Lt(Rn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Lt(Rn,this).getNavigator().toFirstItem(),Lt(Rn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Lt(Rn,this)&&Lt(Rn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Lt(Rn,this)&&(Lt(Rn,this).destroy(),Oc(Rn,this,null)),Lt(np,this)&&Lt(np,this).destroy(),Lt(ip,this)&&Lt(ip,this).destroy(),super.destroy()}}function lfe(t){t.name!==je&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ufe(){this.runLocalHooks("afterClose")}function cfe(){this.openOptions()}function hfe(t,e){dfe(t,e),e.add(t)}function dfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kx(t,e,n){return(e=ffe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ffe(t){var e=gfe(t,"string");return typeof e=="symbol"?e:e+""}function gfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qb=new WeakSet;class bE extends Bg{constructor(e,n){super(e,{id:n.id,stateless:!1}),hfe(this,qb),Kx(this,"name",""),Kx(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new rg(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ll(this.hot,{placeholder:Z_})),this.elements.push(new ll(this.hot,{placeholder:J_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>Xx(qb,this,mfe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),I(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>Xx(qb,this,pfe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=yo(e.command);n.name.startsWith(Kt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),I(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ru(Vn),n=[];return I(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Ru(e?e.name:Vn);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||I(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof rg)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ll)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{j(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&j(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return j(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ru(Vn)];if(e!==null){const{visualIndex:i}=e;n=efe(this.hot.getDataType(0,i,this.hot.countRows(),i))}I(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function mfe(t){I(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function pfe(t){Nu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(t))}function qx(t,e,n){wfe(t,e),e.set(t,n)}function wfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ld(t,e){return t.get(TF(t,e))}function Zx(t,e,n){return t.set(TF(t,e),n),n}function TF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xc=new WeakMap,Zb=new WeakMap;class ov extends po{static get DEFAULTS(){return yo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,hn(ov.DEFAULTS,n)),qx(this,xc,void 0),qx(this,Zb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),Zx(Zb,this,e),Zx(xc,this,this._element.firstChild),Ld(xc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ld(Zb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ld(xc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ld(xc,this).checked=e)}focus(){this.isBuilt()&&Ld(xc,this).focus()}}function vfe(t,e){Cfe(t,e),e.add(t)}function Cfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yfe(t,e,n){return(e=bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bfe(t){var e=Sfe(t,"string");return typeof e=="symbol"?e:e+""}function Sfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jx=0;var Qx=new WeakSet;class Efe extends Bg{constructor(e,n){super(e,{id:n.id,stateless:!1}),vfe(this,Qx),yfe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(j(n.parentNode,"htFiltersMenuOperators"),I(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[al,rv];I(e,n=>{const i=new ov(this.hot,{name:"operator",label:{htmlFor:n,textContent:zde(n)},value:n,checked:n===e[Jx],id:n});i.addLocalHook("change",r=>Rfe(Qx,this,Tfe).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(et`Radio button with index ${e} doesn't exist.`);I(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof ov&&n.isChecked());return e?e.getValue():al}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&I(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:al,n=arguments.length>1?arguments[1]:void 0,i=e;i===nP&&(i=rv),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(Jx)}}function Tfe(t){this.setState(t.target.value)}function _fe(t,e,n){Mfe(t,e),e.set(t,n)}function Mfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jb(t,e){return t.get(_F(t,e))}function Pfe(t,e,n){return t.set(_F(t,e),n),n}function _F(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fd=new WeakMap;class og extends po{static get DEFAULTS(){return yo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,hn(og.DEFAULTS,n)),_fe(this,Fd,void 0)}build(){super.build(),Pfe(Fd,this,this._element.firstChild)}update(){this.isBuilt()&&(Jb(Fd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Jb(Fd,this).focus()}activate(){Jb(Fd,this).click()}}function Ife(t,e){MF(t,e),e.add(t)}function Hc(t,e,n){MF(t,e),e.set(t,n)}function MF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(uh(t,e))}function qr(t,e,n){return t.set(uh(t,e),n),n}function uh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eH="multipleSelect.itemBox";var so=new WeakMap,It=new WeakMap,Qb=new WeakMap,Os=new WeakMap,_a=new WeakMap,Ma=new WeakMap,Vd=new WeakSet;class sg extends po{static get DEFAULTS(){return yo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,hn(sg.DEFAULTS,n)),Ife(this,Vd),Hc(this,so,[]),Hc(this,It,void 0),Hc(this,Qb,void 0),Hc(this,Os,void 0),Hc(this,_a,void 0),Hc(this,Ma,void 0),qr(Os,this,new ll(this.hot,{placeholder:q_,className:"htUIMultipleSelectSearch"})),qr(_a,this,new og(this.hot,{textContent:Y_,className:"htUISelectAll"})),qr(Ma,this,new og(this.hot,{textContent:G_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Me(It,this)}registerHooks(){Me(Os,this).addLocalHook("keydown",e=>uh(Vd,this,Ofe).call(this,e)),Me(Os,this).addLocalHook("input",e=>uh(Vd,this,Afe).call(this,e)),Me(_a,this).addLocalHook("click",e=>uh(Vd,this,xfe).call(this,e)),Me(Ma,this).addLocalHook("click",e=>uh(Vd,this,Hfe).call(this,e))}setItems(e){var n;qr(so,this,e),(n=Me(It,this))===null||n===void 0||n.loadData(Me(so,this))}setLocale(e){qr(Qb,this,e)}getLocale(){return Me(Qb,this)}getItems(){return[...Me(so,this)]}getValue(){return Dfe(Me(so,this))}getSearchInputElement(){return Me(Os,this)}getSelectAllElement(){return Me(_a,this)}getClearAllElement(){return Me(Ma,this)}isSelectedAllValues(){return Me(so,this).length===this.getValue().length}build(){var e;super.build();const{rootDocument:n}=this.hot,i=n.createElement("div"),r=new po(this.hot,{className:"htUISelectionControls",children:[Me(_a,this),Me(Ma,this)]});this._element.appendChild(Me(Os,this).element),this._element.appendChild(r.element),this._element.appendChild(i),(e=Me(It,this))===null||e===void 0||e.destroy(),j(i,"htUIMultipleSelectHot"),qr(It,this,new this.hot.constructor(i,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,l,u,c,h,d)=>{a.title=d.instance.getDataAtRowProp(l,d.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Me(It,this).listen()},modifyColWidth:a=>{const l=Me(It,this).container.scrollWidth-rn(n);return a!==void 0&&a<l?l:a},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Me(It,this).init();const s=Me(It,this).getShortcutManager().getContext("grid");s.removeShortcutsByKeys(["Tab"]),s.removeShortcutsByKeys(["Shift","Tab"]),s.addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:eH}),s.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:a=>{Me(It,this).deselectCell(),this.runLocalHooks("keydown",a,this),this.runLocalHooks("listTabKeydown",a,this)},group:eH})}focus(){this.isBuilt()&&Me(It,this).listen()}reset(){Me(Os,this).reset(),Me(_a,this).reset(),Me(Ma,this).reset()}update(){!this.isBuilt()||Me(It,this).rootElement.offsetHeight===0||(Me(It,this).updateSettings({data:Nfe(Me(so,this),this.options.value)}),super.update())}destroy(){var e;(e=Me(It,this))===null||e===void 0||e.destroy(),Me(Os,this).destroy(),Me(Ma,this).destroy(),Me(_a,this).destroy(),qr(Os,this,null),qr(Ma,this,null),qr(_a,this,null),qr(It,this,null),qr(so,this,null),super.destroy()}}function Afe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());if(this.options.searchMode==="apply"){const n=Me(It,this).getPlugin("hiddenRows");n.showRows(n.getHiddenRows()),Me(so,this).forEach((i,r)=>{i.checked=`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0,i.checked||n.hideRow(r)}),Me(It,this).view.adjustElementsSize(),Me(It,this).render()}else{let n;e===""?n=[...Me(so,this)]:n=Me(so,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Me(It,this).loadData(n)}}function Ofe(t){this.runLocalHooks("keydown",t,this),eT(Nu,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),gr(t),Me(It,this).listen(),Me(It,this).selectCell(0,0))}function xfe(t){const e=[];t.preventDefault(),Me(It,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(TT(n,i)[0])}),Me(It,this).setSourceDataAtCell(e)}function Hfe(t){const e=[];t.preventDefault(),Me(It,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(TT(n,i)[0])}),Me(It,this).setSourceDataAtCell(e)}function Nfe(t,e){const n=jg(e);return t.map(i=>(i.checked=n(i.value),i))}function Dfe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function $fe(t,e){kfe(t,e),e.add(t)}function kfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tH(t,e,n){return(e=Lfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lfe(t){var e=Ffe(t,"string");return typeof e=="symbol"?e:e+""}function Ffe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function op(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wd=new WeakSet;class Vfe extends Bg{constructor(e,n){super(e,{id:n.id,stateless:!1}),$fe(this,Wd),tH(this,"name",""),tH(this,"searchMode",void 0),this.name=n.name,this.searchMode=n.searchMode,this.elements.push(new sg(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>op(Wd,this,Wfe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>op(Wd,this,Bfe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Eu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Vn:Eu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,s,a)=>{const[l]=ul(r,h=>h.name===Eu),u={},c=this.hot.getTranslatedPhrase(kw);if(l){const h=s(i,a),d=Qe(h,_=>_.value),f=new Map(h.map(_=>[_.value,this.hot.getCellMeta(_.meta.visualRow,_.meta.visualCol)])),m=yE(d);o&&(l.args[0]=o);const v=[],b=Ux(m,l.args[0],c,_=>{_.checked&&v.push(_.value),op(Wd,this,nH).call(this,_,f)}),T=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,T).locale,u.args=[v],u.command=Ru(Eu),u.itemsSnapshot=b}else u.args=[],u.command=Ru(Vn);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof sg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{j(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return j(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(kw),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),o=yE(i),s=Ux(o,o,e,l=>{op(Wd,this,nH).call(this,l,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Qe(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:eP(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function Wfe(t){Nu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),gr(t)),Nu(t.keyCode,"ENTER")&&(this.searchMode==="apply"&&this.runLocalHooks("accept"),gr(t))}function nH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Bfe(t,e){switch(e.type){case"numeric":return dL(t,e);default:return t}}var PF;function jfe(t,e){Ufe(t,e),e.add(t)}function Ufe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zfe(t,e,n){return(e=Yfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yfe(t){var e=Gfe(t,"string");return typeof e=="symbol"?e:e+""}function Gfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iH=new WeakSet;class ag extends Bg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),jfe(this,iH),zfe(this,"name",""),this.name=n.name,this.elements.push(new ll(this.hot,{type:"button",value:K_,className:"htUIButton htUIButtonOK",identifier:ag.BUTTON_OK})),this.elements.push(new ll(this.hot,{type:"button",value:X_,className:"htUIButton htUIButtonCancel",identifier:ag.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){I(this.elements,e=>{e.addLocalHook("click",(n,i)=>Kfe(iH,this,Xfe).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(j(n.parentNode,"htFiltersMenuActionBar"),I(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}PF=ag;function Xfe(t,e){e.options.identifier===PF.BUTTON_OK?this.accept():this.cancel()}function eS(t,e,n){return(e=qfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qfe(t){var e=Zfe(t,"string");return typeof e=="symbol"?e:e+""}function Zfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rH="ConditionCollection.filteringStates";class rP{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;eS(this,"hot",void 0),eS(this,"isMapRegistrable",void 0),eS(this,"filteringStates",new aC),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(rH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],s=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:al;return e.length?Ude(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:al,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(et`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Tt(ig[i]))throw new Error(et`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:gl(a,s)}]},r):u.push({name:a,args:s,func:gl(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(rH),this.filteringStates=null,this.clearLocalHooks()}}st(rP,An);function oH(t,e,n){return(e=Jfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jfe(t){var e=Qfe(t,"string");return typeof e=="symbol"?e:e+""}function Qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];oH(this,"conditionCollection",void 0),oH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return I(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return I(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return I(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function ege(t,e){tge(t,e),e.add(t)}function tge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bl(t,e,n){return(e=nge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nge(t){var e=ige(t,"string");return typeof e=="symbol"?e:e+""}function ige(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sp=new WeakSet;class AF{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ege(this,sp),Bl(this,"hot",void 0),Bl(this,"conditionCollection",void 0),Bl(this,"columnDataFactory",void 0),Bl(this,"changes",[]),Bl(this,"grouping",!1),Bl(this,"latestEditedColumnPosition",-1),Bl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>tS(sp,this,rge).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>tS(sp,this,oge).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>tS(sp,this,sge).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,I(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();const l=x$(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new rP(i.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const v=i.columnDataFactory(h);let b;f.isEmpty()?b=v:b=new IF(f,_=>i.columnDataFactory(_)).filter(),b=Qe(b,_=>_.meta.visualRow);const T=jg(b);return f.destroy(),ul(v,_=>T(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Fe(this,(e,n)=>{this[n]=null})}}function rge(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function oge(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function sge(){I(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}st(AF,An);function age(t){return qL({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof sg)return i;if(r.element&&!dl(r.element))return!1;r.focus()}})}const Bd="filters";function lge(t,e){let n=-1,i;const r=age(e),o=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(Bd),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof po&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Bd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Bd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const v=i.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),m.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const v=e[r.getCurrentPage()];v instanceof rg&&(v.openOptions(),m.preventDefault()),v instanceof og&&(v.activate(),m.preventDefault()),v instanceof po||m.preventDefault()}}],Bd)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(Bd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),i=h}function u(){return i}function c(){return n}return{...r,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function uge(t,e){OF(t,e),e.add(t)}function nS(t,e,n){OF(t,e),e.set(t,n)}function OF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jd(t,e,n){return(e=cge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cge(t){var e=hge(t,"string");return typeof e=="symbol"?e:e+""}function hge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hw(t,e,n){return t.set(Ni(t,e),n),n}function xr(t,e){return t.get(Ni(t,e))}function Ni(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SE="filters",dge=250,sH=SE;var ks=new WeakMap,RE=new WeakMap,mu=new WeakMap,qi=new WeakSet;class fge extends Ye{static get PLUGIN_KEY(){return SE}static get PLUGIN_PRIORITY(){return dge}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:e=>typeof e=="string"&&["show","apply"].includes(e)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,uge(this,qi),jd(this,"dropdownMenuPlugin",null),jd(this,"conditionCollection",null),jd(this,"conditionUpdateObserver",null),jd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),jd(this,"filtersRowsMap",null),nS(this,ks,void 0),nS(this,RE,new WeakSet),nS(this,mu,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ni(qi,n,yge).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[SE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Hg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootPortalElement,r=a=>(a.addLocalHook("accept",()=>Ni(qi,this,aH).call(this,"accept")),a.addLocalHook("cancel",()=>Ni(qi,this,aH).call(this,"cancel")),a.addLocalHook("change",l=>Ni(qi,this,Cge).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(j_)}:`,s=()=>`${this.hot.getTranslatedPhrase(U_)}:`;if(!this.components.get("filter_by_condition")){const a=new bE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>Ni(qi,this,lH).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Efe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new bE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>Ni(qi,this,lH).call(this)),this.components.set("filter_by_condition2",r(a))}if(!this.components.get("filter_by_value")){const a=this.getSetting("searchMode");this.components.set("filter_by_value",r(new Vfe(this.hot,{id:"filter_by_value",name:s,searchMode:a})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new ag(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new rP(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new AF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Ni(qi,this,bge).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Ni(qi,e,vge).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Ni(qi,this,wge).call(this)),this.addHook("afterDropdownMenuShow",()=>Ni(qi,this,mge).call(this)),this.addHook("afterDropdownMenuHide",()=>Ni(qi,this,pge).call(this)),this.addHook("afterChange",a=>Ni(qi,this,gge).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!xr(ks,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=xr(ks,this).getMenu(),c=u.getNavigator(),h=xr(ks,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];hw(ks,this,lge(this.dropdownMenuPlugin.menu,a));const l=u=>{xr(ks,this).listen(),u.preventDefault(),Nu(u.keyCode,"TAB")&&(u.shiftKey?xr(ks,this).toPreviousItem():xr(ks,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:sH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sH)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:al;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,xr(mu,this));if(s!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Qe(n.filter(),u=>u.meta.visualRow);const l=jg(r);he(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),I(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),hw(mu,this,this.exportConditions())}else s!==!1&&!i?(hw(mu,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(xr(mu,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return I(this.hot.getSourceDataAtCol(n),(r,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:eP(v)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=yE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===rv&&n.command.key!==Vn&&i.command.key!==Vn&&r.command.key!==Vn?o=nP:r.command.key!==Vn&&(n.command.key===Vn||i.command.key===Vn)&&(o=al),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new IF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return I(r,s=>{I(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function gge(t){t&&I(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function mge(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function pge(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function wge(){const t=this.dropdownMenuPlugin.menu;xr(RE,this).has(t)||xr(ks,this).setMenu(t),xr(RE,this).add(t)}function vge(t){t.items.push({name:je}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function aH(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),o.command.key!==Vn&&(this.conditionCollection.addCondition(r,o,l,u),s.command.key!==Vn&&this.conditionCollection.addCondition(r,s,l,u)),a.command.key!==Vn&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Cge(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===bE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function lH(){this.setListeningDropdownMenu()}function yge(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?j(e,"htFiltersActive"):ae(e,"htFiltersActive")}function bge(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&hw(mu,this,xr(mu,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const o=n.filter(a=>a.name===Eu),s=n.filter(a=>a.name!==Eu);if(o.length>=2||s.length>=3)Le(et`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const xF="internal-use-in-handsontable",EE={licenseKey:xF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function HF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[si])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function NF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Sge(t){var e;const n=t[si],i=NF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=HF(t);return{...EE,...i,...r}}function Rge(t){var e;const n=t[si],i=NF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=HF(t);return{...i,...r}}function Ege(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function IC(){const t="engine_relationship",e=Ur(si);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function oP(){const t="shared_engine_usage",e=Ur(si);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Tge(t){const e=t.getSettings(),n=e[si],i=n==null?void 0:n.engine;if(n===!0||Tt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return _ge((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Tt(i.hyperformula)){const o=IC(),s=oP().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),s&&s.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:xF}),(i.getConfig().leapYear1900!==EE.leapYear1900||Eg(i.getConfig().nullDate,EE.nullDate)===!1)&&Le(et`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function _ge(t,e,n){const i=e[si],r=Sge(e),o=IC(),s=oP();Mge(t,i.functions),Pge(t,i.language);const a=t.buildEmpty(r);return o.set(a,[n]),s.set(a,[n.guid]),Ige(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function uH(t){var e;const n=IC(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function cH(t,e){if(t){const n=IC(),i=n.get(t),r=oP(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function Mge(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(s){Le(s.message)}})}function Pge(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){Le(i.message)}}}function Ige(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:s}=n;try{t.addNamedExpression(i,r,o,s)}catch(a){Le(a.message)}}),t.resumeEvaluation())}function Age(t,e){return(Tt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const DF="DD/MM/YYYY";function Oge(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function xge(t){return Oge(t)?t.substr(1):t}function Hge(t){return typeof t=="string"&&t.startsWith("=")}function sP(t,e){return typeof t=="string"&&e==="date"}function $F(t,e){return K(t,e,!0).isValid()}function kF(t,e){return K(t,e,!0).format(DF)}function Nge(t,e){return K(t,DF,!0).format(e)}function LF(t,e){const i=new Date(Date.UTC(0,0,t+-1));return K(i).format(e)}function Dge(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function $ge(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=r.from;o.from>r.from&&a&&s&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function kge(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function aP(t,e,n){const i=$ge(t,Dge(t,e,n));return kge(i)}function jl(t,e,n){Lge(t,e),e.set(t,n)}function Lge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(FF(t,e))}function Pa(t,e,n){return t.set(FF(t,e),n),n}function FF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ud=new WeakMap,Ia=new WeakMap,Zi=new WeakMap,ap=new WeakMap,iS=new WeakMap,rS=new WeakMap,lp=new WeakMap;class hH{constructor(e,n,i){jl(this,Ud,void 0),jl(this,Ia,void 0),jl(this,Zi,void 0),jl(this,ap,[]),jl(this,iS,[]),jl(this,rS,void 0),jl(this,lp,[]),Pa(Ud,this,e),Pa(Ia,this,n),Pa(Zi,this,i)}setRemovedHfIndexes(e){return Pa(lp,this,e.map(n=>{const i=Mt(Ia,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),Mt(lp,this)}getRemovedHfIndexes(){return Mt(lp,this)}getHfIndexFromVisualIndex(e){const n=Mt(Ia,this).getIndexesSequence(),i=Mt(Ia,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${li(Mt(Ud,this))}s`;Mt(Zi,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,s=r.from+1!==r.to;o&&s&&Mt(Zi,this).getEngine()[i](Mt(Zi,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(Pa(iS,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),Pa(rS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Mt(Zi,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=aP(Mt(iS,this),Mt(rS,this),Mt(Ia,this).getNumberOfIndexes());Mt(Zi,this).getSheetId()===null?Mt(Zi,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${li(Mt(Ud,this))}Order`;return n=>{if(Mt(Zi,this).isPerformingUndoRedo())return;const i=Mt(Ia,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=Mt(ap,this).map(l=>i.indexOf(l)),o=Mt(Zi,this).getEngine().getSheetDimensions(Mt(Zi,this).getSheetId());let s;Mt(Ud,this)==="row"?s=o.height:s=o.width;const a=r.length;for(let l=a;l<s;l+=1)r.push(l);Mt(Zi,this).getEngine()[e](Mt(Zi,this).getSheetId(),r)}Pa(ap,this,i)}}init(){Pa(ap,this,Mt(Ia,this).getIndexesSequence())}}function Ul(t,e,n){Fge(t,e),e.set(t,n)}function Fge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(t,e){return t.get(VF(t,e))}function zl(t,e,n){return t.set(VF(t,e),n),n}function VF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var up=new WeakMap,cp=new WeakMap,oS=new WeakMap,sS=new WeakMap,aS=new WeakMap,lS=new WeakMap,uS=new WeakMap;class Vge{constructor(e,n,i){Ul(this,up,void 0),Ul(this,cp,void 0),Ul(this,oS,void 0),Ul(this,sS,!1),Ul(this,aS,!1),Ul(this,lS,null),Ul(this,uS,null),zl(up,this,new hH("row",e,this)),zl(cp,this,new hH("column",n,this)),zl(oS,this,i)}getForAxis(e){return e==="row"?xs(up,this):xs(cp,this)}setPerformUndo(e){zl(sS,this,e)}setPerformRedo(e){zl(aS,this,e)}isPerformingUndoRedo(){return xs(sS,this)||xs(aS,this)}getSheetId(){return xs(uS,this)}getEngine(){return xs(lS,this)}getPostponeAction(){return xs(oS,this)}setupSyncEndpoint(e,n){zl(lS,this,e),zl(uS,this,n),xs(up,this).init(),xs(cp,this).init()}}function Wge(t,e){WF(t,e),e.add(t)}function Yl(t,e,n){return(e=Bge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bge(t){var e=jge(t,"string");return typeof e=="symbol"?e:e+""}function jge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cS(t,e,n){WF(t,e),e.set(t,n)}function WF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ml(t,e,n){return t.set(De(t,e),n),n}function Ou(t,e){return t.get(De(t,e))}function De(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const si="formulas",Uge=["maxRows","maxColumns","language"],zge=260;re.getSingleton().register("afterNamedExpressionAdded");re.getSingleton().register("afterNamedExpressionRemoved");re.getSingleton().register("afterSheetAdded");re.getSingleton().register("afterSheetRemoved");re.getSingleton().register("afterSheetRenamed");re.getSingleton().register("afterFormulasValuesUpdate");const qh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ra=new WeakMap,AC=new WeakMap,zd=new WeakMap,Ve=new WeakSet;class Yge extends Ye{constructor(){var e;super(...arguments),e=this,Wge(this,Ve),cS(this,ra,!1),cS(this,AC,!1),cS(this,zd,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,lme).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,ume).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,cme).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,hme).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,dme).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return De(Ve,e,fme).call(e,...i)}]]),Yl(this,"staticRegister",Ur("formulas")),Yl(this,"engine",null),Yl(this,"sheetId",null),Yl(this,"sheetName",null),Yl(this,"indexSyncer",null),Yl(this,"rowAxisSyncer",null),Yl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return si}static get PLUGIN_PRIORITY(){return zge}static get SETTING_KEYS(){return[si,...Uge]}isEnabled(){return!!this.hot.getSettings()[si]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Tge(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Le("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,De(Ve,this,lg).call(this));i!==!1&&De(Ve,this,If).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,dH).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,fH).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,dH).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,fH).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,qge).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Zge).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Gge).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Jge).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,gH).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,gH).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Qge).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,eme).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,ime).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,rme).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,tme).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,nme).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,ome).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,sme).call(n,...r)}),this.indexSyncer=new Vge(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,s)=>{this.rowAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("beforeColumnMove",(i,r,o,s)=>{this.columnAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("afterRowMove",(i,r,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,r,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Xge).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,ame).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return De(Ve,n,Kge).call(n,...r)}),Ou(zd,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){Ou(zd,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),cH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Rge(this.hot.getSettings());Ege(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[si];if(te(i)&&te(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[si].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const o=this.addSheet(r??void 0,De(Ve,this,lg).call(this));De(Ve,this,If).call(this,o)}}super.updatePlugin(e)}destroy(){Ou(zd,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),ml(zd,this,null),cH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(te(n)&&!gk(n))return Le("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Le("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return Le(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){nT(`The sheet named \`${e}\` does not exist, switch aborted.`);return}De(Ve,this,If).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${li(si)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const s=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(i.has(s)||i.add(s))}),uH(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var s;r.render(),(s=r.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return te(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(te(l)===!1||te(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=i(o);if(c!==void 0&&!r.has(h)){const d=uH(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){Le(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return sP(i,o.type)&&($F(i,o.dateFormat)?i=kF(i,o.dateFormat):Hge(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function If(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function BF(t,e,n){if(me(n)&&n!==null){const i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getCellMeta(i,r).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function lg(t,e,n,i){return this.hot.getSourceDataArray(t,e,n,i).map((r,o)=>r.map((s,a)=>De(Ve,this,BF).call(this,o,a,s)))}function Gge(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(r);return o.type==="date"&&oi(s)&&(s=LF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Kge(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:v}=h.start,{row:b,col:T}=h.end,_=b-m+1,D=T-v+1;for(let P=0;P<f.length;P+=1)for(let W=0;W<f[P].length;W+=1){const k=f[P][W],$=m+P%_,G=v+W%D,J=this.hot.getCellMeta($,G);sP(k,J.type)&&(k.startsWith("'")?f[P][W]=k.slice(1):this.isFormulaCellType($,G,this.sheetId)===!1&&(f[P][W]=Nge(k,J.dateFormat)))}return f}function dH(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(li(si))||ml(AC,this,Tt(this.hot.getSettings().data))}function Xge(){if(Ou(AC,this)){this.switchSheet(this.sheetName);return}const t=De(Ve,this,lg).call(this);t.forEach((n,i)=>{n.forEach((r,o)=>{const s=this.hot.getCellMeta(i,o,{skipMetaExtension:!0}),a=s.dateFormat;sP(r,s.type)&&($F(r,a)?t[i][o]=kF(r,a):r.startsWith("=")||(t[i][o]=`'${r}`))})}),ml(ra,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),ml(ra,this,!1)}function fH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(li(si)))return;const i=Age(this.engine,this.hot.getSettings()[si].sheetName);if(De(Ve,this,If).call(this,i),n!=="updateSettings")if(Ou(AC,this))this.switchSheet(this.sheetName);else{const r=De(Ve,this,lg).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){ml(ra,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),ml(ra,this,!1)}}}function qge(t,e,n,i){if(i!=="get"||Ou(ra,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const r=this.getCellType(t,e);if(r==="VALUE"||r==="EMPTY"){n.value=xge(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&oi(s)&&(s=LF(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Zge(t,e,n,i){if(i!=="get"||Ou(ra,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null)return;const s=this.getCellType(r,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function gH(t,e){if(qh(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};l=De(Ve,this,BF).call(this,c,h,l),c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function Jge(t,e){if(qh(e))return;const n=[],i=[];t.forEach(r=>{let[o,s,,a]=r;const l=this.hot.propToCol(s);if(!oi(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Le(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function Qge(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function eme(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function tme(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function nme(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ime(t,e,n){if(qh(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function rme(t,e,n){if(qh(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function ome(t,e,n,i){if(qh(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function sme(t,e,n,i){if(qh(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ame(t,e,n){var i;ml(ra,this,!0);const r=De(Ve,this,lg).call(this,n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());ml(ra,this,!1),r.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function lme(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function ume(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function cme(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function hme(t){this.hot.runHooks("afterSheetAdded",t)}function dme(t,e){De(Ve,this,If).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function fme(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function gme(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(y_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function mme(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(b_,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=Qe(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function pme(t,e){jF(t,e),e.add(t)}function wme(t,e,n){jF(t,e),e.set(t,n)}function jF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gl(t,e){return t.get(Ba(t,e))}function mH(t,e,n){return t.set(Ba(t,e),n),n}function Ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideColumns");re.getSingleton().register("afterHideColumns");re.getSingleton().register("beforeUnhideColumns");re.getSingleton().register("afterUnhideColumns");const pH="hiddenColumns",vme=310;var No=new WeakMap,Kl=new WeakSet;class Cme extends Ye{constructor(){super(...arguments),pme(this,Kl),wme(this,No,null)}static get PLUGIN_KEY(){return pH}static get PLUGIN_PRIORITY(){return vme}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[pH]}enablePlugin(){var e=this;this.enabled||(mH(No,this,new sC),Gl(No,this).addLocalHook("init",()=>Ba(Kl,this,Tme).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Gl(No,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ba(Kl,e,Eme).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Ba(Kl,this,bme).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Ba(Kl,this,yme).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ba(Kl,e,Rme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Ba(Kl,this,Sme).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=Gl(No,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));I(l,u=>{o[u]=!1}),r=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&s)!==!1&&(i&&s&&Gl(No,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&s,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{I(e,s=>{Gl(No,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Qe(Gl(No,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Gl(No,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){mH(No,this,null),super.destroy()}}function yme(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function bme(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Sme(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return I(t,i=>{let r=!0,o=0;he(i.startCol,i.endCol,s=>{this.isHidden(s)?(r||n(i.startRow,i.endRow,o,s-1),r=!0):(r&&(o=s),s===i.endCol&&n(i.startRow,i.endRow,o,s),r=!1)})}),e}function Rme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),j(e,n)}function Eme(t){t.items.push({name:je},gme(this),mme(this))}function Tme(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function _me(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(S_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Mme(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(R_,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=Qe(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Pme(t,e){UF(t,e),e.add(t)}function Ime(t,e,n){UF(t,e),e.set(t,n)}function UF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xl(t,e){return t.get(ja(t,e))}function wH(t,e,n){return t.set(ja(t,e),n),n}function ja(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideRows");re.getSingleton().register("afterHideRows");re.getSingleton().register("beforeUnhideRows");re.getSingleton().register("afterUnhideRows");const vH="hiddenRows",Ame=320;var Do=new WeakMap,ql=new WeakSet;class Ome extends Ye{constructor(){super(...arguments),Pme(this,ql),Ime(this,Do,null)}static get PLUGIN_KEY(){return vH}static get PLUGIN_PRIORITY(){return Ame}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[vH]}enablePlugin(){var e=this;this.enabled||(wH(Do,this,new sC),Xl(Do,this).addLocalHook("init",()=>ja(ql,this,kme).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Xl(Do,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ja(ql,e,$me).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>ja(ql,this,Hme).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>ja(ql,this,xme).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ja(ql,e,Dme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>ja(ql,this,Nme).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=Xl(Do,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));I(l,u=>{o[u]=!1}),r=Sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&s)!==!1&&(i&&s&&Xl(Do,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&s,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{I(e,s=>{Xl(Do,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Qe(Xl(Do,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Xl(Do,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){wH(Do,this,null),super.destroy()}}function xme(t,e){return this.isHidden(e)?0:t}function Hme(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Nme(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return I(t,i=>{let r=!0,o=0;he(i.startRow,i.endRow,s=>{this.isHidden(s)?(r||n(o,s-1,i.startCol,i.endCol),r=!0):(r&&(o=s),s===i.endRow&&n(o,s,i.startCol,i.endCol),r=!1)})}),e}function Dme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),j(e,n)}function $me(t){t.items.push({name:je},_me(this),Mme(this))}function kme(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Lme(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(qT)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Fme(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ZT)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Vme(t,e){zF(t,e),e.add(t)}function Wme(t,e,n){zF(t,e),e.set(t,n)}function zF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TE(t,e){return t.get(sv(t,e))}function hS(t,e,n){return t.set(sv(t,e),n),n}function sv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnFreeze");re.getSingleton().register("afterColumnFreeze");re.getSingleton().register("beforeColumnUnfreeze");re.getSingleton().register("afterColumnUnfreeze");const CH="manualColumnFreeze",Bme=110;var uu=new WeakMap,dS=new WeakSet;class jme extends Ye{constructor(){super(...arguments),Vme(this,dS),Wme(this,uu,!1)}static get PLUGIN_KEY(){return CH}static get PLUGIN_PRIORITY(){return Bme}isEnabled(){return!!this.hot.getSettings()[CH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>sv(dS,this,Ume).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>sv(dS,this,zme).call(this,e,n)),super.enablePlugin())}disablePlugin(){hS(uu,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;TE(uu,this)||hS(uu,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;TE(uu,this)||hS(uu,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function Ume(t){t.items.push({name:"---------"},Lme(this),Fme(this))}function zme(t,e){if(TE(uu,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function hp(t,e,n){return(e=Yme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yme(t){var e=Gme(t,"string");return typeof e=="symbol"?e:e+""}function Gme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fS=0,yH=1,bH=2,Nc="px";let YF=class{constructor(e){hp(this,"hot",void 0),hp(this,"_element",null),hp(this,"state",fS),hp(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=bH}build(){this.state===fS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=fS}isAppended(){return this.state===bH}isBuilt(){return this.state>=yH}setPosition(e,n){oi(e)&&(this._element.style.top=e+Nc),oi(n)&&(this._element.style[this.inlineProperty]=n+Nc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){oi(e)&&(this._element.style.width=e+Nc),oi(n)&&(this._element.style.height=n+Nc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){oi(e)&&(this._element.style.marginTop=e+Nc),oi(n)&&(this._element.style[`margin${li(this.inlineProperty)}`]=n+Nc)}getOffset(){const e=this._element.style,n=`margin${li(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Kme="ht__manualColumnMove--backlight";let Xme=class extends YF{build(){super.build(),j(this._element,Kme)}};const qme="ht__manualColumnMove--guideline";let Zme=class extends YF{build(){super.build(),j(this._element,qme)}};function Jme(t,e){GF(t,e),e.add(t)}function Zr(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e,n){return t.set(Ua(t,e),n),n}function ce(t,e){return t.get(Ua(t,e))}function Ua(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnMove");re.getSingleton().register("afterColumnMove");const gS="manualColumnMove",Qme=120,SH="ht__manualColumnMove",av="show-ui",_E="on-moving--columns",ME="after-selection--columns";var yi=new WeakMap,Ga=new WeakMap,Xs=new WeakMap,dw=new WeakMap,el=new WeakMap,Ci=new WeakMap,dp=new WeakMap,Pr=new WeakMap,eh=new WeakMap,lv=new WeakMap,Af=new WeakMap,Zl=new WeakSet;class epe extends Ye{constructor(){super(...arguments),Jme(this,Zl),Zr(this,yi,new Xme(this.hot)),Zr(this,Ga,new Zme(this.hot)),Zr(this,Xs,[]),Zr(this,dw,0),Zr(this,el,!1),Zr(this,Ci,{}),Zr(this,dp,void 0),Zr(this,Pr,void 0),Zr(this,eh,void 0),Zr(this,lv,void 0),Zr(this,Af,void 0)}static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return Qme}isEnabled(){return!!this.hot.getSettings()[gS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ua(Zl,e,tpe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ua(Zl,e,ipe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Ua(Zl,this,ope).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ua(Zl,e,spe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),j(this.hot.rootElement,SH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ae(this.hot.rootElement,SH),this.unregisterEvents(),ce(yi,this).destroy(),ce(Ga,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=ce(dp,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(Wi(dp,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return Wi(dp,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Sn(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const s=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[gS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return he(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Pr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Pr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(yi,this).getOffset().start,u=ce(yi,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,v=nn(this.hot.rootElement),b=m.innerWidth-ce(eh,this)-v;h=m.innerWidth-ce(Ci,this).eventPageX-b-(i.scrollX===void 0?r:0)}else h=ce(Ci,this).eventPageX-(ce(eh,this)-(i.scrollX===void 0?r:0));if(ce(lv,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Pr,this))&&(o+=r),o+=c,ce(Pr,this)<0)ce(Af,this)>0?ce(Ci,this).col=0:ce(Ci,this).col=e>0?e-1:e;else if(ce(Ci,this).TD.offsetWidth/2+o<=h){const m=ce(Pr,this)>=ce(dw,this)?ce(dw,this)-1:ce(Pr,this);ce(Ci,this).col=m+1,o+=ce(Ci,this).TD.offsetWidth}else ce(Ci,this).col=ce(Pr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:i.scrollX!==void 0&&ce(Pr,this)<ce(Af,this)&&(f-=ce(eh,this)<=i.scrollX?ce(eh,this):0),ce(yi,this).setPosition(null,d),ce(Ga,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ua(Zl,this,npe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ua(Zl,this,rpe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(yi,this).build(),ce(Ga,this).build()}destroy(){ce(yi,this).destroy(),ce(Ga,this).destroy(),super.destroy()}}function tpe(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeActive(),a=Ce(t.target,"sortAction");if(!s||!o||ce(el,this)||t.button!==0||a){Wi(el,this,!1),ce(Xs,this).length=0,ae(this.hot.rootElement,[_E,av]);return}const l=ce(Ga,this).isBuilt()&&!ce(Ga,this).isAppended(),u=ce(yi,this).isBuilt()&&!ce(yi,this).isAppended();l&&u&&(ce(Ga,this).appendTo(r.hider),ce(yi,this).appendTo(r.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,Wi(el,this,!0);const m=n.firstChild?$$(t,n.firstChild).x:t.offsetX;ce(Ci,this).eventPageX=t.pageX,Wi(Pr,this,e.col),ce(Ci,this).TD=n,ce(Ci,this).col=e.col,Wi(Xs,this,this.prepareColumnsToMoving(d,f)),Wi(lv,this,!!this.hot.getSettings().rowHeaders),Wi(dw,this,this.hot.countCols()),Wi(Af,this,this.hot.getSettings().fixedColumnsStart),Wi(eh,this,Kn(this.hot.rootElement).left);const v=ce(lv,this)?-1:0,b=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,T=e.col<ce(Af,this),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),D=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(d,e.col-1)+D,W=this.getColumnsWidth(v,d-1)+(T?_:0)+P;ce(yi,this).setPosition(b,W),ce(yi,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-b),ce(yi,this).setOffset(null,-P),j(this.hot.rootElement,_E)}else ae(this.hot.rootElement,ME),Wi(el,this,!1),ce(Xs,this).length=0}function npe(t){ce(el,this)&&(ce(Ci,this).eventPageX=t.pageX,this.refreshPositions())}function ipe(t,e,n,i){!this.hot.getSelectedRangeActive()||!ce(el,this)||(ce(Xs,this).indexOf(e.col)>-1?ae(this.hot.rootElement,av):j(this.hot.rootElement,av),i.row=!0,i.column=!0,i.cell=!0,Wi(Pr,this,e.col),ce(Ci,this).TD=n)}function rpe(){const t=ce(Ci,this).col,e=ce(Xs,this).length;if(Wi(Pr,this,void 0),Wi(el,this,!1),ae(this.hot.rootElement,[_E,av,ME]),this.hot.selection.isSelectedByColumnHeader()&&j(this.hot.rootElement,ME),e<1||t===void 0)return;const n=ce(Xs,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(ce(Xs,this),t);if(ce(Xs,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualColumn(i),s=o+e-1;this.hot.selectColumns(o,s)}}function ope(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;ce(yi,this).setPosition(i),ce(yi,this).setSize(null,t.hider.offsetHeight-i)}function spe(){this.moveBySettingsOrLoad()}function ape(t,e){KF(t,e),e.add(t)}function Zn(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(t,e,n){return t.set(oo(t,e),n),n}function ie(t,e){return t.get(oo(t,e))}function oo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const uv="manualColumnResize",lpe=130,RH="manualColumnWidths";var js=new WeakMap,fp=new WeakMap,ar=new WeakMap,cv=new WeakMap,ns=new WeakMap,upe=new WeakMap,bh=new WeakMap,gp=new WeakMap,Hi=new WeakMap,Ls=new WeakMap,Fu=new WeakMap,hv=new WeakMap,ch=new WeakMap,Of=new WeakMap,ur=new WeakMap,xf=new WeakMap,$o=new WeakSet;class cpe extends Ye{static get PLUGIN_KEY(){return uv}static get PLUGIN_PRIORITY(){return lpe}constructor(e){super(e),ape(this,$o),Zn(this,js,null),Zn(this,fp,null),Zn(this,ar,[]),Zn(this,cv,null),Zn(this,ns,null),Zn(this,upe,null),Zn(this,bh,null),Zn(this,gp,null),Zn(this,Hi,this.hot.rootDocument.createElement("DIV")),Zn(this,Ls,this.hot.rootDocument.createElement("DIV")),Zn(this,Fu,null),Zn(this,hv,!1),Zn(this,ch,0),Zn(this,Of,null),Zn(this,ur,void 0),Zn(this,xf,void 0),j(ie(Hi,this),"manualColumnResizer"),j(ie(Ls,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[uv]}enablePlugin(){var e=this;this.enabled||(tn(ur,this,new vl),ie(ur,this).addLocalHook("init",()=>oo($o,this,hpe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ie(ur,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return oo($o,e,wpe).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return oo($o,e,vpe).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return oo($o,e,Cpe).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(xf,this,ie(ur,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",RH,ie(ur,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",RH,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return ie(ur,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ie(ur,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||ie(ch,this)>1)return;tn(js,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(ie(js,this)),r=i.col;if(r<0)return;const o=cn(ie(js,this)),s=ie(js,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ie(js,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ie(js,this),i.row,i.col)),tn(fp,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),tn(ar,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();I(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;he(d,f,m=>{ie(ar,this).includes(m)||ie(ar,this).push(m)})})}ie(ar,this).includes(ie(fp,this))||tn(ar,this,[ie(fp,this)]),tn(gp,this,l.start-6),tn(bh,this,parseInt(s.width,10)),ie(Hi,this).style.top=`${l.top}px`,ie(Hi,this).style[this.inlineDir]=`${ie(gp,this)+ie(bh,this)}px`,ie(Hi,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ie(Hi,this))}refreshHandlePosition(){ie(Hi,this).style[this.inlineDir]=`${ie(gp,this)+ie(cv,this)}px`}setupGuidePosition(){const e=parseInt(cn(ie(Hi,this)),10),n=parseInt(ie(Hi,this).style.top,10)+e,i=this.hot.view.getTableHeight();j(ie(Hi,this),"active"),j(ie(Ls,this),"active"),ie(Ls,this).style.top=`${n}px`,this.refreshGuidePosition(),ie(Ls,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(ie(Ls,this))}refreshGuidePosition(){ie(Ls,this).style[this.inlineDir]=ie(Hi,this).style[this.inlineDir]}hideHandleAndGuide(){ae(ie(Hi,this),"active"),ae(ie(Ls,this),"active")}checkIfColumnHeader(e){const n=cl(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",ie(ns,this),i,!0);o!==void 0&&tn(ns,this,o),this.setManualSize(i,ie(ns,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(ns,this),i,!0),r&&e()};ie(ch,this)>=2&&(ie(ar,this).length>1?(I(ie(ar,this),r=>{n(r)}),e()):I(ie(ar,this),r=>{n(r,!0)})),tn(ch,this,0),tn(Of,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>oo($o,this,dpe).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>oo($o,this,fpe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>oo($o,this,gpe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>oo($o,this,mpe).call(this)),this.eventManager.addEventListener(ie(Hi,this),"contextmenu",()=>oo($o,this,ppe).call(this))}destroy(){super.destroy()}}function hpe(){const t=this.hot.getSettings()[uv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{ie(ur,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{ie(ur,this).setValueAtIndex(i,n)})},!0),tn(xf,this,t)):t===!0&&Array.isArray(ie(xf,this))&&this.hot.batchExecution(()=>{ie(xf,this).forEach((n,i)=>{ie(ur,this).setValueAtIndex(i,n)})},!0)}function dpe(t){if(!Z0(t.target)&&ie(hv,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ie(Fu,this)||this.setupHandlePosition(e))}}function fpe(t){t.target.parentNode===this.hot.rootElement&&Ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ie(js,this)),this.setupGuidePosition(),tn(Fu,this,!0),ie(Of,this)===null&&(tn(Of,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ie(Of,this))),tn(ch,this,ie(ch,this)+1),this.startX=t.pageX,tn(ns,this,ie(bh,this)))}function gpe(t){if(ie(Fu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(cv,this,ie(bh,this)+e),I(ie(ar,this),n=>{tn(ns,this,this.setManualSize(n,ie(cv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function mpe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",ie(ns,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ie(ns,this),n,!1)};ie(Fu,this)&&(this.hideHandleAndGuide(),tn(Fu,this,!1),ie(ns,this)!==ie(bh,this)&&(ie(ar,this).length>1?(I(ie(ar,this),i=>{e(i)}),t()):I(ie(ar,this),i=>{e(i,!0)})),this.setupHandlePosition(ie(js,this)))}function ppe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ie(Hi,this)),this.hot.rootElement.removeChild(ie(Ls,this)),tn(Fu,this,!1),tn(hv,this,!0),this.hot._registerImmediate(()=>{tn(hv,this,!1)})}function wpe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=ie(ur,this).getValueAtIndex(i);this.hot.getSettings()[uv]&&r&&(n=r)}return n}function vpe(t,e){const n=ie(ur,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Cpe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function mS(t,e,n){return(e=ype(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ype(t){var e=bpe(t,"string");return typeof e=="symbol"?e:e+""}function bpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pS=0,EH=1,TH=2,Dc="px";let XF=class{constructor(e){mS(this,"hot",void 0),mS(this,"_element",null),mS(this,"state",pS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=TH}build(){this.state===pS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=EH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=pS}isAppended(){return this.state===TH}isBuilt(){return this.state>=EH}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Dc),n!==void 0&&(this._element.style.left=n+Dc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Dc),n&&(this._element.style.height=n+Dc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Dc),n&&(this._element.style.marginLeft=n+Dc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Spe="ht__manualRowMove--backlight";class Rpe extends XF{build(){super.build(),j(this._element,Spe)}}const Epe="ht__manualRowMove--guideline";class Tpe extends XF{build(){super.build(),j(this._element,Epe)}}function _pe(t,e){qF(t,e),e.add(t)}function $c(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(t,e,n){return t.set(za(t,e),n),n}function Ae(t,e){return t.get(za(t,e))}function za(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeRowMove");re.getSingleton().register("afterRowMove");const wS="manualRowMove",Mpe=140,_H="ht__manualRowMove",dv="show-ui",PE="on-moving--rows",IE="after-selection--rows";var bi=new WeakMap,Ka=new WeakMap,qs=new WeakMap,tl=new WeakMap,Bi=new WeakMap,mp=new WeakMap,Jl=new WeakSet;class Ppe extends Ye{constructor(){super(...arguments),_pe(this,Jl),$c(this,bi,new Rpe(this.hot)),$c(this,Ka,new Tpe(this.hot)),$c(this,qs,[]),$c(this,tl,void 0),$c(this,Bi,{}),$c(this,mp,void 0)}static get PLUGIN_KEY(){return wS}static get PLUGIN_PRIORITY(){return Mpe}isEnabled(){return!!this.hot.getSettings()[wS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return za(Jl,e,Ipe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return za(Jl,e,Ope).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>za(Jl,this,Hpe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return za(Jl,e,Npe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),j(this.hot.rootElement,_H),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ae(this.hot.rootElement,_H),this.unregisterEvents(),Ae(bi,this).destroy(),Ae(Ka,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=Ae(mp,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(Tu(mp,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return Tu(mp,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Sn(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const s=i.getRenderableFromVisualIndex(o);s!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[wS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return he(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ae(Bi,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ae(Bi,this).TD,a=this.hot.rootElement,l=Kn(a),u=_h(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ae(Bi,this).eventPageY-d+c,m=o.hider.offsetHeight,v=o.TBODY.offsetTop,b=Ae(bi,this).getOffset().top,T=Ae(bi,this).getSize().height,_=s.offsetHeight/2,D=s.offsetHeight;let P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const W=f>=P+_;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ae(Bi,this).row=n>0?n-1:n:W?(Ae(Bi,this).row=e.row+1,P+=e.row===0?D-1:D):Ae(Bi,this).row=e.row;let k=f,$=P;f+T+b>=m?k=m-T-b:f+b<v&&(k=v+Math.abs(b)),P>=m-1&&($=m-1),Ae(bi,this).setPosition(k),Ae(Ka,this).setPosition($)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>za(Jl,this,Ape).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>za(Jl,this,xpe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ae(bi,this).build(),Ae(Ka,this).build()}destroy(){Ae(bi,this).destroy(),Ae(Ka,this).destroy(),super.destroy()}}function Ipe(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!s||Ae(tl,this)||t.button!==0){Tu(tl,this,!1),Ae(qs,this).length=0,ae(this.hot.rootElement,[PE,dv]);return}const l=Ae(Ka,this).isBuilt()&&!Ae(Ka,this).isAppended(),u=Ae(bi,this).isBuilt()&&!Ae(bi,this).isAppended();l&&u&&(Ae(Ka,this).appendTo(r.hider),Ae(bi,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,Tu(tl,this,!0),Ae(Bi,this).eventPageY=t.pageY,Ae(Bi,this).coords=e,Ae(Bi,this).TD=n,Tu(qs,this,this.prepareRowsToMoving());const m=r.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ae(bi,this).setPosition(null,m),Ae(bi,this).setSize(r.hider.offsetWidth-m,this.getRowsHeight(d,f)),Ae(bi,this).setOffset(-v,null),j(this.hot.rootElement,PE),this.refreshPositions()}else ae(this.hot.rootElement,IE),Tu(tl,this,!1),Ae(qs,this).length=0}function Ape(t){Ae(tl,this)&&(Ae(Bi,this).eventPageY=t.pageY,this.refreshPositions())}function Ope(t,e,n,i){!this.hot.getSelectedRangeActive()||!Ae(tl,this)||(Ae(qs,this).indexOf(e.row)>-1?ae(this.hot.rootElement,dv):j(this.hot.rootElement,dv),i.row=!0,i.column=!0,i.cell=!0,Ae(Bi,this).coords=e,Ae(Bi,this).TD=n)}function xpe(){const t=Ae(Bi,this).row,e=Ae(qs,this).length;if(Tu(tl,this,!1),ae(this.hot.rootElement,[PE,dv,IE]),this.hot.selection.isSelectedByRowHeader()&&j(this.hot.rootElement,IE),e<1||t===void 0)return;const n=Ae(qs,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(Ae(qs,this),t);if(Ae(qs,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualRow(i),s=o+e-1;this.hot.selectRows(o,s)}}function Hpe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;Ae(bi,this).setPosition(null,i),Ae(bi,this).setSize(t.hider.offsetWidth-i)}function Npe(){this.moveBySettingsOrLoad()}function Dpe(t,e){ZF(t,e),e.add(t)}function Jn(t,e,n){ZF(t,e),e.set(t,n)}function ZF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e,n){return t.set(Us(t,e),n),n}function ne(t,e){return t.get(Us(t,e))}function Us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fv="manualRowResize",$pe=30,MH="manualRowHeights";var Xo=new WeakMap,pp=new WeakMap,lr=new WeakMap,Hf=new WeakMap,Xa=new WeakMap,lP=new WeakMap,Sh=new WeakMap,wp=new WeakMap,gi=new WeakMap,Yo=new WeakMap,Vu=new WeakMap,gv=new WeakMap,hh=new WeakMap,Nf=new WeakMap,co=new WeakMap,Df=new WeakMap,Aa=new WeakSet;class kpe extends Ye{static get PLUGIN_KEY(){return fv}static get PLUGIN_PRIORITY(){return $pe}constructor(e){super(e),Dpe(this,Aa),Jn(this,Xo,null),Jn(this,pp,null),Jn(this,lr,[]),Jn(this,Hf,null),Jn(this,Xa,null),Jn(this,lP,null),Jn(this,Sh,null),Jn(this,wp,null),Jn(this,gi,this.hot.rootDocument.createElement("DIV")),Jn(this,Yo,this.hot.rootDocument.createElement("DIV")),Jn(this,Vu,!1),Jn(this,gv,!1),Jn(this,hh,0),Jn(this,Nf,null),Jn(this,co,void 0),Jn(this,Df,void 0),j(ne(gi,this),"manualRowResizer"),j(ne(Yo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[fv]}enablePlugin(){this.enabled||(Bt(co,this,new vl),ne(co,this).addLocalHook("init",()=>Us(Aa,this,Upe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ne(co,this)),this.addHook("modifyRowHeight",(e,n)=>Us(Aa,this,jpe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Bt(Df,this,ne(co,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",MH,ne(co,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",MH,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return ne(co,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return ne(Hf,this)}setupHandlePosition(e){if(ne(hh,this)>1)return;Bt(Xo,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(ne(Xo,this)),o=r.row;if(o<0)return;const s=nn(ne(Xo,this)),a=ne(Xo,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ne(Xo,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ne(Xo,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ne(Xo,this),r.row,r.col)),Bt(pp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Bt(lr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();I(d,f=>{const m=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;he(m,v,b=>{ne(lr,this).includes(b)||ne(lr,this).push(b)})})}ne(lr,this).includes(ne(pp,this))||Bt(lr,this,[ne(pp,this)]),Bt(wp,this,c.top-6),Bt(Sh,this,parseInt(a.height,10)),ne(gi,this).style.top=`${ne(wp,this)+ne(Sh,this)}px`,ne(gi,this).style[this.inlineDir]=`${c.start}px`,ne(gi,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ne(gi,this))}refreshHandlePosition(){ne(gi,this).style.top=`${ne(wp,this)+ne(Hf,this)}px`}setupGuidePosition(){const e=parseInt(nn(ne(gi,this)),10),n=parseInt(ne(gi,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();j(ne(gi,this),"active"),j(ne(Yo,this),"active"),ne(Yo,this).style.top=ne(gi,this).style.top,ne(Yo,this).style[this.inlineDir]=`${n}px`,ne(Yo,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(ne(Yo,this))}refreshGuidePosition(){ne(Yo,this).style.top=ne(gi,this).style.top}hideHandleAndGuide(){ae(ne(gi,this),"active"),ae(ne(Yo,this),"active")}checkIfRowHeader(e){const n=cl(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ne(Xa,this)<n?n:ne(Xa,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&Bt(Xa,this,o),this.setManualSize(i,ne(Xa,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};ne(hh,this)>=2&&(ne(lr,this).length>1?(I(ne(lr,this),r=>{n(r)}),e()):I(ne(lr,this),r=>{n(r,!0)})),Bt(hh,this,0),Bt(Nf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Us(Aa,this,Lpe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Us(Aa,this,Fpe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Us(Aa,this,Vpe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Us(Aa,this,Wpe).call(this)),this.eventManager.addEventListener(ne(gi,this),"contextmenu",()=>Us(Aa,this,Bpe).call(this))}destroy(){super.destroy()}}function Lpe(t){if(!Z0(t.target)&&ne(gv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ne(Vu,this)||this.setupHandlePosition(e))}}function Fpe(t){Ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(ne(Xo,this)),this.setupGuidePosition(),Bt(Vu,this,!0),ne(Nf,this)===null&&(Bt(Nf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ne(Nf,this))),Bt(hh,this,ne(hh,this)+1),Bt(lP,this,t.pageY),Bt(Xa,this,ne(Sh,this)))}function Vpe(t){ne(Vu,this)&&(Bt(Hf,this,ne(Sh,this)+(t.pageY-ne(lP,this))),I(ne(lr,this),e=>{Bt(Xa,this,this.setManualSize(e,ne(Hf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Wpe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ne(Vu,this)&&(this.hideHandleAndGuide(),Bt(Vu,this,!1),ne(Xa,this)!==ne(Sh,this)&&(ne(lr,this).length>1?(I(ne(lr,this),i=>{e(i)}),t()):I(ne(lr,this),i=>{e(i,!0)})),this.setupHandlePosition(ne(Xo,this)))}function Bpe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ne(gi,this)),this.hot.rootElement.removeChild(ne(Yo,this)),Bt(Vu,this,!1),Bt(gv,this,!0),this.hot._registerImmediate(()=>{Bt(gv,this,!1)})}function jpe(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),o=ne(co,this).getValueAtIndex(r);if(this.hot.getSettings()[fv]&&o){var i;(i=this.hot.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.isEnabled()?n=Math.max(o,n??0):n=o}}return n}function Upe(){const t=this.hot.getSettings()[fv],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{ne(co,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{ne(co,this).setValueAtIndex(i,n)}),Bt(Df,this,t)):t===!0&&Array.isArray(ne(Df,this))&&ne(Df,this).forEach((n,i)=>{ne(co,this).setValueAtIndex(i,n)})},!0)}var zpe=nC;zpe("flatMap");var Ype=yn,PH=bn,Gpe=fs,Kpe=r0,Xpe=function(t,e){(!e||typeof t!="string")&&PH(t);var n=Kpe(t);return Gpe(PH(n!==void 0?Ype(n,t):t))},qpe=St,AE=yn,Zpe=zi,OE=bn,Jpe=fs,Qpe=Xpe,ewe=c0,xE=Yi,twe=h0,nwe=pl,JF=!twe("flatMap",function(){}),HE=!JF&&nwe("flatMap",TypeError),iwe=JF||HE,rwe=ewe(function(){for(var t=this.iterator,e=this.mapper,n,i;;){if(i=this.inner)try{if(n=OE(AE(i.next,i.iterator)),!n.done)return n.value;this.inner=null}catch(r){xE(t,"throw",r)}if(n=OE(AE(this.next,t)),this.done=!!n.done)return;try{this.inner=Qpe(e(n.value,this.counter++),!1)}catch(r){xE(t,"throw",r)}}});qpe({target:"Iterator",proto:!0,real:!0,forced:iwe},{flatMap:function(e){OE(this);try{Zpe(e)}catch(n){xE(this,"throw",n)}return HE?AE(HE,this,e):new rwe(Jpe(this),{mapper:e,inner:null})}});function owe(t,e,n){swe(t,e),e.set(t,n)}function swe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ql(t,e,n){return(e=awe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function awe(t){var e=lwe(t,"string");return typeof e=="symbol"?e:e+""}function lwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IH(t,e){return t.get(QF(t,e))}function vp(t,e,n){return t.set(QF(t,e),n),n}function QF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eu=new WeakMap;class qo{constructor(e,n,i,r,o,s){Ql(this,"row",void 0),Ql(this,"col",void 0),Ql(this,"rowspan",void 0),Ql(this,"colspan",void 0),Ql(this,"removed",!1),Ql(this,"cellCoordsFactory",void 0),Ql(this,"cellRangeFactory",void 0),owe(this,eu,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return et`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return et`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return et`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return et`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),vp(eu,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=i),i>0)n<=c&&n>u&&(this[o]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,vp(eu,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(u<=a&&c>=l)this[o]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return vp(eu,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return IH(eu,this)||vp(eu,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),IH(eu,this)}}function uwe(t,e){cwe(t,e),e.add(t)}function cwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cp(t,e,n){return(e=hwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hwe(t){var e=dwe(t,"string");return typeof e=="symbol"?e:e+""}function dwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oa=new WeakSet;class mv{constructor(e){uwe(this,Oa),Cp(this,"plugin",void 0),Cp(this,"mergedCells",[]),Cp(this,"mergedCellsMatrix",new Map),Cp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return et`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=r&&h>=i&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Le(mv.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let u=r;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,s=e.colspan,a=new qo(i,r,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),tu(Oa,this,AH).call(this,a),a):(u&&Le(mv.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),tu(Oa,this,fwe).call(this,i),i):!1}clear(){I(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;he(n,n+r,s=>{he(i,i+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:s,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Be(u,r,r+s-1),d=Be(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=tu(Oa,this,yp).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=tu(Oa,this,yp).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=tu(Oa,this,yp).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=tu(Oa,this,yp).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(s=>{s.shift(r,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{tu(Oa,this,AH).call(this,s)})}}function yp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=r.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=r.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function AH(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function fwe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function vS(t,e,n){return(e=gwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gwe(t){var e=mwe(t,"string");return typeof e=="symbol"?e:e+""}function mwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pwe{constructor(e){vS(this,"plugin",void 0),vS(this,"mergedCellsCollection",void 0),vS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),s=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,v=this.getFarthestCollection(e,n,i,r);if(v){if(i==="down"){const b=v.row+v.rowspan-a-m;o[2]+b>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?b:0}else if(i==="right"){const b=v.col+v.colspan-l-m;o[3]+b>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?b:0}else if(i==="up"){const b=u-m-v.row+1;o[0]+b<0?o[0]+=m:o[0]-=m?b:0}else if(i==="left"){const b=c-m-v.col+1;o[1]+b<0?o[1]+=m:o[1]-=m?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),hn(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[r,a+f,c,h]}default:return null}}getFarthestCollection(e,n,i,r){const[o,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,i),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,v=d-m;let b=null,T=null,_=null;switch(i){case"up":b="includesVertically",_=c-v+1;break;case"left":b="includesHorizontally",_=c-v+1;break;case"down":b="includesVertically",_=h+v-1;break;case"right":b="includesHorizontally",_=h+v-1;break}return I(r,D=>{D[b](_)&&D.isFarther(T,i)&&(T=D)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===i.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return I(e,r=>{const o=r[0],s=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,s,a,l]=r,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(m=>{let{colspan:v}=m;return v===h.getWidth()}):!f.every(m=>{let{rowspan:v}=m;return v===h.getHeight()})}}function CS(t,e,n){return(e=wwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wwe(t){var e=vwe(t,"string");return typeof e=="symbol"?e:e+""}function vwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cwe{constructor(e){CS(this,"plugin",void 0),CS(this,"hot",void 0),CS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function ywe(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(QT)}return this.getTranslatedPhrase(JT)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedActive();return e?qo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function $f(t,e,n){return(e=bwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bwe(t){var e=Swe(t,"string");return typeof e=="symbol"?e:e+""}function Swe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OH{constructor(e){$f(this,"data",void 0),$f(this,"next",null),$f(this,"prev",null),this.data=e}}class bp{constructor(){$f(this,"first",null),$f(this,"last",null)}push(e){const n=new OH(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new OH(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function Rwe(t,e){eV(t,e),e.add(t)}function nu(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(pv(t,e))}function Ji(t,e,n){return t.set(pv(t,e),n),n}function pv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ko=new WeakMap,Lo=new WeakMap,Fo=new WeakMap,Vo=new WeakMap,NE=new WeakMap,Sp=new WeakMap,Rp=new WeakMap,yS=new WeakSet;class Ewe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;Rwe(this,yS),nu(this,ko,new bp),nu(this,Lo,new bp),nu(this,Fo,null),nu(this,Vo,null),nu(this,NE,null),nu(this,Sp,null),nu(this,Rp,null),Ji(NE,this,n),Ji(Sp,this,i),Ji(Rp,this,r)}getCurrentVerticalNode(){return lt(Vo,this).data}getFirstVerticalNode(){return lt(Lo,this).first.data}getNextVerticalNode(){return lt(Vo,this).next.data}getPrevVerticalNode(){return lt(Vo,this).prev.data}getCurrentHorizontalNode(){return lt(Fo,this).data}getFirstHorizontalNode(){return lt(ko,this).first.data}getNextHorizontalNode(){return lt(Fo,this).next.data}getPrevHorizontalNode(){return lt(Fo,this).prev.data}setPrevNodeAsActive(){Ji(Vo,this,lt(Vo,this).prev),Ji(Fo,this,lt(Fo,this).prev)}setNextNodeAsActive(){Ji(Vo,this,lt(Vo,this).next),Ji(Fo,this,lt(Fo,this).next)}buildFocusOrder(e){Ji(ko,this,new bp),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.row;a<=s.row;a++)if(!lt(Sp,this).isHidden(a))for(let l=o.col;l<=s.col;l++){if(lt(Rp,this).isHidden(l))continue;const u=pv(yS,this,xH).call(this,{selectedRange:n,selectionLayer:i,listOrder:lt(ko,this),mergeCellsVisitor:r,row:a,column:l});u&&Ji(Fo,this,u)}}),lt(ko,this).first&&(lt(ko,this).first.prev=lt(ko,this).last,lt(ko,this).last.next=lt(ko,this).first),Ji(Lo,this,new bp),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.col;a<=s.col;a++)if(!lt(Rp,this).isHidden(a))for(let l=o.row;l<=s.row;l++){if(lt(Sp,this).isHidden(l))continue;const u=pv(yS,this,xH).call(this,{selectedRange:n,selectionLayer:i,listOrder:lt(Lo,this),mergeCellsVisitor:r,row:l,column:a});u&&Ji(Vo,this,u)}}),lt(Lo,this).first&&(lt(Lo,this).first.prev=lt(Lo,this).last,lt(Lo,this).last.next=lt(Lo,this).first)}setActiveNode(e,n,i){return lt(ko,this).inorder(r=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=r.data;if(o===i&&e>=s&&e<=a&&n>=l&&n<=u)return Ji(Fo,this,r),!0}),lt(Lo,this).inorder(r=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=r.data;if(o===i&&e>=s&&e<=a&&n>=l&&n<=u)return Ji(Vo,this,r),!0}),this}}function xH(t){let{selectedRange:e,selectionLayer:n,listOrder:i,mergeCellsVisitor:r,row:o,column:s}=t;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),c=lt(NE,this).call(this,o,s);if(c&&r.has(c))return null;const h={selectionLayer:n,colStart:s,colEnd:s,rowStart:o,rowEnd:o};if(c){if(r.add(c),c.row<a.row||c.row+c.rowspan-1>l.row||c.col<a.col||c.col+c.colspan-1>l.col)return null;h.colStart=c.col,h.colEnd=c.col+c.colspan-1,h.rowStart=c.row,h.rowEnd=c.row+c.rowspan-1}const d=i.push(h);return o===u.row&&s===u.col||c&&u.row>=c.row&&u.row<=c.row+c.rowspan-1&&u.col>=c.col&&u.col<=c.col+c.colspan-1?d:null}function tV(t,e,n){const{rowIndexMapper:i,stylesHandler:r}=t;let o=0;for(let a=e;a<e+n;a++)if(!i.isHidden(a)){var s;o+=(s=t.getRowHeight(a))!==null&&s!==void 0?s:r.getDefaultRowHeight(a)}return o}function Twe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!me(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),r.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${r.get(l)}px`,r.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[v,b]=t.translateMergedCellToRenderable(h,m,d,f),T=t.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const U=e._getRowHeightFromSettings(l);if(U!==void 0){const B=e.stylesHandler.areCellsBorderBox()?0:1;r.set(l,U-B)}else if(Tg()){const oe=tV(e,h,m);r.set(l,oe/m)}}const _=n.getRenderableFromVisualIndex(l),D=i.getRenderableFromVisualIndex(u),P=v-_+1,W=b-D+1;let k=n.getNearestNotHiddenIndex(h,1),$=i.getNearestNotHiddenIndex(d,1);if(T){const U=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(U)||(k=Math.max(k,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(U)||($=Math.max($,e.getFirstRenderedVisibleColumn()))}const G=Math.min(m,P),J=Math.min(f,W);k===l&&$===u?(a.setAttribute("rowspan",G),a.setAttribute("colspan",J)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function _we(t,e){nV(t,e),e.add(t)}function Ep(t,e,n){nV(t,e),e.set(t,n)}function nV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bS(t,e,n){return(e=Mwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mwe(t){var e=Pwe(t,"string");return typeof e=="symbol"?e:e+""}function Pwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ug(t,e,n){return t.set(ct(t,e),n),n}function bt(t,e){return t.get(ct(t,e))}function ct(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeMergeCells");re.getSingleton().register("afterMergeCells");re.getSingleton().register("beforeUnmergeCells");re.getSingleton().register("afterUnmergeCells");const DE="mergeCells",Iwe=150,HH=DE;var $r=new WeakMap,kr=new WeakMap,is=new WeakMap,NH=new WeakMap,pt=new WeakSet;class Awe extends Ye{constructor(){super(...arguments),_we(this,pt),bS(this,"mergedCellsCollection",null),bS(this,"autofillCalculations",null),bS(this,"selectionCalculations",null),Ep(this,$r,null),Ep(this,kr,{row:0,col:0}),Ep(this,is,new Ewe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Ep(this,NH,Twe(this))}static get PLUGIN_KEY(){return DE}static get PLUGIN_PRIORITY(){return Iwe}static get DEFAULT_SETTINGS(){return{[vL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[DE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new mv(this),this.autofillCalculations=new pwe(this),this.selectionCalculations=new Cwe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Owe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Hwe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Nwe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Dwe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,$we).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,$H).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,$H).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Lwe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Fwe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Vwe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,DH).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,DH).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,xwe).call(e,...i)}),this.addHook("afterRenderer",function(){return bt(NH,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,kwe).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Wwe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Bwe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,jwe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Uwe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,zwe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Ywe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Gwe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Kwe).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Xwe).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,qwe).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Zwe).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Jwe).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,Qwe).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ct(pt,e,eve).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!B0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let s=r+1;s<r+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(r);s&&(s.style.background=Xf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=Xf(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?qo.containsNegativeValues(e)?(Le(qo.NEGATIVE_VALUES_WARNING(e)),!1):qo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Le(qo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):qo.isSingleCell(e)?(Le(qo.IS_SINGLE_CELL(e)),!1):qo.containsZeroSpan(e)?(Le(qo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:s,rowspan:a,colspan:l}=r,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),he(0,s.rowspan-1,c=>{he(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),I(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),he(0,r.rowspan-1,o=>{he(0,r.colspan-1,s=>{this.hot.removeCellMeta(r.row+o,r.col+s,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+s,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeActive();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:HH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HH)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(me(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(me(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(me(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(me(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function Owe(){this.generateFromSettings(),this.hot.render()}function xwe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function Hwe(t){bt(kr,this).row=t.row,bt(kr,this).col=t.col}function Nwe(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;bt($r,this)&&(r.getRenderableFromVisualIndex(bt($r,this).row)!==null&&(n.row=bt($r,this).row),i.getRenderableFromVisualIndex(bt($r,this).col)!==null&&(n.col=bt($r,this).col),ug($r,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Dwe(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function $we(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){ug($r,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);ug($r,this,e.clone()),n&&e.assign(n)}function DH(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:s,colspan:a,rowspan:l}=r,u=o,c=s,h=o+l-1,d=s+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Be(m,u,h),Be(v,c,d),Be(this.hot.getLastRenderedVisibleRow(),u,h),Be(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function kwe(t){t.items.push({name:"---------"},ywe(this))}function $H(){ug($r,this,null)}function Lwe(){if(bt($r,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=bt($r,this).clone().normalize();bt(is,this).setActiveNode(i.row,i.col),bt(kr,this).row>0||bt(kr,this).col>0?bt(is,this).setPrevNodeAsActive():(n==="E-W"&&bt(kr,this).col<0||e==="S-N"&&bt(kr,this).row<0)&&bt(is,this).setNextNodeAsActive()}function Fwe(t,e){const{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let r=this.hot.getActiveSelectionLayerIndex(),o=null,s=null;if(bt(kr,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(is,this).getPrevHorizontalNode();s=n.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1),r=u}else if(bt(kr,this).col>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(is,this).getNextHorizontalNode();s=n.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1),r=u}else if(bt(kr,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(is,this).getPrevVerticalNode();s=n.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1),r=u}else if(bt(kr,this).row>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(is,this).getNextVerticalNode();s=n.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1),r=u}if(o!==null||s!==null){this.hot.selection.setActiveSelectionLayerIndex(r);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(o,s),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(l),c.clear(),c.add(l).commit()}bt(is,this).setActiveNode(t,e,r),ug(kr,this,{row:0,col:0})}function Vwe(){bt(is,this).buildFocusOrder(this.hot.getSelectedRange())}function Wwe(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function Bwe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function jwe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Uwe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function zwe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Ywe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Gwe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Kwe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Xwe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function qwe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),i=this.mergedCellsCollection.getWithinRange(n);I(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function Zwe(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function Jwe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Qwe(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(s,s,a))}function eve(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,tV(this.hot,e,m))}),t}function tve(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function s(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:IL(u.type))(l,u,d)(c,h);if(m===ls){const v=a+1;if(typeof e[v]<"u")return s(v)}return m}(0)}}const iV="sort";function nve(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${iV}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function ive(t){const e=t.className.split(" "),n=new RegExp(`^${iV}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function rve(t,e,n){return(e=ove(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ove(t){var e=sve(t,"string");return typeof e=="symbol"?e:e+""}function sve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wv="multiColumnSorting",ave=170,kH=wv;PL(wv,tve);class lve extends LL{constructor(){super(...arguments),rve(this,"pluginKey",wv)}static get PLUGIN_KEY(){return wv}static get PLUGIN_PRIORITY(){return ave}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Zw)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Cl,position:"before",group:kH})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kH)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),ae(e,ive(e)),this.enabled!==!1&&j(e,nve(...i))}onAfterOnCellMouseDown(e,n){KM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Zw))):this.sort(this.getColumnNextConfig(n.col)))}}function LH(t,e,n){return(e=uve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uve(t){var e=cve(t,"string");return typeof e=="symbol"?e:e+""}function cve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hve="multipleSelectionHandles",dve=160;class fve extends Ye{constructor(){super(...arguments),LH(this,"dragged",[]),LH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return hve}static get PLUGIN_PRIORITY(){return dve}isEnabled(){return mo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(Ce(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(Ce(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(Ce(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(Ce(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function $E(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function rV(){return{label:"",isPlaceholder:!0}}function gve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;I(t,r=>{const o=[];let s=0;n.push(o),I(r,a=>{const l=$E();if(me(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Ct(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Ct(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(rV());return!u})});const i=Math.max(...Qe(n,r=>r.length));return I(n,r=>{if(r.length<i){const o=Qe(new Array(i-r.length),()=>$E());r.splice(r.length,0,...o)}}),n}function SS(t,e,n){mve(t,e),e.set(t,n)}function mve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(t,e){return t.get(oV(t,e))}function Yd(t,e,n){return t.set(oV(t,e),n),n}function oV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const FH=["label","collapsible"];var Hs=new WeakMap,iu=new WeakMap,RS=new WeakMap;class pve{constructor(){SS(this,Hs,[]),SS(this,iu,0),SS(this,RS,1/0)}setColumnsLimit(e){Yd(RS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Yd(Hs,this,gve(e,Jr(RS,this))),Yd(iu,this,Jr(Hs,this).length)}getData(){return Jr(Hs,this)}mergeWith(e){I(e,n=>{let{row:i,col:r,...o}=n;const s=this.getHeaderSettings(i,r);s!==null&&hn(s,o,FH)})}map(e){I(Jr(Hs,this),n=>{I(n,i=>{const r=e({...i});me(r)&&hn(i,r,FH)})})}getHeaderSettings(e,n){var i;if(e>=Jr(iu,this)||e<0)return null;const r=Jr(Hs,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Jr(iu,this)||e<0)return r;const o=Jr(Hs,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Jr(iu,this)}getColumnsCount(){return Jr(iu,this)>0?Jr(Hs,this)[0].length:0}clear(){Yd(Hs,this,[]),Yd(iu,this,0)}}function ES(t,e,n){return(e=wve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wve(t){var e=vve(t,"string");return typeof e=="symbol"?e:e+""}function vve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sV="DF-pre-order";function aV(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=aV.call(this.childs[i],t,e)}return n}const Cve="DF-post-order";function lV(t,e){for(let n=0;n<this.childs.length;n++)if(lV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const uV="BF";function yve(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const bve=uV,VH=new Map([[sV,aV],[Cve,lV],[uV,yve]]);class vv{constructor(e){ES(this,"data",{}),ES(this,"parent",null),ES(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new vv({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bve;if(!VH.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);VH.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function TS(t,e,n){Sve(t,e),e.set(t,n)}function Sve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fi(t,e){return t.get(cV(t,e))}function Rve(t,e,n){return t.set(cV(t,e),n),n}function cV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kc=new WeakMap,ru=new WeakMap,Lc=new WeakMap;class Eve{constructor(e){TS(this,kc,new Map),TS(this,ru,new Map),TS(this,Lc,null),Rve(Lc,this,e)}getRoots(){return Array.from(fi(kc,this).values())}getRootByColumn(e){let n;return fi(ru,this).has(e)&&(n=fi(kc,this).get(fi(ru,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-fi(ru,this).get(n);let o=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=o&&r<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;fi(ru,this).clear(),I(fi(kc,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)fi(ru,this).set(r,e);e+=i})}buildTree(){this.clear();const e=fi(Lc,this).getColumnsCount();let n=0;for(;n<e;){const i=fi(Lc,this).getHeaderSettings(0,n),r=new vv;fi(kc,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=fi(Lc,this).getHeadersSettings(i,n,r);i+=1,I(o,s=>{const a={...s,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new vv(a),e.addChild(l)),i<fi(Lc,this).getLayersCount()&&this.buildLeaves(l,n,i,s.origColspan),n+=s.origColspan})}clear(){fi(kc,this).clear(),fi(ru,this).clear()}}function hV(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function Cv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function yv(t){return Cv(t,"origColspan")===t.data.origColspan}function uP(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yv(t))return uP(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let s=0;if(r.length>0)I(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,hV(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):yv(a)&&(l.isCollapsed=Cv(a,"isCollapsed"))}),{rollbackModification:()=>cP(t),affectedColumns:Array.from(o),colspanCompensation:s}}function cP(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(yv(t))return cP(i[0]);n.isCollapsed=!0;const o=i.slice(1),s=new Set;if(o.length>0)I(o,l=>{hV(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Cv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):yv(l)&&(u.isCollapsed=Cv(l,"isCollapsed"))}),{rollbackModification:()=>uP(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Tve(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(et`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function _ve(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(et`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const WH=new Map([["collapse",cP],["expand",uP],["hide-column",Tve],["show-column",_ve]]);function Mve(t,e,n){if(!WH.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return WH.get(t)(e,n)}function Tp(t){const e=[];return I(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=r,u=Ive(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(rV());else{const f=Pve(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function Pve(t){const{crossHiddenColumns:e,...n}=$E(t);return n}function Ive(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function _S(t,e,n){Ave(t,e),e.set(t,n)}function Ave(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gd(t,e,n){return t.set(dV(t,e),n),n}function Ft(t,e){return t.get(dV(t,e))}function dV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wo=new WeakMap,xi=new WeakMap,ou=new WeakMap;class Ove{constructor(){_S(this,Wo,new pve),_S(this,xi,new Eve(Ft(Wo,this))),_S(this,ou,[[]])}setState(e){Ft(Wo,this).setData(e);let n=!1;try{Ft(xi,this).buildTree()}catch{Ft(xi,this).clear(),Ft(Wo,this).clear(),n=!0}return Gd(ou,this,Tp(Ft(xi,this).getRoots())),n}setColumnsLimit(e){Ft(Wo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Qe(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});Ft(Wo,this).mergeWith(n),Ft(xi,this).buildTree(),Gd(ou,this,Tp(Ft(xi,this).getRoots()))}mapState(e){Ft(Wo,this).map(e),Ft(xi,this).buildTree(),Gd(ou,this,Tp(Ft(xi,this).getRoots()))}mapNodes(e){return Sn(Ft(xi,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Ft(xi,this).getNode(n,i);let o;return r&&(o=Mve(e,r,i),Gd(ou,this,Tp(Ft(xi,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Ft(ou,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Ft(xi,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let s=e;s<=n;s++){const a=Ft(xi,this).getRootByColumn(s);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=i&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},sV)}return r&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ft(Wo,this).getLayersCount()}getColumnsCount(){return Ft(Wo,this).getColumnsCount()}clear(){Gd(ou,this,[]),Ft(Wo,this).clear(),Ft(xi,this).clear()}}function Kd(t,e,n){return(e=xve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xve(t){var e=Hve(t,"string");return typeof e=="symbol"?e:e+""}function Hve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nve{constructor(e,n){Kd(this,"hot",void 0),Kd(this,"nestedHeaderSettingsGetter",void 0),Kd(this,"layersCount",0),Kd(this,"container",void 0),Kd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),wl(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function Dve(t,e){fV(t,e),e.add(t)}function BH(t,e,n){return(e=$ve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ve(t){var e=kve(t,"string");return typeof e=="symbol"?e:e+""}function kve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fc(t,e,n){fV(t,e),e.set(t,n)}function fV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(t,e,n){return t.set(En(t,e),n),n}function Ne(t,e){return t.get(En(t,e))}function En(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jH="nestedHeaders",Lve=280;var ft=new WeakMap,xa=new WeakMap,kf=new WeakMap,OC=new WeakMap,bv=new WeakMap,su=new WeakMap,Hn=new WeakSet;class Fve extends Ye{constructor(){super(...arguments),Dve(this,Hn),Fc(this,ft,new Ove),Fc(this,xa,null),Fc(this,kf,null),Fc(this,OC,!1),Fc(this,bv,null),BH(this,"ghostTable",new Nve(this.hot,(e,n)=>this.getHeaderSettings(e,n))),BH(this,"detectedOverlappedHeaders",!1),Fc(this,su,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:i}=n;if(i.isHeader()&&i.col>=0){const o=Ne(ft,this).findLeftMostColumnIndex(i.row,i.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=o,s.visualCellRange.from.col=o,s.visualCellRange.to.col=o,s.commit()}})}static get PLUGIN_KEY(){return jH}static get PLUGIN_PRIORITY(){return Lve}isEnabled(){return!!this.hot.getSettings()[jH]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Le(et`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>En(Hn,this,tCe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,nCe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,jve).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Uve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,zve).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Yve).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Gve).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Kve).call(e,...r)}),this.addHook("afterSelection",()=>Ne(su,this).call(this)),this.addHook("afterSelectionFocusSet",()=>Ne(su,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Vve).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>En(Hn,this,qve).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Jve).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Qve).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Wve).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Bve).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Xve).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,Zve).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return En(Hn,e,eCe).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",Ne(su,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ne(su,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ne(ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ne(ft,this).setState(e)),this.detectedOverlappedHeaders&&Le(et`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";Ne(ft,this).triggerColumnModification(r,i)}),!Ne(xa,this)&&this.enabled&&Zs(xa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:s}=i;if(r==="replace"){const a=s===!0?"hide-column":"show-column";Ne(ft,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ne(su,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",Ne(su,this)),this.clearColspans(),Ne(ft,this).clear(),Ne(xa,this).unsubscribe(),Zs(xa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ne(ft,this)}getLayersCount(){return Ne(ft,this).getLayersCount()}getHeaderSettings(e,n){return Ne(ft,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=i.childNodes[s];if(!a)break;const l=r.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ae(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ae(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ae(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),o.removeAttribute("colspan"),ae(o,"hiddenHeader"),ae(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ne(ft,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)j(o,"hiddenHeader");else if(c>1){var m,v,b;const{wtOverlays:T}=l._wt,_=(m=T.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),D=(v=T.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((b=T.topOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(o))&&u<i&&j(o,"hiddenHeaderText");const W=_||D?Math.min(c,i-r):c;W>1&&o.setAttribute("colspan",W)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const T=o.querySelector("div.relative");T&&f&&f.length>0&&(ae(T,this.hot.getColumnMeta(u).headerClassName),j(T,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=Ne(ft,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){Zs(ft,this,null),Ne(xa,this)!==null&&(Ne(xa,this).unsubscribe(),Zs(xa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ne(ft,this).getHeaderTreeNodeData(e.row,e.col)}}function Vve(t,e){var n;const i=this.hot.getSelectedRangeActive();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?r.row:(n=Ne(bv,this))===null||n===void 0?void 0:n.row,l=s?t:r.col,u=a<0&&l>=0;if(Zs(bv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ne(ft,this).findLeftMostColumnIndex(a,l),m=Ne(ft,this).findRightMostColumnIndex(a,l),v=m-f+1;if(f<c&&m>h)return f;if(s){let b=null;return f>=c&&m>h?v>d?(e.value="start",b=f):(e.value="end",b=m):f<c&&m<=h&&(v>d?(e.value="end",b=m):(e.value="start",b=f)),b}return f<=c?f:m}function Wve(t,e,n){const i=Ne(ft,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ne(ft,this).getHeaderSettings(e,t);if(o===mT){if(!a)return i.columnIndex}else if(o===sk&&(l>s-r||!a))return null;return t}function Bve(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var r;const m=c+f,v=d-a;if(v===0)continue;((r=Ne(ft,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[m][v]="")}}}function jve(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Uve(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Zs(kf,this,e.clone()),Zs(OC,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,s,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(tC(t)||fl(t)&&l||D$(t))&&o.push(s,s+a-1,e.row),i.selectColumns(...o)}function zve(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:s}=r,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=Be(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Yve(){Zs(OC,this,!1)}function Gve(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ne(OC,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=Ne(ft,this).getHeaderTreeNodeData(Ne(kf,this).row,Ne(kf,this).col);if(e.setHighlight(Ne(kf,this)),o>e.getWidth()||r<n||r+o-1>i){const s=Ne(ft,this).findTopMostEntireHeaderLevel(Be(n,r,r+o-1),Be(i,r,r+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Kve(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=Ne(ft,this).findLeftMostColumnIndex(n.row,n.col),o=Ne(ft,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=r&&e.col<=o?r-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=r&&e.col<=o?o+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Xve(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});Zs(bv,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function qve(t){if(Ne(ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ne(ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Zve(t){const e=Ne(ft,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=Ne(ft,this).findLeftMostColumnIndex(r,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),oi(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?Ne(ft,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Jve(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Qve(t,e,n){var i;const{label:r}=(i=Ne(ft,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function eCe(t,e){if(t<0)return this.hot.getCell(t,Ne(ft,this).findLeftMostColumnIndex(t,e),!0)}function tCe(){this.updatePlugin()}function nCe(t,e){e||this.updatePlugin()}function Xd(t,e,n){return(e=iCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iCe(t){var e=rCe(t,"string");return typeof e=="symbol"?e:e+""}function rCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oCe{constructor(e,n){Xd(this,"hot",void 0),Xd(this,"data",null),Xd(this,"plugin",void 0),Xd(this,"parentReference",new WeakMap),Xd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},he(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&I(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:r!=null&&a===r?{result:s,end:!0}:(s+=1,a.__children&&I(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,i,r),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Fe(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(I(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(he(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),he(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];I(i,o=>{r.push(this.getDataObject(o))}),I(r,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,s=e;r&&r.__children&&r.__children.length===0?(o=r,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(s,n,...i):o.__children.splice(s,n):i?this.data.splice(s,n,...i):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function UH(t,e,n){return(e=sCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sCe(t){var e=aCe(t,"string");return typeof e=="symbol"?e:e+""}function aCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hP{constructor(e,n){UH(this,"hot",void 0),UH(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Jo extends hP{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getDataObject(i);if(!r)return;const o=this.dataManager.getRowLevel(i),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(I(l,c=>{c&&s.removeChild(c)}),j(n,Jo.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",he(0,o-1,()=>{const d=c.createElement("SPAN");j(d,Jo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(r)){const c=this.hot.rootDocument.createElement("DIV");u&&le(c,[Xu()]),j(n,Jo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(j(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.expandButton}`),u&&le(n,[Lr(!1)])):(j(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.collapseButton}`),u&&le(n,[Lr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class lCe extends hP{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),I(i.lastCollapsedRows,(a,l)=>{a>=r&&a<o&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{he(r,r+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&I(o.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];I(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return I(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);I(r.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return I(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);I(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&I(o.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];I(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];I(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];I(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&I(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);Ce(e.target,Jo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),gr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function uCe(t,e,n){cCe(t,e),e.set(t,n)}function cCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hCe(t,e,n){return(e=dCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dCe(t){var e=fCe(t,"string");return typeof e=="symbol"?e:e+""}function fCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gCe(t,e){return t.get(mCe(t,e))}function mCe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zH=new WeakMap;class pCe extends hP{constructor(){super(...arguments),hCe(this,"dataManager",this.plugin.dataManager),uCe(this,zH,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(v_)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedActive();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(C_)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const i=this.hot.getSelectedActive(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return he(0,e.items.length-1,i=>{if(i===0)return I(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return he(0,e.items.length-1,n=>{const i=gCe(zH,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function _p(t,e,n){return(e=wCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wCe(t){var e=vCe(t,"string");return typeof e=="symbol"?e:e+""}function vCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CCe{constructor(e){_p(this,"plugin",void 0),_p(this,"hot",void 0),_p(this,"dataManager",void 0),_p(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(m=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let s=!1;return Tt(r)&&(Le(et`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let s=null;e[i-1]<n?s=this.dataManager.translateTrimmedRow(n-i):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function yCe(t,e){gV(t,e),e.add(t)}function YH(t,e,n){gV(t,e),e.set(t,n)}function gV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MS(t,e,n){return(e=bCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bCe(t){var e=SCe(t,"string");return typeof e=="symbol"?e:e+""}function SCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fw(t,e){return t.get(Tn(t,e))}function Sv(t,e,n){return t.set(Tn(t,e),n),n}function Tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Rv="nestedRows",RCe=300,GH=Rv,ECe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var xC=new WeakMap,Vc=new WeakMap,Nn=new WeakSet;class TCe extends Ye{constructor(){super(...arguments),yCe(this,Nn),MS(this,"dataManager",null),MS(this,"headersUI",null),MS(this,"collapsedRowsMap",null),YH(this,xC,!1),YH(this,Vc,!1)}static get PLUGIN_KEY(){return Rv}static get PLUGIN_PRIORITY(){return RCe}isEnabled(){return!!this.hot.getSettings()[Rv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Hg),this.dataManager=new oCe(this,this.hot),this.collapsingUI=new lCe(this,this.hot),this.headersUI=new Jo(this,this.hot),this.contextMenuUI=new pCe(this,this.hot),this.rowMoveController=new CCe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,FCe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,VCe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,PCe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,ICe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,ACe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,MCe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,HCe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,xCe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,NCe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,DCe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,$Ce).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,kCe).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,OCe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,LCe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tn(Nn,e,_Ce).call(e,...i)}),this.addHook("beforeLoadData",n=>Tn(Nn,this,KH).call(this,n)),this.addHook("beforeUpdateData",n=>Tn(Nn,this,KH).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:GH,relativeToGroup:Cl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(GH)}disableCoreAPIModifiers(){Sv(Vc,this,!0)}enableCoreAPIModifiers(){Sv(Vc,this,!1)}onModifyRowData(e){if(!fw(Vc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!fw(Vc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return fw(Vc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function _Ce(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function MCe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function PCe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Sv(xC,this,!0),this.dataManager.getData().slice()}function ICe(t){return this.contextMenuUI.appendOptions(t)}function ACe(t,e){this.headersUI.appendLevelIndicators(t,e)}function OCe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function xCe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{Sv(xC,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function HCe(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(s)&&s.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function NCe(){this.collapsingUI.collapsedRowsStash.stash()}function DCe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function $Ce(){this.collapsingUI.collapsedRowsStash.stash()}function kCe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function LCe(){this.dataManager.rewriteCache()}function FCe(){this.headersUI.updateRowHeaderWidth()}function VCe(t,e){fw(xC,this)&&(e.skipRender=!0)}function KH(t){if(!mk(t)){nT(ECe),this.hot.getSettings()[Rv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function WCe(t,e){mV(t,e),e.add(t)}function Ha(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){return t.get(Lf(t,e))}function Bo(t,e,n){return t.set(Lf(t,e),n),n}function Lf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BCe=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var dh=new WeakMap,cu=new WeakMap,PS=new WeakMap,Qn=new WeakMap,Wc=new WeakMap,Tr=new WeakMap,IS=new WeakMap,AS=new WeakMap,Mp=new WeakSet;class pV{constructor(e){let{rootElement:n,uiContainer:i,isRtl:r,themeName:o,phraseTranslator:s,shouldHaveBorder:a,a11yAnnouncer:l}=e;WCe(this,Mp),Ha(this,dh,void 0),Ha(this,cu,void 0),Ha(this,PS,!1),Ha(this,Qn,void 0),Ha(this,Wc,void 0),Ha(this,Tr,void 0),Ha(this,IS,void 0),Ha(this,AS,void 0),Bo(dh,this,n),Bo(cu,this,i),Bo(PS,this,r),Bo(Wc,this,o),Bo(Tr,this,s),Bo(IS,this,a),Bo(AS,this,l),this.install()}install(){var e;if((e=Ke(Qn,this))!==null&&e!==void 0&&e.container)return;const n=Eh`${BCe}`,{container:i,first:r,prev:o,next:s,last:a,pageSizeSelect:l}=n.refs;Bo(Qn,this,n.refs),i.setAttribute("dir",Ke(PS,this)?"rtl":"ltr"),i.tabIndex=-1;const u=h=>h.currentTarget.disabled,c=(h,d,f)=>{d.addEventListener(h,m=>{u(m)||f()})};c("click",r,()=>this.runLocalHooks("firstPageClick")),c("click",o,()=>this.runLocalHooks("prevPageClick")),c("click",s,()=>this.runLocalHooks("nextPageClick")),c("click",a,()=>this.runLocalHooks("lastPageClick")),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Ke(cu,this)?(Ke(cu,this).appendChild(n.fragment),j(i,[Ke(Wc,this),"handsontable"])):Ke(dh,this).after(n.fragment)}getContainer(){return Ke(Qn,this).container}getFocusableElements(){const{first:e,prev:n,next:i,last:r,pageSizeSelect:o}=Ke(Qn,this);return[o,e,n,i,r].filter(s=>!s.disabled)}updateWidth(e){return Ke(Qn,this).container.style.width=`${e}px`,this}updateTheme(e){if(Bo(Wc,this,e),Ke(cu,this)){const{container:n}=Ke(Qn,this);ae(n,/ht-theme-.*/g),Ke(Wc,this)&&j(n,Ke(Wc,this))}return this}getHeight(){return Ke(Qn,this).container.offsetHeight}refreshBorderState(){const{container:e}=Ke(Qn,this);return Ke(cu,this)||Ke(IS,this).call(this)?j(e,"ht-pagination--bordered"):ae(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:i,firstVisibleRowIndex:r,lastVisibleRowIndex:o,totalRenderedRows:s,pageSizeList:a,pageSize:l,autoPageSize:u}=e;const{first:c,prev:h,next:d,last:f,pageCounterSection:m,pageNavSection:v,pageNavLabel:b,pageSizeSelect:T,pageSizeLabel:_}=Ke(Qn,this),D=Ke(Tr,this).call(this,tM,{start:r+1,end:o+1,total:s}),P=Ke(Tr,this).call(this,nM,{currentPage:n,totalPages:i}),W=Ke(Tr,this).call(this,Lw);m.textContent=D,b.textContent=P,T.textContent="",_.textContent=`${W}:`,le(v,[hr(Ke(Tr,this).call(this,Q_))]),le(T,[hr(Ke(Tr,this).call(this,Lw))]),Ke(AS,this).call(this,P),this.refreshBorderState(),a.forEach(G=>{const J=G==="auto"?Ke(Tr,this).call(this,eM):G,U=new Option(J,G);(u&&G==="auto"||!u&&G===l)&&(U.selected=!0),T.add(U)});const k=n===1,$=n===i;if(v.style.display!=="none"){const G=Ke(dh,this).ownerDocument.activeElement;k?(j(c,"ht-page-navigation-section__button--disabled"),j(h,"ht-page-navigation-section__button--disabled"),c.disabled=!0,h.disabled=!0):(ae(c,"ht-page-navigation-section__button--disabled"),ae(h,"ht-page-navigation-section__button--disabled"),c.disabled=!1,h.disabled=!1),$?(j(d,"ht-page-navigation-section__button--disabled"),j(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(ae(d,"ht-page-navigation-section__button--disabled"),ae(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[c,h,d,f].includes(G)&&(h.disabled?d.focus():d.disabled&&h.focus())}return le(c,[hr(Ke(Tr,this).call(this,iM)),nf(k)]),le(h,[hr(Ke(Tr,this).call(this,rM)),nf(k)]),le(d,[hr(Ke(Tr,this).call(this,oM)),nf($)]),le(f,[hr(Ke(Tr,this).call(this,sM)),nf($)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:i}=Ke(Qn,this);return n.style.display=e?"":"none",i.disabled=!e,Lf(Mp,this,OS).call(this),this}setCounterSectionVisibility(e){return Ke(Qn,this).pageCounterSection.style.display=e?"":"none",Lf(Mp,this,OS).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:i,prev:r,next:o,last:s}=Ke(Qn,this);return n.style.display=e?"":"none",i.disabled=!e,r.disabled=!e,o.disabled=!e,s.disabled=!e,Lf(Mp,this,OS).call(this),this}destroy(){var e;(e=Ke(Qn,this))===null||e===void 0||e.container.remove(),Bo(Qn,this,null)}}function OS(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:i}=Ke(Qn,this),r=e.style.display!=="none"||n.style.display!=="none"||i.style.display!=="none";Ke(cu,this)||(r?j(Ke(dh,this).querySelector(".ht-wrapper"),"htPagination"):ae(Ke(dh,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=r?"":"none"}st(pV,An);const jCe=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function UCe(t){return jCe.some(e=>{const n=!!t[e];return n&&Le(et`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function xS(t,e,n){return(e=zCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zCe(t){var e=YCe(t,"string");return typeof e=="symbol"?e:e+""}function YCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GCe{constructor(){xS(this,"pageSize",1),xS(this,"totalItems",0),xS(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:i}=e;this.pageSize=Math.max(n,1),this.totalItems=i,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,i=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:i,pageSize:this.pageSize}}}function KCe(t,e,n){return(e=XCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XCe(t){var e=qCe(t,"string");return typeof e=="symbol"?e:e+""}function qCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZCe{constructor(){KCe(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:i}=e;const r=n(),o=i(),s=[];let a=0,l=0,u=0;for(let c=0;c<r.length;c++){const h=r[c];u>0&&l+h>=o&&(s.push({startIndex:a,endIndex:c-1,pageSize:u}),a=c,l=0,u=0),l+=h,u+=1}s.push({startIndex:a,endIndex:Math.max(0,r.length-1),pageSize:u}),this.pages=s}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const XH=new Map([["fixed",GCe],["auto",ZCe]]);function qH(t){if(!XH.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=XH.get(t);return new e}function JCe(t,e){wV(t,e),e.add(t)}function Na(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,e){return t.get(Et(t,e))}function Yn(t,e,n){return t.set(Et(t,e),n),n}function Et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _u="pagination",QCe=900,eye=`plugin:${_u}`,ZH=et`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var Ff=new WeakMap,wi=new WeakMap,ao=new WeakMap,en=new WeakMap,lo=new WeakMap,Ev=new WeakMap,gw=new WeakMap,Pt=new WeakSet,HS=new WeakMap;class tye extends Ye{constructor(){super(...arguments),JCe(this,Pt),Na(this,Ff,null),Na(this,wi,1),Na(this,ao,10),Na(this,en,null),Na(this,lo,null),Na(this,Ev,!1),Na(this,gw,!1),Na(this,HS,()=>{var e;!Se(Ev,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&Et(Pt,this,Mu).call(this)})}static get PLUGIN_KEY(){return _u}static get PLUGIN_PRIORITY(){return QCe}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[_u]}enablePlugin(){var e,n=this;if(UCe(this.hot.getSettings())){this.hot.getSettings()[_u]=!1;return}if(this.enabled)return;const i=this.hot.getSettings()[_u];(i==null?void 0:i.initialPage)!==void 0&&Yn(wi,this,this.getSetting("initialPage")),(i==null?void 0:i.pageSize)!==void 0&&Yn(ao,this,this.getSetting("pageSize")),Yn(Ff,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),Se(ao,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&Le(ZH),Yn(lo,this,qH(Se(ao,this)==="auto"?"auto":"fixed")),Se(en,this)||(Yn(en,this,new pV({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>Et(Pt,this,nye).call(this),a11yAnnouncer:r=>ore(r)})),Et(Pt,this,JH).call(this),Se(en,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",r=>this.setPageSize(r))),this.addHook("init",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,hye).call(n,...o)},-1),this.addHook("beforeSelectAll",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,QH).call(n,...o)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,QH).call(n,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,oye).call(n,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,sye).call(n,...o)}),this.addHook("beforePaste",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,aye).call(n,...o)}),this.addHook("afterViewRender",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,lye).call(n,...o)}),this.addHook("afterRender",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,uye).call(n,...o)}),this.addHook("afterScrollVertically",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,dye).call(n,...o)}),this.addHook("afterLanguageChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,fye).call(n,...o)}),this.addHook("beforeHeightChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,cye).call(n,...o)}),this.addHook("afterSetTheme",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,gye).call(n,...o)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Se(HS,this)),Et(Pt,this,iye).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Et(Pt,this,Mu).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Se(HS,this)).unregisterMap(this.pluginName),Et(Pt,this,rye).call(this),Se(en,this).destroy(),Yn(en,this,null),super.disablePlugin()}getPaginationData(){const e=Se(lo,this).getTotalPages();let n=-1,i=-1;const{pageSize:r,startIndex:o}=Se(lo,this).getState(Se(wi,this)),s=this.hot.countRows();let a=0;for(let l=o;a<r&&!(l>=s);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(n===-1&&(n=l),i=l,a+=1);return{currentPage:Se(wi,this),totalPages:e,pageSize:r,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:Se(ao,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:i}}setPage(e){const n=Se(wi,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&(Yn(wi,this,e),Et(Pt,this,Mu).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,Se(wi,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const i=Se(ao,this);this.hot.runHooks("beforePageSizeChange",i,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&Le(ZH),Yn(lo,this,qH(e==="auto"?"auto":"fixed")),Yn(ao,this,e),Et(Pt,this,Mu).call(this),this.hot.runHooks("afterPageSizeChange",i,Se(ao,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),Et(Pt,this,JH).call(this)}nextPage(){this.setPage(Se(wi,this)+1)}prevPage(){this.setPage(Se(wi,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(Se(lo,this).getTotalPages())}hasPreviousPage(){return Se(wi,this)>1}hasNextPage(){return Se(wi,this)<Se(lo,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){Se(en,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){Se(en,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){Se(en,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){Se(en,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){Se(en,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){Se(en,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;Yn(Ff,this,null),Yn(lo,this,null),(e=Se(en,this))===null||e===void 0||e.destroy(),Yn(en,this,null),super.destroy()}}function JH(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function Mu(){Yn(Ev,this,!0),Se(Ff,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;Se(lo,this).calculate({pageSize:Se(ao,this),totalItems:e,viewportSizeProvider:()=>{const{view:o}=this.hot;if(o.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?o._wt.wtTable.getColumnHeaderHeight():0,c=Se(en,this).getHeight();return o.getWorkspaceHeight()-c-u-l}const s=o.hasHorizontalScroll()?rn():0;return o.getViewportHeight()-s},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(s=>{var a;const l=this.hot.toVisualRow(s);return(a=this.hot.getRowHeight(l))!==null&&a!==void 0?a:n.getDefaultRowHeight(l)})});const i=Se(lo,this).getTotalPages();if(Yn(wi,this,Be(Se(wi,this),1,i)),t.length>0){const{startIndex:o,pageSize:s}=Se(lo,this).getState(Se(wi,this));t.splice(o,s)}t.length>0?this.hot.batchExecution(()=>{t.forEach(o=>Se(Ff,this).setValueAtIndex(o,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),Yn(Ev,this,!1);const r=this.getPaginationData();Se(en,this).updateState({...r,totalRenderedRows:e})}function nye(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function iye(){this.hot.getFocusScopeManager().registerScope(_u,Se(en,this).getContainer(),{shortcutsContextName:eye,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:t=>{const e=Se(en,this).getFocusableElements();e.length>0&&(t==="tab_from_above"?e.at(0).focus():t==="tab_from_below"&&e.at(-1).focus())}})}function rye(){this.hot.getFocusScopeManager().unregisterScope(_u)}function QH(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();(Se(wi,this)>1||t.row>=0)&&(t.row=n),e.row=i}function oye(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function sye(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=Be(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function aye(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();if(n===-1||i===-1)return!1;e.forEach(r=>{let{startRow:o}=r;if(t.length===0)return;const s=Math.min(t.length-(i-o+1),t.length);t.splice(0,s)})}function lye(){if(Se(ao,this)!=="auto"||Se(gw,this)){Yn(gw,this,!1);return}Et(Pt,this,Mu).call(this),Yn(gw,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function uye(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Se(en,this).updateWidth(e).refreshBorderState()}function cye(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${Se(en,this).getHeight()}px)`}function hye(){Se(ao,this)!=="auto"&&Et(Pt,this,Mu).call(this)}function dye(){Se(en,this).refreshBorderState()}function fye(){Et(Pt,this,Mu).call(this)}function gye(t){Se(en,this).updateTheme(t)}function NS(t,e,n){return(e=mye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mye(t){var e=pye(t,"string");return typeof e=="symbol"?e:e+""}function pye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wye{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;NS(this,"rootWindow",void 0),NS(this,"prefix",void 0),NS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){I(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function vye(t,e,n){return(e=Cye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cye(t){var e=yye(t,"string");return typeof e=="symbol"?e:e+""}function yye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}re.getSingleton().register("persistentStateSave");re.getSingleton().register("persistentStateLoad");re.getSingleton().register("persistentStateReset");const e1="persistentState",bye=0,t1=new WeakSet;class Sye extends Ye{constructor(){super(...arguments),vye(this,"storage",void 0)}static get PLUGIN_KEY(){return e1}static get PLUGIN_PRIORITY(){return bye}isEnabled(){return!!this.hot.getSettings()[e1]}enablePlugin(){this.enabled||(t1.has(this.hot)||(t1.add(this.hot),k$("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new wye(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Rye(t,e){Eye(t,e),e.add(t)}function Eye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e,n){return(e=Tye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tye(t){var e=_ye(t,"string");return typeof e=="symbol"?e:e+""}function _ye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $S="search",Mye=190,Pye="htSearchResult",Iye=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},Aye=function(t,e,n){return Tt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Tt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var kS=new WeakSet;class Oye extends Ye{constructor(){super(...arguments),Rye(this,kS),DS(this,"callback",Iye),DS(this,"queryMethod",Aye),DS(this,"searchResultClass",Pye)}static get PLUGIN_KEY(){return $S}static get PLUGIN_PRIORITY(){return Mye}isEnabled(){return this.hot.getSettings()[$S]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[$S];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n1(kS,e,i1).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return n1(kS,e,i1).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return he(0,r-1,l=>{he(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||i)(e,c,h);if(m){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){me(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function i1(t,e,n,i,r,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Pp(t,e,n){return(e=xye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xye(t){var e=Hye(t,"string");return typeof e=="symbol"?e:e+""}function Hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vV{constructor(e){Pp(this,"viewportWidth",void 0),Pp(this,"overwriteColumnWidthFn",void 0),Pp(this,"baseWidths",new Map),Pp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Nye extends vV{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=Mh?(r.push([d,m]),a+=m):f!==m&&(r.push([d,m]),o.push(d),s-=m)}),s<=Mh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;r.forEach((h,d)=>{let[f,m]=h,v=m;o.includes(f)||(v=Math.round(m*l)),this.stretchedWidths.set(f,v),u=f,d<r.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function r1(t,e,n){Dye(t,e),e.set(t,n)}function Dye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e){return t.get(CV(t,e))}function Ip(t,e,n){return t.set(CV(t,e),n),n}function CV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ap=new WeakMap,qd=new WeakMap;class $ye extends vV{constructor(){super(...arguments),r1(this,Ap,0),r1(this,qd,-1)}prepare(e){super.prepare(e),Ip(Ap,this,0),Ip(qd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Ip(qd,this,e),Ip(Ap,this,n)}calculate(){if(LS(qd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+LS(Ap,this),0);this.stretchedWidths.set(LS(qd,this),n)}}function kye(t,e){yV(t,e),e.add(t)}function Op(t,e,n){yV(t,e),e.set(t,n)}function yV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(fh(t,e))}function FS(t,e,n){return t.set(fh(t,e),n),n}function fh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lye="stretchColumns";var kn=new WeakMap,Bc=new WeakMap,VS=new WeakMap,xp=new WeakMap,Zd=new WeakSet;class Fye{constructor(e){kye(this,Zd),Op(this,kn,void 0),Op(this,Bc,void 0),Op(this,VS,new Map([["all",new Nye(fh(Zd,this,o1).bind(this))],["last",new $ye(fh(Zd,this,o1).bind(this))]])),Op(this,xp,"none"),FS(kn,this,e),FS(Bc,this,$t(kn,this).columnIndexMapper.createAndRegisterIndexMap(Lye,"physicalIndexToValue"))}useStrategy(e){FS(xp,this,$t(VS,this).has(e)?e:"none")}refreshStretching(){if($t(xp,this)==="none"){$t(Bc,this).clear();return}$t(kn,this).batchExecution(()=>{$t(Bc,this).clear();const e=$t(VS,this).get($t(xp,this));let i=$t(kn,this).view.getViewportWidth();fh(Zd,this,Vye).call(this)&&(i-=rn($t(kn,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<$t(kn,this).countCols();r++)$t(kn,this).columnIndexMapper.isHidden($t(kn,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,fh(Zd,this,Wye).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,s]=r;$t(Bc,this).setValueAtIndex($t(kn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return $t(Bc,this).getValueAtIndex($t(kn,this).toPhysicalColumn(e))}}function Vye(){const{view:t,stylesHandler:e}=$t(kn,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),i=$t(kn,this).countRows(),r=e.getDefaultRowHeight(),o=e.isClassicTheme(),s=c=>o&&c===0?1:0;let a=0,l=!1;for(let c=0;c<i;c++){var u;if(!$t(kn,this).rowIndexMapper.isHidden($t(kn,this).toPhysicalRow(c))&&(a+=((u=$t(kn,this).getRowHeight(c))!==null&&u!==void 0?u:r)+s(c),a>n)){l=!0;break}}return l}function Wye(t){var e;return(e=$t(kn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Mh}function o1(t,e){return $t(kn,this).runHooks("beforeStretchingColumnWidth",t,e)}function Bye(t,e){bV(t,e),e.add(t)}function WS(t,e,n){bV(t,e),e.set(t,n)}function bV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BS(t,e,n){return t.set(Tv(t,e),n),n}function Fs(t,e){return t.get(Tv(t,e))}function Tv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jye="stretchColumns",Uye=155;var th=new WeakMap,Hp=new WeakMap,Jd=new WeakMap,jS=new WeakSet;class zye extends Ye{constructor(){super(...arguments),Bye(this,jS),WS(this,th,new Fye(this.hot)),WS(this,Hp,null),WS(this,Jd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Fs(Hp,this)!==null&&Fs(Hp,this)!==r.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),BS(Hp,this,r.width)})})}))}static get PLUGIN_KEY(){return jye}static get PLUGIN_PRIORITY(){return Uye}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Fs(th,this).useStrategy(this.hot.getSettings().stretchH),Fs(Jd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tv(jS,e,Gye).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Tv(jS,e,Yye).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Fs(th,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Fs(Jd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Fs(th,this).getStretchedWidth(e)}destroy(){Fs(Jd,this).disconnect(),BS(Jd,this,null),BS(th,this,null),super.destroy()}}function Yye(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function Gye(t){t&&Fs(th,this).refreshStretching()}function Kye(t,e){Xye(t,e),e.add(t)}function Xye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Np(t,e,n){return(e=qye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qye(t){var e=Zye(t,"string");return typeof e=="symbol"?e:e+""}function Zye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function US(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jye="touchScroll",Qye=200;var Dp=new WeakSet;class ebe extends Ye{constructor(){super(...arguments),Kye(this,Dp),Np(this,"scrollbars",[]),Np(this,"clones",[]),Np(this,"lockedCollection",!1),Np(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Jye}static get PLUGIN_PRIORITY(){return Qye}static get SETTING_KEYS(){return!0}isEnabled(){return W0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>US(Dp,this,tbe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>US(Dp,this,nbe).call(this)),this.addHook("afterMomentumScroll",()=>US(Dp,this,ibe).call(this))}}function tbe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function nbe(){this.freezeOverlays=!0,I(this.clones,t=>{j(t,"hide-tween")})}function ibe(){this.freezeOverlays=!1,I(this.clones,t=>{ae(t,"hide-tween"),j(t,"show-tween")}),this.hot._registerTimeout(()=>{I(this.clones,t=>{ae(t,"show-tween")})},400),I(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function rbe(t,e){obe(t,e),e.add(t)}function obe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sbe(t,e,n){return(e=abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=lbe(t,"string");return typeof e=="symbol"?e:e+""}function lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ube(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mw="trimRows",cbe=330;var s1=new WeakSet;class hbe extends Ye{constructor(){super(...arguments),rbe(this,s1),sbe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return mw}static get PLUGIN_PRIORITY(){return cbe}isEnabled(){return!!this.hot.getSettings()[mw]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Hg),this.trimmedRowsMap.addLocalHook("init",()=>ube(s1,this,dbe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[mw];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),I(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{I(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(I(e,l=>{o[l]=!1}),r=Sn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&s,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function dbe(){const t=this.hot.getSettings()[mw];Array.isArray(t)&&this.hot.batchExecution(()=>{I(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function fbe(t,e,n){return(e=gbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gbe(t){var e=mbe(t,"string");return typeof e=="symbol"?e:e+""}function mbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zr{constructor(e){fbe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function $p(t,e,n){return(e=pbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pbe(t){var e=wbe(t,"string");return typeof e=="symbol"?e:e+""}function wbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dP extends zr{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),$p(this,"stateBefore",void 0),$p(this,"range",void 0),$p(this,"type",void 0),$p(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,s)=>{n.done(()=>new dP({stateBefore:i,range:r,type:o,alignment:s}))})}undo(e,n){I(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Wa(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,s)=>e.setCellMeta(i,r,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function a1(t,e,n){return(e=vbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vbe(t){var e=Cbe(t,"string");return typeof e=="symbol"?e:e+""}function Cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fP extends zr{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),a1(this,"columns",void 0),a1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new fP({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),aP(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function l1(t,e,n){return(e=ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ybe(t){var e=bbe(t,"string");return typeof e=="symbol"?e:e+""}function bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gP extends zr{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),l1(this,"previousSortState",void 0),l1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{o&&n.done(()=>new gP({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function u1(t,e,n){return(e=Sbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sbe(t){var e=Rbe(t,"string");return typeof e=="symbol"?e:e+""}function Rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mP extends zr{constructor(e){let{index:n,amount:i}=e;super("insert_col"),u1(this,"index",void 0),u1(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new mP({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function c1(t,e,n){return(e=Ebe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ebe(t){var e=Tbe(t,"string");return typeof e=="symbol"?e:e+""}function Tbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pP extends zr{constructor(e){let{index:n,amount:i}=e;super("insert_row"),c1(this,"index",void 0),c1(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new pP({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function kp(t,e,n){return(e=_be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _be(t){var e=Mbe(t,"string");return typeof e=="symbol"?e:e+""}function Mbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wP extends zr{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),kp(this,"changes",void 0),kp(this,"selected",void 0),kp(this,"countCols",void 0),kp(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new wP({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=ui(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(3,1);e.addHookOnce("afterChange",()=>{const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){const i=ui(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.redo")}}function h1(t,e,n){return(e=Pbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pbe(t){var e=Ibe(t,"string");return typeof e=="symbol"?e:e+""}function Ibe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vP extends zr{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),h1(this,"conditionsStack",void 0),h1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new vP({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function Abe(t,e,n){return(e=Obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Obe(t){var e=xbe(t,"string");return typeof e=="symbol"?e:e+""}function xbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CP extends zr{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),Abe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),s=i.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new CP({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function SV(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return he(i,r,l=>{he(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Ns(t,e,n){return(e=Hbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hbe(t){var e=Nbe(t,"string");return typeof e=="symbol"?e:e+""}function Nbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yP extends zr{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Ns(this,"index",void 0),Ns(this,"indexes",void 0),Ns(this,"data",void 0),Ns(this,"amount",void 0),Ns(this,"headers",void 0),Ns(this,"columnPositions",void 0),Ns(this,"rowPositions",void 0),Ns(this,"fixedColumnsStart",void 0),Ns(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+i)%e.countCols(),c=u+r-1,h=[],d=[],f=[];return he(l.length-1,m=>{const v=[],b=l[m];he(u,c,T=>{v.push(b[e.toPhysicalColumn(T)])}),h.push(v)}),he(r-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&he(r-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new yP({index:u,indexes:f,data:h,amount:r,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:SV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(r[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Qe(this.data[c],o));const l=Qe(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),I(e.getSourceDataArray(),(c,h)=>{I(r,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&I(l,(c,h)=>{e.getSettings().colHeaders[r[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function jc(t,e,n){return(e=Dbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dbe(t){var e=$be(t,"string");return typeof e=="symbol"?e:e+""}function $be(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bP extends zr{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),jc(this,"index",void 0),jc(this,"data",void 0),jc(this,"fixedRowsBottom",void 0),jc(this,"fixedRowsTop",void 0),jc(this,"rowIndexesSequence",void 0),jc(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,s)=>{const a=()=>{const l=e.toPhysicalRow(i),u=l+r-1,c=ui(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new bP({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:SV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);r.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function d1(t,e,n){return(e=kbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kbe(t){var e=Lbe(t,"string");return typeof e=="symbol"?e:e+""}function Lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SP extends zr{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),d1(this,"rows",void 0),d1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new SP({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),aP(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Fbe(t,e,n){return(e=Vbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vbe(t){var e=Wbe(t,"string");return typeof e=="symbol"?e:e+""}function Wbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RP extends zr{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Fbe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new RP({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function Bbe(t,e){[dP,fP,gP,mP,pP,wP,vP,CP,yP,bP,SP,RP].forEach(n=>n.startRegisteringEvents(t,e))}function jbe(t,e){Ube(t,e),e.add(t)}function Ube(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zS(t,e,n){return(e=zbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zbe(t){var e=Ybe(t,"string");return typeof e=="symbol"?e:e+""}function Ybe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const f1="undoRedo",Gbe="undoRedo",Kbe=1e3;re.getSingleton().register("beforeUndo");re.getSingleton().register("afterUndo");re.getSingleton().register("beforeRedo");re.getSingleton().register("afterRedo");const g1=new Set;var Lp=new WeakSet;class Xbe extends Ye{static get PLUGIN_KEY(){return Gbe}static get PLUGIN_PRIORITY(){return Kbe}static get SETTING_KEYS(){return!0}constructor(e){super(e),jbe(this,Lp),zS(this,"doneActions",[]),zS(this,"undoneActions",[]),zS(this,"ignoreNewActions",!1),Bbe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return YS(Lp,e,qbe).call(e,...i)}),this.registerShortcuts(),YS(Lp,this,Zbe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),YS(Lp,this,Jbe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:f1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(f1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=ui(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=ui(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function qbe(t,e){e==="loadData"&&this.clear()}function Zbe(){const t=e=>{g1.has(e)||(Le(et`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),g1.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Jbe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const Fn="ht-dialog";function Qbe(){function t(){return`
      <div data-ref="contentElement" class="${Fn}__content"></div>
    `}let e=null;const n={};function i(){const o=Eh`${t()}`;return Object.assign(n,o.refs),e=o.fragment,o}function r(){if(e===null)throw new Error("Compile the template first.");return[]}return{TEMPLATE_NAME:"base",dialogA11YOptions(){return{role:"dialog"}},compile:i,focusableElements:r}}function eSe(t){let{id:e="",title:n="",description:i="",buttons:r=[]}=t;function o(){return`
      <div tabindex="-1" data-ref="contentElement" class="${Fn}__content-wrapper-inner">
        <div class="${Fn}__content">
          <h2
            id="${e}-dialog-confirm-title"
            class="${Fn}__title">${os(n)}</h2>
          <p
            id="${e}-dialog-confirm-description"
            class="${Fn}__description">${os(i)}</p>
        </div>
        ${r.length>0?`
          <div data-ref="buttonsContainer" class="${Fn}__buttons">
            ${r.map(c=>`
              <button class="ht-button ht-button--${c.type}">${os(c.text)}</button>
            `).join("")}
          </div>
        `:""}
      </div>
    `}let s=null;const a={};function l(){const c=Eh`${o()}`;return Object.assign(a,c.refs),s=c.fragment,c}function u(){if(s===null)throw new Error("Compile the template first.");const{contentElement:c,buttonsContainer:h}=a,d=[];return h?d.push(...Array.from(h.children)):d.push(c),d}return{TEMPLATE_NAME:"confirm",dialogA11YOptions(){return{role:"alertdialog",ariaLabelledby:`${e}-dialog-confirm-title`,ariaDescribedby:i?`${e}-dialog-confirm-description`:void 0}},compile:l,focusableElements:u}}const Qd=new Map([["base",Qbe],["confirm",eSe]]);function tSe(t,e){RV(t,e),e.add(t)}function Uc(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){return t.get(_v(t,e))}function to(t,e,n){return t.set(_v(t,e),n),n}function _v(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nSe=`
<div data-ref="dialogElement" class="${Fn}">
  <div data-ref="dialogWrapperElement" class="${Fn}__content-wrapper">
</div>
`;var GS=new WeakMap,ei=new WeakMap,KS=new WeakMap,df=new WeakMap,jo=new WeakMap,Fp=new WeakMap,XS=new WeakSet;class EV{constructor(e){let{rootElement:n,isRtl:i}=e;tSe(this,XS),Uc(this,GS,void 0),Uc(this,ei,void 0),Uc(this,KS,!1),Uc(this,df,!1),Uc(this,jo,Qd.get("base")),Uc(this,Fp,[]),to(GS,this,n),to(KS,this,i),this.install()}useTemplate(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Qd.has(e)||e==="base"){const r=Array.from(Qd.keys()).filter(o=>o!=="base").join(", ");throw new Error(et`Invalid template: ${e}.\x20
        Valid templates are: ${r}.`)}to(jo,this,Qd.get(e)(i)),to(Fp,this,((n=i.buttons)!==null&&n!==void 0?n:[]).map(r=>r.callback))}useDefaultTemplate(){to(jo,this,Qd.get("base")()),to(Fp,this,[])}install(){var e;if((e=Dt(ei,this))!==null&&e!==void 0&&e.dialogElement)return;const n=Eh`${nSe}`;to(ei,this,n.refs);const{dialogElement:i}=Dt(ei,this);le(i,[G9(),["dir",Dt(KS,this)?"rtl":"ltr"]]),i.addEventListener("transitionstart",()=>_v(XS,this,rSe).call(this)),i.addEventListener("transitionend",()=>_v(XS,this,iSe).call(this)),Dt(GS,this).after(n.fragment)}getContainer(){return Dt(ei,this).dialogElement}getFocusableElements(){return Dt(jo,this).focusableElements()}updateDialog(e){let{isVisible:n,content:i,customClassName:r,background:o,contentBackground:s,animation:a,a11y:l}=e;const u=Dt(jo,this).compile(),{dialogElement:c,dialogWrapperElement:h}=Dt(ei,this);h.innerHTML="",h.appendChild(u.fragment),Object.assign(Dt(ei,this),u.refs);const{contentElement:d,buttonsContainer:f}=Dt(ei,this);Dt(jo,this).TEMPLATE_NAME!=="base"&&Object.assign(l,Dt(jo,this).dialogA11YOptions());const m=r?` ${r}`:"",v=o?` ${Fn}--background-${o}`:"",b=a?` ${Fn}--animation`:"",T=n?` ${Fn}--show`:"";c.className=[Fn,`${Fn}--${Dt(jo,this).TEMPLATE_NAME}`,"handsontable",m,v,b,T].join(" "),le(c,[Dt(jo,this).TEMPLATE_NAME==="base"?Co(-1):void 0]),le(c,[l.role==="alertdialog"?x9():O9()]),l.ariaLabel&&!l.ariaLabelledby?le(c,[l.ariaLabel?hr(l.ariaLabel):void 0]):ss(c,"aria-label"),l.ariaLabelledby?le(c,[$9(l.ariaLabelledby)]):ss(c,"aria-labelledby"),l.ariaDescribedby?le(c,[k9(l.ariaDescribedby)]):ss(c,"aria-describedby");const _=s?` ${Fn}__content--background`:"";return j(d,`${Fn}__content${_}`),Dt(jo,this).TEMPLATE_NAME==="base"?(d.innerHTML="",typeof i=="string"?wl(d,i):(i instanceof HTMLElement||i instanceof DocumentFragment)&&d.appendChild(i)):f&&Array.from(f.children).forEach((D,P)=>{const W=Dt(Fp,this)[P];W&&D.addEventListener("click",W)}),this}showDialog(e){const{dialogElement:n}=Dt(ei,this);return n.style.display="block",e&&n.offsetHeight,j(n,`${Fn}--show`),to(df,this,!1),this}hideDialog(e){const{dialogElement:n}=Dt(ei,this);return ae(n,`${Fn}--show`),(e&&!Dt(df,this)||!e)&&(n.style.display="none"),to(df,this,!1),this}focusDialog(){Dt(ei,this).dialogElement.focus()}updateWidth(e){return Dt(ei,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return Dt(ei,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=Dt(ei,this))===null||e===void 0||e.dialogElement.remove(),to(ei,this,null)}}function iSe(){const{dialogElement:t}=Dt(ei,this);Ce(t,`${Fn}--show`)||(t.style.display="none")}function rSe(){to(df,this,!0)}st(EV,An);function oSe(t,e){TV(t,e),e.add(t)}function qS(t,e,n){TV(t,e),e.set(t,n)}function TV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(t,e,n){return t.set(pu(t,e),n),n}function Ln(t,e){return t.get(pu(t,e))}function pu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nl="dialog",sSe=360,kE=nl,Mv=`plugin:${nl}`;var Gn=new WeakMap,nh=new WeakMap,zc=new WeakMap,Yc=new WeakSet;class Pv extends Ye{constructor(){super(...arguments),oSe(this,Yc),qS(this,Gn,null),qS(this,nh,!1),qS(this,zc,null)}static get PLUGIN_KEY(){return nl}static get PLUGIN_PRIORITY(){return sSe}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:e=>me(e)&&typeof["alert","confirm"].includes(e.type)&&typeof e.title=="string"&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&e.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&["primary","secondary"].includes(n.type)&&(typeof n.callback>"u"||typeof n.callback=="function"))),content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>me(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[nl]}enablePlugin(){this.enabled||(Ln(Gn,this)||Da(Gn,this,new EV({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),pu(Yc,this,aSe).call(this),pu(Yc,this,uSe).call(this),this.addHook("afterViewRender",()=>pu(Yc,this,hSe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),pu(Yc,this,lSe).call(this),pu(Yc,this,cSe).call(this),super.disablePlugin()}isVisible(){return Ln(nh,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.enabled){if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Ln(Gn,this).showDialog(this.getSetting("animation")),Da(nh,this,!0),this.hot.getFocusScopeManager().activateScope(nl),Da(zc,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")}}hide(){var e;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Ln(Gn,this).hideDialog(this.getSetting("animation")),Da(nh,this,!1),this.hot.getFocusScopeManager().deactivateScope(nl),((e=Ln(zc,this))===null||e===void 0?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(Ln(zc,this)),this.hot.view.render(),Da(zc,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){if(!this.enabled)return;this.updatePluginSettings(e);const n=this.getSetting("template");if(n!==Pv.DEFAULT_SETTINGS.template&&this.getSetting("content")!==Pv.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");n?Ln(Gn,this).useTemplate(n.type,{id:this.hot.guid,...n}):Ln(Gn,this).useDefaultTemplate(),Ln(Gn,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(e,n){const{title:i="Alert",description:r}=me(e)?e:{title:e};this.show({template:{type:"confirm",title:i,description:r,buttons:[{text:this.hot.getTranslatedPhrase(Dw),type:"primary",callback:function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n==null?void 0:n(...s)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(e,n,i){const{title:r="Confirm",description:o}=me(e)?e:{title:e};this.show({template:{type:"confirm",title:r,description:o,buttons:[{text:this.hot.getTranslatedPhrase(NT),type:"secondary",callback:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return i==null?void 0:i(...a)}},{text:this.hot.getTranslatedPhrase(Dw),type:"primary",callback:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return n==null?void 0:n(...a)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){Ln(Gn,this).focusDialog()}destroy(){var e;(e=Ln(Gn,this))===null||e===void 0||e.destroyDialog(),Da(Gn,this,null),Da(nh,this,!1),Da(zc,this,null),super.destroy()}}function aSe(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(Mv))!==null&&t!==void 0?t:e.addContext(Mv);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Ln(nh,this)&&this.getSetting("closable"),group:kE}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:i=>{this.hot._registerTimeout(()=>{i.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:kE})}function lSe(){this.hot.getShortcutManager().getContext(Mv).removeShortcutsByGroup(kE)}function uSe(){this.hot.getFocusScopeManager().registerScope(nl,Ln(Gn,this).getContainer(),{shortcutsContextName:Mv,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:t=>{const e=this.hot.isListening(),n=Ln(Gn,this).getFocusableElements();n.length>0?t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus():t!=="tab_from_above"&&t!=="tab_from_below"&&e&&!Ln(Gn,this).getContainer().contains(this.hot.rootDocument.activeElement)&&Ln(Gn,this).getContainer().focus(),e&&this.hot.runHooks("afterDialogFocus",t==="unknown"?"show":t)}})}function cSe(){this.hot.getFocusScopeManager().unregisterScope(nl)}function hSe(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,i=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Ln(Gn,this).updateWidth(i);const r=e.querySelector(".hot-display-license-info");if(r){const o=r.offsetHeight,s=Number.parseFloat(n.getComputedStyle(r).marginTop);Ln(Gn,this).updateHeight(o+s)}}function dSe(t){let{id:e,icon:n,title:i,description:r}=t;return`
    <div class="${wu}__content">
      <i class="${wu}__icon">${n}</i>
      <div class="${wu}__text">
        <h2 id="${e}-${Pu}-title" class="${wu}__title">${i}</h2>
        ${r?`<p id="${e}-${Pu}-description" class="${wu}__description">${r}</p>`:""}
      </div>
    </div>
  `}function fSe(t,e){_V(t,e),e.add(t)}function gSe(t,e,n){_V(t,e),e.set(t,n)}function _V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m1(t,e,n){return t.set(EP(t,e),n),n}function nr(t,e){return t.get(EP(t,e))}function EP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pu="loading",mSe=350,wu=`ht-${Pu}`;var ti=new WeakMap,p1=new WeakSet;class pSe extends Ye{constructor(){super(...arguments),fSe(this,p1),gSe(this,ti,null)}static get PLUGIN_KEY(){return Pu}static get PLUGIN_PRIORITY(){return mSe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${wu}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[Pu]}enablePlugin(){if(!this.enabled){if(nr(ti,this)===null){var e;m1(ti,this,this.hot.getPlugin("dialog")),(e=nr(ti,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>EP(p1,this,wSe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=nr(ti,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!nr(ti,this)||!((e=nr(ti,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),nr(ti,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!nr(ti,this)||!((e=nr(ti,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(nr(ti,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,i;if(!this.isEnabled()||!nr(ti,this)||!((n=nr(ti,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const r=this.hot.guid,o=this.getSetting("icon"),s=(i=this.getSetting("title"))!==null&&i!==void 0?i:this.hot.getTranslatedPhrase(cM),a=this.getSetting("description"),l=dSe({id:r,icon:o,title:s,description:a});nr(ti,this).update({content:l,customClassName:wu,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${r}-${Pu}-title`,ariaDescribedby:a?`${r}-${Pu}-description`:void 0}})}destroy(){m1(ti,this,null),super.destroy()}}function wSe(){nr(ti,this).focus()}function Vp(t,e,n){vSe(t,e),e.set(t,n)}function vSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(t,e){return t.get(MV(t,e))}function Ds(t,e,n){return t.set(MV(t,e),n),n}function MV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Si="ht-empty-data-state",CSe=150,ySe=`<div data-ref="emptyDataStateElement" class="${Si} handsontable">
  <div class="${Si}__content-wrapper">
    <div data-ref="emptyDataStateInner" class="${Si}__content-wrapper-inner"></div>
  </div>
</div>`,bSe=t=>{let{title:e,description:n,buttons:i}=t;return`
  <div class="${Si}__content">
    ${e?`<h2 class="${Si}__title">${os(e)}</h2>`:""}
    ${n?`<p class="${Si}__description">${os(n)}</p>`:""}
  </div>
  <div
    data-ref="emptyDataStateButtons"
    class="${Si}__buttons${(i==null?void 0:i.length)>0?` ${Si}__buttons--has-buttons`:""}"
  >${(i==null?void 0:i.length)>0?i.map(r=>`<button class="ht-button ht-button--${r.type}">${os(r.text)}</button>`).join(""):""}</div>`};var ZS=new WeakMap,JS=new WeakMap,Dn=new WeakMap,Qi=new WeakMap;class SSe{constructor(e){let{rootElement:n,rootDocument:i}=e;Vp(this,ZS,void 0),Vp(this,JS,void 0),Vp(this,Dn,void 0),Vp(this,Qi,void 0),Ds(ZS,this,n),Ds(JS,this,i),this.install()}install(){var e;if((e=Nt(Dn,this))!==null&&e!==void 0&&e.emptyDataStateElement)return;const n=Eh`${ySe}`;Ds(Dn,this,n.refs);const{emptyDataStateInner:i,emptyDataStateElement:r}=Nt(Dn,this);le(i,[Co(-1)]),le(r,[Co(-1)]),Nt(ZS,this).after(n.fragment)}getElement(){var e;return(e=Nt(Dn,this))===null||e===void 0?void 0:e.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:e,emptyDataStateInner:n}=Nt(Dn,this),i=Array.from(e==null?void 0:e.children);return i.length===0?[n]:i}show(){var e;(e=Nt(Dn,this))!==null&&e!==void 0&&e.emptyDataStateElement&&(Nt(Dn,this).emptyDataStateElement.style.display="block")}hide(){var e,n;(e=Nt(Dn,this))!==null&&e!==void 0&&e.emptyDataStateElement&&((n=Nt(Qi,this))===null||n===void 0||n.remove(),Ds(Qi,this,null),Nt(Dn,this).emptyDataStateElement.style.display="none")}updateContent(e){var n;const{emptyDataStateInner:i}=Nt(Dn,this);let r="";typeof e=="string"?r={title:e}:r={title:e==null?void 0:e.title,description:e==null?void 0:e.description,buttons:e==null?void 0:e.buttons};const o=Eh`${bSe(r)}`;Ds(Dn,this,{...Nt(Dn,this),...o.refs}),i.innerHTML="",i.appendChild(o.fragment),((n=r.buttons)===null||n===void 0?void 0:n.length)>0&&Array.from(Nt(Dn,this).emptyDataStateButtons.children).forEach((s,a)=>{s.addEventListener("click",r.buttons[a].callback)})}updateClassNames(e){const{emptyDataStateElement:n}=Nt(Dn,this);e.countRenderableColumns()>0&&e.getColumnHeadersCount()>0?j(n,`${Si}--disable-top-border`):ae(n,`${Si}--disable-top-border`),e.countRenderableRows()>0&&e.getRowHeadersCount()>0?j(n,`${Si}--disable-inline-border`):ae(n,`${Si}--disable-inline-border`),e.hasHorizontalScroll()&&!e.isHorizontallyScrollableByWindow()?j(n,`${Si}--disable-bottom-border`):ae(n,`${Si}--disable-bottom-border`)}updateSize(e){const{emptyDataStateElement:n}=Nt(Dn,this),i=e.hasHorizontalScroll()?rn(e.hot.rootDocument):0,r=e.countRenderableRows(),o=e.countRenderableColumns(),s=e.getColumnHeadersCount();if(n.style.top=o>0?`${e.getColumnHeaderHeight()}px`:"0px",n.style.insetInlineStart=r>0?`${e.getRowHeaderWidth()}px`:"0px",r===0)Nt(Qi,this)||(Ds(Qi,this,Nt(JS,this).createElement("div")),Nt(Qi,this).classList.add(`${Si}-placeholder`),e._wt.wtTable.holder.appendChild(Nt(Qi,this))),Nt(Qi,this).style.width="100%",Nt(Qi,this).style.height=`${CSe}px`;else{var a;(a=Nt(Qi,this))===null||a===void 0||a.remove(),Ds(Qi,this,null)}let l=e.getWorkspaceWidth(),u=e.getTableHeight();e.isHorizontallyScrollableByWindow()?o>0?l=e.getTotalTableWidth():r>0&&(l=e.getViewportWidth()):r>0?l=e.getViewportWidth():e.getTableWidth()-e.getRowHeaderWidth()<e.getViewportWidth()&&o>0&&(l=e.getTableWidth()),e.isVerticallyScrollableByWindow()||e.hasVerticalScroll()?o>0?u=e.hot.getTableHeight()-e.getColumnHeaderHeight():u=e.hot.getTableHeight():s>0&&o>0?u=e.getViewportHeight()-i:s>0&&o===0&&(u=e.getWorkspaceHeight()-i),n.style.width=`${l}px`,n.style.height=`${u}px`}destroy(){var e,n;(e=Nt(Dn,this))===null||e===void 0||(e=e.emptyDataStateElement)===null||e===void 0||e.remove(),(n=Nt(Qi,this))===null||n===void 0||n.remove(),Ds(Qi,this,null),Ds(Dn,this,null)}}function RSe(t,e){PV(t,e),e.add(t)}function ef(t,e,n){PV(t,e),e.set(t,n)}function PV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ji(t,e,n){return t.set(un(t,e),n),n}function Yt(t,e){return t.get(un(t,e))}function un(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wu="emptyDataState",ESe=370,LE=Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"}),TSe=`plugin:${Wu}`;var xu=new WeakMap,Mn=new WeakMap,Hh=new WeakMap,Iv=new WeakMap,Rh=new WeakMap,vn=new WeakSet;class _Se extends Ye{constructor(){super(...arguments),RSe(this,vn),ef(this,xu,!1),ef(this,Mn,null),ef(this,Hh,null),ef(this,Iv,!1),ef(this,Rh,null)}static get PLUGIN_KEY(){return Wu}static get PLUGIN_PRIORITY(){return ESe}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:e=>typeof e=="string"||typeof e=="function"||me(e)&&(typeof(e==null?void 0:e.title)>"u"||typeof(e==null?void 0:e.title)=="string")&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&(e==null?void 0:e.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&typeof n.type=="string"&&["primary","secondary"].includes(n.type)&&typeof n.callback=="function")))||e===void 0}}isEnabled(){return!!this.hot.getSettings()[Wu]}enablePlugin(){this.enabled||(Yt(Mn,this)||(ji(Mn,this,new SSe({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),un(vn,this,ASe).call(this),un(vn,this,MSe).call(this),un(vn,this,PSe).call(this)),this.addHook("afterInit",()=>un(vn,this,DSe).call(this)),this.addHook("afterRender",()=>un(vn,this,$Se).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>un(vn,this,FE).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>un(vn,this,FE).call(this)),this.addHook("beforeFilter",e=>un(vn,this,kSe).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),un(vn,this,TP).call(this),this.isVisible()&&Yt(Mn,this).show(),super.updatePlugin()}disablePlugin(){un(vn,this,OSe).call(this),un(vn,this,ISe).call(this),Yt(Mn,this).destroy(),ji(Mn,this,null),super.disablePlugin()}isVisible(){return Yt(xu,this)}destroy(){var e;ji(xu,this,!1),(e=Yt(Mn,this))===null||e===void 0||e.destroy(),ji(Mn,this,null),ji(Hh,this,null),ji(Iv,this,!1),ji(Rh,this,null),super.destroy()}}function MSe(){this.eventManager.addEventListener(Yt(Mn,this).getElement(),"wheel",t=>un(vn,this,NSe).call(this,t))}function PSe(){ji(Hh,this,new MutationObserver(()=>{if(!this.hot)return;const t=Yt(Mn,this).getElement();this.hot.rootGridElement.nextElementSibling!==t&&this.hot.rootGridElement.after(t)})),Yt(Hh,this).observe(this.hot.rootWrapperElement,{childList:!0})}function ISe(){Yt(Hh,this).disconnect(),ji(Hh,this,null)}function ASe(){this.hot.getFocusScopeManager().registerScope(Wu,Yt(Mn,this).getElement(),{shortcutsContextName:TSe,runOnlyIf:()=>this.isVisible(),onActivate:t=>{var e;const n=(e=Yt(Mn,this))===null||e===void 0?void 0:e.getFocusableElements();n.length>0&&(t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus())}})}function OSe(){this.hot.getFocusScopeManager().unregisterScope(Wu)}function w1(t){var e,n,i;let r;return typeof this.getSetting("message")=="function"?r=this.getSetting("message")(t):r=this.getSetting("message"),typeof r=="string"&&(r={title:r}),!((e=r)!==null&&e!==void 0&&e.title)&&!((n=r)!==null&&n!==void 0&&n.description)&&!((i=r)!==null&&i!==void 0&&i.buttons)&&(r={},t===LE.FILTERS?(r.title=this.hot.getTranslatedPhrase(fM),r.description=this.hot.getTranslatedPhrase(gM),r.buttons=[{text:this.hot.getTranslatedPhrase(mM),type:"secondary",callback:()=>{const o=this.hot.getPlugin("filters");o&&(o.clearConditions(),o.filter())}}]):(r.title=this.hot.getTranslatedPhrase(hM),r.description=this.hot.getTranslatedPhrase(dM))),r}function FE(){this.hot.view&&(this.hot.view.countRenderableColumns()===0||this.hot.view.countRenderableRows()===0?un(vn,this,xSe).call(this):un(vn,this,HSe).call(this))}function xSe(){Yt(xu,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),un(vn,this,TP).call(this),Yt(Mn,this).show(),ji(xu,this,!0),ji(Rh,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope(Wu),this.hot.runHooks("afterEmptyDataStateShow"))}function TP(){Yt(Iv,this)?Yt(Mn,this).updateContent(un(vn,this,w1).call(this,LE.FILTERS)):Yt(Mn,this).updateContent(un(vn,this,w1).call(this,LE.UNKNOWN))}function HSe(){var t;Yt(xu,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),Yt(Mn,this).hide(),ji(xu,this,!1),this.hot.getFocusScopeManager().deactivateScope(Wu),((t=Yt(Rh,this))===null||t===void 0?void 0:t.ranges.length)>0?(this.hot.selection.importSelection(Yt(Rh,this)),this.hot.view.render(),ji(Rh,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function NSe(t){const e=Number.isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;e!==0&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+e}),t.preventDefault())}function DSe(){un(vn,this,FE).call(this),this.hot.render()}function $Se(){var t;(t=Yt(Mn,this))!==null&&t!==void 0&&t.getElement()&&this.isVisible()&&(Yt(Mn,this).updateSize(this.hot.view),Yt(Mn,this).updateClassNames(this.hot.view))}function kSe(t){ji(Iv,this,(t==null?void 0:t.length)>0),this.isVisible()&&un(vn,this,TP).call(this)}function LSe(){ze(Ef),ze(Tae),ze(Tf),ze(rle),ze(dle),ze(LL),ze(lue),ze(Kue),ze(TC),ze(nhe),ze(Phe),ze(khe),ze(PC),ze(Cde),ze(fge),ze(Yge),ze(Cme),ze(Ome),ze(jme),ze(epe),ze(cpe),ze(Ppe),ze(kpe),ze(Awe),ze(lve),ze(fve),ze(Fve),ze(TCe),ze(tye),ze(Sye),ze(Oye),ze(zye),ze(ebe),ze(hbe),ze(Xbe),ze(Pv),ze(pSe),ze(_Se)}function FSe(){Yre(),mse(),Ese(),Kse(),LSe()}function VSe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const i=this.first();let r=i.data("handsontable");if(typeof n!="string"){const u=n||{};return r?r.updateSettings(u):(r=new t.Core(i[0],u),i.data("handsontable",r),r.init()),i}let o;if(r)if(typeof r[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=r[n].call(r,...a),n==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var QS,eR,tR,nR,iR;FSe();VSe(Pe);Pe.__GhostTable=zM;Pe._getListenersCounter=P8;Pe._getRegisteredMapsCounter=Dee;Pe.EventManager=Vr;const WSe=[f9,E5,gee,wse,b5,k5,w9,v7,y5,C9,V5,w7],BSe=[H5,W5];Pe.helper={};Pe.dom={};I(WSe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Pe.helper[e]=t[e])})});I(BSe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Pe.dom[e]=t[e])})});Pe.cellTypes=(QS=Pe.cellTypes)!==null&&QS!==void 0?QS:{};I(Ute(),t=>{Pe.cellTypes[t]=yM(t)});Pe.cellTypes.registerCellType=_r;Pe.cellTypes.getCellType=yM;Pe.editors=(eR=Pe.editors)!==null&&eR!==void 0?eR:{};I(S8(),t=>{Pe.editors[`${li(t)}Editor`]=xw(t)});Pe.editors.registerEditor=$i;Pe.editors.getEditor=xw;Pe.renderers=(tR=Pe.renderers)!==null&&tR!==void 0?tR:{};I(H7(),t=>{const e=Hw(t);t==="base"&&(Pe.renderers.cellDecorator=e),Pe.renderers[`${li(t)}Renderer`]=e});Pe.renderers.registerRenderer=ir;Pe.renderers.getRenderer=Hw;Pe.validators=(nR=Pe.validators)!==null&&nR!==void 0?nR:{};I($7(),t=>{Pe.validators[`${li(t)}Validator`]=lT(t)});Pe.validators.registerValidator=du;Pe.validators.getValidator=lT;Pe.plugins=(iR=Pe.plugins)!==null&&iR!==void 0?iR:{};I(aT(),t=>{Pe.plugins[t]=Ag(t)});Pe.plugins[`${li(Ye.PLUGIN_KEY)}Plugin`]=Ye;Pe.plugins.registerPlugin=ze;Pe.plugins.getPlugin=Ag;const jSe=Object.assign({inheritAttrs:!1},{__name:"BaseHotTable",props:{data:{type:Array,default:()=>[]},colHeaders:{type:[Array,Boolean],default:()=>[]},columns:{type:Array,default:()=>[]},rowHeaders:{type:[Boolean,Array],default:!0},height:{type:[Number,String],default:400},afterChange:{type:Function,default:null},afterSelection:{type:Function,default:null}},setup(t,{expose:e}){const n=t,i=Nr(null),r=Nr(null);return VE(()=>{r.value=new Pe(i.value,{data:n.data,colHeaders:n.colHeaders,columns:n.columns,rowHeaders:n.rowHeaders,height:n.height,licenseKey:"non-commercial-and-evaluation",className:"ht-theme-main",stretchH:"all",afterChange(o,s){n.afterChange&&n.afterChange(o,s)},afterSelection(o,s,a,l){n.afterSelection&&n.afterSelection(o,s,a,l)}})}),DV(()=>n.data,o=>{const s=r.value;s&&!s.isDestroyed&&s.loadData(o)},{deep:!0}),$V(()=>{const o=r.value;o&&!o.isDestroyed&&o.destroy(),r.value=null}),e({hotInstance:r}),(o,s)=>(BE(),WE("div",{ref_key:"container",ref:i},null,512))}}),USe={class:"grid mb-1"},zSe={class:"col-6"},YSe={class:"col-6"},GSe={class:"grid mb-2"},KSe={class:"col-3"},XSe={class:"col-3"},qSe={class:"col-3"},ZSe={class:"col-3"},JSe={class:"flex justify-end mb-1 mt-3 mr-3"},QSe={class:"w-full"},eRe={class:"flex justify-content-end gap-4 mt-4 mr-2"},tRe={class:"flex gap-2 justify-end mt-1 pt-3"},nRe={__name:"RecipeDetailPop",setup(t){const{userId:e}=kV(),{vError:n,vSuccess:i,vInfo:r,vWarning:o}=LV(),s=Nr(!1),a=Nr(1),l=C1(),u=FV("dialogRef"),c=VV(null),h=Nr(null),d=Nr(null),f=Nr([]),m=Nr([{sortDist:1,phase:"",itemCd:"",itemName:"",content:0,inPrice:0,unitPrice:0}]),v=y1({clientName:"",clientId:"",prodName:"",managerName:"",managerId:"",regDate:"",labNo:"",prodType:"",recipeId:"",userId:e}),b=[{data:"sortDist",readOnly:!0,className:"htCenter",width:60},{data:"phase",type:"text",className:"htCenter",width:60},{data:"itemCd",type:"text",className:"htCenter",width:180},{data:"itemName",type:"text",width:500},{data:"content",type:"numeric",className:"htRight",width:150},{data:"inPrice",type:"numeric",className:"htRight",width:150},{data:"unitPrice",type:"numeric",className:"htRight",width:150}],T=$C(()=>{const B=m.value.reduce((z,ee)=>z+(Number(ee.content)||0),0);return parseFloat(B.toFixed(7))});$C(()=>m.value.reduce((B,z)=>B+(Number(z.inPrice)||0),0));const _=$C(()=>m.value.reduce((B,z)=>B+(Number(z.unitPrice)||0),0).toFixed(7)),D=async(B,z)=>{if(!(!B||z==="loadData"))for(const[ee,pe,gt,Re]of B){const Te=m.value[ee];if(Te){if(pe==="itemCd"&&Re&&Re!==gt)try{let Ie=null;if(Re.charAt(0).toUpperCase()==="J"?Ie=await qV.getItemInfo(Re):(Ie=await $a.getNewMaterialInfo(Re),Ie=Ie.getNewMaterialInfo),Ie){Te.inPrice=Ie.inPrice||0;const Ee=Number(Te.content);if(!isNaN(Ee)&&Ie.inPrice!=null){let we=Ee*Ie.inPrice*.001*.01;Te.unitPrice=parseFloat(we.toFixed(7))}else Te.unitPrice=0}else Te.inPrice=0,Te.unitPrice=0}catch(Ie){console.error("íëª© ì¡°í ì¤ë¥:",Ie)}if(pe==="content"&&Re!==gt){const Ie=Number(Re),Ee=Number(Te.inPrice);if(!isNaN(Ie)&&!isNaN(Ee)&&Ee>0){const we=parseFloat((Ie*Ee*.001*.01).toFixed(7));Te.unitPrice=we}else Te.unitPrice=0}if(pe==="inPrice"&&Re!==gt){const Ie=Number(Re),Ee=Number(Te.content);if(!isNaN(Ee)&&!isNaN(Ie)&&Ie>0){const we=parseFloat((Ee*Ie*.001*.01).toFixed(7));Te.unitPrice=we}else Te.unitPrice=0}}}},P=(B,z,ee,pe)=>{d.value=[B,z,ee,pe]},W=()=>{const B=m.value.length>0?Math.max(...m.value.map(z=>z.sortDist||0))+1:1;m.value.push({id:a.value++,sortDist:B,phase:"",itemCd:"",itemName:"",content:0,inPrice:0,unitPrice:0})},k=B=>{let z="";B==="U"?(c.value=JV,z="ì¬ì©ì ëª©ë¡"):B==="C"&&(c.value=ZV,z="ê³ ê°ì¬ ëª©ë¡"),c.value&&l.open(c.value,{props:{header:z,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},data:B,onClose:ee=>{ee!=null&&ee.data&&(B==="C"?(v.clientId=ee.data.clientId,v.clientName=ee.data.clientName):B==="U"&&(v.managerId=ee.data.userId,v.managerName=ee.data.memberNm))}})},$=async B=>{var z,ee;try{const pe={recipeInfo:v,recipeList:m.value},gt=await $a.saveRecipeInfo(pe);v.recipeId=gt.data.recipeId,i("ì ì¥ëììµëë¤.")}catch(pe){n(((ee=(z=pe==null?void 0:pe.response)==null?void 0:z.data)==null?void 0:ee.message)||"ì ì¥ ì¤ ì¤ë¥ê° ë°ìíìµëë¤.")}},G=async()=>{if(ka(v.recipeId)){r("ì²ë°©ì ë³´ê° ììµëë¤. ì ì¥ í ìëí´ì£¼ì¸ì.");return}if(ka(v.prodType)){o("ì íì½ëë¥¼ ìë ¥í´ì£¼ì¸ì.");return}try{const B={recipeInfo:{...v},recipeList:m.value},z=await $a.downloadRecipe(B),ee=window.URL.createObjectURL(z),pe=document.createElement("a");pe.href=ee,pe.download=`recipe_${v.prodName}.xlsx`,pe.click(),window.URL.revokeObjectURL(ee)}catch{n("ìì ë¤ì´ë¡ë ì¤í¨")}},J=async()=>{if(ka(v.recipeId)){r("ì²ë°©ì ë³´ê° ììµëë¤. ì ì¥ í ìëí´ì£¼ì¸ì.");return}if(ka(v.prodType)){o("ì íì½ëë¥¼ ìë ¥í´ì£¼ì¸ì.");return}try{const B=await $a.downloadIngredient(v.recipeId),z=window.URL.createObjectURL(B),ee=document.createElement("a");ee.href=z,ee.download=`ì ì±ë¶_${v.prodName}.xlsx`,ee.click(),window.URL.revokeObjectURL(z)}catch{n("ìì ë¤ì´ë¡ë ì¤í¨")}},U=async()=>{if(ka(v.recipeId)){r("ì²ë°©ì ë³´ê° ììµëë¤. ì ì¥ í ìëí´ì£¼ì¸ì.");return}if(ka(v.prodType)){o("ì íì½ëë¥¼ ìë ¥í´ì£¼ì¸ì.");return}try{const B=await $a.downloadIngredientCn(v.recipeId),z=window.URL.createObjectURL(B),ee=document.createElement("a");ee.href=z,ee.download=`ì¤êµ­ììíê°_${v.prodName}.xlsx`,ee.click(),window.URL.revokeObjectURL(z)}catch{n("ìì ë¤ì´ë¡ë ì¤í¨")}},oe=()=>{u.value.close()};return VE(async()=>{var B;if(s.value=!0,f.value=await $a.getProdTypeList(),v.prodType=((B=f.value[0])==null?void 0:B.code)??null,!ka(u.value.data)){v.recipeId=u.value.data;const z=await $a.getRecipeInfo(v.recipeId);Object.assign(v,z.recipeInfo),m.value=z.recipeList||[]}}),(B,z)=>{const ee=E1,pe=KV,gt=GV,Re=R1,Te=XV,Ie=YV,Ee=b1;return BE(),WE(S1,null,[Oe(Ie,{style:{width:"95rem",height:"9rem"}},{content:vi(()=>[dt("div",USe,[dt("div",zSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(gt,{iconPosition:"left"},{default:vi(()=>[Oe(ee,{modelValue:v.clientName,"onUpdate:modelValue":z[0]||(z[0]=we=>v.clientName=we),class:"w-full"},null,8,["modelValue"]),Oe(pe,{class:"pi pi-search",onClick:z[1]||(z[1]=we=>k("C"))})]),_:1}),z[13]||(z[13]=dt("label",null,"ê³ ê°ì¬",-1))]),_:1})]),dt("div",YSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(ee,{modelValue:v.prodName,"onUpdate:modelValue":z[2]||(z[2]=we=>v.prodName=we),class:"w-full"},null,8,["modelValue"]),z[14]||(z[14]=dt("label",null,"ì íëª",-1))]),_:1})])]),dt("div",GSe,[dt("div",KSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(gt,{iconPosition:"left"},{default:vi(()=>[Oe(ee,{modelValue:v.managerName,"onUpdate:modelValue":z[3]||(z[3]=we=>v.managerName=we),class:"w-full"},null,8,["modelValue"]),Oe(pe,{class:"pi pi-search",onClick:z[4]||(z[4]=we=>k("U"))})]),_:1}),z[15]||(z[15]=dt("label",null,"ë´ë¹ìëª",-1))]),_:1})]),dt("div",XSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(WV(QV),{modelValue:v.regDate,"onUpdate:modelValue":z[5]||(z[5]=we=>v.regDate=we),class:"w-full"},null,8,["modelValue"]),z[16]||(z[16]=dt("label",null,"ë±ë¡ì¼",-1))]),_:1})]),dt("div",qSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(ee,{modelValue:v.labNo,"onUpdate:modelValue":z[6]||(z[6]=we=>v.labNo=we),class:"w-full"},null,8,["modelValue"]),z[17]||(z[17]=dt("label",null,"Lab No",-1))]),_:1})]),dt("div",ZSe,[Oe(Re,{variant:"on"},{default:vi(()=>[Oe(Te,{modelValue:v.prodType,"onUpdate:modelValue":z[7]||(z[7]=we=>v.prodType=we),options:f.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),z[18]||(z[18]=dt("label",null,"ì íì½ë",-1))]),_:1})])])]),_:1}),dt("div",JSe,[Oe(Ee,{label:"ì¶ê°+",onClick:W,class:"p-button-xm"})]),dt("div",QSe,[Oe(jSe,{ref_key:"hotTable",ref:h,data:m.value,colHeaders:["No.","Phase","íëª©ì½ë","íëª©ëª","í¨ë","ìê°(ì)","ë¨ê°(ì/g)"],columns:b,rowHeaders:!1,height:430,afterChange:D,afterSelection:P},null,8,["data"])]),dt("div",eRe,[z[19]||(z[19]=dt("div",null,[dt("strong",null,"í©ê³")],-1)),dt("div",null,"í¨ë : "+rR(T.value)+"%",1),dt("div",null,"ë¨ê°(ì/g) : "+rR(_.value)+"ì",1)]),dt("div",tRe,[Oe(Ee,{label:"BOMì°ê²°",class:"btn-save",onClick:z[8]||(z[8]=we=>k("N"))}),Oe(Ee,{label:"ì ì¥",class:"btn-save",onClick:z[9]||(z[9]=we=>$())}),Oe(Ee,{label:"ì ì±ë¶(ìì¶)",class:"btn-save",onClick:z[10]||(z[10]=we=>J())}),Oe(Ee,{label:"ë¨ê°",class:"btn-save",onClick:z[11]||(z[11]=we=>G())}),Oe(Ee,{label:"ì¤êµ­ììíê°",class:"btn-save",onClick:z[12]||(z[12]=we=>U())}),Oe(Ee,{label:"ë«ê¸°",onClick:oe})])],64)}}},iRe=v1(nRe,[["__scopeId","data-v-98ca7a13"]]),rRe={class:"flex flex-wrap items-center gap-2 w-full"},oRe={class:"flex items-center justify-end gap-2 mb-2"},sRe=["onClick"],aRe={__name:"RecipeList",setup(t){const e=C1(),n=Nr([]),i=Nr(null),r=y1({prodName:"",labNo:"",managerName:""}),o=async()=>{const c={...r};n.value=await $a.getRecipeList(c)},s=c=>{let h="ì°êµ¬ì²ë°© ë±ë¡";ka(c)||(h="ì°êµ¬ì²ë°© ìì¸"),e.open(iRe,{props:{header:h,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},data:c,onClose:async d=>{await o()}})},a=Nr({icon:"pi pi-home"}),l=Nr([{label:"ì°êµ¬ì²ë°©ê´ë¦¬"},{label:"ì°êµ¬ì²ë°© ëª©ë¡"}]);VE(async()=>{});const u=()=>{var h;const c=((h=i.value)==null?void 0:h.columns)??[];if(!c.length){console.warn("No Columns Found");return}zV(n.value,"ì°êµ¬ì²ë°© ë¦¬ì¤í¸",c)};return(c,h)=>{const d=UV,f=E1,m=R1,v=b1,b=NV,T=HV,_=xV;return BE(),WE(S1,null,[Oe(d,{home:a.value,model:l.value},null,8,["home","model"]),dt("form",{onSubmit:BV(o,["prevent"]),class:"space-y-4"},[Oe(b,{class:"flex flex-wrap mt-2 mb-2 gap-1 w-full"},{start:vi(()=>[dt("div",rRe,[Oe(m,{variant:"on"},{default:vi(()=>[Oe(f,{id:"on_label",modelValue:r.prodName,"onUpdate:modelValue":h[0]||(h[0]=D=>r.prodName=D),style:{width:"150px"}},null,8,["modelValue"]),h[4]||(h[4]=dt("label",{for:"on_label"},"ì íëª",-1))]),_:1}),Oe(m,{variant:"on"},{default:vi(()=>[Oe(f,{id:"on_label1",modelValue:r.labNo,"onUpdate:modelValue":h[1]||(h[1]=D=>r.labNo=D),style:{width:"250px"}},null,8,["modelValue"]),h[5]||(h[5]=dt("label",{for:"on_label1"},"Lab No.",-1))]),_:1}),Oe(m,{variant:"on"},{default:vi(()=>[Oe(f,{id:"on_label1",modelValue:r.managerName,"onUpdate:modelValue":h[2]||(h[2]=D=>r.managerName=D),style:{width:"250px"}},null,8,["modelValue"]),h[6]||(h[6]=dt("label",{for:"on_label1"},"ë´ë¹ì",-1))]),_:1}),Oe(v,{label:"ê²ì",icon:"pi pi-search",type:"submit",class:"bg-blue-500 text-white hover:bg-blue-600"})])]),_:1})],32),dt("div",oRe,[Oe(v,{label:"ì ê·",icon:"pi pi-plus",severity:"secondary",onClick:h[3]||(h[3]=D=>s(""))}),Oe(v,{label:"ìì",icon:"pi pi-file-excel",severity:"success",onClick:u})]),dt("div",null,[Oe(_,{ref_key:"dt",ref:i,paginator:"",rows:20,value:n.value,dataKey:"recipeId",rowsPerPageOptions:[20,30,40],scrollable:"",scrollHeight:"650px",showGridlines:"",class:"my-table"},{default:vi(()=>[Oe(T,{field:"rowNum",header:"No.",style:{width:"20px","text-align":"center"},pt:{columnHeaderContent:"justify-center"}}),Oe(T,{field:"prodName",header:"ì íëª",style:jV([{width:"400px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:vi(D=>[dt("div",{style:{cursor:"pointer","text-decoration":"underline"},onClick:P=>s(D.data.recipeId),class:"clickable-cell"},rR(D.data.prodName),9,sRe)]),_:1}),Oe(T,{field:"clientName",header:"ê³ ê°ì¬",style:{width:"200px"},pt:{columnHeaderContent:"justify-center"}}),Oe(T,{field:"labNo",header:"Lab No",style:{width:"200px"},pt:{columnHeaderContent:"justify-center"}}),Oe(T,{field:"managerName",header:"ë´ë¹ì",style:{width:"110px"},pt:{columnHeaderContent:"justify-center"}}),Oe(T,{field:"prodType",header:"ì í",style:{width:"110px"},pt:{columnHeaderContent:"justify-center"}}),Oe(T,{field:"regDate",header:"ë±ë¡ì¼ì",style:{width:"110px"},pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["value"])])],64)}}},VRe=v1(aRe,[["__scopeId","data-v-231c4994"]]);export{VRe as default};
