import{A as C}from"./apiOrders-aYcVHbt-.js";import{_ as W,a as X,u as Y,p as Z,r as f,k as ee,m as te,c as p,g as o,d as c,w as u,F as le,e as oe,G as ae,o as i,f as t,h,t as s,i as A,B as se,b as O,A as de}from"./index-CSVU4KnH.js";import{e as B,k as re}from"./common-Vxxi2eVn.js";import{_ as E}from"./SingleFileUpload-D3K6CdK1.js";import{_ as ne}from"./UserListPop-Dvf9Erza.js";import{D as Q}from"./DownLoadLink-_ADZG-34.js";import"./format-CBpsKyOP.js";import"./filedownLoad-vZrQWoXx.js";const ie={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},pe={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ue={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ce={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},me={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ve={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},he={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},xe={key:0},ge={key:1},ye={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},_e={key:0},be={key:1},Fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ie={key:0},Ne={key:1},Ae={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},De={key:0},Ue={key:1},ke={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},we={key:0},Ve={key:1},qe={colspan:"3"},Se={colspan:"4",style:{height:"100px","text-align":"center"}},Ce={colspan:"3"},Oe={key:1},Be={colspan:"3"},Ee={key:1},Qe={__name:"DraftEdit",setup($e){const $=Z(),D=oe(),{userId:L,memberNm:P,deptNm:j}=X(),{vError:U,vSuccess:k}=Y(),b=$.params.id,g=f([]),y=f([]),F=f(!1),w=f(!1),V=f(!1),a=ee({draftDate:"",seq:"",customerName:"",itemName:"",orderQty:0,dueDate:"",draftUserName:"",draftDept:"",draftUserId:"",draftId:b,userId:L}),d=f({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessUserName:"",productUserName:"",purchaseUserName:"",qcUserName:"",labUserName:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),r=f({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),J=l=>{d.value.labUserName=l.memberNm,d.value.labUserId=l.userId},M=async()=>{const l=new FormData,e={...a};e.dueDate=B(a.dueDate),e.orderQty=re(a.orderQty),console.log("params",e),console.log("approval",d.value),l.append("draftInfo",JSON.stringify(e)),l.append("approval",JSON.stringify(d.value));const x=g.value instanceof File,m=y.value instanceof File;x?l.append("orderFile",g.value):l.append("orderAttachFileId",r.value.orderFileAttachFileId),m?l.append("prodFile",y.value):l.append("prodAttachFileId",r.value.prodFileAttachFileId);try{const v=await C.saveDraftInfo(l);k(v),D.push({name:"DraftDetail",params:{id:b}})}catch(v){U(v.response)}},R=l=>{l.orderAttachFileInfo===null?w.value=!0:(r.value.orderFileName=l.orderAttachFileInfo.fileName,r.value.orderFileAttachFileId=l.orderAttachFileInfo.attachFileId,r.value.orderSeq=l.orderAttachFileInfo.seq),l.prodAttachFileInfo===null?V.value=!0:(r.value.prodFileName=l.prodAttachFileInfo.fileName,r.value.prodFileAttachFileId=l.prodAttachFileInfo.attachFileId,r.value.prodSeq=l.prodAttachFileInfo.seq)},q=async l=>{let e="";e=r.value.prodFileAttachFileId,r.value.prodFileAttachFileId=null;const x=1;try{const m=await de.deleteFile(e,x);k(m)}catch(m){U(m)}};te(async()=>{const l=await C.getDraftInfo(b);Object.assign(a,l.draftInfo),Object.assign(d.value,l.approvalInfo),R(l)});const G=()=>{D.push({name:"DraftList"})};return(l,e)=>{const x=c("v-breadcrumbs"),m=c("v-table"),v=c("v-col"),I=c("v-row"),S=c("v-card-text"),N=c("v-text-field"),H=c("v-date-input"),_=c("v-btn"),T=c("v-card"),z=c("v-dialog"),K=ae("comma-number");return i(),p(le,null,[o(x,{items:["MES","영업관리","사양서 수정"]}),o(T,null,{default:u(()=>[o(S,{class:"overflow-y-hidden"},{default:u(()=>[o(I,null,{default:u(()=>[o(v,{class:"d-flex justify-end pa-1"},{default:u(()=>[o(m,{style:{border:"0.1px solid #ccc"}},{default:u(()=>[t("tbody",null,[e[10]||(e[10]=t("tr",null,[t("th",{rowspan:"3",style:{"vertical-align":"middle",width:"20px"}},[h("결"),t("br"),t("br"),t("br"),h("재")]),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"기안자"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"영업관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"생산관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"구매부"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"품질관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"연구소")],-1)),t("tr",null,[t("td",ie,s(a.draftUserName),1),t("td",pe,s(d.value.businessUserName),1),t("td",ue,s(d.value.productUserName),1),t("td",ce,s(d.value.purchaseUserName),1),t("td",me,s(d.value.qcUserName),1),t("td",ve,s(d.value.labUserName),1)]),t("tr",null,[t("td",fe,s(a.draftDate),1),t("td",he,[d.value.businessApprovalDate?(i(),p("span",ge,s(d.value.businessApprovalDate),1)):(i(),p("span",xe,"결제일자"))]),t("td",ye,[d.value.productApprovalDate?(i(),p("span",be,s(d.value.productApprovalDate),1)):(i(),p("span",_e,"결제일자"))]),t("td",Fe,[d.value.purchaseApprovalDate?(i(),p("span",Ne,s(d.value.purchaseApprovalDate),1)):(i(),p("span",Ie,"결제일자"))]),t("td",Ae,[d.value.qcApprovalDate?(i(),p("span",Ue,s(d.value.qcApprovalDate),1)):(i(),p("span",De,"결제일자"))]),t("td",ke,[d.value.labApprovalDate?(i(),p("span",Ve,s(d.value.labApprovalDate),1)):(i(),p("span",we,"결제일자"))])])])]),_:1})]),_:1})]),_:1})]),_:1}),o(S,{class:"overflow-y-hidden"},{default:u(()=>[o(I,null,{default:u(()=>[o(v,null,{default:u(()=>[o(m,{class:"compact-table",style:{height:"590px"}},{default:u(()=>[t("tbody",null,[t("tr",null,[e[11]||(e[11]=t("th",null,"문서번호",-1)),t("td",null,s(a.draftDate)+"-"+s(a.seq),1),e[12]||(e[12]=t("th",null,"처리기한",-1)),e[13]||(e[13]=t("td",null,"즉시",-1))]),t("tr",null,[e[14]||(e[14]=t("th",null,"보존년한",-1)),e[15]||(e[15]=t("td",null,"5년",-1)),e[16]||(e[16]=t("th",null,"기안일자",-1)),t("td",null,s(a.draftDate),1)]),t("tr",null,[e[17]||(e[17]=t("th",null,"기안부서",-1)),t("td",null,s(A(j)),1),e[18]||(e[18]=t("th",null,"기안자",-1)),t("td",null,s(A(P)),1)]),t("tr",null,[e[19]||(e[19]=t("th",null,"제목",-1)),t("td",qe,s(a.customerName)+"    "+s(a.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),t("tr",null,[t("td",Se,[h(s(a.customerName)+"    "+s(a.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),e[20]||(e[20]=t("br",null,null,-1)),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=h(" - 아 래 - "))])]),t("tr",null,[e[23]||(e[23]=t("th",null,"고객사명",-1)),t("td",null,[o(N,{modelValue:a.customerName,"onUpdate:modelValue":e[0]||(e[0]=n=>a.customerName=n),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue"])]),e[24]||(e[24]=t("th",null,"품목",-1)),t("td",null,[o(N,{modelValue:a.itemName,"onUpdate:modelValue":e[1]||(e[1]=n=>a.itemName=n),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue"])])]),t("tr",null,[e[25]||(e[25]=t("th",null,"발주수량",-1)),t("td",null,[se(o(N,{modelValue:a.orderQty,"onUpdate:modelValue":e[2]||(e[2]=n=>a.orderQty=n),variant:"outlined",density:"compact","hide-details":"",style:{"text-align":"right"},class:"cell-input"},null,8,["modelValue"]),[[K]])]),e[26]||(e[26]=t("th",null,"납기일자",-1)),t("td",null,[o(H,{modelValue:a.dueDate,"onUpdate:modelValue":e[3]||(e[3]=n=>a.dueDate=n),"display-format":A(B),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue","display-format"])])]),t("tr",null,[e[28]||(e[28]=t("th",null,"발주서첨부",-1)),t("td",Ce,[w.value?(i(),O(E,{key:0,modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=n=>g.value=n),style:{height:"20px",width:"1100px"},class:"mb-4"},null,8,["modelValue"])):(i(),p("div",Oe,[o(Q,{fileName:r.value.orderFileName||"",attachFileId:r.value.orderFileAttachFileId||"",seq:r.value.orderSeq||""},null,8,["fileName","attachFileId","seq"]),e[27]||(e[27]=h("      ")),o(_,{text:"삭제",density:"compact",onClick:e[5]||(e[5]=n=>q("p"))})]))])]),t("tr",null,[e[30]||(e[30]=t("th",null,"제품사양서첨부",-1)),t("td",Be,[V.value?(i(),O(E,{key:0,modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=n=>y.value=n),style:{height:"20px",width:"1100px"},class:"mb-4"},null,8,["modelValue"])):(i(),p("div",Ee,[o(Q,{fileName:r.value.prodFileName||"",attachFileId:r.value.prodFileAttachFileId||"",seq:r.value.prodSeq||""},null,8,["fileName","attachFileId","seq"]),e[29]||(e[29]=h("      ")),o(_,{text:"삭제",density:"compact",onClick:e[7]||(e[7]=n=>q("p"))})]))])])])]),_:1})]),_:1})]),_:1}),o(I,null,{default:u(()=>[o(v,{class:"d-flex ga-4 justify-end mb-3"},{default:u(()=>[o(_,{text:"저장",class:"gt-2",color:"brown-lighten-4",onClick:M}),o(_,{text:"목록",class:"mr-3",onClick:G})]),_:1})]),_:1})]),_:1})]),_:1}),o(z,{modelValue:F.value,"onUpdate:modelValue":e[9]||(e[9]=n=>F.value=n),height:"800px",width:"900px",persistent:""},{default:u(()=>[o(ne,{onSelected:J,onCloseDialog:e[8]||(e[8]=n=>F.value=!1)})]),_:1},8,["modelValue"])],64)}}},Te=W(Qe,[["__scopeId","data-v-aa3a226f"]]);export{Te as default};
