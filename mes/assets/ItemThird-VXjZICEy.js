import{u as ee,a as te,r,k as le,m as ae,n as ie,p as oe,s as me,c as ne,f as E,g as t,d as u,w as i,F as ue,e as de,o as U,i as g,j as se,b as re,q as ce}from"./index-C-Q3ea6s.js";import{A as n}from"./apiCommon-DLJ6uQuV.js";import{A as d}from"./apiItem-BvJCdtAu.js";import{C as pe}from"./CustomerListPop-D05Rszn0.js";import{t as ve,p as G,f as k,b as Ce,c as ye}from"./common-DX12Nz2N.js";import{l as T}from"./lodash-DR4aaNSv.js";import"./apiBase-QvrfTKy4.js";import"./format-CBpsKyOP.js";import"./_commonjsHelpers-CZnAS8i4.js";const fe=["id"],ge={class:"d-flex ga-4 justify-end"},Le={__name:"ItemThird",setup(_e){const{vError:S,vSuccess:Y,vInfo:I,vWarning:R}=ee(),{userId:A}=te(),M=r(!1),_=r(!1),f=r(!1),N=le(),D=de(),V=N.query.id,L=N.query.type,s=r([]),w=r([]),c=r([]),p=r([]),b=r([]),x=r([]),j=[{text:"사용",value:"Y"},{text:"미사용",value:"N"}],e=ae({itemCd:"",itemName:"",itemTypeCd:"",useCate:"",itemCategory1:"",itemCategory2:"",customerCd:"",customerName:"",unit:"",spec:"",inPrice:"",outPrice:"",itemGrp1:"",itemGrp2:"",etc:"",useYn:"Y",userId:A}),q=()=>{_.value=!0};ie(async()=>{const o=await d.getItemInfo(V);s.value=await n.getCodeList("ITEM_TYPE_CD"),s.value=s.value.filter(l=>!["M1","M4"].includes(l.code)),b.value=await n.getCodeList("ITEM_GRP1"),x.value=await n.getCodeList("ITEM_GRP2"),e.itemCd=o.itemCd,e.itemName=o.itemName,c.value=await d.getProdLList(),p.value=await d.getProdMList(o.itemCategory1),Object.assign(e,T.omit(o,["itemTypeCd"]))}),oe(()=>e.itemTypeCd,o=>{if(w.value=[],f.value=!1,!["M2","M7"].includes(o)&&o!==L){I("품목구분이 틀립니다.");return}["M2","M7"].includes(o)?B():["M0","M6"].includes(o)?O():F()});const B=async()=>{M.value=!1,f.value=!0,c.value=[],p.value=[],e.itemCategory1=null,e.itemCategory2=null,e.itemCd=null,e.itemName=null,w.value=await n.getCodeList("use_Cate"),c.value=await n.getCodeList("order_cate"),p.value=await n.getCodeList("sub_item")},O=async()=>{M.value=!0,f.value=!1,c.value=[],p.value=[],e.itemCategory1=null,e.itemCategory2=null,e.itemCd=null,e.itemName=null;const o=await d.getItemInfo(V);s.value=await n.getCodeList("ITEM_TYPE_CD"),s.value=s.value.filter(l=>!["M1","M4"].includes(l.code)),c.value=await d.getProdLList(),p.value=await d.getProdMList(o.itemCategory1),b.value=await n.getCodeList("ITEM_GRP1"),x.value=await n.getCodeList("ITEM_GRP2"),Object.assign(e,T.omit(o,["itemTypeCd"])),e.itemCd=Ce(o.itemCd),e.itemName=o.itemName},F=async()=>{M.value=!0,f.value=!1,c.value=[],p.value=[],e.itemCategory1=null,e.itemCategory2=null,e.itemCd=null,e.itemName=null;const o=await d.getItemInfo(V);s.value=await n.getCodeList("ITEM_TYPE_CD"),s.value=s.value.filter(l=>!["M1","M4"].includes(l.code)),b.value=await n.getCodeList("ITEM_GRP1"),x.value=await n.getCodeList("ITEM_GRP2"),c.value=await d.getProdLList(),p.value=await d.getProdMList(o.itemCategory1),Object.assign(e,T.omit(o,["itemTypeCd"])),e.itemCd=ye(e.itemCd),e.itemName=o.itemName};me(async()=>{if(e.itemCategory1&&e.itemCategory2&&["M2","M7"].includes(e.itemTypeCd)){if(L!=="M0"){I("부자재 및 소모품은 완제품 품목으로 호출하셔야 합니다.");return}e.itemCd="JP"+e.useCate+e.itemCategory1+e.itemCategory2+V.slice(-5),e.itemName=ve(e.itemTypeCd)}});const $=async()=>{await d.getItemCdCheck(e.itemCd)==="Y"?R("중복된 품목코드입니다."):I("사용가능한 품목코드입니다.")},J=async()=>{try{const o={...e},l=await d.saveItemInfo(o);Y(l),h()}catch{S("저장에 실패했습니다.")}},W=o=>{e.customerCd=o.customerCd,e.customerName=o.customerName},h=()=>{D.push({name:"ItemList"})};return(o,l)=>{const z=u("v-breadcrumbs"),H=u("v-card-item"),C=u("v-select"),m=u("v-col"),P=u("v-btn"),y=u("v-row"),v=u("v-text-field"),K=u("v-form"),Q=u("v-card-text"),X=u("v-card"),Z=u("v-dialog");return U(),ne(ue,null,[E("div",{id:o.$attrs.id},null,8,fe),t(z,{items:["MES","기본관리","품목코드 신규"]}),t(X,null,{default:i(()=>[t(H,{title:g(N).query.id},null,8,["title"]),t(Q,null,{default:i(()=>[t(K,{onSubmit:se(J,["prevent"])},{default:i(()=>[t(y,null,{default:i(()=>[t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.itemTypeCd,"onUpdate:modelValue":l[0]||(l[0]=a=>e.itemTypeCd=a),label:"품목구분",items:s.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[f.value?(U(),re(C,{key:0,modelValue:e.useCate,"onUpdate:modelValue":l[1]||(l[1]=a=>e.useCate=a),label:"사용구분",items:w.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])):ce("",!0)]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(P,{text:"중복확인",density:"compact",onClick:$})]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.itemCategory1,"onUpdate:modelValue":l[2]||(l[2]=a=>e.itemCategory1=a),label:"대분류",items:c.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.itemCategory2,"onUpdate:modelValue":l[3]||(l[3]=a=>e.itemCategory2=a),label:"중분류",items:p.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,{cols:"3",style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.itemCd,"onUpdate:modelValue":l[4]||(l[4]=a=>e.itemCd=a),label:"품목코드",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(m,{cols:"9",style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.itemName,"onUpdate:modelValue":l[5]||(l[5]=a=>e.itemName=a),label:"품목명",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.customerName,"onUpdate:modelValue":l[6]||(l[6]=a=>e.customerName=a),label:"거래처명",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":q},null,8,["modelValue"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.itemGrp1,"onUpdate:modelValue":l[7]||(l[7]=a=>e.itemGrp1=a),label:"거래유형",items:b.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.itemGrp2,"onUpdate:modelValue":l[8]||(l[8]=a=>e.itemGrp2=a),label:"제품유형",items:x.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.unit,"onUpdate:modelValue":l[9]||(l[9]=a=>e.unit=a),label:"단위",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.spec,"onUpdate:modelValue":l[10]||(l[10]=a=>e.spec=a),label:"SPEC",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{"model-value":g(k)(e.inPrice),label:"입고단가",variant:"underlined",density:"compact","onUpdate:modelValue":l[11]||(l[11]=a=>e.inPrice=g(G)(a))},null,8,["model-value"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{"model-value":g(k)(e.outPrice),label:"출고단가",variant:"underlined",density:"compact","onUpdate:modelValue":l[12]||(l[12]=a=>e.outPrice=g(G)(a))},null,8,["model-value"])]),_:1}),t(m,{style:{height:"60px"}},{default:i(()=>[t(C,{modelValue:e.useYn,"onUpdate:modelValue":l[13]||(l[13]=a=>e.useYn=a),label:"사용유무",items:j,"item-title":"text","item-value":"value",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,{style:{height:"60px"}},{default:i(()=>[t(v,{modelValue:e.etc,"onUpdate:modelValue":l[14]||(l[14]=a=>e.etc=a),label:"비고",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(y,null,{default:i(()=>[t(m,null,{default:i(()=>[E("div",ge,[t(P,{color:"indigo-darken-4",text:"저장",variant:"tonal",type:"submit"}),t(P,{text:"목록",variant:"tonal",onClick:h})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(Z,{modelValue:_.value,"onUpdate:modelValue":l[16]||(l[16]=a=>_.value=a),"max-width":"800px",height:"800px",persistent:""},{default:i(()=>[t(pe,{onSelected:W,onCloseDialog:l[15]||(l[15]=a=>_.value=!1)})]),_:1},8,["modelValue"])],64)}}};export{Le as default};
