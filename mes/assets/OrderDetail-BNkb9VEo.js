import{D as j}from"./DownLoadLink-D4IEarVx.js";import{_ as Z,a as ee,u as te,r as h,p as le,m as ae,z as se,c as p,f as e,g as u,b as E,s as O,d as x,w as f,F as P,e as oe,o as n,h as k,t as s,i as re,n as ue}from"./index-DbwVXjcr.js";import{A as T}from"./apiOrders-UQLCal3q.js";import{i as g,j as m}from"./common-BCog4hmn.js";import"./filedownLoad-CMEUJAlR.js";import"./format-CBpsKyOP.js";const de=["id"],ne={class:"d-flex justify-end"},pe={class:"approval-user"},ie={style:{height:"80px"}},ve={class:"approval-date"},ce={style:{height:"30px"}},he={style:{height:"30px"}},fe={key:0},me={key:1},Ie={style:{height:"30px"}},be={key:0},_e={key:1},Ae={style:{height:"30px"}},ye={key:0},De={key:1},xe={style:{height:"30px"}},ge={key:0},Fe={key:1},Ue={style:{height:"30px"}},Ne={key:0},ke={key:1},qe={class:"d-flex ga-4 justify-end"},Ce={colspan:"3"},we={colspan:"4",style:{height:"120px","text-align":"center"}},Se={key:0},Oe={colspan:"3"},Ve={colspan:"3"},Le={class:"d-flex ga-4 justify-end"},je={__name:"OrderDetail",setup(Ee){const{userId:r,memberNm:B}=ee(),{vError:Y,vSuccess:M}=te(),V=h(!1),y=h(!1),L=h(!1),Q=le(),q=oe(),F=Q.params.id,o=h({orderDate:"",seq:"",customerNm:"",itemName:"",orderQty:0,dueDate:"",draftNm:"",draftDept:"",draftDate:"",draftUserId:""}),l=h({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:"",approvalId:""}),C=h([]),d=h({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),v=h(null),R=async()=>{const a={userId:r,field:z(r),boardTxt:U.value,approvalId:o.value.approvalId,boardId:o.value.boardId,orderId:F,appDate:v.value};console.log("params",a.boardTxt);try{const t=await T.updateInfo(a);M(t),q.push({name:"OrderDetail",params:{id:F}})}catch(t){Y(t)}},z=a=>{const{businessUserId:t,productUserId:I,purchaseUserId:b,qcUserId:c,labUserId:_}=l.value;let i="";return a===t?i="business_approval_date":a===I?i="product_approval_date":a===b?i="purchase_approval_date":a===c?i="qc_approval_date":a===_&&(i="lab_approval_date"),i},$=()=>{const{businessUserId:a,productUserId:t,purchaseUserId:I,qcUserId:b,labUserId:c}=l.value;r===a?g(l.value.businessApprovalDate)?(l.value.businessApprovalDate=m(),v.value=m(),y.value=!1):v.value=l.value.businessApprovalDate:r===t?g(l.value.productApprovalDate)?(l.value.productApprovalDate=m(),v.value=m(),y.value=!1):v.value=l.value.productApprovalDate:r===I?g(l.value.purchaseApprovalDate)?(l.value.purchaseApprovalDate=m(),v.value=m(),y.value=!1):v.value=l.value.purchaseApprovalDate:r===b?g(l.value.qcApprovalDate)?(l.value.qcApprovalDate=m(),v.value=m(),y.value=!1):v.value=l.value.qcApprovalDate:r===c&&(g(l.value.labApprovalDate)?(l.value.labApprovalDate=m(),v.value=m(),y.value=!1):v.value=l.value.labApprovalDate)},G=()=>{r===o.value.draftUserId&&(L.value=!0);const t=Object.values(l.value).includes(r),{businessCheckYn:I,productCheckYn:b,purchaseCheckYn:c,qcCheckYn:_,labCheckYn:i,businessUserId:N,productUserId:A,purchaseUserId:w,qcUserId:S,labUserId:X}=l.value;o.value.draftUserId!==r&&(V.value=!0);const D=h(!1);(r===N&&I==="N"||r===A&&b==="N"||r===w&&c==="N"||r===S&&_==="N"||r===X&&i==="N")&&(D.value=!0),t&&D.value&&(y.value=!0)};ae(async()=>{const a=await T.getOrderInfo(F);Object.assign(o.value,a.orderInfo),Object.assign(l.value,a.approvalInfo),C.value=a.boardInfo||[],G();const t=C.value.find(I=>I.boardUserId===r);U.value=t?t.boardTxt:"",J(a)});const U=h(""),H=se(()=>C.value.filter(a=>a.boardUserId!==r)),J=a=>{a.orderAttachFileInfo!==null&&(d.value.orderFileName=a.orderAttachFileInfo.fileName,d.value.orderFilePath=a.orderAttachFileInfo.filePath,d.value.orderFileAttachFileId=a.orderAttachFileInfo.attachFileId,d.value.orderSeq=a.orderAttachFileInfo.seq),a.prodAttachFileInfo!==null&&(d.value.prodFileName=a.prodAttachFileInfo.fileName,d.value.prodFilePath=a.prodAttachFileInfo.filepath,d.value.prodFileAttachFileId=a.prodAttachFileInfo.attachFileId,d.value.prodSeq=a.prodAttachFileInfo.seq)},K=()=>{q.push({name:"OrderEdit",params:{id:F}})},W=()=>{q.push({name:"OrderList"})};return(a,t)=>{const I=x("v-breadcrumbs"),b=x("v-table"),c=x("v-col"),_=x("v-row"),i=x("v-btn"),N=x("v-text-field");return n(),p(P,null,[e("div",{id:a.$attrs.id},null,8,de),u(I,{items:["MES","발주관리","발주 상세"]}),u(_,null,{default:f(()=>[u(c,null,{default:f(()=>[e("div",ne,[u(b,{class:"approval-table"},{default:f(()=>[e("tbody",null,[t[1]||(t[1]=e("tr",null,[e("th",{style:{width:"10px"},rowspan:"3"},[k("결"),e("br"),e("br"),e("br"),k("재")]),e("th",{style:{height:"30px","text-align":"center"}},"기안자"),e("th",{style:{height:"30px","text-align":"center"}},"영업관리"),e("th",{style:{height:"30px","text-align":"center"}},"생산관리"),e("th",{style:{height:"30px","text-align":"center"}},"구매부"),e("th",{style:{height:"30px","text-align":"center"}},"품질관리"),e("th",{style:{height:"30px","text-align":"center"}},"연구소")],-1)),e("tr",pe,[e("td",ie,s(o.value.draftNm),1),e("td",null,s(l.value.businessUserId),1),e("td",null,s(l.value.productUserId),1),e("td",null,s(l.value.purchaseUserId),1),e("td",null,s(l.value.qcUserId),1),e("td",null,s(l.value.labUserId),1)]),e("tr",ve,[e("td",ce,s(o.value.draftDate),1),e("td",he,[l.value.businessApprovalDate?(n(),p("span",me,s(l.value.businessApprovalDate),1)):(n(),p("span",fe," 결제일자 "))]),e("td",Ie,[l.value.productApprovalDate?(n(),p("span",_e,s(l.value.productApprovalDate),1)):(n(),p("span",be," 결제일자 "))]),e("td",Ae,[l.value.purchaseApprovalDate?(n(),p("span",De,s(l.value.purchaseApprovalDate),1)):(n(),p("span",ye," 결제일자 "))]),e("td",xe,[l.value.qcApprovalDate?(n(),p("span",Fe,s(l.value.qcApprovalDate),1)):(n(),p("span",ge," 결제일자 "))]),e("td",Ue,[l.value.labApprovalDate?(n(),p("span",ke,s(l.value.labApprovalDate),1)):(n(),p("span",Ne," 결제일자 "))])])])]),_:1})])]),_:1})]),_:1}),y.value?(n(),E(_,{key:0},{default:f(()=>[u(c,null,{default:f(()=>[e("div",qe,[u(i,{color:"brown-lighten-4",class:"mt-1",density:"compact",text:"승인",onClick:$})])]),_:1})]),_:1})):O("",!0),u(_,null,{default:f(()=>[u(c,null,{default:f(()=>[u(b,{class:"order-table"},{default:f(()=>[e("tbody",null,[e("tr",null,[t[2]||(t[2]=e("th",null,"문서번호",-1)),e("td",null,s(o.value.orderNm),1),t[3]||(t[3]=e("th",null,"처리기한",-1)),t[4]||(t[4]=e("td",null,"즉시",-1))]),e("tr",null,[t[5]||(t[5]=e("th",null,"보존년한",-1)),t[6]||(t[6]=e("td",null,"5년",-1)),t[7]||(t[7]=e("th",null,"기안일자",-1)),e("td",null,s(o.value.draftDate),1)]),e("tr",null,[t[8]||(t[8]=e("th",null,"기안부서",-1)),e("td",null,s(o.value.draftDept),1),t[9]||(t[9]=e("th",null,"기안자",-1)),e("td",null,s(o.value.draftNm),1)]),e("tr",null,[t[10]||(t[10]=e("th",null,"제목",-1)),e("td",Ce,s(o.value.customerNm)+"   "+s(o.value.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),e("tr",null,[e("td",we,[k(s(o.value.customerNm)+"    "+s(o.value.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),t[11]||(t[11]=e("br",null,null,-1)),t[12]||(t[12]=e("br",null,null,-1)),t[13]||(t[13]=k(" - 아 래- "))])]),e("tr",null,[t[14]||(t[14]=e("th",null,"고객사명",-1)),e("td",null,s(o.value.customerNm),1),t[15]||(t[15]=e("th",null,"품목",-1)),e("td",null,s(o.value.itemName),1)]),e("tr",null,[t[16]||(t[16]=e("th",null,"발주수량",-1)),e("td",null,s(Number(o.value.orderQty).toLocaleString()),1),t[17]||(t[17]=e("th",null,"납기일자",-1)),e("td",null,s(o.value.dueDate),1)]),e("tr",null,[t[18]||(t[18]=e("th",null,"발주서 첨부파일",-1)),e("td",null,[u(j,{filepath:d.value.orderFilePath||"",fileName:d.value.orderFileName||"",attachFileId:d.value.orderAttachFileId||"",seq:d.value.orderSeq||""},null,8,["filepath","fileName","attachFileId","seq"])]),t[19]||(t[19]=e("th",null,"제품사양서 ",-1)),e("td",null,[u(j,{filepath:d.value.prodFilePath||"",fileName:d.value.prodFileName||"",attachFileId:d.value.prodAttachFileId||"",seq:d.value.prodSeq||""},null,8,["filepath","fileName","attachFileId","seq"])])]),V.value?(n(),p("tr",Se,[e("th",null,s(re(B)),1),e("td",Oe,[u(N,{modelValue:U.value,"onUpdate:modelValue":t[0]||(t[0]=A=>U.value=A),readonly:!1,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue"])])])):O("",!0),(n(!0),p(P,null,ue(H.value,(A,w)=>(n(),p("tr",{key:A.boardId||w},[e("th",null,s(A.boardUserId),1),e("td",Ve,[u(N,{modelValue:A.boardTxt,"onUpdate:modelValue":S=>A.boardTxt=S,readonly:!0,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1}),u(_,null,{default:f(()=>[u(c,null,{default:f(()=>[e("div",Le,[L.value?(n(),E(i,{key:0,color:"brown-lighten-4",class:"mt-1",text:"수정",onClick:K})):O("",!0),u(i,{color:"brown-lighten-4",class:"mt-1",text:"저장",onClick:R}),u(i,{class:"mt-1 mr-3",text:"목록",onClick:W})])]),_:1})]),_:1})],64)}}},Re=Z(je,[["__scopeId","data-v-2420a60b"]]);export{Re as default};
