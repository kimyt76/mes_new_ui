import{_ as le,k as ae,u as oe,r as v,a as ne,v as se,m as de,C as ie,n as ue,c as k,f as u,g as t,d as m,w as o,i as q,F as B,e as me,o as N,j as re,t as E,E as U,G as b,x as pe,y as ce,b as ve,z as fe}from"./index-BNL3Tgw5.js";import{_ as R}from"./DateSinglePicker-8DAkXH4C.js";import{_ as ge}from"./MultiFileUpload--c0CfwPP.js";import{I as _e}from"./ItemListSinglePop-B9yN6Coo.js";import{_ as ye}from"./CustomerListPop-C12lnYGL.js";import{_ as Ve}from"./UserListPop-DEkQwN6k.js";import{_ as xe}from"./StorageListPop-DItQtyxf.js";import{A as D}from"./apiOrders-Whxuw2Cj.js";import{_ as he}from"./SaleListPop-COeEt8O-.js";import"./format-CBpsKyOP.js";import"./filedownLoad-DSISiZ_u.js";import"./apiCommon-LY9rUrf-.js";import"./apiItem-CL-1bRvd.js";import"./apiBase-CSC4uJMW.js";const we=["id"],Se={class:"d-flex ga-4 justify-end"},Ne={class:"d-flex ga-4 justify-end"},Ue=["onUpdate:modelValue","onDblclick"],be=["onUpdate:modelValue"],Ie=["onUpdate:modelValue","onBlur"],Ce=["onUpdate:modelValue"],ke={class:"summary-row"},De={style:{width:"110px",height:"30px","text-align":"right","font-weight":"bold"}},$e={class:"d-flex ga-4 justify-end"},Le={__name:"ShipmentDetail",setup(Me){const A=ae().params.id,{vError:O,vSuccess:P}=oe(),$=me();let r=v(""),z=v("");const{userId:J}=ne(),x=v(!1),_=v(!1);let h=v("");const y=se(null),I=v(null),L=v([]),V=v([]),i=v([]),l=de({shipmentDate:"",seq:"",customerName:"",customerCd:"",releaseUserId:"",releaseUserName:"",descStorageCd:"",descStorageName:"",deliveryTelno:"",deliveryManagerName:"",dueDate:"",releaseTime:"",releaseType:"",accountStatement:"",address:"",attachFileId:"",saleIds:"",userId:J}),G=ie(()=>i.value.reduce((n,e)=>n+Number(e.qty||0),0)),H=[{title:"품목코드 ",key:"itemCd",align:"center",width:100},{title:"품목명",key:"itemName",align:"center",width:250},{title:"수량",key:"qty",align:"center",width:110},{title:"lot No.",key:"lotNo",align:"center",width:150}],w=n=>{switch(h.value=n,n){case"C":y.value=ye,r.value="800px",r.value="900px";break;case"U":y.value=Ve,r.value="800px",r.value="900px";break;case"S":y.value=xe,r.value="800px",r.value="900px";break;default:h.value="I",I.value=n,y.value=_e,r.value="1100px",r.value="800px";break}_.value=!0},Q=(n,e)=>{switch(h.value){case"C":l.customerName=e,l.customerCd=n;break;case"U":l.releaseUserName=e,l.releaseUserId=n;break;case"S":l.descStorageName=e,l.descStorageCd=n;break;case"I":if(I.value!==null){const g=i.value[I.value];g.itemCd=n,g.itemName=e}break}h.value="",_.value=!1},W=async n=>{L.value=n,l.customerCd=n[0].customerCd,l.customerName=n[0].customerName,l.releaseUserId=n[0].managerId,l.releaseUserName=n[0].managerName,l.descStorageCd=n[0].descStorageCd,l.descStorageName=n[0].descStorageName,l.tradingMethod=n[0].tradingMethod,l.saleIds=L.value.map(e=>e.saleId).join(","),i.value=await D.getSalesItemList(l.saleIds),console.log("itemList",i.value)},K=async()=>{const n=new FormData;try{const e={...l};n.append("shipmentInfo",JSON.stringify(e)),n.append("itemList",JSON.stringify(i.value)),V.value.forEach(S=>{S.file instanceof File&&n.append("attachFile",S.file)});const g=await D.saveShipmentInfo(n);P(g),$.push({name:"ShipmentList"})}catch(e){O(e.message)}},X=()=>{x.value=!0};ue(async()=>{Y()});const Y=async()=>{const n=await D.getShipmentInfo(A);Object.assign(l,n.shipmentInfo),i.value=n.itemList,n.attachFileInfo!==null?V.value=n.attachFileInfo:V.value=[]},Z=()=>{$.push({name:"ShipmentList"})};return(n,e)=>{const g=m("v-breadcrumbs"),S=m("v-card-item"),p=m("v-text-field"),s=m("v-col"),f=m("v-row"),M=m("v-textarea"),F=m("v-card-text"),C=m("v-btn"),j=m("v-data-table-virtual"),ee=m("v-form"),te=m("v-card"),T=m("v-dialog");return N(),k(B,null,[u("div",{id:n.$attrs.id},null,8,we),t(g,{items:["MES","수주관리","출하지시서 상세"],class:"custom-breadcrumbs"}),t(te,null,{default:o(()=>[t(S,{title:"출하지시서 상세"}),t(ee,{ref:"vform",onSubmit:re(K,["prevent"])},{default:o(()=>[t(F,null,{default:o(()=>[t(f,null,{default:o(()=>[t(s,{class:"d-flex flex-row align-center",style:{gap:"0px"}},{default:o(()=>[t(R,{modelValue:l.shipmentDate,"onUpdate:modelValue":e[0]||(e[0]=a=>l.shipmentDate=a),title:"주문일자",density:"compact",style:{width:"100px"}},null,8,["modelValue"]),t(p,{modelValue:l.seq,"onUpdate:modelValue":e[1]||(e[1]=a=>l.seq=a),label:"순번",density:"compact",style:{width:"50px","max-width":"70px","min-width":"0"},readonly:""},null,8,["modelValue"])]),_:1}),t(s),t(s,null,{default:o(()=>[u("div",Se,[t(R,{modelValue:l.shipmentDate,"onUpdate:modelValue":e[2]||(e[2]=a=>l.shipmentDate=a),title:"출하예정일",density:"compact"},null,8,["modelValue"])])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.tradingMethod,"onUpdate:modelValue":e[3]||(e[3]=a=>l.tradingMethod=a),label:"거래방법",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"6"},{default:o(()=>[t(p,{modelValue:l.customerName,"onUpdate:modelValue":e[4]||(e[4]=a=>l.customerName=a),label:"거래처",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[5]||(e[5]=a=>w("C"))},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.releaseUserName,"onUpdate:modelValue":e[6]||(e[6]=a=>l.releaseUserName=a),label:"출고요청자",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[7]||(e[7]=a=>w("U"))},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.descStorageName,"onUpdate:modelValue":e[8]||(e[8]=a=>l.descStorageName=a),label:"출하창고",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[9]||(e[9]=a=>w("S"))},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,null,{default:o(()=>[t(p,{modelValue:l.deliveryTelno,"onUpdate:modelValue":e[10]||(e[10]=a=>l.deliveryTelno=a),label:"납품지연락처",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.deliveryManagerName,"onUpdate:modelValue":e[11]||(e[11]=a=>l.deliveryManagerName=a),label:"납품지담당자",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.releaseType,"onUpdate:modelValue":e[12]||(e[12]=a=>l.releaseType=a),label:"출고구분",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.accountStatement,"onUpdate:modelValue":e[13]||(e[13]=a=>l.accountStatement=a),label:"거래명세서",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"6"},{default:o(()=>[t(M,{modelValue:l.address,"onUpdate:modelValue":e[14]||(e[14]=a=>l.address=a),label:"납품지 주소",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),t(s,{cols:"6"},{default:o(()=>[t(M,{modelValue:l.etc,"onUpdate:modelValue":e[15]||(e[15]=a=>l.etc=a),label:"특이사항",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{dense:""},{default:o(()=>[t(s,{cols:"12"},{default:o(()=>[t(ge,{modelValue:V.value,"onUpdate:modelValue":e[16]||(e[16]=a=>V.value=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(F,null,{default:o(()=>[t(f,null,{default:o(()=>[t(s,null,{default:o(()=>[u("div",Ne,[t(C,{text:"판매",density:"compact",onClick:X})])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"12"},{default:o(()=>[t(j,{headers:H,items:i.value,"item-value":"id"},{headers:o(({columns:a})=>[u("tr",null,[(N(!0),k(B,null,pe(a,d=>(N(),k("th",{key:d.key,class:"custom-header",style:ce([{height:"30px"},{width:d.width+"px"}])},E(d.title),5))),128))])]),"item.itemCd":o(({item:a,index:d})=>[U(u("input",{"onUpdate:modelValue":c=>i.value[d].itemCd=c,style:{"text-align":"center",width:"100px","min-width":"100px","max-width":"100px"},class:"custom-input",onDblclick:c=>w(d)},null,40,Ue),[[b,i.value[d].itemCd]])]),"item.itemName":o(({item:a,index:d})=>[U(u("input",{"onUpdate:modelValue":c=>i.value[d].itemName=c,style:{"text-align":"left",width:"250px","min-width":"250px","max-width":"250px"},class:"custom-input",readonly:""},null,8,be),[[b,i.value[d].itemName]])]),"item.qty":o(({item:a,index:d})=>[U(u("input",{"onUpdate:modelValue":c=>i.value[d].qty=c,type:"number",style:{"text-align":"right",width:"110px","min-width":"110px","max-width":"110px"},class:"custom-line",onBlur:c=>n.onBlur(d)},null,40,Ie),[[b,i.value[d].qty]])]),"item.lotNo":o(({item:a,index:d})=>[U(u("input",{"onUpdate:modelValue":c=>i.value[d].lotNo=c,style:{"text-align":"right",width:"110px","min-width":"110px","max-width":"110px"},class:"custom-line"},null,8,Ce),[[b,i.value[d].lotNo]])]),"body.append":o(()=>[u("tr",ke,[e[21]||(e[21]=u("td",{style:{width:"100px",height:"30px"}},null,-1)),e[22]||(e[22]=u("td",{style:{width:"250px",height:"30px"}},null,-1)),u("td",De,E(G.value.toLocaleString()),1),e[23]||(e[23]=u("td",null,null,-1))])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),t(f,{class:"mt-2 mb-2"},{default:o(()=>[t(s,null,{default:o(()=>[u("div",$e,[t(C,{text:"저장",class:"gt-2",color:"brown-lighten-4",type:"submit"}),t(C,{text:"목록",class:"mr-3",onClick:Z})])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(T,{modelValue:_.value,"onUpdate:modelValue":e[18]||(e[18]=a=>_.value=a),width:q(r),height:q(z),persistent:""},{default:o(()=>[(N(),ve(fe(y.value),{id:n.id,onSelected:Q,onCloseDialog:e[17]||(e[17]=a=>_.value=!1)},null,40,["id"]))]),_:1},8,["modelValue","width","height"]),t(T,{modelValue:x.value,"onUpdate:modelValue":e[20]||(e[20]=a=>x.value=a),width:"1200px",height:"800px",persistent:""},{default:o(()=>[t(he,{onSelected:W,onCloseSaleDialog:e[19]||(e[19]=a=>x.value=!1)})]),_:1},8,["modelValue"])],64)}}},Ke=le(Le,[["__scopeId","data-v-66a21c0c"]]);export{Ke as default};
