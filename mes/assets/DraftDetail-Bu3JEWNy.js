import{A as M}from"./apiOrders-LBbh7QBG.js";import{K as ne,a1 as ue,M as ie,L as pe,A as i,a8 as ce,W as ve,H as me,e as v,p as o,k as h,l as m,F as Q,N as fe,r as he,o as u,i as j,g as k,h as e,y as q,t as r,w as xe,a2 as H,u as be}from"./index-BCdxernO.js";import{D as K}from"./DownLoadLink-Dc-ck991.js";import{U as _e}from"./UserListPop-40qvmJxy.js";import{e as p,i as A,g as ye}from"./common-Ctgf_4Dl.js";import"./filedownLoad-Cs3MYRER.js";import"./apiCommon-DQdCmI3G.js";import"./index-CEOpAmiF.js";import"./index-Z2YNGKhZ.js";import"./index-CKfU0QJd.js";import"./index-WWuz9eST.js";import"./index-BGn1OEmN.js";import"./index-DhHuXiFi.js";import"./apiSystem-BBpYMteA.js";const Ie={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},De={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ge={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ae={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ue={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ne={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},ke={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},qe={key:0},Ve={key:1},we={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ce={key:0},Se={key:1},Le={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Be={key:0},Ee={key:1},Te={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},je={key:0},Oe={key:1},Pe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ye={key:0},Me={key:1},Qe={class:"d-flex ga-4 justify-end"},He={colspan:"3"},Ke={colspan:"4",style:{height:"100px","text-align":"center"}},Re={colspan:"3"},We={colspan:"3",style:{"border-bottom":"1px solid #ccc"}},$e={key:0},ze={colspan:"3"},Ge={colspan:"3"},Je={__name:"DraftDetail",setup(Xe){const R=ue(),V=fe(),w=R.params.id,{userId:d,memberNm:W,deptNm:Ze}=ie(),{vError:$,vSuccess:z,vInfo:et}=pe();i([]),i([]);const C=i([]),G=ce(()=>C.value.filter(a=>a.boardUserId!==d)),S=i(!1),O=i(!1),L=i(!1),P=i(!1),Y=i(!1);let y=i("");const U=i("");let f=i(null);const s=ve({draftDate:p(),seq:"",customerName:"",itemName:"",orderQty:0,dueDate:"",draftUserName:"",draftDept:"",draftUserId:"",statusType:"",userId:d}),J=i(""),l=i({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessUserName:"",productUserName:"",purchaseUserName:"",qcUserName:"",labUserName:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),c=i({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),X=a=>{l.value.labUserName=a.memberNm,l.value.labUserId=a.userId},Z=async()=>{const a={userId:d,field:y.value,boardId:s.boardId,approvalId:s.approvalId,boardTxt:U.value,appDate:f.value,draftId:w,statusType:J.value};try{const t=await M.updateInfo(a);z(t),V.push({name:"DraftList"})}catch(t){$(t)}},ee=()=>{s.draftUserId===d&&(P.value=!0);const t=Object.values(l.value).includes(d),{businessCheckYn:b,productCheckYn:N,purchaseCheckYn:I,qcCheckYn:D,labCheckYn:F,businessUserId:g,productUserId:_,purchaseUserId:B,qcUserId:E,labUserId:T}=l.value;A(te(d))||(Y.value=!0),s.draftUserId!==d&&(O.value=!0);const x=i(!1);(d===g&&b==="N"||d===_&&N==="N"||d===B&&I==="N"||d===E&&D==="N"||d===T&&F==="N")&&(x.value=!0),t&&x.value&&(L.value=!0)},te=a=>{for(const[t,b]of Object.entries(l.value))if(t.endsWith("UserId")&&b===a)return t;return null};me(async()=>{const a=await M.getDraftInfo(w);Object.assign(s,a.draftInfo),Object.assign(l.value,a.approvalInfo),C.value=a.boardInfo||[],ee();const t=C.value.find(b=>b.boardUserId===d);U.value=t?t.boardTxt:"",le(a)});const le=a=>{a.orderAttachFileInfo!==null&&(c.value.orderFileName=a.orderAttachFileInfo.fileName,c.value.orderFilePath=a.orderAttachFileInfo.filePath,c.value.orderFileAttachFileId=a.orderAttachFileInfo.attachFileId,c.value.orderSeq=a.orderAttachFileInfo.seq),a.prodAttachFileInfo!==null&&(c.value.prodFileName=a.prodAttachFileInfo.fileName,c.value.prodFilePath=a.prodAttachFileInfo.filepath,c.value.prodFileAttachFileId=a.prodAttachFileInfo.attachFileId,c.value.prodSeq=a.prodAttachFileInfo.seq)},ae=()=>{l.value.businessUserId.includes(d)&&(A(l.value.businessApprovalDate)?(l.value.businessApprovalDate=p(),l.value.productApprovalDate=p(),l.value.purchaseApprovalDate=p(),l.value.qcApprovalDate=p(),l.value.labApprovalDate=p(),f.value=p(),y.value="business_approval_date"):f.value=l.value.businessApprovalDate),l.value.productUserId.includes(d)?A(l.value.productApprovalDate)?(l.value.productApprovalDate=p(),f.value=p(),y.value="product_Approval_Date"):f.value=l.value.productApprovalDate:l.value.purchaseUserId.includes(d)?A(l.value.purchaseApprovalDate)?(l.value.purchaseApprovalDate=p(),f.value=p(),y.value="purchase_Approval_Date"):f.value=l.value.purchaseApprovalDate:l.value.qcUserId.includes(d)?A(l.value.qcApprovalDate)?(l.value.qcApprovalDate=p(),f.value=p(),y.value="qc_Approval_Date"):f.value=l.value.qcApprovalDate:l.value.labUserId.includes(d)&&(A(l.value.labApprovalDate)?(l.value.labApprovalDate=p(),f.value=p(),y.value="lab_Approval_Date"):f.value=l.value.labApprovalDate),L.value=!1},oe=()=>{V.push({name:"DraftEdit",params:{id:w}})},se=()=>{V.push({name:"DraftList"})};return(a,t)=>{const b=h("v-breadcrumbs"),N=h("v-table"),I=h("v-col"),D=h("v-row"),F=h("v-card-text"),g=h("v-btn"),_=h("v-text-field"),B=h("v-date-input"),E=h("v-card"),T=h("v-dialog"),x=he("comma-number");return u(),v(Q,null,[o(b,{items:["MES","영업관리","사양서 상세"]}),o(E,null,{default:m(()=>[o(F,null,{default:m(()=>[o(D,null,{default:m(()=>[o(I,{class:"d-flex justify-end pa-1"},{default:m(()=>[o(N,{style:{border:"0.1px solid #ccc"}},{default:m(()=>[e("tbody",null,[t[7]||(t[7]=e("tr",null,[e("th",{rowspan:"3",style:{"vertical-align":"middle",width:"20px"}},[q("결"),e("br"),e("br"),e("br"),q("재")]),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"기안자"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"영업관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"생산관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"구매부"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"품질관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"연구소")],-1)),e("tr",null,[e("td",Ie,r(s.draftUserName),1),e("td",De,r(l.value.businessUserName),1),e("td",ge,r(l.value.productUserName),1),e("td",Ae,r(l.value.purchaseUserName),1),e("td",Ue,r(l.value.qcUserName),1),e("td",Ne,r(l.value.labUserName),1)]),e("tr",null,[e("td",Fe,r(s.draftDate),1),e("td",ke,[l.value.businessApprovalDate?(u(),v("span",Ve,r(l.value.businessApprovalDate),1)):(u(),v("span",qe,"결제일자"))]),e("td",we,[l.value.productApprovalDate?(u(),v("span",Se,r(l.value.productApprovalDate),1)):(u(),v("span",Ce,"결제일자"))]),e("td",Le,[l.value.purchaseApprovalDate?(u(),v("span",Ee,r(l.value.purchaseApprovalDate),1)):(u(),v("span",Be,"결제일자"))]),e("td",Te,[l.value.qcApprovalDate?(u(),v("span",Oe,r(l.value.qcApprovalDate),1)):(u(),v("span",je,"결제일자"))]),e("td",Pe,[l.value.labApprovalDate?(u(),v("span",Me,r(l.value.labApprovalDate),1)):(u(),v("span",Ye,"결제일자"))])])])]),_:1})]),_:1})]),_:1})]),_:1}),L.value?(u(),j(D,{key:0},{default:m(()=>[o(I,null,{default:m(()=>[e("div",Qe,[o(g,{color:"brown-lighten-4",class:"mt-1 mr-3",text:"승인",onClick:ae})])]),_:1})]),_:1})):k("",!0),o(F,null,{default:m(()=>[o(D,null,{default:m(()=>[o(I,null,{default:m(()=>[o(N,{class:"compact-table"},{default:m(()=>[e("tbody",null,[e("tr",null,[t[8]||(t[8]=e("th",null,"문서번호",-1)),e("td",null,r(s.draftDate)+"-"+r(s.seq),1),t[9]||(t[9]=e("th",null,"처리기한",-1)),t[10]||(t[10]=e("td",null,"즉시",-1))]),e("tr",null,[t[11]||(t[11]=e("th",null,"보존년한",-1)),t[12]||(t[12]=e("td",null,"5년",-1)),t[13]||(t[13]=e("th",null,"기안일자",-1)),e("td",null,r(s.draftDate),1)]),e("tr",null,[t[14]||(t[14]=e("th",null,"기안부서",-1)),e("td",null,r(s.draftDept),1),t[15]||(t[15]=e("th",null,"기안자",-1)),e("td",null,r(s.draftUserName),1)]),e("tr",null,[t[16]||(t[16]=e("th",null,"제목",-1)),e("td",He,r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),e("tr",null,[e("td",Ke,[q(r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),t[17]||(t[17]=e("br",null,null,-1)),t[18]||(t[18]=e("br",null,null,-1)),t[19]||(t[19]=q(" - 아 래 - ",-1))])]),e("tr",null,[t[20]||(t[20]=e("th",null,"고객사명",-1)),e("td",null,[o(_,{modelValue:s.customerName,"onUpdate:modelValue":t[0]||(t[0]=n=>s.customerName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])]),t[21]||(t[21]=e("th",null,"품목",-1)),e("td",null,[o(_,{modelValue:s.itemName,"onUpdate:modelValue":t[1]||(t[1]=n=>s.itemName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])])]),e("tr",null,[t[22]||(t[22]=e("th",null,"발주수량",-1)),e("td",null,[xe(o(_,{modelValue:s.orderQty,"onUpdate:modelValue":t[2]||(t[2]=n=>s.orderQty=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",style:{"text-align":"right"},class:"cell-input"},null,8,["modelValue"]),[[x]])]),t[23]||(t[23]=e("th",null,"납기일자",-1)),e("td",null,[o(B,{modelValue:s.dueDate,"onUpdate:modelValue":t[3]||(t[3]=n=>s.dueDate=n),"display-format":H(ye),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue","display-format"])])]),e("tr",null,[t[24]||(t[24]=e("th",null,"발주서 첨부파일",-1)),e("td",Re,[o(K,{fileName:c.value.orderFileName||"",attachFileId:c.value.orderFileAttachFileId||"",seq:c.value.orderSeq||""},null,8,["fileName","attachFileId","seq"])])]),e("tr",null,[t[25]||(t[25]=e("th",null,"제품사양서 첨부",-1)),e("td",We,[o(K,{fileName:c.value.prodFileName||"",attachFileId:c.value.prodFileAttachFileId||"",seq:c.value.prodSeq||""},null,8,["fileName","attachFileId","seq"])])]),O.value?(u(),v("tr",$e,[e("th",null,r(H(W)),1),e("td",ze,[o(_,{modelValue:U.value,"onUpdate:modelValue":t[4]||(t[4]=n=>U.value=n),readonly:!1,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue"])])])):k("",!0),(u(!0),v(Q,null,be(G.value,(n,re)=>(u(),v("tr",{key:n.boardId||re},[e("th",null,r(n.boardUserId),1),e("td",Ge,[o(_,{modelValue:n.boardTxt,"onUpdate:modelValue":de=>n.boardTxt=de,readonly:!0,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1}),o(D,null,{default:m(()=>[o(I,{class:"d-flex ga-4 justify-end mb-3"},{default:m(()=>[P.value?(u(),j(g,{key:0,color:"brown-lighten-4",text:"수정",onClick:oe})):k("",!0),Y.value?(u(),j(g,{key:1,text:"저장",class:"gt-2",color:"brown-lighten-4",onClick:Z})):k("",!0),o(g,{text:"목록",class:"mr-3",onClick:se})]),_:1})]),_:1})]),_:1})]),_:1}),o(T,{modelValue:S.value,"onUpdate:modelValue":t[6]||(t[6]=n=>S.value=n),height:"800px",width:"900px",persistent:""},{default:m(()=>[o(_e,{onSelected:X,onCloseDialog:t[5]||(t[5]=n=>S.value=!1)})]),_:1},8,["modelValue"])],64)}}},ft=ne(Je,[["__scopeId","data-v-3cf0ca6c"]]);export{ft as default};
