import{r as f,k as K,d as a,b as ne,o as Q,w as t,g as e,h as M,f as g,j as W,_ as ae,u as oe,p as ie,m as de,c as se,F as ue,e as re,i as z,B as w,C}from"./index-B3xMVO1S.js";import{A as B}from"./apiLab-DdIqXNsg.js";import{i as T,f as q}from"./common-UsHpmNCI.js";import{_ as me}from"./MultiFileUpload-DzqmH1VV.js";import"./format-CBpsKyOP.js";import"./filedownLoad-HpKgPGuY.js";const ce={style:{"overflow-y":"auto",height:"calc(100% - 40px)"}},pe={__name:"IngredientListPop",emits:["selected","close-dialog"],setup(X,{emit:$}){const k=$,N=f(""),I=f([]),h=f([]),v=K({ingredientCode:"",ingredientName:"",functionNm:""}),m=[{title:"성분코드",key:"ingredientCode",width:120},{title:"국문성분명",key:"krIngredientName",width:230},{title:"영문성분명",key:"enIngredientName",width:230},{title:"CAS No",key:"casNo",width:110},{title:"function",key:"functionNm",width:130}],V=async()=>{try{const x={...v};h.value=await B.getIngredientList(x)}catch(x){vError(x)}finally{}},c=()=>{k("selected",I.value)};return(x,d)=>{const P=a("v-toolbar-title"),i=a("v-spacer"),U=a("v-icon"),y=a("v-btn"),R=a("v-toolbar"),b=a("v-text-field"),A=a("v-col"),j=a("v-form"),L=a("v-row"),S=a("v-data-table"),E=a("v-card-text"),o=a("v-card-actions"),l=a("v-card");return Q(),ne(l,null,{default:t(()=>[e(R,{height:"40",class:"d-flex align-center justify-space-between px-2 toolbar-Head"},{default:t(()=>[e(P,null,{default:t(()=>d[7]||(d[7]=[M("성분코드조회")])),_:1}),e(i),e(y,{icon:"",onClick:d[0]||(d[0]=s=>k("close-dialog"))},{default:t(()=>[e(U,null,{default:t(()=>d[8]||(d[8]=[M("mdi-close")])),_:1})]),_:1})]),_:1}),e(i),e(E,null,{default:t(()=>[e(L,null,{default:t(()=>[e(j,{ref_key:"srhForm",ref:N,onSubmit:W(V,["prevent"])},{default:t(()=>[e(A,{class:"d-flex flex-row ga-3"},{default:t(()=>[e(b,{modelValue:v.ingredientCode,"onUpdate:modelValue":d[1]||(d[1]=s=>v.ingredientCode=s),label:"성분코드",placeholder:"성분코드를 입력해주세요",density:"compact",style:{width:"200px"}},null,8,["modelValue"]),e(b,{modelValue:v.ingredientName,"onUpdate:modelValue":d[2]||(d[2]=s=>v.ingredientName=s),label:"성분명",placeholder:"성분명을 입력해주세요",density:"compact",style:{width:"200px"}},null,8,["modelValue"]),e(b,{modelValue:v.functionNm,"onUpdate:modelValue":d[3]||(d[3]=s=>v.functionNm=s),label:"function명",placeholder:"function명을 입력해주세요",density:"compact",style:{width:"200px"}},null,8,["modelValue"]),e(y,{text:"조회",color:"brown-lighten-4",type:"submit"}),e(y,{text:"초기화",onClick:d[4]||(d[4]=s=>N.value.reset())})]),_:1})]),_:1},512)]),_:1}),g("div",ce,[e(S,{modelValue:I.value,"onUpdate:modelValue":d[5]||(d[5]=s=>I.value=s),headers:m,items:h.value,"item-value":"ingredientCode",density:"compact","fixed-header":"",height:"520px","show-select":"",class:"custom-table","return-object":""},null,8,["modelValue","items"])])]),_:1}),e(o,null,{default:t(()=>[e(y,{text:"선택",variant:"flat",class:"mb-4",color:"indigo-darken-3",onClick:c}),e(y,{text:"닫기",variant:"tonal",class:"mb-4 mr-3",onClick:d[6]||(d[6]=s=>k("close-dialog"))})]),_:1})]),_:1})}}},ve=["id"],fe=["onUpdate:modelValue"],_e=["onUpdate:modelValue"],ye={__name:"MaterialDetail",setup(X){const{vError:$,vSuccess:k}=oe(),N=re(),h=ie().params.id,v=f(!1),m=f([]),V=f([]),c=f([]),x=f([]),d=[{title:"성분코드",key:"ingredientCode",align:"center",width:"90px"},{title:"국문성분명",key:"krIngredientName",align:"start",width:"230px"},{title:"영어성분명",key:"enIngredientName",align:"start",width:"230px"},{title:"국내함량",key:"inContent",align:"center",width:"100px"},{title:"수출용함량",key:"outContent",align:"center",width:"100px"},{title:"CAS No",key:"casNo",align:"center",width:"90px"},{title:"function",key:"functionNm",align:"center",width:"90px"},{title:"한도 국가",key:"limitCountry",align:"center",width:"90px"},{title:"금지 국가",key:"banCountry",align:"center",width:"90px"},{title:"-",key:"actions",align:"center",width:"10px"}],P=[{title:"변경사유",key:"etc",align:"start",width:500},{title:"수정자",key:"updName",align:"center",width:100},{title:"수정일",key:"updDate",align:"center",width:100},{title:"-",key:"actions",align:"center",width:10}],i=K({itemCd:"",itemName:"",unit:"",customerName:"",inPrice:"",outPrice:"",itemGrp1:"",vegan:!1,halal:!1,rspo:!1,addtion:!1}),U=async()=>{const o=new FormData;try{const l={itemCd:h,historyId:L.value,attachFileId:S.value};o.append("materialInfo",JSON.stringify(l)),o.append("materialList",JSON.stringify(m.value)),o.append("historyList",JSON.stringify(c.value)),V.value.forEach(u=>{u.file instanceof File&&o.append("attachFile",u.file)});const s=await B.saveMaterialInfo(o)}catch(l){$(l.respose)}},y=()=>{v.value=!0},R=()=>{let o=c.value.length;c.value.push({id:o,etc:"",updName:"",updDate:""})},b=o=>{if(!Array.isArray(o))return;let l=m.value.length;const s=o.map((u,r)=>({id:l++,ingredientCode:u.ingredientCode,krIngredientName:u.krIngredientName,enIngredientName:u.enIngredientName,inContent:"",outContent:"",casNo:u.casNo,functionNm:u.functionNm,limitCountry:u.limitCountry,banCountry:u.banCountry}));m.value.length>0?m.value.push(...s):m.value=[...s]},A=o=>{const l=m.value.findIndex(s=>s.ingredientCode===o);m.value.splice(l,1)},j=o=>{const l=c.value.findIndex(s=>s.historyId===o);c.value.splice(l,1)},L=f(""),S=f("");de(async()=>{const o=await B.getMaterialInfo(h);Object.assign(i,o.itemInfo),L.value=o.materialInfo.historyId,S.value=o.materialInfo.attachFileId,T(o.materialList)||(m.value=o.materialList),T(o.historyList)||(c.value=o.historyList)});const E=()=>{N.push({name:"MaterialList"})};return(o,l)=>{const s=a("v-breadcrumbs"),u=a("v-text-field"),r=a("v-col"),_=a("v-row"),D=a("v-checkbox"),Y=a("v-select"),Z=a("v-form"),ee=a("v-card-text"),te=a("v-card"),G=a("v-card-subtitle"),F=a("v-btn"),H=a("v-icon"),J=a("v-data-table-virtual"),le=a("v-dialog");return Q(),se(ue,null,[g("div",{id:o.$attrs.id},null,8,ve),e(s,{items:["MES","연구관리","원료상세"]}),e(te,null,{default:t(()=>[e(ee,null,{default:t(()=>[e(Z,{onSubmit:W(U,["prevent"])},{default:t(()=>[e(_,null,{default:t(()=>[e(r,null,{default:t(()=>[e(u,{modelValue:i.itemCd,"onUpdate:modelValue":l[0]||(l[0]=n=>i.itemCd=n),label:"품목코드",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1}),e(r,{cols:"6"},{default:t(()=>[e(u,{modelValue:i.itemName,"onUpdate:modelValue":l[1]||(l[1]=n=>i.itemName=n),label:"품목명",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(u,{modelValue:i.unit,"onUpdate:modelValue":l[2]||(l[2]=n=>i.unit=n),label:"단위",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(r,{cols:"6"},{default:t(()=>[e(u,{modelValue:i.customerName,"onUpdate:modelValue":l[3]||(l[3]=n=>i.customerName=n),label:"거래처명",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1}),e(r,{class:"d-flex"},{default:t(()=>[e(D,{modelValue:i.vegan,"onUpdate:modelValue":l[4]||(l[4]=n=>i.vegan=n),label:"Vegan",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"]),e(D,{modelValue:i.halal,"onUpdate:modelValue":l[5]||(l[5]=n=>i.halal=n),label:"Halal",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"]),e(D,{modelValue:i.rspo,"onUpdate:modelValue":l[6]||(l[6]=n=>i.rspo=n),label:"RSPO",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"]),e(D,{modelValue:i.addtion,"onUpdate:modelValue":l[7]||(l[7]=n=>i.addtion=n),label:"RSPO",density:"compact","hide-details":"",readonly:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(Y,{modelValue:i.itemGrp1,"onUpdate:modelValue":l[8]||(l[8]=n=>i.itemGrp1=n),items:x.value,label:"거래유형","item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue","items"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(r,null,{default:t(()=>[e(u,{"model-value":z(q)(i.inPrice),label:"입고단가",variant:"underlined",density:"compact",readonly:""},null,8,["model-value"])]),_:1}),e(r,null,{default:t(()=>[e(u,{"model-value":z(q)(i.outPrice),label:"출고단가",variant:"underlined",density:"compact",readonly:""},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{class:"mt-4"},{default:t(()=>[e(r,{class:"mt-3"},{default:t(()=>[e(G,null,{default:t(()=>l[15]||(l[15]=[M(" - 성분코드 ")])),_:1})]),_:1}),e(r,{class:"d-flex justify-end"},{default:t(()=>[e(F,{color:"brown-lighten-4",class:"mt-3",text:"추가+",density:"compact",onClick:y})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(J,{headers:d,items:m.value,class:"custom-table"},{"item.inContent":t(({item:n,index:p})=>[w(g("input",{"onUpdate:modelValue":O=>m.value[p].inContent=O,style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,8,fe),[[C,m.value[p].inContent]])]),"item.outContent":t(({item:n,index:p})=>[w(g("input",{"onUpdate:modelValue":O=>m.value[p].outContent=O,style:{"text-align":"right",width:"90%",height:"30px"},class:"custom-line"},null,8,_e),[[C,m.value[p].outContent]])]),"item.actions":t(({item:n})=>[e(H,{color:"medium-emphasis",icon:"mdi-delete",size:"small",onClick:p=>A(n.ingredientCode)},null,8,["onClick"])]),_:1},8,["items"])]),_:1}),e(_,null,{default:t(()=>[e(r,{class:"mt-5"},{default:t(()=>[e(me,{modelValue:V.value,"onUpdate:modelValue":l[9]||(l[9]=n=>V.value=n)},null,8,["modelValue"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(r,{class:"mt-3"},{default:t(()=>[e(G,null,{default:t(()=>l[16]||(l[16]=[M(" - 변경이력 ")])),_:1})]),_:1}),e(r,{class:"d-flex justify-end"},{default:t(()=>[e(F,{color:"brown-lighten-4",class:"mt-3",text:"추가+",density:"compact",onClick:R})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(r,null,{default:t(()=>[e(J,{headers:P,items:c.value,class:"custom-table"},{"item.etc":t(({item:n})=>[w(g("input",{"onUpdate:modelValue":l[10]||(l[10]=p=>c.value.etc=p),style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,512),[[C,c.value.etc]])]),"item.updName":t(({item:n})=>[w(g("input",{"onUpdate:modelValue":l[11]||(l[11]=p=>c.value.updName=p),style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,512),[[C,c.value.updName]])]),"item.updDate":t(({item:n})=>[w(g("input",{"onUpdate:modelValue":l[12]||(l[12]=p=>c.value.updDate=p),style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,512),[[C,c.value.updDate]])]),"item.actions":t(({item:n})=>[e(H,{color:"medium-emphasis",icon:"mdi-delete",size:"small",onClick:p=>j(n.historyId)},null,8,["onClick"])]),_:1},8,["items"])]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(r,{class:"d-flex justify-end mt-3 ga-3"},{default:t(()=>[e(F,{text:"저장",color:"brown-lighten-4",onClick:U}),e(F,{text:"목록",onClick:E})]),_:1})]),_:1}),e(le,{modelValue:v.value,"onUpdate:modelValue":l[14]||(l[14]=n=>v.value=n),width:"900px",persistent:""},{default:t(()=>[e(pe,{onSelected:b,onCloseDialog:l[13]||(l[13]=n=>v.value=!1)})]),_:1},8,["modelValue"])],64)}}},Ce=ae(ye,[["__scopeId","data-v-986f50d5"]]);export{Ce as default};
