import{_ as B,a as U}from"./SingleFileUpload-DOsv-ewV.js";import{D as O}from"./DownLoadLink-DhWFMjA0.js";import{_ as L,u as Q,a as M,k as R,r as m,n as G,c as u,f as e,g as s,d as f,w as p,F as J,e as T,E as z,o as r,h as c,v as o,G as H,b as P}from"./index-B3k6qWTO.js";import{A as C}from"./apiOrders-C4cqJx2A.js";import{A as K}from"./apiCommon-Cgp-9u3n.js";import"./format-CBpsKyOP.js";const W=["id"],X={class:"d-flex justify-end"},Y={class:"approval-user"},Z={style:{height:"80px"}},ee={class:"approval-date"},te={style:{height:"30px"}},le={style:{height:"30px"}},ae={key:0},oe={key:1},se={style:{height:"30px"}},ne={key:0},re={key:1},de={style:{height:"30px"}},ue={key:0},ie={key:1},pe={style:{height:"30px"}},ve={key:0},me={key:1},he={style:{height:"30px"}},fe={key:0},ce={key:1},ye={colspan:"3"},xe={colspan:"4",style:{height:"120px","text-align":"center"}},ge={key:1},Fe={key:1},_e={class:"d-flex ga-4 justify-end"},be={__name:"OrderEdit",setup(Ie){const F=R(),_=T(),{vSuccess:D,vError:N}=Q(),{userId:Ae,memberNm:De}=M(),S=F.params.id,k=m(!1),V=m(!1),y=m(null),x=m(null),l=m({customerNm:"",itemNm:"",orderQty:"",dueDate:"",approvalId:""}),n=m({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),i=m({orderFileName:"",orderFilePath:"",prodFileName:"",prodFilePath:""}),E=async()=>{const a=new FormData;a.append("orderInfo",JSON.stringify(l.value)),a.append("board",null),a.append("approval",null);const t=y.value instanceof File,v=x.value instanceof File;t?a.append("orderFile",y.value):a.append("orderAttachFileId",l.value.orderAttachFileId),v?a.append("prodFile",x.value):a.append("prodAttachFileId",l.value.prodAttachFileId);try{const h=await C.saveOrderInfo(a);D(h),_.push({name:"OrderDetail",params:{id:F.params.id}})}catch(h){N(h)}};G(async()=>{const a=await C.getOrderInfo(S);Object.assign(l.value,a.orderInfo),Object.assign(n.value,a.approvalInfo),q(a)});const q=a=>{a.orderAttachFileInfo===null?k.value=!0:(i.value.orderFileName=a.orderAttachFileInfo.fileName,i.value.orderFilePath=a.orderAttachFileInfo.filePath),a.prodAttachFileInfo===null?V.value=!0:(i.value.prodFileName=a.prodAttachFileInfo.fileName,i.value.prodFilePath=a.prodAttachFileInfo.filePath)},w=async a=>{let t="";a==="o"?(t=l.value.orderAttachFileId,l.value.orderAttachFileId=null):(t=l.value.prodAttachFileId,l.value.prodAttachFileId=null);try{const v=await K.deleteFile(t);D(v),_.push({name:"OrderDetail",params:{id:F.params.id}})}catch(v){N(v)}},$=()=>{_.push({name:"OrderList"})};return(a,t)=>{const v=f("v-breadcrumbs"),h=f("v-table"),b=f("v-col"),I=f("v-row"),A=f("v-text-field"),g=f("v-btn"),j=z("comma-number");return r(),u(J,null,[e("div",{id:a.$attrs.id},null,8,W),s(v,{items:["MES","발주관리","발주 수정"]}),s(I,null,{default:p(()=>[s(b,null,{default:p(()=>[e("div",X,[s(h,{class:"approval-table"},{default:p(()=>[e("tbody",null,[t[8]||(t[8]=e("tr",null,[e("th",{style:{width:"10px"},rowspan:"3"},[c("결"),e("br"),e("br"),e("br"),c("재")]),e("th",{style:{height:"30px","text-align":"center"}},"기안자"),e("th",{style:{height:"30px","text-align":"center"}},"영업관리"),e("th",{style:{height:"30px","text-align":"center"}},"생산관리"),e("th",{style:{height:"30px","text-align":"center"}},"구매부"),e("th",{style:{height:"30px","text-align":"center"}},"품질관리"),e("th",{style:{height:"30px","text-align":"center"}},"연구소")],-1)),e("tr",Y,[e("td",Z,o(l.value.draftNm),1),e("td",null,o(n.value.businessUserId),1),e("td",null,o(n.value.productUserId),1),e("td",null,o(n.value.purchaseUserId),1),e("td",null,o(n.value.qcUserId),1),e("td",null,o(n.value.labUserId),1)]),e("tr",ee,[e("td",te,o(l.value.draftDate),1),e("td",le,[n.value.businessApprovalDate?(r(),u("span",oe,o(n.value.businessApprovalDate),1)):(r(),u("span",ae," 결재일자 "))]),e("td",se,[n.value.productApprovalDate?(r(),u("span",re,o(n.value.productApprovalDate),1)):(r(),u("span",ne," 결재일자 "))]),e("td",de,[n.value.purchaseApprovalDate?(r(),u("span",ie,o(n.value.purchaseApprovalDate),1)):(r(),u("span",ue," 결재일자 "))]),e("td",pe,[n.value.qcApprovalDate?(r(),u("span",me,o(n.value.qcApprovalDate),1)):(r(),u("span",ve," 결재일자 "))]),e("td",he,[n.value.labApprovalDate?(r(),u("span",ce,o(n.value.labApprovalDate),1)):(r(),u("span",fe," 결재일자 "))])])])]),_:1})])]),_:1})]),_:1}),s(I,null,{default:p(()=>[s(b,null,{default:p(()=>[s(h,{class:"order-table"},{default:p(()=>[e("tbody",null,[e("tr",null,[t[9]||(t[9]=e("th",null,"문서번호",-1)),e("td",null,o(l.value.orderNm),1),t[10]||(t[10]=e("th",null,"처리기한",-1)),t[11]||(t[11]=e("td",null,"즉시",-1))]),e("tr",null,[t[12]||(t[12]=e("th",null,"보존년한",-1)),t[13]||(t[13]=e("td",null,"5년",-1)),t[14]||(t[14]=e("th",null,"기안일자",-1)),e("td",null,o(l.value.draftDate),1)]),e("tr",null,[t[15]||(t[15]=e("th",null,"기안부서",-1)),e("td",null,o(l.value.draftDept),1),t[16]||(t[16]=e("th",null,"기안자",-1)),e("td",null,o(l.value.draftNm),1)]),e("tr",null,[t[17]||(t[17]=e("th",null,"제목",-1)),e("td",ye,o(l.value.customerNm)+"   "+o(l.value.itemNm)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),e("tr",null,[e("td",xe,[c(o(l.value.customerNm)+"    "+o(l.value.itemNm)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),t[18]||(t[18]=e("br",null,null,-1)),t[19]||(t[19]=e("br",null,null,-1)),t[20]||(t[20]=c(" - 아 래- "))])]),e("tr",null,[t[21]||(t[21]=e("th",null,"고객사명",-1)),e("td",null,[s(A,{modelValue:l.value.customerNm,"onUpdate:modelValue":t[0]||(t[0]=d=>l.value.customerNm=d),style:{width:"500px",height:"20px"},density:"compact",class:"mb-4"},null,8,["modelValue"])]),t[22]||(t[22]=e("th",null,"품목",-1)),e("td",null,[s(A,{modelValue:l.value.itemNm,"onUpdate:modelValue":t[1]||(t[1]=d=>l.value.itemNm=d),style:{width:"500px",height:"20px","vertical-align":"center"},density:"compact",class:"mb-4"},null,8,["modelValue"])])]),e("tr",null,[t[23]||(t[23]=e("th",null,"발주수량",-1)),e("td",null,[H(s(A,{modelValue:l.value.orderQty,"onUpdate:modelValue":t[2]||(t[2]=d=>l.value.orderQty=d),density:"compact",style:{width:"500px",height:"20px"},class:"mb-4"},null,8,["modelValue"]),[[j]])]),t[24]||(t[24]=e("th",null,"납기일자",-1)),e("td",null,[s(B,{modelValue:l.value.dueDate,"onUpdate:modelValue":t[3]||(t[3]=d=>l.value.dueDate=d),title:"납기일자",style:{width:"500px",height:"20px","vertical-align":"middle"},class:"mb-10"},null,8,["modelValue"])])]),e("tr",null,[t[27]||(t[27]=e("th",null,"발주서 첨부파일",-1)),e("td",null,[k.value?(r(),P(U,{key:0,modelValue:y.value,"onUpdate:modelValue":t[4]||(t[4]=d=>y.value=d),style:{height:"20px",width:"500px"},class:"mb-4"},null,8,["modelValue"])):(r(),u("div",ge,[s(O,{filepath:i.value.orderFilePath||"",fileName:i.value.orderFileName||""},null,8,["filepath","fileName"]),t[25]||(t[25]=c("      ")),s(g,{text:"삭제",onClick:t[5]||(t[5]=d=>w("o"))})]))]),t[28]||(t[28]=e("th",null,"제품사양서",-1)),e("td",null,[V.value?(r(),P(U,{key:0,modelValue:x.value,"onUpdate:modelValue":t[6]||(t[6]=d=>x.value=d),style:{height:"20px",width:"500px"},class:"mb-4"},null,8,["modelValue"])):(r(),u("div",Fe,[s(O,{filepath:i.value.prodFilePath||"",fileName:i.value.prodFileName||""},null,8,["filepath","fileName"]),t[26]||(t[26]=c("      ")),s(g,{text:"삭제",density:"compact",onClick:t[7]||(t[7]=d=>w("p"))})]))])])])]),_:1})]),_:1})]),_:1}),s(I,null,{default:p(()=>[s(b,null,{default:p(()=>[e("div",_e,[s(g,{text:"저장",class:"gt-2",onClick:E}),s(g,{text:"목록",class:"mr-3",onClick:$})])]),_:1})]),_:1})],64)}}},Pe=L(be,[["__scopeId","data-v-633c29e7"]]);export{Pe as default};
