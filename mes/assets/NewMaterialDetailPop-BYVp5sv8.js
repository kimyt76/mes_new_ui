import{a as D,s as P}from"./index-Z2YNGKhZ.js";import{K as S,V as R,A as x,W as F,i as W,o as A,l as i,h as n,P as q,p as t,G,a0 as C,Z,M as J,L as Q,U as X,H as Y,a9 as ee,e as te,a2 as le,a7 as ae,F as ne}from"./index-BCdxernO.js";import{s as B}from"./index-CEOpAmiF.js";import{a as oe,b as se}from"./index-CKfU0QJd.js";import{s as ie}from"./index-BGn1OEmN.js";import{s as T}from"./index-DhHuXiFi.js";import{s as E}from"./index-WWuz9eST.js";import{A as N}from"./apiLab-DBKUW3x6.js";import{i as U}from"./common-Ctgf_4Dl.js";import{C as re}from"./CustomerListPop-CR8s3FNg.js";import{I as de}from"./ItemListSinglePop-WX5hrlWb.js";import{I as ue}from"./IngredientistPop-D_P0asTf.js";import"./apiBase-DJzL_JWR.js";import"./apiCommon-DQdCmI3G.js";import"./apiItem-B0JHHkd5.js";const me={class:"flex flex-column h-full"},ce={class:"search-section"},pe={class:"search-field flex gap-2"},fe={class:"list-section mt-3 h-[500px]"},ge={class:"overflow-auto"},ve={class:"flex gap-2 justify-end pt-3"},Ce={__name:"NewMaterialListPop",setup(z){const c=R("dialogRef"),p=x([]),h=x([]),V=x([]),u=F({customerGrp1:"",customerGrp2:"",businessCd:"",customerName:""}),M=async()=>{const d={...u};p.value=await N.getNewMaterialList(d)},$=async d=>{h.value=await N.getNewMaterialListMapping(d.data.newMaterialCd),c.value.close(h.value)},w=()=>{c.value.close()};return(d,l)=>{const y=E,f=T,b=G,g=P,j=D,H=B;return A(),W(H,{style:{width:"55rem",height:"48rem"}},{content:i(()=>[n("div",me,[n("div",ce,[n("form",{onSubmit:q(M,["prevent"]),class:"search-form"},[n("div",pe,[t(f,{variant:"on"},{default:i(()=>[t(y,{id:"on_label1",modelValue:u.newMaterialCd,"onUpdate:modelValue":l[0]||(l[0]=s=>u.newMaterialCd=s),style:{width:"180px"}},null,8,["modelValue"]),l[4]||(l[4]=n("label",{for:"on_label1"},"신원료코드",-1))]),_:1}),t(f,{variant:"on"},{default:i(()=>[t(y,{id:"on_label1",modelValue:u.materialName,"onUpdate:modelValue":l[1]||(l[1]=s=>u.materialName=s),style:{width:"180px"}},null,8,["modelValue"]),l[5]||(l[5]=n("label",{for:"on_label1"},"신원료명",-1))]),_:1}),t(f,{variant:"on"},{default:i(()=>[t(y,{id:"on_label1",modelValue:u.regName,"onUpdate:modelValue":l[2]||(l[2]=s=>u.regName=s),style:{width:"180px"}},null,8,["modelValue"]),l[6]||(l[6]=n("label",{for:"on_label1"},"등록자명",-1))]),_:1}),t(b,{label:"검색",icon:"pi pi-search",severity:"secondary",type:"submit",class:"search-button"})])],32)]),n("div",fe,[n("div",ge,[t(j,{selection:V.value,"onUpdate:selection":l[3]||(l[3]=s=>V.value=s),value:p.value,dataKey:"newMaterialCd",paginator:"",rows:15,rowsPerPageOptions:[15,30,40],tableStyle:"table-layout: fixed; width: 100%",columnResizeMode:"fit",class:"my-table",scrollable:"",scrollHeight:"500px",showGridlines:"",selectionMode:"single",onRowSelect:$},{default:i(()=>[t(g,{field:"newMaterialCd",header:"신원료코드",style:C([{width:"110px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}}),t(g,{field:"materialName",header:"신원료명",style:C([{width:"330px"},{"text-align":"left"}]),pt:{columnHeaderContent:"justify-center"}}),t(g,{field:"itemCd",header:"품목코드",style:C([{width:"100px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}}),t(g,{field:"regName",header:"담당자",style:C([{width:"120px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["selection","value"])])])]),n("div",ve,[t(b,{label:"닫기",onClick:w})])]),_:1})}}},we=S(Ce,[["__scopeId","data-v-652bc27a"]]),ye={class:"grid mb-2"},be={class:"col-3"},_e={class:"col-6"},xe={class:"col-3"},Ne={class:"grid mb-2"},he={class:"col-3"},Ve={class:"col-6"},Ie={class:"col-3"},Me={class:"flex justify-content-between align-items-center ml-2 mb-1 mt-2"},$e={class:"flex justify-end gap-2"},je=["onClick"],He={class:"flex gap-2 justify-end pt-3"},ke={__name:"NewMaterialDetailPop",setup(z){const c=x(!1),p=Z(null),{userId:h}=J(),{vError:V,vSuccess:u,vInfo:M}=Q(),$=X(),w=R("dialogRef"),d=x([]),l=F({newMaterialCd:"",itemCd:"",itemName:"",materialName:"",inPrice:"",customerCd:"",customerName:"",mtrName:"",userId:h}),y=()=>{c.value=!0},f=s=>{let e="",r="";s==="N"?(p.value=we,r="",e="신원료 목록"):s==="C"?(p.value=re,r="",e="거래처 목록"):s==="I"&&(p.value=de,r="M1",e="품목 목록"),$.open(p.value,{props:{header:e,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},data:r,onClose:a=>{a!=null&&a.data&&(s==="C"?(l.customerCd=a.data.customerCd,l.customerName=a.data.customerName):s==="I"?l.itemCd=a.data.itemCd:s==="N"&&g(a.data))}})},b=async s=>{var e,r;try{const a={newMaterialInfo:l,materialMappingList:d.value};if(s==="N"){if(U(l.itemCd)){M("이관할 품목코드를 선택해주세요.");return}const v=await N.saveNewMaterialMapping(a);u("이관 되었습니다.")}else{const v=await N.saveNewMaterialInfo(a);l.newMaterialCd=v.data.newMaterialCd,u("저장되었습니다.")}}catch(a){V(((r=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:r.message)||"저장 중 오류가 발생했습니다.")}},g=s=>{if(!Array.isArray(s))return;let e=d.value.length;const r=s.map(a=>({id:e++,ingredientCode:a.ingredientCode,krIngredientName:a.krIngredientName,enIngredientName:a.enIngredientName,inContent:a.inContent,outContent:a.outContent,casNo:a.casNo,functionNm:a.functionNm,limitCountry:a.limitCountry,banCountry:a.banCountry}));d.value.length>0?d.value.push(...r):d.value=[...r]},j=s=>{d.value.splice(s,1)};Y(async()=>{await ee();const s=document.querySelector(".p-dialog");if(s&&(console.log("Dialog width:",s.offsetWidth),console.log("Dialog height:",s.offsetHeight)),!U(w.value.data)){const e=await N.getNewMaterialInfo(w.value.data);Object.assign(l,e.newMaterialInfo),d.value=e.materialMappingList}});const H=()=>{w.value.close()};return(s,e)=>{const r=E,a=T,v=ie,k=se,L=oe,K=B,_=G,m=P,O=D;return A(),te(ne,null,[t(K,{style:{width:"110rem",height:"8rem"}},{content:i(()=>[n("div",ye,[n("div",be,[t(a,{variant:"on"},{default:i(()=>[t(r,{modelValue:l.newMaterialCd,"onUpdate:modelValue":e[0]||(e[0]=o=>l.newMaterialCd=o),class:"w-full"},null,8,["modelValue"]),e[13]||(e[13]=n("label",null,"임시코드",-1))]),_:1})]),n("div",_e,[t(a,{variant:"on"},{default:i(()=>[t(r,{modelValue:l.materialName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.materialName=o),class:"w-full"},null,8,["modelValue"]),e[14]||(e[14]=n("label",null,"원료명",-1))]),_:1})]),n("div",xe,[t(a,{variant:"on"},{default:i(()=>[t(v,{modelValue:l.inPrice,"onUpdate:modelValue":e[2]||(e[2]=o=>l.inPrice=o),class:"w-full"},null,8,["modelValue"]),e[15]||(e[15]=n("label",null,"입고단가",-1))]),_:1})])]),n("div",Ne,[n("div",he,[t(a,{variant:"on"},{default:i(()=>[t(r,{modelValue:l.mtrName,"onUpdate:modelValue":e[3]||(e[3]=o=>l.mtrName=o),class:"w-full"},null,8,["modelValue"]),e[16]||(e[16]=n("label",null,"제조원",-1))]),_:1})]),n("div",Ve,[t(a,{variant:"on"},{default:i(()=>[t(L,{iconPosition:"left"},{default:i(()=>[t(r,{modelValue:l.customerName,"onUpdate:modelValue":e[4]||(e[4]=o=>l.customerName=o),class:"w-full"},null,8,["modelValue"]),t(k,{class:"pi pi-search",onClick:e[5]||(e[5]=o=>f("C"))})]),_:1}),e[17]||(e[17]=n("label",null,"거래처명",-1))]),_:1})]),n("div",Ie,[t(a,{variant:"on"},{default:i(()=>[t(L,{iconPosition:"left"},{default:i(()=>[t(r,{modelValue:l.itemCd,"onUpdate:modelValue":e[6]||(e[6]=o=>l.itemCd=o),class:"w-full"},null,8,["modelValue"]),t(k,{class:"pi pi-search",onClick:e[7]||(e[7]=o=>f("I"))})]),_:1}),e[18]||(e[18]=n("label",null,"품목코드",-1))]),_:1})])])]),_:1}),n("div",Me,[e[19]||(e[19]=n("h5",{class:"m-0"},"- 성분코드",-1)),n("div",$e,[t(_,{label:"추가+",onClick:y,class:"p-button-xm"}),t(_,{label:"신원료",onClick:e[8]||(e[8]=o=>f("N")),class:"p-button-xm"})])]),n("div",null,[t(O,{value:d.value,scrollHeight:"600px",scrollable:"",showGridlines:"",class:"my-table"},{default:i(()=>[t(m,{field:"ingredientCode",header:"성분코드",style:C([{"text-align":"center"},{width:"60px"}]),pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"krIngredientName",header:"구문성분명",style:{width:"270px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"enIngredientName",header:"영어성분명",style:{width:"270px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"inContent",header:"국내함량",style:{width:"60px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[t(v,{modelValue:o.data.inContent,"onUpdate:modelValue":I=>o.data.inContent=I,class:"w-full",min:0,minFractionDigits:0,maxFractionDigits:7,useGrouping:!1,inputStyle:{width:"50px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{field:"outContent",header:"수출용함량",style:{width:"60px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[t(v,{modelValue:o.data.outContent,"onUpdate:modelValue":I=>o.data.outContent=I,class:"w-full",min:0,minFractionDigits:0,maxFractionDigits:7,useGrouping:!1,inputStyle:{width:"50px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(m,{field:"casNo",header:"CAS No.",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"functionNm",header:"funciton",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"limitCountry",header:"한도국가",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"banCountry",header:"금지국가",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),t(m,{field:"actions",header:"-",style:C([{width:"20px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[n("i",{class:"pi pi-trash cursor-pointer",onClick:I=>j(o.index)},null,8,je)]),_:1})]),_:1},8,["value"])]),n("div",He,[t(_,{label:"원료이관",class:"btn-save",onClick:e[9]||(e[9]=o=>b("N"))}),t(_,{label:"저장",class:"btn-save",onClick:e[10]||(e[10]=o=>b("S"))}),t(_,{label:"닫기",onClick:H})]),t(le(ae),{visible:c.value,"onUpdate:visible":e[12]||(e[12]=o=>c.value=o),header:"성분 목록"},{default:i(()=>[t(ue,{onSelected:g,onClose:e[11]||(e[11]=o=>c.value=!1)})]),_:1},8,["visible"])],64)}}},We=S(ke,[["__scopeId","data-v-bc495db7"]]);export{We as default};
