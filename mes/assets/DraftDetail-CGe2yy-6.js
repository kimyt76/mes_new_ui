import{A as Q}from"./apiOrders-VrRkxjij.js";import{_ as de,k as ne,a as ue,u as ie,r as p,B as pe,m as ce,n as ve,c,g as o,d as h,w as v,F as M,e as fe,C as me,o as u,b as O,q as k,f as e,h as q,t as r,D as he,i as R,v as xe}from"./index-C-Q3ea6s.js";import{D as $}from"./DownLoadLink-CTMe4pms.js";import{_ as be}from"./UserListPop-Do7LYruu.js";import{e as m,i as A,h as _e}from"./common-DX12Nz2N.js";import"./filedownLoad-mJr14i86.js";import"./apiCommon-DLJ6uQuV.js";import"./format-CBpsKyOP.js";const ye={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ie={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ge={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},De={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ae={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ne={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ue={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},ke={key:0},qe={key:1},Ve={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},we={key:0},Ce={key:1},Se={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Be={key:0},Ee={key:1},Le={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},je={key:0},Oe={key:1},Te={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Pe={key:0},Ye={key:1},Qe={class:"d-flex ga-4 justify-end"},Me={colspan:"3"},Re={colspan:"4",style:{height:"100px","text-align":"center"}},$e={colspan:"3"},He={colspan:"3",style:{"border-bottom":"1px solid #ccc"}},Ke={key:0},We={colspan:"3"},ze={colspan:"3"},Ge={__name:"DraftDetail",setup(Je){const H=ne(),V=fe(),w=H.params.id,{userId:d,memberNm:K,deptNm:Xe}=ue(),{vError:W,vSuccess:z,vInfo:Ze}=ie();p([]),p([]);const C=p([]),G=pe(()=>C.value.filter(a=>a.boardUserId!==d)),S=p(!1),T=p(!1),B=p(!1),P=p(!1),Y=p(!1);let y=p("");const N=p("");let f=p(null);const s=ce({draftDate:m(),seq:"",customerName:"",itemName:"",orderQty:0,dueDate:"",draftUserName:"",draftDept:"",draftUserId:"",userId:d}),l=p({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessUserName:"",productUserName:"",purchaseUserName:"",qcUserName:"",labUserName:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),i=p({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),J=a=>{l.value.labUserName=a.memberNm,l.value.labUserId=a.userId},X=async()=>{const a={userId:d,field:y.value,boardId:s.boardId,approvalId:s.approvalId,boardTxt:N.value,appDate:f.value,draftId:w};try{const t=await Q.updateInfo(a);z(t),V.push({name:"DraftList"})}catch(t){W(t)}},Z=()=>{s.draftUserId===d&&(P.value=!0);const t=Object.values(l.value).includes(d),{businessCheckYn:b,productCheckYn:U,purchaseCheckYn:I,qcCheckYn:g,labCheckYn:F,businessUserId:D,productUserId:_,purchaseUserId:E,qcUserId:L,labUserId:j}=l.value;A(ee(d))||(Y.value=!0),s.draftUserId!==d&&(T.value=!0);const x=p(!1);(d===D&&b==="N"||d===_&&U==="N"||d===E&&I==="N"||d===L&&g==="N"||d===j&&F==="N")&&(x.value=!0),t&&x.value&&(B.value=!0)},ee=a=>{for(const[t,b]of Object.entries(l.value))if(t.endsWith("UserId")&&b===a)return t;return null};ve(async()=>{const a=await Q.getDraftInfo(w);Object.assign(s,a.draftInfo),Object.assign(l.value,a.approvalInfo),C.value=a.boardInfo||[],Z();const t=C.value.find(b=>b.boardUserId===d);N.value=t?t.boardTxt:"",te(a)});const te=a=>{a.orderAttachFileInfo!==null&&(i.value.orderFileName=a.orderAttachFileInfo.fileName,i.value.orderFilePath=a.orderAttachFileInfo.filePath,i.value.orderFileAttachFileId=a.orderAttachFileInfo.attachFileId,i.value.orderSeq=a.orderAttachFileInfo.seq),a.prodAttachFileInfo!==null&&(i.value.prodFileName=a.prodAttachFileInfo.fileName,i.value.prodFilePath=a.prodAttachFileInfo.filepath,i.value.prodFileAttachFileId=a.prodAttachFileInfo.attachFileId,i.value.prodSeq=a.prodAttachFileInfo.seq)},le=()=>{l.value.businessUserId.includes(d)?A(l.value.businessApprovalDate)?(l.value.businessApprovalDate=m(),f.value=m(),y.value="business_approval_date"):f.value=l.value.businessApprovalDate:l.value.productUserId.includes(d)?A(l.value.productApprovalDate)?(l.value.productApprovalDate=m(),f.value=m(),y.value="product_Approval_Date"):f.value=l.value.productApprovalDate:l.value.purchaseUserId.includes(d)?A(l.value.purchaseApprovalDate)?(l.value.purchaseApprovalDate=m(),f.value=m(),y.value="purchase_Approval_Date"):f.value=l.value.purchaseApprovalDate:l.value.qcUserId.includes(d)?A(l.value.qcApprovalDate)?(l.value.qcApprovalDate=m(),f.value=m(),y.value="qc_Approval_Date"):f.value=l.value.qcApprovalDate:l.value.labUserId.includes(d)&&(A(l.value.labApprovalDate)?(l.value.labApprovalDate=m(),f.value=m(),y.value="lab_Approval_Date"):f.value=l.value.labApprovalDate),B.value=!1},ae=()=>{V.push({name:"DraftEdit",params:{id:w}})},oe=()=>{V.push({name:"DraftList"})};return(a,t)=>{const b=h("v-breadcrumbs"),U=h("v-table"),I=h("v-col"),g=h("v-row"),F=h("v-card-text"),D=h("v-btn"),_=h("v-text-field"),E=h("v-date-input"),L=h("v-card"),j=h("v-dialog"),x=me("comma-number");return u(),c(M,null,[o(b,{items:["MES","영업관리","기안서 상세"]}),o(L,null,{default:v(()=>[o(F,null,{default:v(()=>[o(g,null,{default:v(()=>[o(I,{class:"d-flex justify-end pa-1"},{default:v(()=>[o(U,{style:{border:"0.1px solid #ccc"}},{default:v(()=>[e("tbody",null,[t[7]||(t[7]=e("tr",null,[e("th",{rowspan:"3",style:{"vertical-align":"middle",width:"20px"}},[q("결"),e("br"),e("br"),e("br"),q("재")]),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"기안자"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"영업관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"생산관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"구매부"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"품질관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"연구소")],-1)),e("tr",null,[e("td",ye,r(s.draftUserName),1),e("td",Ie,r(l.value.businessUserName),1),e("td",ge,r(l.value.productUserName),1),e("td",De,r(l.value.purchaseUserName),1),e("td",Ae,r(l.value.qcUserName),1),e("td",Ne,r(l.value.labUserName),1)]),e("tr",null,[e("td",Ue,r(s.draftDate),1),e("td",Fe,[l.value.businessApprovalDate?(u(),c("span",qe,r(l.value.businessApprovalDate),1)):(u(),c("span",ke,"결재일자"))]),e("td",Ve,[l.value.productApprovalDate?(u(),c("span",Ce,r(l.value.productApprovalDate),1)):(u(),c("span",we,"결재일자"))]),e("td",Se,[l.value.purchaseApprovalDate?(u(),c("span",Ee,r(l.value.purchaseApprovalDate),1)):(u(),c("span",Be,"결재일자"))]),e("td",Le,[l.value.qcApprovalDate?(u(),c("span",Oe,r(l.value.qcApprovalDate),1)):(u(),c("span",je,"결재일자"))]),e("td",Te,[l.value.labApprovalDate?(u(),c("span",Ye,r(l.value.labApprovalDate),1)):(u(),c("span",Pe,"결재일자"))])])])]),_:1})]),_:1})]),_:1})]),_:1}),B.value?(u(),O(g,{key:0},{default:v(()=>[o(I,null,{default:v(()=>[e("div",Qe,[o(D,{color:"brown-lighten-4",class:"mt-1 mr-3",text:"승인",onClick:le})])]),_:1})]),_:1})):k("",!0),o(F,null,{default:v(()=>[o(g,null,{default:v(()=>[o(I,null,{default:v(()=>[o(U,{class:"compact-table"},{default:v(()=>[e("tbody",null,[e("tr",null,[t[8]||(t[8]=e("th",null,"문서번호",-1)),e("td",null,r(s.draftDate)+"-"+r(s.seq),1),t[9]||(t[9]=e("th",null,"처리기한",-1)),t[10]||(t[10]=e("td",null,"즉시",-1))]),e("tr",null,[t[11]||(t[11]=e("th",null,"보존년한",-1)),t[12]||(t[12]=e("td",null,"5년",-1)),t[13]||(t[13]=e("th",null,"기안일자",-1)),e("td",null,r(s.draftDate),1)]),e("tr",null,[t[14]||(t[14]=e("th",null,"기안부서",-1)),e("td",null,r(s.draftDept),1),t[15]||(t[15]=e("th",null,"기안자",-1)),e("td",null,r(s.draftUserName),1)]),e("tr",null,[t[16]||(t[16]=e("th",null,"제목",-1)),e("td",Me,r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),e("tr",null,[e("td",Re,[q(r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),t[17]||(t[17]=e("br",null,null,-1)),t[18]||(t[18]=e("br",null,null,-1)),t[19]||(t[19]=q(" - 아 래 - "))])]),e("tr",null,[t[20]||(t[20]=e("th",null,"고객사명",-1)),e("td",null,[o(_,{modelValue:s.customerName,"onUpdate:modelValue":t[0]||(t[0]=n=>s.customerName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])]),t[21]||(t[21]=e("th",null,"품목",-1)),e("td",null,[o(_,{modelValue:s.itemName,"onUpdate:modelValue":t[1]||(t[1]=n=>s.itemName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])])]),e("tr",null,[t[22]||(t[22]=e("th",null,"발주수량",-1)),e("td",null,[he(o(_,{modelValue:s.orderQty,"onUpdate:modelValue":t[2]||(t[2]=n=>s.orderQty=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",style:{"text-align":"right"},class:"cell-input"},null,8,["modelValue"]),[[x]])]),t[23]||(t[23]=e("th",null,"납기일자",-1)),e("td",null,[o(E,{modelValue:s.dueDate,"onUpdate:modelValue":t[3]||(t[3]=n=>s.dueDate=n),"display-format":R(_e),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue","display-format"])])]),e("tr",null,[t[24]||(t[24]=e("th",null,"발주서 첨부파일",-1)),e("td",$e,[o($,{fileName:i.value.orderFileName||"",attachFileId:i.value.orderFileAttachFileId||"",seq:i.value.orderSeq||""},null,8,["fileName","attachFileId","seq"])])]),e("tr",null,[t[25]||(t[25]=e("th",null,"제품사양서 첨부",-1)),e("td",He,[o($,{fileName:i.value.prodFileName||"",attachFileId:i.value.prodFileAttachFileId||"",seq:i.value.prodSeq||""},null,8,["fileName","attachFileId","seq"])])]),T.value?(u(),c("tr",Ke,[e("th",null,r(R(K)),1),e("td",We,[o(_,{modelValue:N.value,"onUpdate:modelValue":t[4]||(t[4]=n=>N.value=n),readonly:!1,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue"])])])):k("",!0),(u(!0),c(M,null,xe(G.value,(n,se)=>(u(),c("tr",{key:n.boardId||se},[e("th",null,r(n.boardUserId),1),e("td",ze,[o(_,{modelValue:n.boardTxt,"onUpdate:modelValue":re=>n.boardTxt=re,readonly:!0,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1}),o(g,null,{default:v(()=>[o(I,{class:"d-flex ga-4 justify-end mb-3"},{default:v(()=>[P.value?(u(),O(D,{key:0,color:"brown-lighten-4",text:"수정",onClick:ae})):k("",!0),Y.value?(u(),O(D,{key:1,text:"저장",class:"gt-2",color:"brown-lighten-4",onClick:X})):k("",!0),o(D,{text:"목록",class:"mr-3",onClick:oe})]),_:1})]),_:1})]),_:1})]),_:1}),o(j,{modelValue:S.value,"onUpdate:modelValue":t[6]||(t[6]=n=>S.value=n),height:"800px",width:"900px",persistent:""},{default:v(()=>[o(be,{onSelected:J,onCloseDialog:t[5]||(t[5]=n=>S.value=!1)})]),_:1},8,["modelValue"])],64)}}},nt=de(Ge,[["__scopeId","data-v-6cad0f28"]]);export{nt as default};
