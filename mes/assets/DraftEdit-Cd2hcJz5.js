import{A as Q}from"./apiOrders-LBbh7QBG.js";import{A as X}from"./apiCommon-DQdCmI3G.js";import{ac as Y,k as c,i as q,o as i,K as Z,M as ee,L as te,a1 as le,A as f,W as oe,H as ae,e as p,p as o,l as u,F as se,N as de,r as re,h as t,y as h,t as s,a2 as k,w as ne}from"./index-BCdxernO.js";import{g as B,h as ie}from"./common-Ctgf_4Dl.js";import{U as pe}from"./UserListPop-40qvmJxy.js";import{D as $}from"./DownLoadLink-Dc-ck991.js";import"./index-CEOpAmiF.js";import"./index-Z2YNGKhZ.js";import"./index-CKfU0QJd.js";import"./index-WWuz9eST.js";import"./index-BGn1OEmN.js";import"./index-DhHuXiFi.js";import"./apiSystem-BBpYMteA.js";import"./filedownLoad-Cs3MYRER.js";const j={__name:"SingleFileUpload",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(S){const y=Y(S,"modelValue");return(I,g)=>{const N=c("v-file-input");return i(),q(N,{modelValue:y.value,"onUpdate:modelValue":g[0]||(g[0]=A=>y.value=A),label:"파일 선택","prepend-icon":"mdi-upload",density:"compact"},null,8,["modelValue"])}}},ue={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ce={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},me={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ve={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},fe={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},he={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},xe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},ye={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},ge={key:0},_e={key:1},Fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},be={key:0},Ie={key:1},Ne={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ae={key:0},De={key:1},Ue={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ve={key:0},we={key:1},ke={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},qe={key:0},Se={key:1},Ce={colspan:"3"},Oe={colspan:"4",style:{height:"100px","text-align":"center"}},Le={colspan:"3"},Ee={key:1},Me={colspan:"3"},Pe={key:1},Qe={__name:"DraftEdit",setup(S){const y=le(),I=de(),{userId:g,memberNm:N,deptNm:A}=ee(),{vError:C,vSuccess:O}=te(),D=y.params.id,_=f([]),F=f([]),U=f(!1),L=f(!1),E=f(!1),a=oe({draftDate:"",seq:"",customerName:"",itemName:"",orderQty:0,dueDate:"",draftUserName:"",draftDept:"",draftUserId:"",draftId:D,userId:g}),d=f({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessUserName:"",productUserName:"",purchaseUserName:"",qcUserName:"",labUserName:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),r=f({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),H=l=>{d.value.labUserName=l.memberNm,d.value.labUserId=l.userId},J=async()=>{const l=new FormData,e={...a};e.dueDate=B(a.dueDate),e.orderQty=ie(a.orderQty),console.log("params",e),console.log("approval",d.value),l.append("draftInfo",JSON.stringify(e)),l.append("approval",JSON.stringify(d.value));const x=_.value instanceof File,m=F.value instanceof File;x?l.append("orderFile",_.value):l.append("orderAttachFileId",r.value.orderFileAttachFileId),m?l.append("prodFile",F.value):l.append("prodAttachFileId",r.value.prodFileAttachFileId);try{const v=await Q.saveDraftInfo(l);O(v),I.push({name:"DraftDetail",params:{id:D}})}catch(v){C(v.response)}},R=l=>{l.orderAttachFileInfo===null?L.value=!0:(r.value.orderFileName=l.orderAttachFileInfo.fileName,r.value.orderFileAttachFileId=l.orderAttachFileInfo.attachFileId,r.value.orderSeq=l.orderAttachFileInfo.seq),l.prodAttachFileInfo===null?E.value=!0:(r.value.prodFileName=l.prodAttachFileInfo.fileName,r.value.prodFileAttachFileId=l.prodAttachFileInfo.attachFileId,r.value.prodSeq=l.prodAttachFileInfo.seq)},M=async l=>{let e="";e=r.value.prodFileAttachFileId,r.value.prodFileAttachFileId=null;const x=1;try{const m=await X.deleteFile(e,x);O(m)}catch(m){C(m)}};ae(async()=>{const l=await Q.getDraftInfo(D);Object.assign(a,l.draftInfo),Object.assign(d.value,l.approvalInfo),R(l)});const K=()=>{I.push({name:"DraftList"})};return(l,e)=>{const x=c("v-breadcrumbs"),m=c("v-table"),v=c("v-col"),V=c("v-row"),P=c("v-card-text"),w=c("v-text-field"),T=c("v-date-input"),b=c("v-btn"),W=c("v-card"),z=c("v-dialog"),G=re("comma-number");return i(),p(se,null,[o(x,{items:["MES","영업관리","사양서 수정"]}),o(W,null,{default:u(()=>[o(P,{class:"overflow-y-hidden"},{default:u(()=>[o(V,null,{default:u(()=>[o(v,{class:"d-flex justify-end pa-1"},{default:u(()=>[o(m,{style:{border:"0.1px solid #ccc"}},{default:u(()=>[t("tbody",null,[e[10]||(e[10]=t("tr",null,[t("th",{rowspan:"3",style:{"vertical-align":"middle",width:"20px"}},[h("결"),t("br"),t("br"),t("br"),h("재")]),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"기안자"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"영업관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"생산관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"구매부"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"품질관리"),t("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"연구소")],-1)),t("tr",null,[t("td",ue,s(a.draftUserName),1),t("td",ce,s(d.value.businessUserName),1),t("td",me,s(d.value.productUserName),1),t("td",ve,s(d.value.purchaseUserName),1),t("td",fe,s(d.value.qcUserName),1),t("td",he,s(d.value.labUserName),1)]),t("tr",null,[t("td",xe,s(a.draftDate),1),t("td",ye,[d.value.businessApprovalDate?(i(),p("span",_e,s(d.value.businessApprovalDate),1)):(i(),p("span",ge,"결제일자"))]),t("td",Fe,[d.value.productApprovalDate?(i(),p("span",Ie,s(d.value.productApprovalDate),1)):(i(),p("span",be,"결제일자"))]),t("td",Ne,[d.value.purchaseApprovalDate?(i(),p("span",De,s(d.value.purchaseApprovalDate),1)):(i(),p("span",Ae,"결제일자"))]),t("td",Ue,[d.value.qcApprovalDate?(i(),p("span",we,s(d.value.qcApprovalDate),1)):(i(),p("span",Ve,"결제일자"))]),t("td",ke,[d.value.labApprovalDate?(i(),p("span",Se,s(d.value.labApprovalDate),1)):(i(),p("span",qe,"결제일자"))])])])]),_:1})]),_:1})]),_:1})]),_:1}),o(P,{class:"overflow-y-hidden"},{default:u(()=>[o(V,null,{default:u(()=>[o(v,null,{default:u(()=>[o(m,{class:"compact-table",style:{height:"590px"}},{default:u(()=>[t("tbody",null,[t("tr",null,[e[11]||(e[11]=t("th",null,"문서번호",-1)),t("td",null,s(a.draftDate)+"-"+s(a.seq),1),e[12]||(e[12]=t("th",null,"처리기한",-1)),e[13]||(e[13]=t("td",null,"즉시",-1))]),t("tr",null,[e[14]||(e[14]=t("th",null,"보존년한",-1)),e[15]||(e[15]=t("td",null,"5년",-1)),e[16]||(e[16]=t("th",null,"기안일자",-1)),t("td",null,s(a.draftDate),1)]),t("tr",null,[e[17]||(e[17]=t("th",null,"기안부서",-1)),t("td",null,s(k(A)),1),e[18]||(e[18]=t("th",null,"기안자",-1)),t("td",null,s(k(N)),1)]),t("tr",null,[e[19]||(e[19]=t("th",null,"제목",-1)),t("td",Ce,s(a.customerName)+"    "+s(a.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),t("tr",null,[t("td",Oe,[h(s(a.customerName)+"    "+s(a.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),e[20]||(e[20]=t("br",null,null,-1)),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=h(" - 아 래 - ",-1))])]),t("tr",null,[e[23]||(e[23]=t("th",null,"고객사명",-1)),t("td",null,[o(w,{modelValue:a.customerName,"onUpdate:modelValue":e[0]||(e[0]=n=>a.customerName=n),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue"])]),e[24]||(e[24]=t("th",null,"품목",-1)),t("td",null,[o(w,{modelValue:a.itemName,"onUpdate:modelValue":e[1]||(e[1]=n=>a.itemName=n),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue"])])]),t("tr",null,[e[25]||(e[25]=t("th",null,"발주수량",-1)),t("td",null,[ne(o(w,{modelValue:a.orderQty,"onUpdate:modelValue":e[2]||(e[2]=n=>a.orderQty=n),variant:"outlined",density:"compact","hide-details":"",style:{"text-align":"right"},class:"cell-input"},null,8,["modelValue"]),[[G]])]),e[26]||(e[26]=t("th",null,"납기일자",-1)),t("td",null,[o(T,{modelValue:a.dueDate,"onUpdate:modelValue":e[3]||(e[3]=n=>a.dueDate=n),"display-format":k(B),variant:"outlined",density:"compact","hide-details":"",class:"cell-input"},null,8,["modelValue","display-format"])])]),t("tr",null,[e[28]||(e[28]=t("th",null,"발주서첨부",-1)),t("td",Le,[L.value?(i(),q(j,{key:0,modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=n=>_.value=n),style:{height:"20px",width:"1100px"},class:"mb-4"},null,8,["modelValue"])):(i(),p("div",Ee,[o($,{fileName:r.value.orderFileName||"",attachFileId:r.value.orderFileAttachFileId||"",seq:r.value.orderSeq||""},null,8,["fileName","attachFileId","seq"]),e[27]||(e[27]=h("      ",-1)),o(b,{text:"삭제",density:"compact",onClick:e[5]||(e[5]=n=>M("p"))})]))])]),t("tr",null,[e[30]||(e[30]=t("th",null,"제품사양서첨부",-1)),t("td",Me,[E.value?(i(),q(j,{key:0,modelValue:F.value,"onUpdate:modelValue":e[6]||(e[6]=n=>F.value=n),style:{height:"20px",width:"1100px"},class:"mb-4"},null,8,["modelValue"])):(i(),p("div",Pe,[o($,{fileName:r.value.prodFileName||"",attachFileId:r.value.prodFileAttachFileId||"",seq:r.value.prodSeq||""},null,8,["fileName","attachFileId","seq"]),e[29]||(e[29]=h("      ",-1)),o(b,{text:"삭제",density:"compact",onClick:e[7]||(e[7]=n=>M("p"))})]))])])])]),_:1})]),_:1})]),_:1}),o(V,null,{default:u(()=>[o(v,{class:"d-flex ga-4 justify-end mb-3"},{default:u(()=>[o(b,{text:"저장",class:"gt-2",color:"brown-lighten-4",onClick:J}),o(b,{text:"목록",class:"mr-3",onClick:K})]),_:1})]),_:1})]),_:1})]),_:1}),o(z,{modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=n=>U.value=n),height:"800px",width:"900px",persistent:""},{default:u(()=>[o(pe,{onSelected:H,onCloseDialog:e[8]||(e[8]=n=>U.value=!1)})]),_:1},8,["modelValue"])],64)}}},et=Z(Qe,[["__scopeId","data-v-aa3a226f"]]);export{et as default};
