import{_ as oe,u as de,a as se,k as ie,x as me,r as p,m as ue,B as re,p as pe,n as ce,c as T,f as u,g as t,d as m,w as o,i as N,F as E,e as ve,o as S,j as fe,t as R,D as C,G as b,v as ge,b as ye,y as _e}from"./index-Be8ZRtMe.js";import{A as $}from"./apiOrders-BV9f5KE8.js";import{A as Ve}from"./apiCommon-B9fwy2tv.js";import{j as y,i as we}from"./common-IBXzpVzr.js";import{_ as he}from"./MultiFileUpload-BeeAPDwc.js";import{C as xe}from"./CustomerListPop-ZmNksim-.js";import{_ as Ne}from"./UserListPop-CsvKPMu9.js";import{_ as Se}from"./StorageListPop-CxDhn6Hi.js";import{_ as Ce}from"./SaleListPop-DlIdk1ft.js";import"./format-CBpsKyOP.js";import"./filedownLoad-BQbSUCvP.js";import"./apiBase-BOHAoysR.js";const be=["id"],Ue=["onUpdate:modelValue"],Ie=["onUpdate:modelValue"],ke=["onUpdate:modelValue"],De=["onUpdate:modelValue"],Me={class:"summary-row"},Te={style:{width:"250px","text-align":"right","font-weight":"bold",height:"30px"}},$e={__name:"ShipmentDetail",setup(qe){const{vError:O,vSuccess:P}=de(),q=ve(),J=ie(),{userId:z}=se(),G=J.params.id,_=me(null),V=p(!1),f=p(!1);let w=p(""),h=p(""),U=p("");p(null);const L=p([]),g=p([]),i=p([]),l=ue({shipmentDate:"",seq:"",customerName:"",customerCd:"",managerId:"",managerName:"",descStorageCd:"",descStorageName:"",deliveryTelno:"",deliveryManagerName:"",tradingMethod:"",dueDate:"",releaseTime:"",releaseType:"",accountStatement:"",address:"",attachFileId:"",saleIds:"",userId:z}),H=[{title:"품목코드 ",key:"itemCd",align:"center",width:"150px"},{title:"품목명",key:"itemName",align:"center",width:"400px"},{title:"수량",key:"qty",align:"center",width:"130px"},{title:"lot No.",key:"lotNo",align:"center",width:"200px"},{title:"-",key:"actions",align:"center",width:10}],Q=re(()=>i.value.reduce((n,e)=>n+Number(e.qty||0),0)),W=async()=>{const n=new FormData;try{const e={...l};n.append("shipmentInfo",JSON.stringify(e)),n.append("itemList",JSON.stringify(i.value)),g.value.forEach(x=>{x.file instanceof File&&n.append("attachFile",x.file)});const k=await $.saveShipmentInfo(n);P(k),q.push({name:"ShipmentList"})}catch(e){O(e.message)}},I=n=>{switch(U.value=n,n){case"C":_.value=xe,w.value="800px",h.value="800px";break;case"U":_.value=Ne,w.value="800px",h.value="800px";break;case"S":_.value=Se,w.value="800px",h.value="850px";break}f.value=!0},K=n=>{switch(U.value){case"C":l.customerName=n.customerName,l.customerCd=n.customerCd,l.managerName=n.memberCd,l.managerId=n.memberCd,l.tradingMethod=n.tradingMethod;break;case"U":l.managerName=n.memberNm,l.managerId=n.userId;break;case"S":l.descStorageName=n.storageName,l.descStorageCd=n.storageCd;break}U.value="",f.value=!1},X=async n=>{L.value=n,l.customerCd=n[0].customerCd,l.customerName=n[0].customerName,l.managerId=n[0].managerId,l.managerName=n[0].managerName,l.descStorageCd=n[0].descStorageCd,l.descStorageName=n[0].descStorageName,l.tradingMethod=n[0].tradingMethod,l.saleIds=L.value.map(e=>e.saleId).join(","),i.value=await $.getSalesItemList(l.saleIds)};pe(()=>l.shipmentDate,async(n,e)=>{we(y(e))||e!==y(n)&&(l.seq=await Ve.getNextSeq("tb_shipment_mst","shipment_Date",y(n)))});const Y=n=>{i.value.splice(n,1)},Z=()=>{V.value=!0};ce(async()=>{j()});const j=async()=>{const n=await $.getShipmentInfo(G);Object.assign(l,n.shipmentInfo),i.value=n.itemList,n.attachFileInfo!==null?g.value=n.attachFileInfo:g.value=[]},ee=()=>{q.push({name:"ShipmentList"})};return(n,e)=>{const k=m("v-breadcrumbs"),x=m("v-card-item"),F=m("v-date-input"),r=m("v-text-field"),d=m("v-col"),c=m("v-row"),A=m("v-textarea"),D=m("v-card-text"),M=m("v-btn"),te=m("v-icon"),le=m("v-data-table-virtual"),ae=m("v-form"),ne=m("v-card"),B=m("v-dialog");return S(),T(E,null,[u("div",{id:n.$attrs.id},null,8,be),t(k,{items:["MES","영업관리","출하지시서 상세"],class:"custom-breadcrumbs"}),t(ne,null,{default:o(()=>[t(x,{title:"출하지시서 상세"}),t(ae,{ref:"vform",onSubmit:fe(W,["prevent"])},{default:o(()=>[t(D,null,{default:o(()=>[t(c,null,{default:o(()=>[t(d,{class:"d-flex"},{default:o(()=>[t(F,{modelValue:l.shipmentDate,"onUpdate:modelValue":e[0]||(e[0]=a=>l.shipmentDate=a),label:"주문일자",density:"compact","display-format":N(y),variant:"underlined",style:{width:"200px"},class:"mb-2"},null,8,["modelValue","display-format"]),t(r,{modelValue:l.seq,"onUpdate:modelValue":e[1]||(e[1]=a=>l.seq=a),density:"compact",style:{width:"20px"},class:"mb-2",readonly:""},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(F,{modelValue:l.dueDate,"onUpdate:modelValue":e[2]||(e[2]=a=>l.dueDate=a),label:"출하예정일",density:"compact","display-format":N(y),variant:"underlined",style:{width:"200px"}},null,8,["modelValue","display-format"])]),_:1}),t(d,{cols:"6"},{default:o(()=>[t(r,{modelValue:l.customerName,"onUpdate:modelValue":e[3]||(e[3]=a=>l.customerName=a),label:"거래처",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[4]||(e[4]=a=>I("C"))},null,8,["modelValue"])]),_:1})]),_:1}),t(c,null,{default:o(()=>[t(d,null,{default:o(()=>[t(r,{modelValue:l.managerName,"onUpdate:modelValue":e[5]||(e[5]=a=>l.managerName=a),label:"출고요청자",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[6]||(e[6]=a=>I("U"))},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.descStorageName,"onUpdate:modelValue":e[7]||(e[7]=a=>l.descStorageName=a),label:"출하창고",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[8]||(e[8]=a=>I("S"))},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.deliveryTelno,"onUpdate:modelValue":e[9]||(e[9]=a=>l.deliveryTelno=a),label:"납품지연락처",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.deliveryManagerName,"onUpdate:modelValue":e[10]||(e[10]=a=>l.deliveryManagerName=a),label:"납품지담당자",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,null,{default:o(()=>[t(d,null,{default:o(()=>[t(r,{modelValue:l.releaseTime,"onUpdate:modelValue":e[11]||(e[11]=a=>l.releaseTime=a),label:"출하시간",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.releaseType,"onUpdate:modelValue":e[12]||(e[12]=a=>l.releaseType=a),label:"출고구분",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.accountStatement,"onUpdate:modelValue":e[13]||(e[13]=a=>l.accountStatement=a),label:"거래명세서",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),t(d,null,{default:o(()=>[t(r,{modelValue:l.tradingMethod,"onUpdate:modelValue":e[14]||(e[14]=a=>l.tradingMethod=a),label:"거래방법",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,null,{default:o(()=>[t(d,{cols:"6"},{default:o(()=>[t(A,{modelValue:l.address,"onUpdate:modelValue":e[15]||(e[15]=a=>l.address=a),label:"납품지 주소",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),t(d,{cols:"6"},{default:o(()=>[t(A,{modelValue:l.etc,"onUpdate:modelValue":e[16]||(e[16]=a=>l.etc=a),label:"특이사항",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1}),t(c,{dense:""},{default:o(()=>[t(d,{cols:"12"},{default:o(()=>[t(he,{modelValue:g.value,"onUpdate:modelValue":e[17]||(e[17]=a=>g.value=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(D,null,{default:o(()=>[t(c,null,{default:o(()=>[t(d,{class:"d-flex ga-4 justify-end"},{default:o(()=>[t(M,{text:"판매",density:"compact",onClick:Z})]),_:1})]),_:1})]),_:1}),t(D,null,{default:o(()=>[t(c,null,{default:o(()=>[t(d,null,{default:o(()=>[t(le,{headers:H,items:i.value,density:"compact","item-value":"id",class:"custom-table no-padding-table"},{headers:o(({columns:a})=>[u("tr",null,[(S(!0),T(E,null,ge(a,s=>(S(),T("th",{key:s.key,class:"custom-header"},R(s.title),1))),128))])]),"item.itemCd":o(({item:a,index:s})=>[C(u("input",{"onUpdate:modelValue":v=>i.value[s].itemCd=v,style:{"text-align":"center",width:"95%","min-width":"95%","max-width":"95%"},class:"custom-input",readonly:""},null,8,Ue),[[b,i.value[s].itemCd]])]),"item.itemName":o(({item:a,index:s})=>[C(u("input",{"onUpdate:modelValue":v=>i.value[s].itemName=v,style:{"text-align":"left",width:"95%","min-width":"95%","max-width":"95%"},class:"custom-input",readonly:""},null,8,Ie),[[b,i.value[s].itemName]])]),"item.qty":o(({item:a,index:s})=>[C(u("input",{"onUpdate:modelValue":v=>i.value[s].qty=v,style:{"text-align":"right",width:"95%"},class:"custom-line"},null,8,ke),[[b,i.value[s].qty]])]),"item.lotNo":o(({item:a,index:s})=>[C(u("input",{"onUpdate:modelValue":v=>i.value[s].lotNo=v,type:"text",style:{"text-align":"left",width:"90%","min-width":"90%","max-width":"90%"},class:"custom-line"},null,8,De),[[b,i.value[s].lotNo]])]),"item.actions":o(({item:a})=>[t(te,{color:"medium-emphasis",icon:"mdi-delete",size:"small",onClick:s=>Y(a)},null,8,["onClick"])]),"body.append":o(()=>[u("tr",Me,[e[22]||(e[22]=u("td",{style:{width:"200px",height:"30px"}},null,-1)),e[23]||(e[23]=u("td",{style:{width:"650px",height:"30px"}},null,-1)),u("td",Te,R(Q.value.toLocaleString()),1),e[24]||(e[24]=u("td",null,null,-1)),e[25]||(e[25]=u("td",null,null,-1))])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),t(c,{class:"mt-2 mb-2"},{default:o(()=>[t(d,{class:"d-flex ga-4 justify-end"},{default:o(()=>[t(M,{text:"저장",class:"gt-2",color:"brown-lighten-4",type:"submit"}),t(M,{text:"목록",class:"mr-3",onClick:ee})]),_:1})]),_:1})]),_:1},512)]),_:1}),t(B,{modelValue:f.value,"onUpdate:modelValue":e[19]||(e[19]=a=>f.value=a),width:N(w),height:N(h),persistent:""},{default:o(()=>[(S(),ye(_e(_.value),{id:n.id,onSelected:K,onCloseDialog:e[18]||(e[18]=a=>f.value=!1)},null,40,["id"]))]),_:1},8,["modelValue","width","height"]),t(B,{modelValue:V.value,"onUpdate:modelValue":e[21]||(e[21]=a=>V.value=a),width:"800",height:"800",persistent:""},{default:o(()=>[t(Ce,{onSelected:X,onCloseSaleDialog:e[20]||(e[20]=a=>V.value=!1)})]),_:1},8,["modelValue"])],64)}}},Qe=oe($e,[["__scopeId","data-v-42bbc3be"]]);export{Qe as default};
