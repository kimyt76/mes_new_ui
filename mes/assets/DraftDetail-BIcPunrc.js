import{A as Q}from"./apiOrders-aYcVHbt-.js";import{_ as ne,p as ue,a as ie,u as pe,r as i,z as ce,k as ve,m as fe,c as v,g as o,d as h,w as f,F as M,e as me,G as he,o as u,b as j,s as k,f as e,h as q,t as r,B as be,i as R,n as xe}from"./index-CSVU4KnH.js";import{D as $}from"./DownLoadLink-_ADZG-34.js";import{_ as _e}from"./UserListPop-Dvf9Erza.js";import{j as p,i as A,e as ye}from"./common-Vxxi2eVn.js";import"./filedownLoad-vZrQWoXx.js";import"./format-CBpsKyOP.js";const Ie={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},De={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},ge={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ae={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ne={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Ue={style:{height:"80px","text-align":"center","border-left":"1px solid #ccc"}},Fe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},ke={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},qe={key:0},Ve={key:1},we={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ce={key:0},Se={key:1},Be={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ee={key:0},Le={key:1},Te={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},je={key:0},Oe={key:1},Pe={style:{height:"30px","text-align":"center","border-left":"1px solid #ccc"}},Ye={key:0},Qe={key:1},Me={class:"d-flex ga-4 justify-end"},Re={colspan:"3"},$e={colspan:"4",style:{height:"100px","text-align":"center"}},ze={colspan:"3"},Ge={colspan:"3",style:{"border-bottom":"1px solid #ccc"}},He={key:0},Ke={colspan:"3"},We={colspan:"3"},Je={__name:"DraftDetail",setup(Xe){const z=ue(),V=me(),w=z.params.id,{userId:d,memberNm:G,deptNm:Ze}=ie(),{vError:H,vSuccess:K,vInfo:et}=pe();i([]),i([]);const C=i([]),W=ce(()=>C.value.filter(a=>a.boardUserId!==d)),S=i(!1),O=i(!1),B=i(!1),P=i(!1),Y=i(!1);let y=i("");const N=i("");let m=i(null);const s=ve({draftDate:p(),seq:"",customerName:"",itemName:"",orderQty:0,dueDate:"",draftUserName:"",draftDept:"",draftUserId:"",statusType:"",userId:d}),J=i(""),l=i({businessUserId:"",productUserId:"",purchaseUserId:"",qcUserId:"",labUserId:"",businessUserName:"",productUserName:"",purchaseUserName:"",qcUserName:"",labUserName:"",businessApprovalDate:"",productApprovalDate:"",purchaseApprovalDate:"",qcApprovalDate:"",labApprovalDate:""}),c=i({orderFileName:"",orderFilePath:"",orderFileAttachFileId:"",orderSeq:"",prodFileName:"",prodFilePath:"",prodFileAttachFileId:"",prodSeq:""}),X=a=>{l.value.labUserName=a.memberNm,l.value.labUserId=a.userId},Z=async()=>{const a={userId:d,field:y.value,boardId:s.boardId,approvalId:s.approvalId,boardTxt:N.value,appDate:m.value,draftId:w,statusType:J.value};try{const t=await Q.updateInfo(a);K(t),V.push({name:"DraftList"})}catch(t){H(t)}},ee=()=>{s.draftUserId===d&&(P.value=!0);const t=Object.values(l.value).includes(d),{businessCheckYn:x,productCheckYn:U,purchaseCheckYn:I,qcCheckYn:D,labCheckYn:F,businessUserId:g,productUserId:_,purchaseUserId:E,qcUserId:L,labUserId:T}=l.value;A(te(d))||(Y.value=!0),s.draftUserId!==d&&(O.value=!0);const b=i(!1);(d===g&&x==="N"||d===_&&U==="N"||d===E&&I==="N"||d===L&&D==="N"||d===T&&F==="N")&&(b.value=!0),t&&b.value&&(B.value=!0)},te=a=>{for(const[t,x]of Object.entries(l.value))if(t.endsWith("UserId")&&x===a)return t;return null};fe(async()=>{const a=await Q.getDraftInfo(w);Object.assign(s,a.draftInfo),Object.assign(l.value,a.approvalInfo),C.value=a.boardInfo||[],ee();const t=C.value.find(x=>x.boardUserId===d);N.value=t?t.boardTxt:"",le(a)});const le=a=>{a.orderAttachFileInfo!==null&&(c.value.orderFileName=a.orderAttachFileInfo.fileName,c.value.orderFilePath=a.orderAttachFileInfo.filePath,c.value.orderFileAttachFileId=a.orderAttachFileInfo.attachFileId,c.value.orderSeq=a.orderAttachFileInfo.seq),a.prodAttachFileInfo!==null&&(c.value.prodFileName=a.prodAttachFileInfo.fileName,c.value.prodFilePath=a.prodAttachFileInfo.filepath,c.value.prodFileAttachFileId=a.prodAttachFileInfo.attachFileId,c.value.prodSeq=a.prodAttachFileInfo.seq)},ae=()=>{l.value.businessUserId.includes(d)&&(A(l.value.businessApprovalDate)?(l.value.businessApprovalDate=p(),l.value.productApprovalDate=p(),l.value.purchaseApprovalDate=p(),l.value.qcApprovalDate=p(),l.value.labApprovalDate=p(),m.value=p(),y.value="business_approval_date"):m.value=l.value.businessApprovalDate),l.value.productUserId.includes(d)?A(l.value.productApprovalDate)?(l.value.productApprovalDate=p(),m.value=p(),y.value="product_Approval_Date"):m.value=l.value.productApprovalDate:l.value.purchaseUserId.includes(d)?A(l.value.purchaseApprovalDate)?(l.value.purchaseApprovalDate=p(),m.value=p(),y.value="purchase_Approval_Date"):m.value=l.value.purchaseApprovalDate:l.value.qcUserId.includes(d)?A(l.value.qcApprovalDate)?(l.value.qcApprovalDate=p(),m.value=p(),y.value="qc_Approval_Date"):m.value=l.value.qcApprovalDate:l.value.labUserId.includes(d)&&(A(l.value.labApprovalDate)?(l.value.labApprovalDate=p(),m.value=p(),y.value="lab_Approval_Date"):m.value=l.value.labApprovalDate),B.value=!1},oe=()=>{V.push({name:"DraftEdit",params:{id:w}})},se=()=>{V.push({name:"DraftList"})};return(a,t)=>{const x=h("v-breadcrumbs"),U=h("v-table"),I=h("v-col"),D=h("v-row"),F=h("v-card-text"),g=h("v-btn"),_=h("v-text-field"),E=h("v-date-input"),L=h("v-card"),T=h("v-dialog"),b=he("comma-number");return u(),v(M,null,[o(x,{items:["MES","영업관리","사양서 상세"]}),o(L,null,{default:f(()=>[o(F,null,{default:f(()=>[o(D,null,{default:f(()=>[o(I,{class:"d-flex justify-end pa-1"},{default:f(()=>[o(U,{style:{border:"0.1px solid #ccc"}},{default:f(()=>[e("tbody",null,[t[7]||(t[7]=e("tr",null,[e("th",{rowspan:"3",style:{"vertical-align":"middle",width:"20px"}},[q("결"),e("br"),e("br"),e("br"),q("재")]),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"기안자"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"영업관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"생산관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"구매부"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"품질관리"),e("th",{style:{height:"30px",width:"120px","text-align":"center","border-left":"1px solid #ccc"}},"연구소")],-1)),e("tr",null,[e("td",Ie,r(s.draftUserName),1),e("td",De,r(l.value.businessUserName),1),e("td",ge,r(l.value.productUserName),1),e("td",Ae,r(l.value.purchaseUserName),1),e("td",Ne,r(l.value.qcUserName),1),e("td",Ue,r(l.value.labUserName),1)]),e("tr",null,[e("td",Fe,r(s.draftDate),1),e("td",ke,[l.value.businessApprovalDate?(u(),v("span",Ve,r(l.value.businessApprovalDate),1)):(u(),v("span",qe,"결제일자"))]),e("td",we,[l.value.productApprovalDate?(u(),v("span",Se,r(l.value.productApprovalDate),1)):(u(),v("span",Ce,"결제일자"))]),e("td",Be,[l.value.purchaseApprovalDate?(u(),v("span",Le,r(l.value.purchaseApprovalDate),1)):(u(),v("span",Ee,"결제일자"))]),e("td",Te,[l.value.qcApprovalDate?(u(),v("span",Oe,r(l.value.qcApprovalDate),1)):(u(),v("span",je,"결제일자"))]),e("td",Pe,[l.value.labApprovalDate?(u(),v("span",Qe,r(l.value.labApprovalDate),1)):(u(),v("span",Ye,"결제일자"))])])])]),_:1})]),_:1})]),_:1})]),_:1}),B.value?(u(),j(D,{key:0},{default:f(()=>[o(I,null,{default:f(()=>[e("div",Me,[o(g,{color:"brown-lighten-4",class:"mt-1 mr-3",text:"승인",onClick:ae})])]),_:1})]),_:1})):k("",!0),o(F,null,{default:f(()=>[o(D,null,{default:f(()=>[o(I,null,{default:f(()=>[o(U,{class:"compact-table"},{default:f(()=>[e("tbody",null,[e("tr",null,[t[8]||(t[8]=e("th",null,"문서번호",-1)),e("td",null,r(s.draftDate)+"-"+r(s.seq),1),t[9]||(t[9]=e("th",null,"처리기한",-1)),t[10]||(t[10]=e("td",null,"즉시",-1))]),e("tr",null,[t[11]||(t[11]=e("th",null,"보존년한",-1)),t[12]||(t[12]=e("td",null,"5년",-1)),t[13]||(t[13]=e("th",null,"기안일자",-1)),e("td",null,r(s.draftDate),1)]),e("tr",null,[t[14]||(t[14]=e("th",null,"기안부서",-1)),e("td",null,r(s.draftDept),1),t[15]||(t[15]=e("th",null,"기안자",-1)),e("td",null,r(s.draftUserName),1)]),e("tr",null,[t[16]||(t[16]=e("th",null,"제목",-1)),e("td",Re,r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 검토 요청의 건 ",1)]),e("tr",null,[e("td",$e,[q(r(s.customerName)+"    "+r(s.itemName)+"    발주서 및 제품 사양서 기안하오니 검토하여 주시기 바랍니다.",1),t[17]||(t[17]=e("br",null,null,-1)),t[18]||(t[18]=e("br",null,null,-1)),t[19]||(t[19]=q(" - 아 래 - "))])]),e("tr",null,[t[20]||(t[20]=e("th",null,"고객사명",-1)),e("td",null,[o(_,{modelValue:s.customerName,"onUpdate:modelValue":t[0]||(t[0]=n=>s.customerName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])]),t[21]||(t[21]=e("th",null,"품목",-1)),e("td",null,[o(_,{modelValue:s.itemName,"onUpdate:modelValue":t[1]||(t[1]=n=>s.itemName=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue"])])]),e("tr",null,[t[22]||(t[22]=e("th",null,"발주수량",-1)),e("td",null,[be(o(_,{modelValue:s.orderQty,"onUpdate:modelValue":t[2]||(t[2]=n=>s.orderQty=n),variant:"outlined",density:"compact","hide-details":"",readonly:"",style:{"text-align":"right"},class:"cell-input"},null,8,["modelValue"]),[[b]])]),t[23]||(t[23]=e("th",null,"납기일자",-1)),e("td",null,[o(E,{modelValue:s.dueDate,"onUpdate:modelValue":t[3]||(t[3]=n=>s.dueDate=n),"display-format":R(ye),variant:"outlined",density:"compact","hide-details":"",readonly:"",class:"cell-input"},null,8,["modelValue","display-format"])])]),e("tr",null,[t[24]||(t[24]=e("th",null,"발주서 첨부파일",-1)),e("td",ze,[o($,{fileName:c.value.orderFileName||"",attachFileId:c.value.orderFileAttachFileId||"",seq:c.value.orderSeq||""},null,8,["fileName","attachFileId","seq"])])]),e("tr",null,[t[25]||(t[25]=e("th",null,"제품사양서 첨부",-1)),e("td",Ge,[o($,{fileName:c.value.prodFileName||"",attachFileId:c.value.prodFileAttachFileId||"",seq:c.value.prodSeq||""},null,8,["fileName","attachFileId","seq"])])]),O.value?(u(),v("tr",He,[e("th",null,r(R(G)),1),e("td",Ke,[o(_,{modelValue:N.value,"onUpdate:modelValue":t[4]||(t[4]=n=>N.value=n),readonly:!1,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue"])])])):k("",!0),(u(!0),v(M,null,xe(W.value,(n,re)=>(u(),v("tr",{key:n.boardId||re},[e("th",null,r(n.boardUserId),1),e("td",We,[o(_,{modelValue:n.boardTxt,"onUpdate:modelValue":de=>n.boardTxt=de,readonly:!0,density:"compact",style:{height:"20px"},class:"mb-4"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1}),o(D,null,{default:f(()=>[o(I,{class:"d-flex ga-4 justify-end mb-3"},{default:f(()=>[P.value?(u(),j(g,{key:0,color:"brown-lighten-4",text:"수정",onClick:oe})):k("",!0),Y.value?(u(),j(g,{key:1,text:"저장",class:"gt-2",color:"brown-lighten-4",onClick:Z})):k("",!0),o(g,{text:"목록",class:"mr-3",onClick:se})]),_:1})]),_:1})]),_:1})]),_:1}),o(T,{modelValue:S.value,"onUpdate:modelValue":t[6]||(t[6]=n=>S.value=n),height:"800px",width:"900px",persistent:""},{default:f(()=>[o(_e,{onSelected:X,onCloseDialog:t[5]||(t[5]=n=>S.value=!1)})]),_:1},8,["modelValue"])],64)}}},nt=ne(Je,[["__scopeId","data-v-3cf0ca6c"]]);export{nt as default};
