import{L as kD,M as YW,c as GW,o as LD,N as qW,r as KW,b as XW,v as ZW,i as QW}from"./index-WOYElqRf.js";import{c as bP}from"./_commonjsHelpers-CZnAS8i4.js";var RP={},ph,EP;function nn(){if(EP)return ph;EP=1;var t=function(e){return e&&e.Math===Math&&e};return ph=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof bP=="object"&&bP)||t(typeof ph=="object"&&ph)||function(){return this}()||Function("return this")(),ph}var bv={},Rv,TP;function cn(){return TP||(TP=1,Rv=function(t){try{return!!t()}catch{return!0}}),Rv}var Ev,_P;function Mi(){if(_P)return Ev;_P=1;var t=cn();return Ev=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Ev}var Tv,MP;function pw(){if(MP)return Tv;MP=1;var t=cn();return Tv=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Tv}var _v,PP;function hn(){if(PP)return _v;PP=1;var t=pw(),e=Function.prototype.call;return _v=t?e.bind(e):function(){return e.apply(e,arguments)},_v}var Mv={},IP;function JW(){if(IP)return Mv;IP=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return Mv.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Mv}var Pv,OP;function ww(){return OP||(OP=1,Pv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Pv}var Iv,xP;function rn(){if(xP)return Iv;xP=1;var t=pw(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return Iv=t?r:function(i){return function(){return n.apply(i,arguments)}},Iv}var Ov,AP;function du(){if(AP)return Ov;AP=1;var t=rn(),e=t({}.toString),n=t("".slice);return Ov=function(r){return n(e(r),8,-1)},Ov}var xv,HP;function eB(){if(HP)return xv;HP=1;var t=rn(),e=cn(),n=du(),r=Object,i=t("".split);return xv=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,xv}var Av,NP;function UE(){return NP||(NP=1,Av=function(t){return t==null}),Av}var Hv,DP;function Rf(){if(DP)return Hv;DP=1;var t=UE(),e=TypeError;return Hv=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Hv}var Nv,kP;function Ef(){if(kP)return Nv;kP=1;var t=eB(),e=Rf();return Nv=function(n){return t(e(n))},Nv}var Dv,LP;function dn(){if(LP)return Dv;LP=1;var t=typeof document=="object"&&document.all;return Dv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Dv}var kv,$P;function Pi(){if($P)return kv;$P=1;var t=dn();return kv=function(e){return typeof e=="object"?e!==null:t(e)},kv}var Lv,FP;function Jc(){if(FP)return Lv;FP=1;var t=nn(),e=dn(),n=function(r){return e(r)?r:void 0};return Lv=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Lv}var $v,VP;function Tf(){if(VP)return $v;VP=1;var t=rn();return $v=t({}.isPrototypeOf),$v}var Fv,WP;function vw(){if(WP)return Fv;WP=1;var t=nn(),e=t.navigator,n=e&&e.userAgent;return Fv=n?String(n):"",Fv}var Vv,BP;function tB(){if(BP)return Vv;BP=1;var t=nn(),e=vw(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Vv=a,Vv}var Wv,jP;function zE(){if(jP)return Wv;jP=1;var t=tB(),e=cn(),n=nn(),r=n.String;return Wv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Wv}var Bv,UP;function $D(){if(UP)return Bv;UP=1;var t=zE();return Bv=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Bv}var jv,zP;function YE(){if(zP)return jv;zP=1;var t=Jc(),e=dn(),n=Tf(),r=$D(),i=Object;return jv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},jv}var Uv,YP;function Cw(){if(YP)return Uv;YP=1;var t=String;return Uv=function(e){try{return t(e)}catch{return"Object"}},Uv}var zv,GP;function xr(){if(GP)return zv;GP=1;var t=dn(),e=Cw(),n=TypeError;return zv=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},zv}var Yv,qP;function _f(){if(qP)return Yv;qP=1;var t=xr(),e=UE();return Yv=function(n,r){var i=n[r];return e(i)?void 0:t(i)},Yv}var Gv,KP;function nB(){if(KP)return Gv;KP=1;var t=hn(),e=dn(),n=Pi(),r=TypeError;return Gv=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},Gv}var qv={exports:{}},Kv,XP;function ja(){return XP||(XP=1,Kv=!1),Kv}var Xv,ZP;function GE(){if(ZP)return Xv;ZP=1;var t=nn(),e=Object.defineProperty;return Xv=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Xv}var QP;function qE(){if(QP)return qv.exports;QP=1;var t=ja(),e=nn(),n=GE(),r="__core-js_shared__",i=qv.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.46.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),qv.exports}var Zv,JP;function FD(){if(JP)return Zv;JP=1;var t=qE();return Zv=function(e,n){return t[e]||(t[e]=n||{})},Zv}var Qv,eI;function eh(){if(eI)return Qv;eI=1;var t=Rf(),e=Object;return Qv=function(n){return e(t(n))},Qv}var Jv,tI;function Ii(){if(tI)return Jv;tI=1;var t=rn(),e=eh(),n=t({}.hasOwnProperty);return Jv=Object.hasOwn||function(i,o){return n(e(i),o)},Jv}var eC,nI;function VD(){if(nI)return eC;nI=1;var t=rn(),e=0,n=Math.random(),r=t(1.1.toString);return eC=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},eC}var tC,rI;function oo(){if(rI)return tC;rI=1;var t=nn(),e=FD(),n=Ii(),r=VD(),i=zE(),o=$D(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return tC=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},tC}var nC,iI;function rB(){if(iI)return nC;iI=1;var t=hn(),e=Pi(),n=YE(),r=_f(),i=nB(),o=oo(),s=TypeError,a=o("toPrimitive");return nC=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},nC}var rC,oI;function WD(){if(oI)return rC;oI=1;var t=rB(),e=YE();return rC=function(n){var r=t(n,"string");return e(r)?r:r+""},rC}var iC,sI;function KE(){if(sI)return iC;sI=1;var t=nn(),e=Pi(),n=t.document,r=e(n)&&e(n.createElement);return iC=function(i){return r?n.createElement(i):{}},iC}var oC,aI;function BD(){if(aI)return oC;aI=1;var t=Mi(),e=cn(),n=KE();return oC=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),oC}var lI;function jD(){if(lI)return bv;lI=1;var t=Mi(),e=hn(),n=JW(),r=ww(),i=Ef(),o=WD(),s=Ii(),a=BD(),l=Object.getOwnPropertyDescriptor;return bv.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},bv}var sC={},aC,uI;function UD(){if(uI)return aC;uI=1;var t=Mi(),e=cn();return aC=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),aC}var lC,cI;function fn(){if(cI)return lC;cI=1;var t=Pi(),e=String,n=TypeError;return lC=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},lC}var hI;function Ua(){if(hI)return sC;hI=1;var t=Mi(),e=BD(),n=UD(),r=fn(),i=WD(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return sC.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var w=a(d,f);w&&w[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:w[u],enumerable:l in m?m[l]:w[l],writable:!1})}return s(d,f,m)}:s:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return s(d,f,m)}catch{}if("get"in m||"set"in m)throw new o("Accessors not supported");return"value"in m&&(d[f]=m.value),d},sC}var uC,dI;function th(){if(dI)return uC;dI=1;var t=Mi(),e=Ua(),n=ww();return uC=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},uC}var cC={exports:{}},hC,fI;function iB(){if(fI)return hC;fI=1;var t=Mi(),e=Ii(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return hC={EXISTS:i,PROPER:o,CONFIGURABLE:s},hC}var dC,gI;function oB(){if(gI)return dC;gI=1;var t=rn(),e=dn(),n=qE(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),dC=n.inspectSource,dC}var fC,mI;function sB(){if(mI)return fC;mI=1;var t=nn(),e=dn(),n=t.WeakMap;return fC=e(n)&&/native code/.test(String(n)),fC}var gC,pI;function XE(){if(pI)return gC;pI=1;var t=FD(),e=VD(),n=t("keys");return gC=function(r){return n[r]||(n[r]=e(r))},gC}var mC,wI;function ZE(){return wI||(wI=1,mC={}),mC}var pC,vI;function zD(){if(vI)return pC;vI=1;var t=sB(),e=nn(),n=Pi(),r=th(),i=Ii(),o=qE(),s=XE(),a=ZE(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(b){return f(b)?d(b):h(b,{})},w=function(b){return function(M){var R;if(!n(M)||(R=d(M)).type!==b)throw new u("Incompatible receiver, "+b+" required");return R}};if(t||o.state){var y=o.state||(o.state=new c);y.get=y.get,y.has=y.has,y.set=y.set,h=function(b,M){if(y.has(b))throw new u(l);return M.facade=b,y.set(b,M),M},d=function(b){return y.get(b)||{}},f=function(b){return y.has(b)}}else{var T=s("state");a[T]=!0,h=function(b,M){if(i(b,T))throw new u(l);return M.facade=b,r(b,T,M),M},d=function(b){return i(b,T)?b[T]:{}},f=function(b){return i(b,T)}}return pC={set:h,get:d,has:f,enforce:m,getterFor:w},pC}var CI;function YD(){if(CI)return cC.exports;CI=1;var t=rn(),e=cn(),n=dn(),r=Ii(),i=Mi(),o=iB().CONFIGURABLE,s=oB(),a=zD(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),w=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),T=cC.exports=function(b,M,R){d(c(M),0,7)==="Symbol("&&(M="["+f(c(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),R&&R.getter&&(M="get "+M),R&&R.setter&&(M="set "+M),(!r(b,"name")||o&&b.name!==M)&&(i?h(b,"name",{value:M,configurable:!0}):b.name=M),w&&R&&r(R,"arity")&&b.length!==R.arity&&h(b,"length",{value:R.arity});try{R&&r(R,"constructor")&&R.constructor?i&&h(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var D=l(b);return r(D,"source")||(D.source=m(y,typeof M=="string"?M:"")),b};return Function.prototype.toString=T(function(){return n(this)&&u(this).source||s(this)},"toString"),cC.exports}var wC,yI;function QE(){if(yI)return wC;yI=1;var t=dn(),e=Ua(),n=YD(),r=GE();return wC=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},wC}var vC={},CC,SI;function aB(){if(SI)return CC;SI=1;var t=Math.ceil,e=Math.floor;return CC=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},CC}var yC,bI;function Mf(){if(bI)return yC;bI=1;var t=aB();return yC=function(e){var n=+e;return n!==n||n===0?0:t(n)},yC}var SC,RI;function lB(){if(RI)return SC;RI=1;var t=Mf(),e=Math.max,n=Math.min;return SC=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},SC}var bC,EI;function uB(){if(EI)return bC;EI=1;var t=Mf(),e=Math.min;return bC=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},bC}var RC,TI;function nh(){if(TI)return RC;TI=1;var t=uB();return RC=function(e){return t(e.length)},RC}var EC,_I;function cB(){if(_I)return EC;_I=1;var t=Ef(),e=lB(),n=nh(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return EC={includes:r(!0),indexOf:r(!1)},EC}var TC,MI;function GD(){if(MI)return TC;MI=1;var t=rn(),e=Ii(),n=Ef(),r=cB().indexOf,i=ZE(),o=t([].push);return TC=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},TC}var _C,PI;function JE(){return PI||(PI=1,_C=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),_C}var II;function hB(){if(II)return vC;II=1;var t=GD(),e=JE(),n=e.concat("length","prototype");return vC.f=Object.getOwnPropertyNames||function(i){return t(i,n)},vC}var MC={},OI;function dB(){return OI||(OI=1,MC.f=Object.getOwnPropertySymbols),MC}var PC,xI;function fB(){if(xI)return PC;xI=1;var t=Jc(),e=rn(),n=hB(),r=dB(),i=fn(),o=e([].concat);return PC=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},PC}var IC,AI;function qD(){if(AI)return IC;AI=1;var t=Ii(),e=fB(),n=jD(),r=Ua();return IC=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},IC}var OC,HI;function gB(){if(HI)return OC;HI=1;var t=cn(),e=dn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return OC=r,OC}var xC,NI;function yt(){if(NI)return xC;NI=1;var t=nn(),e=jD().f,n=th(),r=QE(),i=GE(),o=qD(),s=gB();return xC=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,w,y,T;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(y=l[m],a.dontCallGetSet?(T=e(f,m),w=T&&T.value):w=f[m],d=s(c?m:u+(h?".":"#")+m,a.forced),!d&&w!==void 0){if(typeof y==typeof w)continue;o(y,w)}(a.sham||w&&w.sham)&&n(y,"sham",!0),r(f,m,y,a)}},xC}var AC,DI;function Pf(){if(DI)return AC;DI=1;var t=pw(),e=Function.prototype,n=e.apply,r=e.call;return AC=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),AC}var HC,kI;function KD(){if(kI)return HC;kI=1;var t=rn(),e=xr();return HC=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},HC}var NC,LI;function mB(){if(LI)return NC;LI=1;var t=Pi();return NC=function(e){return t(e)||e===null},NC}var DC,$I;function pB(){if($I)return DC;$I=1;var t=mB(),e=String,n=TypeError;return DC=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},DC}var kC,FI;function XD(){if(FI)return kC;FI=1;var t=KD(),e=Pi(),n=Rf(),r=pB();return kC=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),kC}var LC,VI;function wB(){if(VI)return LC;VI=1;var t=Ua().f;return LC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},LC}var $C,WI;function vB(){if(WI)return $C;WI=1;var t=dn(),e=Pi(),n=XD();return $C=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},$C}var FC,BI;function CB(){if(BI)return FC;BI=1;var t=oo(),e=t("toStringTag"),n={};return n[e]="z",FC=String(n)==="[object z]",FC}var VC,jI;function ZD(){if(jI)return VC;jI=1;var t=CB(),e=dn(),n=du(),r=oo(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return VC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},VC}var WC,UI;function yw(){if(UI)return WC;UI=1;var t=ZD(),e=String;return WC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},WC}var BC,zI;function yB(){if(zI)return BC;zI=1;var t=yw();return BC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},BC}var jC,YI;function SB(){if(YI)return jC;YI=1;var t=Pi(),e=th();return jC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},jC}var UC,GI;function bB(){if(GI)return UC;GI=1;var t=rn(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return UC=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},UC}var zC,qI;function RB(){if(qI)return zC;qI=1;var t=cn(),e=ww();return zC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),zC}var YC,KI;function EB(){if(KI)return YC;KI=1;var t=th(),e=bB(),n=RB(),r=Error.captureStackTrace;return YC=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},YC}var GC,XI;function TB(){if(XI)return GC;XI=1;var t=Jc(),e=Ii(),n=th(),r=Tf(),i=XD(),o=qD(),s=wB(),a=vB(),l=yB(),u=SB(),c=EB(),h=Mi(),d=ja();return GC=function(f,m,w,y){var T="stackTraceLimit",b=y?2:1,M=f.split("."),R=M[M.length-1],D=t.apply(null,M);if(D){var I=D.prototype;if(!d&&e(I,"cause")&&delete I.cause,!w)return D;var O=t("Error"),U=m(function(G,W){var X=l(y?W:G,void 0),z=y?new D(G):new D;return X!==void 0&&n(z,"message",X),c(z,U,z.stack,2),this&&r(I,this)&&a(z,this,U),arguments.length>b&&u(z,arguments[b]),z});if(U.prototype=I,R!=="Error"?i?i(U,O):o(U,O,{name:!0}):h&&T in D&&(s(U,D,T),s(U,D,"prepareStackTrace")),o(U,D),!d)try{I.name!==R&&n(I,"name",R),I.constructor=U}catch{}return U}},GC}var ZI;function _B(){if(ZI)return RP;ZI=1;var t=yt(),e=nn(),n=Pf(),r=TB(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),RP}_B();var QI={},qC,JI;function QD(){if(JI)return qC;JI=1;var t=du();return qC=Array.isArray||function(n){return t(n)==="Array"},qC}var KC,eO;function JD(){if(eO)return KC;eO=1;var t=Mi(),e=QD(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return KC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},KC}var XC,tO;function ek(){if(tO)return XC;tO=1;var t=TypeError,e=9007199254740991;return XC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},XC}var nO;function MB(){if(nO)return QI;nO=1;var t=yt(),e=eh(),n=nh(),r=JD(),i=ek(),o=cn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),QI}MB();var rO={},ZC,iO;function PB(){if(iO)return ZC;iO=1;var t=du(),e=rn();return ZC=function(n){if(t(n)==="Function")return e(n)},ZC}var QC,oO;function tk(){if(oO)return QC;oO=1;var t=PB(),e=xr(),n=pw(),r=t(t.bind);return QC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},QC}var JC,sO;function nk(){return sO||(sO=1,JC={}),JC}var ey,aO;function IB(){if(aO)return ey;aO=1;var t=oo(),e=nk(),n=t("iterator"),r=Array.prototype;return ey=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},ey}var ty,lO;function e0(){if(lO)return ty;lO=1;var t=ZD(),e=_f(),n=UE(),r=nk(),i=oo(),o=i("iterator");return ty=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},ty}var ny,uO;function OB(){if(uO)return ny;uO=1;var t=hn(),e=xr(),n=fn(),r=Cw(),i=e0(),o=TypeError;return ny=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},ny}var ry,cO;function Ar(){if(cO)return ry;cO=1;var t=hn(),e=fn(),n=_f();return ry=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},ry}var iy,hO;function rh(){if(hO)return iy;hO=1;var t=tk(),e=hn(),n=fn(),r=Cw(),i=IB(),o=nh(),s=Tf(),a=OB(),l=e0(),u=Ar(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return iy=function(f,m,w){var y=w&&w.that,T=!!(w&&w.AS_ENTRIES),b=!!(w&&w.IS_RECORD),M=!!(w&&w.IS_ITERATOR),R=!!(w&&w.INTERRUPTED),D=t(m,y),I,O,U,G,W,X,z,ae=function(ce){return I&&u(I,"normal"),new h(!0,ce)},ee=function(ce){return T?(n(ce),R?D(ce[0],ce[1],ae):D(ce[0],ce[1])):R?D(ce,ae):D(ce)};if(b)I=f.iterator;else if(M)I=f;else{if(O=l(f),!O)throw new c(r(f)+" is not iterable");if(i(O)){for(U=0,G=o(f);G>U;U++)if(W=ee(f[U]),W&&s(d,W))return W;return new h(!1)}I=a(f,O)}for(X=b?f.next:I.next;!(z=e(X,I)).done;){try{W=ee(z.value)}catch(ce){u(I,"throw",ce)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},iy}var oy,dO;function rk(){if(dO)return oy;dO=1;var t=Mi(),e=Ua(),n=ww();return oy=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},oy}var fO;function xB(){if(fO)return rO;fO=1;var t=yt(),e=rh(),n=rk();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),rO}xB();var gO={},sy,mO;function Yo(){if(mO)return sy;mO=1;var t=rn(),e=Set.prototype;return sy={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},sy}var ay,pO;function fu(){if(pO)return ay;pO=1;var t=Yo().has;return ay=function(e){return t(e),e},ay}var ly,wO;function gu(){if(wO)return ly;wO=1;var t=hn();return ly=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},ly}var uy,vO;function If(){if(vO)return uy;vO=1;var t=rn(),e=gu(),n=Yo(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return uy=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},uy}var cy,CO;function t0(){if(CO)return cy;CO=1;var t=Yo(),e=If(),n=t.Set,r=t.add;return cy=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},cy}var hy,yO;function Of(){if(yO)return hy;yO=1;var t=KD(),e=Yo();return hy=t(e.proto,"size","get")||function(n){return n.size},hy}var dy,SO;function Go(){return SO||(SO=1,dy=function(t){return{iterator:t,next:t.next,done:!1}}),dy}var fy,bO;function mu(){if(bO)return fy;bO=1;var t=xr(),e=fn(),n=hn(),r=Mf(),i=Go(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},fy=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},fy}var gy,RO;function AB(){if(RO)return gy;RO=1;var t=fu(),e=Yo(),n=t0(),r=Of(),i=mu(),o=If(),s=gu(),a=e.has,l=e.remove;return gy=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(m){d.includes(m)&&l(f,m)}):s(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},gy}var my,EO;function pu(){if(EO)return my;EO=1;var t=Jc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return my=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},my}var TO;function HB(){if(TO)return gO;TO=1;var t=yt(),e=AB(),n=cn(),r=pu(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),gO}HB();var _O={},py,MO;function NB(){if(MO)return py;MO=1;var t=fu(),e=Yo(),n=Of(),r=mu(),i=If(),o=gu(),s=e.Set,a=e.add,l=e.has;return py=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},py}var PO;function DB(){if(PO)return _O;PO=1;var t=yt(),e=cn(),n=NB(),r=pu(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),_O}DB();var IO={},wy,OO;function kB(){if(OO)return wy;OO=1;var t=fu(),e=Yo().has,n=Of(),r=mu(),i=If(),o=gu(),s=Ar();return wy=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},wy}var xO;function LB(){if(xO)return IO;xO=1;var t=yt(),e=kB(),n=pu(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),IO}LB();var AO={},vy,HO;function $B(){if(HO)return vy;HO=1;var t=fu(),e=Of(),n=If(),r=mu();return vy=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},vy}var NO;function FB(){if(NO)return AO;NO=1;var t=yt(),e=$B(),n=pu(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),AO}FB();var DO={},Cy,kO;function VB(){if(kO)return Cy;kO=1;var t=fu(),e=Yo().has,n=Of(),r=mu(),i=gu(),o=Ar();return Cy=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Cy}var LO;function WB(){if(LO)return DO;LO=1;var t=yt(),e=VB(),n=pu(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),DO}WB();var $O={},yy,FO;function BB(){if(FO)return yy;FO=1;var t=fu(),e=Yo(),n=t0(),r=mu(),i=gu(),o=e.add,s=e.has,a=e.remove;return yy=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},yy}var Sy,VO;function ik(){return VO||(VO=1,Sy=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),Sy}var WO;function jB(){if(WO)return $O;WO=1;var t=yt(),e=BB(),n=ik(),r=pu(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),$O}jB();var BO={},by,jO;function UB(){if(jO)return by;jO=1;var t=fu(),e=Yo().add,n=t0(),r=mu(),i=gu();return by=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},by}var UO;function zB(){if(UO)return BO;UO=1;var t=yt(),e=UB(),n=ik(),r=pu(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),BO}zB();var zO={},YO={},Ry,GO;function YB(){if(GO)return Ry;GO=1;var t=Tf(),e=TypeError;return Ry=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},Ry}var Ey,qO;function GB(){if(qO)return Ey;qO=1;var t=cn();return Ey=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Ey}var Ty,KO;function ok(){if(KO)return Ty;KO=1;var t=Ii(),e=dn(),n=eh(),r=XE(),i=GB(),o=r("IE_PROTO"),s=Object,a=s.prototype;return Ty=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Ty}var _y,XO;function qB(){if(XO)return _y;XO=1;var t=YD(),e=Ua();return _y=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},_y}var My={},Py,ZO;function KB(){if(ZO)return Py;ZO=1;var t=GD(),e=JE();return Py=Object.keys||function(r){return t(r,e)},Py}var QO;function XB(){if(QO)return My;QO=1;var t=Mi(),e=UD(),n=Ua(),r=fn(),i=Ef(),o=KB();return My.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},My}var Iy,JO;function sk(){if(JO)return Iy;JO=1;var t=Jc();return Iy=t("document","documentElement"),Iy}var Oy,ex;function n0(){if(ex)return Oy;ex=1;var t=fn(),e=XB(),n=JE(),r=ZE(),i=sk(),o=KE(),s=XE(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(b){return l+c+a+b+l+"/"+c+a},m=function(b){b.write(f("")),b.close();var M=b.parentWindow.Object;return b=null,M},w=function(){var b=o("iframe"),M="java"+c+":",R;return b.style.display="none",i.appendChild(b),b.src=String(M),R=b.contentWindow.document,R.open(),R.write(f("document.F=Object")),R.close(),R.F},y,T=function(){try{y=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&y?m(y):w():m(y);for(var b=n.length;b--;)delete T[u][n[b]];return T()};return r[h]=!0,Oy=Object.create||function(M,R){var D;return M!==null?(d[u]=t(M),D=new d,d[u]=null,D[h]=M):D=T(),R===void 0?D:e.f(D,R)},Oy}var xy,tx;function ak(){if(tx)return xy;tx=1;var t=cn(),e=dn(),n=Pi(),r=n0(),i=ok(),o=QE(),s=oo(),a=ja(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),xy={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},xy}var nx;function ZB(){if(nx)return YO;nx=1;var t=yt(),e=nn(),n=YB(),r=fn(),i=dn(),o=ok(),s=qB(),a=rk(),l=cn(),u=Ii(),c=oo(),h=ak().IteratorPrototype,d=Mi(),f=ja(),m="constructor",w="Iterator",y=c("toStringTag"),T=TypeError,b=e[w],M=f||!i(b)||b.prototype!==h||!l(function(){b({})}),R=function(){if(n(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},D=function(I,O){d?s(h,I,{configurable:!0,get:function(){return O},set:function(U){if(r(this),this===h)throw new T("You can't redefine this property");u(this,I)?this[I]=U:a(this,I,U)}}):h[I]=O};return u(h,y)||D(y,w),(M||!u(h,m)||h[m]===Object)&&D(m,R),R.prototype=h,t({global:!0,constructor:!0,forced:M},{Iterator:R}),YO}var rx;function QB(){return rx||(rx=1,ZB()),zO}QB();var ix={},ox={},Ay,sx;function JB(){if(sx)return Ay;sx=1;var t=QE();return Ay=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},Ay}var Hy,ax;function ej(){return ax||(ax=1,Hy=function(t,e){return{value:t,done:e}}),Hy}var Ny,lx;function tj(){if(lx)return Ny;lx=1;var t=Ar();return Ny=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},Ny}var Dy,ux;function r0(){if(ux)return Dy;ux=1;var t=hn(),e=n0(),n=th(),r=JB(),i=oo(),o=zD(),s=_f(),a=ak().IteratorPrototype,l=ej(),u=Ar(),c=tj(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",m="normal",w="throw",y=o.set,T=function(R){var D=o.getterFor(R?f:d);return r(e(a),{next:function(){var O=D(this);if(R)return O.nextHandler();if(O.done)return l(void 0,!0);try{var U=O.nextHandler();return O.returnHandlerResult?U:l(U,O.done)}catch(G){throw O.done=!0,G}},return:function(){var I=D(this),O=I.iterator;if(I.done=!0,R){var U=s(O,"return");return U?t(U,O):l(void 0,!0)}if(I.inner)try{u(I.inner.iterator,m)}catch(G){return u(O,w,G)}if(I.openIters)try{c(I.openIters,m)}catch(G){return u(O,w,G)}return O&&u(O,m),l(void 0,!0)}})},b=T(!0),M=T(!1);return n(M,h,"Iterator Helper"),Dy=function(R,D,I){var O=function(G,W){W?(W.iterator=G.iterator,W.next=G.next):W=G,W.type=D?f:d,W.returnHandlerResult=!!I,W.nextHandler=R,W.counter=0,W.done=!1,y(this,W)};return O.prototype=D?b:M,O},Dy}var ky,cx;function lk(){if(cx)return ky;cx=1;var t=fn(),e=Ar();return ky=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},ky}var Ly,hx;function i0(){return hx||(hx=1,Ly=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),Ly}var $y,dx;function za(){if(dx)return $y;dx=1;var t=nn();return $y=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},$y}var fx;function nj(){if(fx)return ox;fx=1;var t=yt(),e=hn(),n=xr(),r=fn(),i=Go(),o=r0(),s=lk(),a=ja(),l=Ar(),u=i0(),c=za(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,m=o(function(){for(var w=this.iterator,y=this.predicate,T=this.next,b,M,R;;){if(b=r(e(T,w)),M=this.done=!!b.done,M)return;if(R=b.value,s(w,y,[R,this.counter++],!0))return R}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(y){r(this);try{n(y)}catch(T){l(this,"throw",T)}return d?e(d,this,y):new m(i(this),{predicate:y})}}),ox}var gx;function rj(){return gx||(gx=1,nj()),ix}rj();var mx={},px={},wx;function ij(){if(wx)return px;wx=1;var t=yt(),e=hn(),n=rh(),r=xr(),i=fn(),o=Go(),s=Ar(),a=za(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),px}var vx;function oj(){return vx||(vx=1,ij()),mx}oj();var Cx={},yx={},Sx;function sj(){if(Sx)return yx;Sx=1;var t=yt(),e=hn(),n=xr(),r=fn(),i=Go(),o=r0(),s=lk(),a=Ar(),l=i0(),u=za(),c=ja(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,m=o(function(){var w=this.iterator,y=r(e(this.next,w)),T=this.done=!!y.done;if(!T)return s(w,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(y){r(this);try{n(y)}catch(T){a(this,"throw",T)}return d?e(d,this,y):new m(i(this),{mapper:y})}}),yx}var bx;function aj(){return bx||(bx=1,sj()),Cx}aj();var Rx={},Ex={},Fy,Tx;function o0(){if(Tx)return Fy;Tx=1;var t=rn();return Fy=t([].slice),Fy}var Vy,_x;function uk(){if(_x)return Vy;_x=1;var t=TypeError;return Vy=function(e,n){if(e<n)throw new t("Not enough arguments");return e},Vy}var Wy,Mx;function lj(){if(Mx)return Wy;Mx=1;var t=vw();return Wy=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Wy}var By,Px;function ck(){if(Px)return By;Px=1;var t=nn(),e=vw(),n=du(),r=function(i){return e.slice(0,i.length)===i};return By=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),By}var jy,Ix;function uj(){if(Ix)return jy;Ix=1;var t=ck();return jy=t==="NODE",jy}var Uy,Ox;function hk(){if(Ox)return Uy;Ox=1;var t=nn(),e=Pf(),n=tk(),r=dn(),i=Ii(),o=cn(),s=sk(),a=o0(),l=KE(),u=uk(),c=lj(),h=uj(),d=t.setImmediate,f=t.clearImmediate,m=t.process,w=t.Dispatch,y=t.Function,T=t.MessageChannel,b=t.String,M=0,R={},D="onreadystatechange",I,O,U,G;o(function(){I=t.location});var W=function(ee){if(i(R,ee)){var ce=R[ee];delete R[ee],ce()}},X=function(ee){return function(){W(ee)}},z=function(ee){W(ee.data)},ae=function(ee){t.postMessage(b(ee),I.protocol+"//"+I.host)};return(!d||!f)&&(d=function(ce){u(arguments.length,1);var Et=r(ce)?ce:y(ce),$e=a(arguments,1);return R[++M]=function(){e(Et,void 0,$e)},O(M),M},f=function(ce){delete R[ce]},h?O=function(ee){m.nextTick(X(ee))}:w&&w.now?O=function(ee){w.now(X(ee))}:T&&!c?(U=new T,G=U.port2,U.port1.onmessage=z,O=n(G.postMessage,G)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&I&&I.protocol!=="file:"&&!o(ae)?(O=ae,t.addEventListener("message",z,!1)):D in l("script")?O=function(ee){s.appendChild(l("script"))[D]=function(){s.removeChild(this),W(ee)}}:O=function(ee){setTimeout(X(ee),0)}),Uy={set:d,clear:f},Uy}var xx;function cj(){if(xx)return Ex;xx=1;var t=yt(),e=nn(),n=hk().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),Ex}var Ax={},zy,Hx;function hj(){if(Hx)return zy;Hx=1;var t=nn(),e=Pf(),n=dn(),r=ck(),i=vw(),o=o0(),s=uk(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return zy=function(u,c){var h=c?2:1;return l?function(d,f){var m=s(arguments.length,1)>h,w=n(d)?d:a(d),y=m?o(arguments,h):[],T=m?function(){e(w,this,y)}:w;return c?u(T,f):u(T)}:u},zy}var Nx;function dj(){if(Nx)return Ax;Nx=1;var t=yt(),e=nn(),n=hk().set,r=hj(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Ax}var Dx;function fj(){return Dx||(Dx=1,cj(),dj()),Rx}fj();/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:dk,setPrototypeOf:kx,isFrozen:gj,getPrototypeOf:mj,getOwnPropertyDescriptor:pj}=Object;let{freeze:ur,seal:Ti,create:LR}=Object,{apply:$R,construct:FR}=typeof Reflect<"u"&&Reflect;ur||(ur=function(e){return e});Ti||(Ti=function(e){return e});$R||($R=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return e.apply(n,i)});FR||(FR=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new e(...r)});const ng=cr(Array.prototype.forEach),wj=cr(Array.prototype.lastIndexOf),Lx=cr(Array.prototype.pop),wh=cr(Array.prototype.push),vj=cr(Array.prototype.splice),$m=cr(String.prototype.toLowerCase),Yy=cr(String.prototype.toString),Gy=cr(String.prototype.match),vh=cr(String.prototype.replace),Cj=cr(String.prototype.indexOf),yj=cr(String.prototype.trim),Ui=cr(Object.prototype.hasOwnProperty),Qn=cr(RegExp.prototype.test),Ch=Sj(TypeError);function cr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return $R(t,e,r)}}function Sj(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return FR(t,n)}}function Ue(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$m;kx&&kx(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(gj(e)||(e[r]=o),i=o)}t[i]=!0}return t}function bj(t){for(let e=0;e<t.length;e++)Ui(t,e)||(t[e]=null);return t}function gs(t){const e=LR(null);for(const[n,r]of dk(t))Ui(t,n)&&(Array.isArray(r)?e[n]=bj(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=gs(r):e[n]=r);return e}function yh(t,e){for(;t!==null;){const r=pj(t,e);if(r){if(r.get)return cr(r.get);if(typeof r.value=="function")return cr(r.value)}t=mj(t)}function n(){return null}return n}const $x=ur(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),qy=ur(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ky=ur(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Rj=ur(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xy=ur(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ej=ur(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Fx=ur(["#text"]),Vx=ur(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Zy=ur(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Wx=ur(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rg=ur(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tj=Ti(/\{\{[\w\W]*|[\w\W]*\}\}/gm),_j=Ti(/<%[\w\W]*|[\w\W]*%>/gm),Mj=Ti(/\$\{[\w\W]*/gm),Pj=Ti(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ij=Ti(/^aria-[\-\w]+$/),fk=Ti(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Oj=Ti(/^(?:\w+script|data):/i),xj=Ti(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),gk=Ti(/^html$/i),Aj=Ti(/^[a-z][.\w]*(-[.\w]+)+$/i);var Bx=Object.freeze({__proto__:null,ARIA_ATTR:Ij,ATTR_WHITESPACE:xj,CUSTOM_ELEMENT:Aj,DATA_ATTR:Pj,DOCTYPE_NAME:gk,ERB_EXPR:_j,IS_ALLOWED_URI:fk,IS_SCRIPT_OR_DATA:Oj,MUSTACHE_EXPR:Tj,TMPLIT_EXPR:Mj});const Sh={element:1,text:3,progressingInstruction:7,comment:8,document:9},Hj=function(){return typeof window>"u"?null:window},Nj=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},jx=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function mk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hj();const e=we=>mk(we);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==Sh.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,w=yh(m,"cloneNode"),y=yh(m,"remove"),T=yh(m,"nextSibling"),b=yh(m,"childNodes"),M=yh(m,"parentNode");if(typeof s=="function"){const we=n.createElement("template");we.content&&we.content.ownerDocument&&(n=we.content.ownerDocument)}let R,D="";const{implementation:I,createNodeIterator:O,createDocumentFragment:U,getElementsByTagName:G}=n,{importNode:W}=r;let X=jx();e.isSupported=typeof dk=="function"&&typeof M=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:z,ERB_EXPR:ae,TMPLIT_EXPR:ee,DATA_ATTR:ce,ARIA_ATTR:Et,IS_SCRIPT_OR_DATA:$e,ATTR_WHITESPACE:Ye,CUSTOM_ELEMENT:St}=Bx;let{IS_ALLOWED_URI:ut}=Bx,ct=null;const kn=Ue({},[...$x,...qy,...Ky,...Xy,...Fx]);let it=null;const g=Ue({},[...Vx,...Zy,...Wx,...rg]);let p=Object.seal(LR(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,k=null;const F=Object.seal(LR(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let j=!0,v=!0,S=!1,_=!0,x=!1,E=!0,H=!1,$=!1,A=!1,L=!1,B=!1,V=!1,q=!0,J=!1;const se="user-content-";let be=!0,je=!1,Xe={},Re=null;const Te=Ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let qe=null;const xn=Ue({},["audio","video","img","source","image","track"]);let Hr=null;const Nr=Ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Rn="http://www.w3.org/1998/Math/MathML",Dr="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Je=bt,ot=!1,ao=null;const Ka=Ue({},[Rn,Dr,bt],Yy);let js=Ue({},["mi","mo","mn","ms","mtext"]),Zn=Ue({},["annotation-xml"]);const kr=Ue({},["title","style","font","a","script"]);let Us=null;const tg=["application/xhtml+xml","text/html"],BW="text/html";let En=null,Su=null;const jW=n.createElement("form"),cP=function(N){return N instanceof RegExp||N instanceof Function},Cv=function(){let N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Su&&Su===N)){if((!N||typeof N!="object")&&(N={}),N=gs(N),Us=tg.indexOf(N.PARSER_MEDIA_TYPE)===-1?BW:N.PARSER_MEDIA_TYPE,En=Us==="application/xhtml+xml"?Yy:$m,ct=Ui(N,"ALLOWED_TAGS")?Ue({},N.ALLOWED_TAGS,En):kn,it=Ui(N,"ALLOWED_ATTR")?Ue({},N.ALLOWED_ATTR,En):g,ao=Ui(N,"ALLOWED_NAMESPACES")?Ue({},N.ALLOWED_NAMESPACES,Yy):Ka,Hr=Ui(N,"ADD_URI_SAFE_ATTR")?Ue(gs(Nr),N.ADD_URI_SAFE_ATTR,En):Nr,qe=Ui(N,"ADD_DATA_URI_TAGS")?Ue(gs(xn),N.ADD_DATA_URI_TAGS,En):xn,Re=Ui(N,"FORBID_CONTENTS")?Ue({},N.FORBID_CONTENTS,En):Te,C=Ui(N,"FORBID_TAGS")?Ue({},N.FORBID_TAGS,En):gs({}),k=Ui(N,"FORBID_ATTR")?Ue({},N.FORBID_ATTR,En):gs({}),Xe=Ui(N,"USE_PROFILES")?N.USE_PROFILES:!1,j=N.ALLOW_ARIA_ATTR!==!1,v=N.ALLOW_DATA_ATTR!==!1,S=N.ALLOW_UNKNOWN_PROTOCOLS||!1,_=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=N.SAFE_FOR_TEMPLATES||!1,E=N.SAFE_FOR_XML!==!1,H=N.WHOLE_DOCUMENT||!1,L=N.RETURN_DOM||!1,B=N.RETURN_DOM_FRAGMENT||!1,V=N.RETURN_TRUSTED_TYPE||!1,A=N.FORCE_BODY||!1,q=N.SANITIZE_DOM!==!1,J=N.SANITIZE_NAMED_PROPS||!1,be=N.KEEP_CONTENT!==!1,je=N.IN_PLACE||!1,ut=N.ALLOWED_URI_REGEXP||fk,Je=N.NAMESPACE||bt,js=N.MATHML_TEXT_INTEGRATION_POINTS||js,Zn=N.HTML_INTEGRATION_POINTS||Zn,p=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&cP(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(p.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&cP(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(p.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(p.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(v=!1),B&&(L=!0),Xe&&(ct=Ue({},Fx),it=[],Xe.html===!0&&(Ue(ct,$x),Ue(it,Vx)),Xe.svg===!0&&(Ue(ct,qy),Ue(it,Zy),Ue(it,rg)),Xe.svgFilters===!0&&(Ue(ct,Ky),Ue(it,Zy),Ue(it,rg)),Xe.mathMl===!0&&(Ue(ct,Xy),Ue(it,Wx),Ue(it,rg))),N.ADD_TAGS&&(typeof N.ADD_TAGS=="function"?F.tagCheck=N.ADD_TAGS:(ct===kn&&(ct=gs(ct)),Ue(ct,N.ADD_TAGS,En))),N.ADD_ATTR&&(typeof N.ADD_ATTR=="function"?F.attributeCheck=N.ADD_ATTR:(it===g&&(it=gs(it)),Ue(it,N.ADD_ATTR,En))),N.ADD_URI_SAFE_ATTR&&Ue(Hr,N.ADD_URI_SAFE_ATTR,En),N.FORBID_CONTENTS&&(Re===Te&&(Re=gs(Re)),Ue(Re,N.FORBID_CONTENTS,En)),be&&(ct["#text"]=!0),H&&Ue(ct,["html","head","body"]),ct.table&&(Ue(ct,["tbody"]),delete C.tbody),N.TRUSTED_TYPES_POLICY){if(typeof N.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ch('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof N.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ch('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=N.TRUSTED_TYPES_POLICY,D=R.createHTML("")}else R===void 0&&(R=Nj(f,i)),R!==null&&typeof D=="string"&&(D=R.createHTML(""));ur&&ur(N),Su=N}},hP=Ue({},[...qy,...Ky,...Rj]),dP=Ue({},[...Xy,...Ej]),UW=function(N){let Q=M(N);(!Q||!Q.tagName)&&(Q={namespaceURI:Je,tagName:"template"});const ge=$m(N.tagName),It=$m(Q.tagName);return ao[N.namespaceURI]?N.namespaceURI===Dr?Q.namespaceURI===bt?ge==="svg":Q.namespaceURI===Rn?ge==="svg"&&(It==="annotation-xml"||js[It]):!!hP[ge]:N.namespaceURI===Rn?Q.namespaceURI===bt?ge==="math":Q.namespaceURI===Dr?ge==="math"&&Zn[It]:!!dP[ge]:N.namespaceURI===bt?Q.namespaceURI===Dr&&!Zn[It]||Q.namespaceURI===Rn&&!js[It]?!1:!dP[ge]&&(kr[ge]||!hP[ge]):!!(Us==="application/xhtml+xml"&&ao[N.namespaceURI]):!1},lo=function(N){wh(e.removed,{element:N});try{M(N).removeChild(N)}catch{y(N)}},Xa=function(N,Q){try{wh(e.removed,{attribute:Q.getAttributeNode(N),from:Q})}catch{wh(e.removed,{attribute:null,from:Q})}if(Q.removeAttribute(N),N==="is")if(L||B)try{lo(Q)}catch{}else try{Q.setAttribute(N,"")}catch{}},fP=function(N){let Q=null,ge=null;if(A)N="<remove></remove>"+N;else{const sn=Gy(N,/^[\r\n\t ]+/);ge=sn&&sn[0]}Us==="application/xhtml+xml"&&Je===bt&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");const It=R?R.createHTML(N):N;if(Je===bt)try{Q=new d().parseFromString(It,Us)}catch{}if(!Q||!Q.documentElement){Q=I.createDocument(Je,"template",null);try{Q.documentElement.innerHTML=ot?D:It}catch{}}const Ln=Q.body||Q.documentElement;return N&&ge&&Ln.insertBefore(n.createTextNode(ge),Ln.childNodes[0]||null),Je===bt?G.call(Q,H?"html":"body")[0]:H?Q.documentElement:Ln},gP=function(N){return O.call(N.ownerDocument||N,N,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},yv=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},mP=function(N){return typeof a=="function"&&N instanceof a};function Jo(we,N,Q){ng(we,ge=>{ge.call(e,N,Q,Su)})}const pP=function(N){let Q=null;if(Jo(X.beforeSanitizeElements,N,null),yv(N))return lo(N),!0;const ge=En(N.nodeName);if(Jo(X.uponSanitizeElement,N,{tagName:ge,allowedTags:ct}),E&&N.hasChildNodes()&&!mP(N.firstElementChild)&&Qn(/<[/\w!]/g,N.innerHTML)&&Qn(/<[/\w!]/g,N.textContent)||N.nodeType===Sh.progressingInstruction||E&&N.nodeType===Sh.comment&&Qn(/<[/\w]/g,N.data))return lo(N),!0;if(!(F.tagCheck instanceof Function&&F.tagCheck(ge))&&(!ct[ge]||C[ge])){if(!C[ge]&&vP(ge)&&(p.tagNameCheck instanceof RegExp&&Qn(p.tagNameCheck,ge)||p.tagNameCheck instanceof Function&&p.tagNameCheck(ge)))return!1;if(be&&!Re[ge]){const It=M(N)||N.parentNode,Ln=b(N)||N.childNodes;if(Ln&&It){const sn=Ln.length;for(let dr=sn-1;dr>=0;--dr){const es=w(Ln[dr],!0);es.__removalCount=(N.__removalCount||0)+1,It.insertBefore(es,T(N))}}}return lo(N),!0}return N instanceof l&&!UW(N)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&Qn(/<\/no(script|embed|frames)/i,N.innerHTML)?(lo(N),!0):(x&&N.nodeType===Sh.text&&(Q=N.textContent,ng([z,ae,ee],It=>{Q=vh(Q,It," ")}),N.textContent!==Q&&(wh(e.removed,{element:N.cloneNode()}),N.textContent=Q)),Jo(X.afterSanitizeElements,N,null),!1)},wP=function(N,Q,ge){if(q&&(Q==="id"||Q==="name")&&(ge in n||ge in jW))return!1;if(!(v&&!k[Q]&&Qn(ce,Q))){if(!(j&&Qn(Et,Q))){if(!(F.attributeCheck instanceof Function&&F.attributeCheck(Q,N))){if(!it[Q]||k[Q]){if(!(vP(N)&&(p.tagNameCheck instanceof RegExp&&Qn(p.tagNameCheck,N)||p.tagNameCheck instanceof Function&&p.tagNameCheck(N))&&(p.attributeNameCheck instanceof RegExp&&Qn(p.attributeNameCheck,Q)||p.attributeNameCheck instanceof Function&&p.attributeNameCheck(Q,N))||Q==="is"&&p.allowCustomizedBuiltInElements&&(p.tagNameCheck instanceof RegExp&&Qn(p.tagNameCheck,ge)||p.tagNameCheck instanceof Function&&p.tagNameCheck(ge))))return!1}else if(!Hr[Q]){if(!Qn(ut,vh(ge,Ye,""))){if(!((Q==="src"||Q==="xlink:href"||Q==="href")&&N!=="script"&&Cj(ge,"data:")===0&&qe[N])){if(!(S&&!Qn($e,vh(ge,Ye,"")))){if(ge)return!1}}}}}}}return!0},vP=function(N){return N!=="annotation-xml"&&Gy(N,St)},CP=function(N){Jo(X.beforeSanitizeAttributes,N,null);const{attributes:Q}=N;if(!Q||yv(N))return;const ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:it,forceKeepAttr:void 0};let It=Q.length;for(;It--;){const Ln=Q[It],{name:sn,namespaceURI:dr,value:es}=Ln,bu=En(sn),Sv=es;let An=sn==="value"?Sv:yj(Sv);if(ge.attrName=bu,ge.attrValue=An,ge.keepAttr=!0,ge.forceKeepAttr=void 0,Jo(X.uponSanitizeAttribute,N,ge),An=ge.attrValue,J&&(bu==="id"||bu==="name")&&(Xa(sn,N),An=se+An),E&&Qn(/((--!?|])>)|<\/(style|title|textarea)/i,An)){Xa(sn,N);continue}if(bu==="attributename"&&Gy(An,"href")){Xa(sn,N);continue}if(ge.forceKeepAttr)continue;if(!ge.keepAttr){Xa(sn,N);continue}if(!_&&Qn(/\/>/i,An)){Xa(sn,N);continue}x&&ng([z,ae,ee],SP=>{An=vh(An,SP," ")});const yP=En(N.nodeName);if(!wP(yP,bu,An)){Xa(sn,N);continue}if(R&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!dr)switch(f.getAttributeType(yP,bu)){case"TrustedHTML":{An=R.createHTML(An);break}case"TrustedScriptURL":{An=R.createScriptURL(An);break}}if(An!==Sv)try{dr?N.setAttributeNS(dr,sn,An):N.setAttribute(sn,An),yv(N)?lo(N):Lx(e.removed)}catch{Xa(sn,N)}}Jo(X.afterSanitizeAttributes,N,null)},zW=function we(N){let Q=null;const ge=gP(N);for(Jo(X.beforeSanitizeShadowDOM,N,null);Q=ge.nextNode();)Jo(X.uponSanitizeShadowNode,Q,null),pP(Q),CP(Q),Q.content instanceof o&&we(Q.content);Jo(X.afterSanitizeShadowDOM,N,null)};return e.sanitize=function(we){let N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Q=null,ge=null,It=null,Ln=null;if(ot=!we,ot&&(we="<!-->"),typeof we!="string"&&!mP(we))if(typeof we.toString=="function"){if(we=we.toString(),typeof we!="string")throw Ch("dirty is not a string, aborting")}else throw Ch("toString is not a function");if(!e.isSupported)return we;if($||Cv(N),e.removed=[],typeof we=="string"&&(je=!1),je){if(we.nodeName){const es=En(we.nodeName);if(!ct[es]||C[es])throw Ch("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof a)Q=fP("<!---->"),ge=Q.ownerDocument.importNode(we,!0),ge.nodeType===Sh.element&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?Q=ge:Q.appendChild(ge);else{if(!L&&!x&&!H&&we.indexOf("<")===-1)return R&&V?R.createHTML(we):we;if(Q=fP(we),!Q)return L?null:V?D:""}Q&&A&&lo(Q.firstChild);const sn=gP(je?we:Q);for(;It=sn.nextNode();)pP(It),CP(It),It.content instanceof o&&zW(It.content);if(je)return we;if(L){if(B)for(Ln=U.call(Q.ownerDocument);Q.firstChild;)Ln.appendChild(Q.firstChild);else Ln=Q;return(it.shadowroot||it.shadowrootmode)&&(Ln=W.call(r,Ln,!0)),Ln}let dr=H?Q.outerHTML:Q.innerHTML;return H&&ct["!doctype"]&&Q.ownerDocument&&Q.ownerDocument.doctype&&Q.ownerDocument.doctype.name&&Qn(gk,Q.ownerDocument.doctype.name)&&(dr="<!DOCTYPE "+Q.ownerDocument.doctype.name+`>
`+dr),x&&ng([z,ae,ee],es=>{dr=vh(dr,es," ")}),R&&V?R.createHTML(dr):dr},e.setConfig=function(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cv(we),$=!0},e.clearConfig=function(){Su=null,$=!1},e.isValidAttribute=function(we,N,Q){Su||Cv({});const ge=En(we),It=En(N);return wP(ge,It,Q)},e.addHook=function(we,N){typeof N=="function"&&wh(X[we],N)},e.removeHook=function(we,N){if(N!==void 0){const Q=wj(X[we],N);return Q===-1?void 0:vj(X[we],Q,1)[0]}return Lx(X[we])},e.removeHooks=function(we){X[we]=[]},e.removeAllHooks=function(){X=jx()},e}var Dj=mk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var pk;function K(){return pk.apply(null,arguments)}function kj(t){pk=t}function no(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function tu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function tt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s0(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(tt(t,e))return!1;return!0}function br(t){return t===void 0}function Ns(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function xf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function wk(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function _a(t,e){for(var n in e)tt(e,n)&&(t[n]=e[n]);return tt(e,"toString")&&(t.toString=e.toString),tt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function qo(t,e,n,r){return Vk(t,e,n,r,!0).utc()}function Lj(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ae(t){return t._pf==null&&(t._pf=Lj()),t._pf}var VR;Array.prototype.some?VR=Array.prototype.some:VR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function a0(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ae(t),n=VR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function Sw(t){var e=qo(NaN);return t!=null?_a(Ae(e),t):Ae(e).userInvalidated=!0,e}var Ux=K.momentProperties=[],Qy=!1;function l0(t,e){var n,r,i,o=Ux.length;if(br(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),br(e._i)||(t._i=e._i),br(e._f)||(t._f=e._f),br(e._l)||(t._l=e._l),br(e._strict)||(t._strict=e._strict),br(e._tzm)||(t._tzm=e._tzm),br(e._isUTC)||(t._isUTC=e._isUTC),br(e._offset)||(t._offset=e._offset),br(e._pf)||(t._pf=Ae(e)),br(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=Ux[n],i=e[r],br(i)||(t[r]=i);return t}function Af(t){l0(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Qy===!1&&(Qy=!0,K.updateOffset(this),Qy=!1)}function ro(t){return t instanceof Af||t!=null&&t._isAMomentObject!=null}function vk(t){K.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Oi(t,e){var n=!0;return _a(function(){if(K.deprecationHandler!=null&&K.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])tt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}vk(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var zx={};function Ck(t,e){K.deprecationHandler!=null&&K.deprecationHandler(t,e),zx[t]||(vk(e),zx[t]=!0)}K.suppressDeprecationWarnings=!1;K.deprecationHandler=null;function Ko(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function $j(t){var e,n;for(n in t)tt(t,n)&&(e=t[n],Ko(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function WR(t,e){var n=_a({},t),r;for(r in e)tt(e,r)&&(tu(t[r])&&tu(e[r])?(n[r]={},_a(n[r],t[r]),_a(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)tt(t,r)&&!tt(e,r)&&tu(t[r])&&(n[r]=_a({},n[r]));return n}function u0(t){t!=null&&this.set(t)}var BR;Object.keys?BR=Object.keys:BR=function(t){var e,n=[];for(e in t)tt(t,e)&&n.push(e);return n};var Fj={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Vj(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Ko(r)?r.call(e,n):r}function Uo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var c0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ig=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Jy={},Ac={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Ac[t]=i),e&&(Ac[e[0]]=function(){return Uo(i.apply(this,arguments),e[1],e[2])}),n&&(Ac[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Wj(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Bj(t){var e=t.match(c0),n,r;for(n=0,r=e.length;n<r;n++)Ac[e[n]]?e[n]=Ac[e[n]]:e[n]=Wj(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Ko(e[s])?e[s].call(i,t):e[s];return o}}function Fm(t,e){return t.isValid()?(e=yk(e,t.localeData()),Jy[e]=Jy[e]||Bj(e),Jy[e](t)):t.localeData().invalidDate()}function yk(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(ig.lastIndex=0;n>=0&&ig.test(t);)t=t.replace(ig,r),ig.lastIndex=0,n-=1;return t}var jj={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Uj(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(c0).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var zj="Invalid date";function Yj(){return this._invalidDate}var Gj="%d",qj=/\d{1,2}/;function Kj(t){return this._ordinal.replace("%d",t)}var Xj={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Zj(t,e,n,r){var i=this._relativeTime[n];return Ko(i)?i(t,e,n,r):i.replace(/%d/i,t)}function Qj(t,e){var n=this._relativeTime[t>0?"future":"past"];return Ko(n)?n(e):n.replace(/%s/i,e)}var Yx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function xi(t){return typeof t=="string"?Yx[t]||Yx[t.toLowerCase()]:void 0}function h0(t){var e={},n,r;for(r in t)tt(t,r)&&(n=xi(r),n&&(e[n]=t[r]));return e}var Jj={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function eU(t){var e=[],n;for(n in t)tt(t,n)&&e.push({unit:n,priority:Jj[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var Sk=/\d/,ii=/\d\d/,bk=/\d{3}/,d0=/\d{4}/,bw=/[+-]?\d{6}/,Pt=/\d\d?/,Rk=/\d\d\d\d?/,Ek=/\d\d\d\d\d\d?/,Rw=/\d{1,3}/,f0=/\d{1,4}/,Ew=/[+-]?\d{1,6}/,ih=/\d+/,Tw=/[+-]?\d+/,tU=/Z|[+-]\d\d:?\d\d/gi,_w=/Z|[+-]\d\d(?::?\d\d)?/gi,nU=/[+-]?\d+(\.\d{1,3})?/,Hf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,oh=/^[1-9]\d?/,g0=/^([1-9]\d|\d)/,cp;cp={};function ue(t,e,n){cp[t]=Ko(e)?e:function(r,i){return r&&n?n:e}}function rU(t,e){return tt(cp,t)?cp[t](e._strict,e._locale):new RegExp(iU(t))}function iU(t){return As(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function As(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Si(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ze(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Si(e)),n}var jR={};function wt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ns(e)&&(r=function(o,s){s[e]=ze(o)}),i=t.length,n=0;n<i;n++)jR[t[n]]=r}function Nf(t,e){wt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function oU(t,e,n){e!=null&&tt(jR,t)&&jR[t](e,n._a,n,t)}function Mw(t){return t%4===0&&t%100!==0||t%400===0}var qn=0,Ts=1,ko=2,Sn=3,Ji=4,_s=5,Yl=6,sU=7,aU=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Uo(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Tw);ue("YY",Pt,ii);ue("YYYY",f0,d0);ue("YYYYY",Ew,bw);ue("YYYYYY",Ew,bw);wt(["YYYYY","YYYYYY"],qn);wt("YYYY",function(t,e){e[qn]=t.length===2?K.parseTwoDigitYear(t):ze(t)});wt("YY",function(t,e){e[qn]=K.parseTwoDigitYear(t)});wt("Y",function(t,e){e[qn]=parseInt(t,10)});function Pd(t){return Mw(t)?366:365}K.parseTwoDigitYear=function(t){return ze(t)+(ze(t)>68?1900:2e3)};var Tk=sh("FullYear",!0);function lU(){return Mw(this.year())}function sh(t,e){return function(n){return n!=null?(_k(this,t,n),K.updateOffset(this,e),this):ef(this,t)}}function ef(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function _k(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Mw(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function uU(t){return t=xi(t),Ko(this[t])?this[t]():this}function cU(t,e){if(typeof t=="object"){t=h0(t);var n=eU(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=xi(t),Ko(this[t]))return this[t](e);return this}function hU(t,e){return(t%e+e)%e}var Qt;Array.prototype.indexOf?Qt=Array.prototype.indexOf:Qt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function m0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=hU(e,12);return t+=(e-n)/12,n===1?Mw(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Pt,oh);ue("MM",Pt,ii);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});wt(["M","MM"],function(t,e){e[Ts]=ze(t)-1});wt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Ts]=i:Ae(n).invalidMonth=t});var dU="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Mk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Pk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,fU=Hf,gU=Hf;function mU(t,e){return t?no(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Pk).test(e)?"format":"standalone"][t.month()]:no(this._months)?this._months:this._months.standalone}function pU(t,e){return t?no(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Pk.test(e)?"format":"standalone"][t.month()]:no(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function wU(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=qo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null))}function vU(t,e,n){var r,i,o;if(this._monthsParseExact)return wU.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=qo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function Ik(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ze(e);else if(e=t.localeData().monthsParse(e),!Ns(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,m0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function Ok(t){return t!=null?(Ik(this,t),K.updateOffset(this,!0),this):ef(this,"Month")}function CU(){return m0(this.year(),this.month())}function yU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||xk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(tt(this,"_monthsShortRegex")||(this._monthsShortRegex=fU),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function SU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||xk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(tt(this,"_monthsRegex")||(this._monthsRegex=gU),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function xk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=qo([2e3,i]),s=As(this.monthsShort(o,"")),a=As(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function bU(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function tf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function hp(t,e,n){var r=7+e-n,i=(7+tf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function Ak(t,e,n,r,i){var o=(7+n-r)%7,s=hp(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Pd(l)+a):a>Pd(t)?(l=t+1,u=a-Pd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function nf(t,e,n){var r=hp(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Hs(s,e,n)):i>Hs(t.year(),e,n)?(o=i-Hs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Hs(t,e,n){var r=hp(t,e,n),i=hp(t+1,e,n);return(Pd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",Pt,oh);ue("ww",Pt,ii);ue("W",Pt,oh);ue("WW",Pt,ii);Nf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=ze(t)});function RU(t){return nf(t,this._week.dow,this._week.doy).week}var EU={dow:0,doy:6};function TU(){return this._week.dow}function _U(){return this._week.doy}function MU(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function PU(t){var e=nf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",Pt);ue("e",Pt);ue("E",Pt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Nf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ae(n).invalidWeekday=t});Nf(["d","e","E"],function(t,e,n,r){e[r]=ze(t)});function IU(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function OU(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function p0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var xU="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Hk="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),AU="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),HU=Hf,NU=Hf,DU=Hf;function kU(t,e){var n=no(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?p0(n,this._week.dow):t?n[t.day()]:n}function LU(t){return t===!0?p0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function $U(t){return t===!0?p0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function FU(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=qo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1||(i=Qt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qt.call(this._minWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function VU(t,e,n){var r,i,o;if(this._weekdaysParseExact)return FU.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=qo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function WU(t){if(!this.isValid())return t!=null?this:NaN;var e=ef(this,"Day");return t!=null?(t=IU(t,this.localeData()),this.add(t-e,"d")):e}function BU(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function jU(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=OU(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function UU(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||w0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(tt(this,"_weekdaysRegex")||(this._weekdaysRegex=HU),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function zU(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||w0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(tt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=NU),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function YU(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||w0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(tt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=DU),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function w0(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=qo([2e3,1]).day(o),a=As(this.weekdaysMin(s,"")),l=As(this.weekdaysShort(s,"")),u=As(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function v0(){return this.hours()%12||12}function GU(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,v0);Ce("k",["kk",2],0,GU);Ce("hmm",0,0,function(){return""+v0.apply(this)+Uo(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+v0.apply(this)+Uo(this.minutes(),2)+Uo(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Uo(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Uo(this.minutes(),2)+Uo(this.seconds(),2)});function Nk(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Nk("a",!0);Nk("A",!1);function Dk(t,e){return e._meridiemParse}ue("a",Dk);ue("A",Dk);ue("H",Pt,g0);ue("h",Pt,oh);ue("k",Pt,oh);ue("HH",Pt,ii);ue("hh",Pt,ii);ue("kk",Pt,ii);ue("hmm",Rk);ue("hmmss",Ek);ue("Hmm",Rk);ue("Hmmss",Ek);wt(["H","HH"],Sn);wt(["k","kk"],function(t,e,n){var r=ze(t);e[Sn]=r===24?0:r});wt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wt(["h","hh"],function(t,e,n){e[Sn]=ze(t),Ae(n).bigHour=!0});wt("hmm",function(t,e,n){var r=t.length-2;e[Sn]=ze(t.substr(0,r)),e[Ji]=ze(t.substr(r)),Ae(n).bigHour=!0});wt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Sn]=ze(t.substr(0,r)),e[Ji]=ze(t.substr(r,2)),e[_s]=ze(t.substr(i)),Ae(n).bigHour=!0});wt("Hmm",function(t,e,n){var r=t.length-2;e[Sn]=ze(t.substr(0,r)),e[Ji]=ze(t.substr(r))});wt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Sn]=ze(t.substr(0,r)),e[Ji]=ze(t.substr(r,2)),e[_s]=ze(t.substr(i))});function qU(t){return(t+"").toLowerCase().charAt(0)==="p"}var KU=/[ap]\.?m?\.?/i,XU=sh("Hours",!0);function ZU(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var kk={calendar:Fj,longDateFormat:jj,invalidDate:zj,ordinal:Gj,dayOfMonthOrdinalParse:qj,relativeTime:Xj,months:dU,monthsShort:Mk,week:EU,weekdays:xU,weekdaysMin:AU,weekdaysShort:Hk,meridiemParse:KU},Ht={},bh={},rf;function QU(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function Gx(t){return t&&t.toLowerCase().replace("_","-")}function JU(t){for(var e=0,n,r,i,o;e<t.length;){for(o=Gx(t[e]).split("-"),n=o.length,r=Gx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Pw(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&QU(o,r)>=n-1)break;n--}e++}return rf}function ez(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Pw(t){var e=null,n;if(Ht[t]===void 0&&typeof module<"u"&&module&&module.exports&&ez(t))try{e=rf._abbr,n=require,n("./locale/"+t),Aa(e)}catch{Ht[t]=null}return Ht[t]}function Aa(t,e){var n;return t&&(br(e)?n=$s(t):n=C0(t,e),n?rf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),rf._abbr}function C0(t,e){if(e!==null){var n,r=kk;if(e.abbr=t,Ht[t]!=null)Ck("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ht[t]._config;else if(e.parentLocale!=null)if(Ht[e.parentLocale]!=null)r=Ht[e.parentLocale]._config;else if(n=Pw(e.parentLocale),n!=null)r=n._config;else return bh[e.parentLocale]||(bh[e.parentLocale]=[]),bh[e.parentLocale].push({name:t,config:e}),null;return Ht[t]=new u0(WR(r,e)),bh[t]&&bh[t].forEach(function(i){C0(i.name,i.config)}),Aa(t),Ht[t]}else return delete Ht[t],null}function tz(t,e){if(e!=null){var n,r,i=kk;Ht[t]!=null&&Ht[t].parentLocale!=null?Ht[t].set(WR(Ht[t]._config,e)):(r=Pw(t),r!=null&&(i=r._config),e=WR(i,e),r==null&&(e.abbr=t),n=new u0(e),n.parentLocale=Ht[t],Ht[t]=n),Aa(t)}else Ht[t]!=null&&(Ht[t].parentLocale!=null?(Ht[t]=Ht[t].parentLocale,t===Aa()&&Aa(t)):Ht[t]!=null&&delete Ht[t]);return Ht[t]}function $s(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return rf;if(!no(t)){if(e=Pw(t),e)return e;t=[t]}return JU(t)}function nz(){return BR(Ht)}function y0(t){var e,n=t._a;return n&&Ae(t).overflow===-2&&(e=n[Ts]<0||n[Ts]>11?Ts:n[ko]<1||n[ko]>m0(n[qn],n[Ts])?ko:n[Sn]<0||n[Sn]>24||n[Sn]===24&&(n[Ji]!==0||n[_s]!==0||n[Yl]!==0)?Sn:n[Ji]<0||n[Ji]>59?Ji:n[_s]<0||n[_s]>59?_s:n[Yl]<0||n[Yl]>999?Yl:-1,Ae(t)._overflowDayOfYear&&(e<qn||e>ko)&&(e=ko),Ae(t)._overflowWeeks&&e===-1&&(e=sU),Ae(t)._overflowWeekday&&e===-1&&(e=aU),Ae(t).overflow=e),t}var rz=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,iz=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,oz=/Z|[+-]\d\d(?::?\d\d)?/,og=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],eS=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],sz=/^\/?Date\((-?\d+)/i,az=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,lz={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Lk(t){var e,n,r=t._i,i=rz.exec(r)||iz.exec(r),o,s,a,l,u=og.length,c=eS.length;if(i){for(Ae(t).iso=!0,e=0,n=u;e<n;e++)if(og[e][1].exec(i[1])){s=og[e][0],o=og[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(eS[e][1].exec(i[3])){a=(i[2]||" ")+eS[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(oz.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),b0(t)}else t._isValid=!1}function uz(t,e,n,r,i,o){var s=[cz(t),Mk.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function cz(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function hz(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function dz(t,e,n){if(t){var r=Hk.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ae(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function fz(t,e,n){if(t)return lz[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function $k(t){var e=az.exec(hz(t._i)),n;if(e){if(n=uz(e[4],e[3],e[2],e[5],e[6],e[7]),!dz(e[1],n,t))return;t._a=n,t._tzm=fz(e[8],e[9],e[10]),t._d=tf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ae(t).rfc2822=!0}else t._isValid=!1}function gz(t){var e=sz.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Lk(t),t._isValid===!1)delete t._isValid;else return;if($k(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:K.createFromInputFallback(t)}K.createFromInputFallback=Oi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function hc(t,e,n){return t??e??n}function mz(t){var e=new Date(K.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function S0(t){var e,n,r=[],i,o,s;if(!t._d){for(i=mz(t),t._w&&t._a[ko]==null&&t._a[Ts]==null&&pz(t),t._dayOfYear!=null&&(s=hc(t._a[qn],i[qn]),(t._dayOfYear>Pd(s)||t._dayOfYear===0)&&(Ae(t)._overflowDayOfYear=!0),n=tf(s,0,t._dayOfYear),t._a[Ts]=n.getUTCMonth(),t._a[ko]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Sn]===24&&t._a[Ji]===0&&t._a[_s]===0&&t._a[Yl]===0&&(t._nextDay=!0,t._a[Sn]=0),t._d=(t._useUTC?tf:bU).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Sn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ae(t).weekdayMismatch=!0)}}function pz(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=hc(e.GG,t._a[qn],nf(Mt(),1,4).year),r=hc(e.W,1),i=hc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=nf(Mt(),o,s),n=hc(e.gg,t._a[qn],u.year),r=hc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Hs(n,o,s)?Ae(t)._overflowWeeks=!0:l!=null?Ae(t)._overflowWeekday=!0:(a=Ak(n,r,i,o,s),t._a[qn]=a.year,t._dayOfYear=a.dayOfYear)}K.ISO_8601=function(){};K.RFC_2822=function(){};function b0(t){if(t._f===K.ISO_8601){Lk(t);return}if(t._f===K.RFC_2822){$k(t);return}t._a=[],Ae(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=yk(t._f,t._locale).match(c0)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(rU(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ae(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Ac[o]?(r?Ae(t).empty=!1:Ae(t).unusedTokens.push(o),oU(o,r,t)):t._strict&&!r&&Ae(t).unusedTokens.push(o);Ae(t).charsLeftOver=a-l,e.length>0&&Ae(t).unusedInput.push(e),t._a[Sn]<=12&&Ae(t).bigHour===!0&&t._a[Sn]>0&&(Ae(t).bigHour=void 0),Ae(t).parsedDateParts=t._a.slice(0),Ae(t).meridiem=t._meridiem,t._a[Sn]=wz(t._locale,t._a[Sn],t._meridiem),u=Ae(t).era,u!==null&&(t._a[qn]=t._locale.erasConvertYear(u,t._a[qn])),S0(t),y0(t)}function wz(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function vz(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ae(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=l0({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],b0(e),a0(e)&&(s=!0),o+=Ae(e).charsLeftOver,o+=Ae(e).unusedTokens.length*10,Ae(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));_a(t,n||e)}function Cz(t){if(!t._d){var e=h0(t._i),n=e.day===void 0?e.date:e.day;t._a=wk([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),S0(t)}}function yz(t){var e=new Af(y0(Fk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Fk(t){var e=t._i,n=t._f;return t._locale=t._locale||$s(t._l),e===null||n===void 0&&e===""?Sw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ro(e)?new Af(y0(e)):(xf(e)?t._d=e:no(n)?vz(t):n?b0(t):Sz(t),a0(t)||(t._d=null),t))}function Sz(t){var e=t._i;br(e)?t._d=new Date(K.now()):xf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?gz(t):no(e)?(t._a=wk(e.slice(0),function(n){return parseInt(n,10)}),S0(t)):tu(e)?Cz(t):Ns(e)?t._d=new Date(e):K.createFromInputFallback(t)}function Vk(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(tu(t)&&s0(t)||no(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,yz(o)}function Mt(t,e,n,r){return Vk(t,e,n,r,!1)}var bz=Oi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Mt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Sw()}),Rz=Oi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Mt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Sw()});function Wk(t,e){var n,r;if(e.length===1&&no(e[0])&&(e=e[0]),!e.length)return Mt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function Ez(){var t=[].slice.call(arguments,0);return Wk("isBefore",t)}function Tz(){var t=[].slice.call(arguments,0);return Wk("isAfter",t)}var _z=function(){return Date.now?Date.now():+new Date},Rh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Mz(t){var e,n=!1,r,i=Rh.length;for(e in t)if(tt(t,e)&&!(Qt.call(Rh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Rh[r]]){if(n)return!1;parseFloat(t[Rh[r]])!==ze(t[Rh[r]])&&(n=!0)}return!0}function Pz(){return this._isValid}function Iz(){return so(NaN)}function Iw(t){var e=h0(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Mz(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=$s(),this._bubble()}function Vm(t){return t instanceof Iw}function UR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Oz(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)ze(t[s])!==ze(e[s])&&o++;return o+i}function Bk(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Uo(~~(n/60),2)+e+Uo(~~n%60,2)})}Bk("Z",":");Bk("ZZ","");ue("Z",_w);ue("ZZ",_w);wt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=R0(_w,t)});var xz=/([\+\-]|\d\d)/gi;function R0(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(xz)||["-",0,0],o=+(i[1]*60)+ze(i[2]),o===0?0:i[0]==="+"?o:-o)}function E0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ro(t)||xf(t)?t.valueOf():Mt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),K.updateOffset(n,!1),n):Mt(t).local()}function zR(t){return-Math.round(t._d.getTimezoneOffset())}K.updateOffset=function(){};function Az(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=R0(_w,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=zR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?zk(this,so(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,K.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:zR(this)}function Hz(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Nz(t){return this.utcOffset(0,t)}function Dz(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(zR(this),"m")),this}function kz(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=R0(tU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Lz(t){return this.isValid()?(t=t?Mt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function $z(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Fz(){if(!br(this._isDSTShifted))return this._isDSTShifted;var t={},e;return l0(t,this),t=Fk(t),t._a?(e=t._isUTC?qo(t._a):Mt(t._a),this._isDSTShifted=this.isValid()&&Oz(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Vz(){return this.isValid()?!this._isUTC:!1}function Wz(){return this.isValid()?this._isUTC:!1}function jk(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Bz=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,jz=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function so(t,e){var n=t,r=null,i,o,s;return Vm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ns(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=Bz.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:ze(r[ko])*i,h:ze(r[Sn])*i,m:ze(r[Ji])*i,s:ze(r[_s])*i,ms:ze(UR(r[Yl]*1e3))*i}):(r=jz.exec(t))?(i=r[1]==="-"?-1:1,n={y:Za(r[2],i),M:Za(r[3],i),w:Za(r[4],i),d:Za(r[5],i),h:Za(r[6],i),m:Za(r[7],i),s:Za(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Uz(Mt(n.from),Mt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Iw(n),Vm(t)&&tt(t,"_locale")&&(o._locale=t._locale),Vm(t)&&tt(t,"_isValid")&&(o._isValid=t._isValid),o}so.fn=Iw.prototype;so.invalid=Iz;function Za(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function qx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Uz(t,e){var n;return t.isValid()&&e.isValid()?(e=E0(e,t),t.isBefore(e)?n=qx(t,e):(n=qx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Uk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(Ck(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=so(n,r),zk(this,i,t),this}}function zk(t,e,n,r){var i=e._milliseconds,o=UR(e._days),s=UR(e._months);t.isValid()&&(r=r??!0,s&&Ik(t,ef(t,"Month")+s*n),o&&_k(t,"Date",ef(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&K.updateOffset(t,o||s))}var zz=Uk(1,"add"),Yz=Uk(-1,"subtract");function Yk(t){return typeof t=="string"||t instanceof String}function Gz(t){return ro(t)||xf(t)||Yk(t)||Ns(t)||Kz(t)||qz(t)||t===null||t===void 0}function qz(t){var e=tu(t)&&!s0(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||tt(t,o);return e&&n}function Kz(t){var e=no(t),n=!1;return e&&(n=t.filter(function(r){return!Ns(r)&&Yk(t)}).length===0),e&&n}function Xz(t){var e=tu(t)&&!s0(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||tt(t,o);return e&&n}function Zz(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Qz(t,e){arguments.length===1&&(arguments[0]?Gz(arguments[0])?(t=arguments[0],e=void 0):Xz(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Mt(),r=E0(n,this).startOf("day"),i=K.calendarFormat(this,r)||"sameElse",o=e&&(Ko(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Mt(n)))}function Jz(){return new Af(this)}function eY(t,e){var n=ro(t)?t:Mt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function tY(t,e){var n=ro(t)?t:Mt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function nY(t,e,n,r){var i=ro(t)?t:Mt(t),o=ro(e)?e:Mt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function rY(t,e){var n=ro(t)?t:Mt(t),r;return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function iY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function oY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function sY(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=E0(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=xi(e),e){case"year":o=Wm(this,r)/12;break;case"month":o=Wm(this,r);break;case"quarter":o=Wm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Si(o)}function Wm(t,e){if(t.date()<e.date())return-Wm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}K.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";K.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function aY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Fm(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ko(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Fm(n,"Z")):Fm(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function uY(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function cY(t){t||(t=this.isUtc()?K.defaultFormatUtc:K.defaultFormat);var e=Fm(this,t);return this.localeData().postformat(e)}function hY(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Mt(t).isValid())?so({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function dY(t){return this.from(Mt(),t)}function fY(t,e){return this.isValid()&&(ro(t)&&t.isValid()||Mt(t).isValid())?so({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function gY(t){return this.to(Mt(),t)}function Gk(t){var e;return t===void 0?this._locale._abbr:(e=$s(t),e!=null&&(this._locale=e),this)}var qk=Oi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Kk(){return this._locale}var dp=1e3,Hc=60*dp,fp=60*Hc,Xk=(365*400+97)*24*fp;function Nc(t,e){return(t%e+e)%e}function Zk(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Xk:new Date(t,e,n).valueOf()}function Qk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Xk:Date.UTC(t,e,n)}function mY(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Qk:Zk,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Nc(e+(this._isUTC?0:this.utcOffset()*Hc),fp);break;case"minute":e=this._d.valueOf(),e-=Nc(e,Hc);break;case"second":e=this._d.valueOf(),e-=Nc(e,dp);break}return this._d.setTime(e),K.updateOffset(this,!0),this}function pY(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Qk:Zk,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=fp-Nc(e+(this._isUTC?0:this.utcOffset()*Hc),fp)-1;break;case"minute":e=this._d.valueOf(),e+=Hc-Nc(e,Hc)-1;break;case"second":e=this._d.valueOf(),e+=dp-Nc(e,dp)-1;break}return this._d.setTime(e),K.updateOffset(this,!0),this}function wY(){return this._d.valueOf()-(this._offset||0)*6e4}function vY(){return Math.floor(this.valueOf()/1e3)}function CY(){return new Date(this.valueOf())}function yY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function SY(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function bY(){return this.isValid()?this.toISOString():null}function RY(){return a0(this)}function EY(){return _a({},Ae(this))}function TY(){return Ae(this).overflow}function _Y(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",T0);ue("NN",T0);ue("NNN",T0);ue("NNNN",LY);ue("NNNNN",$Y);wt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ae(n).era=i:Ae(n).invalidEra=t});ue("y",ih);ue("yy",ih);ue("yyy",ih);ue("yyyy",ih);ue("yo",FY);wt(["y","yy","yyy","yyyy"],qn);wt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[qn]=n._locale.eraYearOrdinalParse(t,i):e[qn]=parseInt(t,10)});function MY(t,e){var n,r,i,o=this._eras||$s("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=K(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=K(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function PY(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function IY(t,e){var n=t.since<=t.until?1:-1;return e===void 0?K(t.since).year():K(t.since).year()+(e-t.offset)*n}function OY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function xY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function AY(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function HY(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-K(i[t].since).year())*n+i[t].offset;return this.year()}function NY(t){return tt(this,"_erasNameRegex")||_0.call(this),t?this._erasNameRegex:this._erasRegex}function DY(t){return tt(this,"_erasAbbrRegex")||_0.call(this),t?this._erasAbbrRegex:this._erasRegex}function kY(t){return tt(this,"_erasNarrowRegex")||_0.call(this),t?this._erasNarrowRegex:this._erasRegex}function T0(t,e){return e.erasAbbrRegex(t)}function LY(t,e){return e.erasNameRegex(t)}function $Y(t,e){return e.erasNarrowRegex(t)}function FY(t,e){return e._eraYearOrdinalRegex||ih}function _0(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=As(u[i].name),a=As(u[i].abbr),l=As(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ow(t,e){Ce(0,[t,t.length],0,e)}Ow("gggg","weekYear");Ow("ggggg","weekYear");Ow("GGGG","isoWeekYear");Ow("GGGGG","isoWeekYear");ue("G",Tw);ue("g",Tw);ue("GG",Pt,ii);ue("gg",Pt,ii);ue("GGGG",f0,d0);ue("gggg",f0,d0);ue("GGGGG",Ew,bw);ue("ggggg",Ew,bw);Nf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=ze(t)});Nf(["gg","GG"],function(t,e,n,r){e[r]=K.parseTwoDigitYear(t)});function VY(t){return Jk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function WY(t){return Jk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function BY(){return Hs(this.year(),1,4)}function jY(){return Hs(this.isoWeekYear(),1,4)}function UY(){var t=this.localeData()._week;return Hs(this.year(),t.dow,t.doy)}function zY(){var t=this.localeData()._week;return Hs(this.weekYear(),t.dow,t.doy)}function Jk(t,e,n,r,i){var o;return t==null?nf(this,r,i).year:(o=Hs(t,r,i),e>o&&(e=o),YY.call(this,t,e,n,r,i))}function YY(t,e,n,r,i){var o=Ak(t,e,n,r,i),s=tf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",Sk);wt("Q",function(t,e){e[Ts]=(ze(t)-1)*3});function GY(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",Pt,oh);ue("DD",Pt,ii);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wt(["D","DD"],ko);wt("Do",function(t,e){e[ko]=ze(t.match(Pt)[0])});var eL=sh("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Rw);ue("DDDD",bk);wt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ze(t)});function qY(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",Pt,g0);ue("mm",Pt,ii);wt(["m","mm"],Ji);var KY=sh("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",Pt,g0);ue("ss",Pt,ii);wt(["s","ss"],_s);var XY=sh("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Rw,Sk);ue("SS",Rw,ii);ue("SSS",Rw,bk);var Ma,tL;for(Ma="SSSS";Ma.length<=9;Ma+="S")ue(Ma,ih);function ZY(t,e){e[Yl]=ze(("0."+t)*1e3)}for(Ma="S";Ma.length<=9;Ma+="S")wt(Ma,ZY);tL=sh("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function QY(){return this._isUTC?"UTC":""}function JY(){return this._isUTC?"Coordinated Universal Time":""}var Z=Af.prototype;Z.add=zz;Z.calendar=Qz;Z.clone=Jz;Z.diff=sY;Z.endOf=pY;Z.format=cY;Z.from=hY;Z.fromNow=dY;Z.to=fY;Z.toNow=gY;Z.get=uU;Z.invalidAt=TY;Z.isAfter=eY;Z.isBefore=tY;Z.isBetween=nY;Z.isSame=rY;Z.isSameOrAfter=iY;Z.isSameOrBefore=oY;Z.isValid=RY;Z.lang=qk;Z.locale=Gk;Z.localeData=Kk;Z.max=Rz;Z.min=bz;Z.parsingFlags=EY;Z.set=cU;Z.startOf=mY;Z.subtract=Yz;Z.toArray=yY;Z.toObject=SY;Z.toDate=CY;Z.toISOString=lY;Z.inspect=uY;typeof Symbol<"u"&&Symbol.for!=null&&(Z[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Z.toJSON=bY;Z.toString=aY;Z.unix=vY;Z.valueOf=wY;Z.creationData=_Y;Z.eraName=OY;Z.eraNarrow=xY;Z.eraAbbr=AY;Z.eraYear=HY;Z.year=Tk;Z.isLeapYear=lU;Z.weekYear=VY;Z.isoWeekYear=WY;Z.quarter=Z.quarters=GY;Z.month=Ok;Z.daysInMonth=CU;Z.week=Z.weeks=MU;Z.isoWeek=Z.isoWeeks=PU;Z.weeksInYear=UY;Z.weeksInWeekYear=zY;Z.isoWeeksInYear=BY;Z.isoWeeksInISOWeekYear=jY;Z.date=eL;Z.day=Z.days=WU;Z.weekday=BU;Z.isoWeekday=jU;Z.dayOfYear=qY;Z.hour=Z.hours=XU;Z.minute=Z.minutes=KY;Z.second=Z.seconds=XY;Z.millisecond=Z.milliseconds=tL;Z.utcOffset=Az;Z.utc=Nz;Z.local=Dz;Z.parseZone=kz;Z.hasAlignedHourOffset=Lz;Z.isDST=$z;Z.isLocal=Vz;Z.isUtcOffset=Wz;Z.isUtc=jk;Z.isUTC=jk;Z.zoneAbbr=QY;Z.zoneName=JY;Z.dates=Oi("dates accessor is deprecated. Use date instead.",eL);Z.months=Oi("months accessor is deprecated. Use month instead",Ok);Z.years=Oi("years accessor is deprecated. Use year instead",Tk);Z.zone=Oi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Hz);Z.isDSTShifted=Oi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Fz);function eG(t){return Mt(t*1e3)}function tG(){return Mt.apply(null,arguments).parseZone()}function nL(t){return t}var nt=u0.prototype;nt.calendar=Vj;nt.longDateFormat=Uj;nt.invalidDate=Yj;nt.ordinal=Kj;nt.preparse=nL;nt.postformat=nL;nt.relativeTime=Zj;nt.pastFuture=Qj;nt.set=$j;nt.eras=MY;nt.erasParse=PY;nt.erasConvertYear=IY;nt.erasAbbrRegex=DY;nt.erasNameRegex=NY;nt.erasNarrowRegex=kY;nt.months=mU;nt.monthsShort=pU;nt.monthsParse=vU;nt.monthsRegex=SU;nt.monthsShortRegex=yU;nt.week=RU;nt.firstDayOfYear=_U;nt.firstDayOfWeek=TU;nt.weekdays=kU;nt.weekdaysMin=$U;nt.weekdaysShort=LU;nt.weekdaysParse=VU;nt.weekdaysRegex=UU;nt.weekdaysShortRegex=zU;nt.weekdaysMinRegex=YU;nt.isPM=qU;nt.meridiem=ZU;function gp(t,e,n,r){var i=$s(),o=qo().set(r,e);return i[n](o,t)}function rL(t,e,n){if(Ns(t)&&(e=t,t=void 0),t=t||"",e!=null)return gp(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=gp(t,r,n,"month");return i}function M0(t,e,n,r){typeof t=="boolean"?(Ns(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ns(e)&&(n=e,e=void 0),e=e||"");var i=$s(),o=t?i._week.dow:0,s,a=[];if(n!=null)return gp(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=gp(e,(s+o)%7,r,"day");return a}function nG(t,e){return rL(t,e,"months")}function rG(t,e){return rL(t,e,"monthsShort")}function iG(t,e,n){return M0(t,e,n,"weekdays")}function oG(t,e,n){return M0(t,e,n,"weekdaysShort")}function sG(t,e,n){return M0(t,e,n,"weekdaysMin")}Aa("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ze(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});K.lang=Oi("moment.lang is deprecated. Use moment.locale instead.",Aa);K.langData=Oi("moment.langData is deprecated. Use moment.localeData instead.",$s);var ts=Math.abs;function aG(){var t=this._data;return this._milliseconds=ts(this._milliseconds),this._days=ts(this._days),this._months=ts(this._months),t.milliseconds=ts(t.milliseconds),t.seconds=ts(t.seconds),t.minutes=ts(t.minutes),t.hours=ts(t.hours),t.months=ts(t.months),t.years=ts(t.years),this}function iL(t,e,n,r){var i=so(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function lG(t,e){return iL(this,t,e,1)}function uG(t,e){return iL(this,t,e,-1)}function Kx(t){return t<0?Math.floor(t):Math.ceil(t)}function cG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Kx(YR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Si(t/1e3),r.seconds=i%60,o=Si(i/60),r.minutes=o%60,s=Si(o/60),r.hours=s%24,e+=Si(s/24),l=Si(oL(e)),n+=l,e-=Kx(YR(l)),a=Si(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function oL(t){return t*4800/146097}function YR(t){return t*146097/4800}function hG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=xi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+oL(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(YR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Fs(t){return function(){return this.as(t)}}var sL=Fs("ms"),dG=Fs("s"),fG=Fs("m"),gG=Fs("h"),mG=Fs("d"),pG=Fs("w"),wG=Fs("M"),vG=Fs("Q"),CG=Fs("y"),yG=sL;function SG(){return so(this)}function bG(t){return t=xi(t),this.isValid()?this[t+"s"]():NaN}function wu(t){return function(){return this.isValid()?this._data[t]:NaN}}var RG=wu("milliseconds"),EG=wu("seconds"),TG=wu("minutes"),_G=wu("hours"),MG=wu("days"),PG=wu("months"),IG=wu("years");function OG(){return Si(this.days()/7)}var vs=Math.round,Sc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function xG(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function AG(t,e,n,r){var i=so(t).abs(),o=vs(i.as("s")),s=vs(i.as("m")),a=vs(i.as("h")),l=vs(i.as("d")),u=vs(i.as("M")),c=vs(i.as("w")),h=vs(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,xG.apply(null,d)}function HG(t){return t===void 0?vs:typeof t=="function"?(vs=t,!0):!1}function NG(t,e){return Sc[t]===void 0?!1:e===void 0?Sc[t]:(Sc[t]=e,t==="s"&&(Sc.ss=e-1),!0)}function DG(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Sc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Sc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=AG(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var tS=Math.abs;function Ru(t){return(t>0)-(t<0)||+t}function xw(){if(!this.isValid())return this.localeData().invalidDate();var t=tS(this._milliseconds)/1e3,e=tS(this._days),n=tS(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Si(t/60),i=Si(r/60),t%=60,r%=60,o=Si(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ru(this._months)!==Ru(a)?"-":"",c=Ru(this._days)!==Ru(a)?"-":"",h=Ru(this._milliseconds)!==Ru(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ke=Iw.prototype;Ke.isValid=Pz;Ke.abs=aG;Ke.add=lG;Ke.subtract=uG;Ke.as=hG;Ke.asMilliseconds=sL;Ke.asSeconds=dG;Ke.asMinutes=fG;Ke.asHours=gG;Ke.asDays=mG;Ke.asWeeks=pG;Ke.asMonths=wG;Ke.asQuarters=vG;Ke.asYears=CG;Ke.valueOf=yG;Ke._bubble=cG;Ke.clone=SG;Ke.get=bG;Ke.milliseconds=RG;Ke.seconds=EG;Ke.minutes=TG;Ke.hours=_G;Ke.days=MG;Ke.weeks=OG;Ke.months=PG;Ke.years=IG;Ke.humanize=DG;Ke.toISOString=xw;Ke.toString=xw;Ke.toJSON=xw;Ke.locale=Gk;Ke.localeData=Kk;Ke.toIsoString=Oi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xw);Ke.lang=qk;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Tw);ue("X",nU);wt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wt("x",function(t,e,n){n._d=new Date(ze(t))});//! moment.js
K.version="2.30.1";kj(Mt);K.fn=Z;K.min=Ez;K.max=Tz;K.now=_z;K.utc=qo;K.unix=eG;K.months=nG;K.isDate=xf;K.locale=Aa;K.invalid=Sw;K.duration=so;K.isMoment=ro;K.weekdays=iG;K.parseZone=tG;K.localeData=$s;K.isDuration=Vm;K.monthsShort=rG;K.weekdaysMin=sG;K.defineLocale=C0;K.updateLocale=tz;K.locales=nz;K.weekdaysShort=oG;K.normalizeUnits=xi;K.relativeTimeRounding=HG;K.relativeTimeThreshold=NG;K.calendarFormat=Zz;K.prototype=Z;K.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Xx={},Zx={},Qx;function kG(){if(Qx)return Zx;Qx=1;var t=yt(),e=rh(),n=xr(),r=fn(),i=Go(),o=Ar(),s=za(),a=Pf(),l=cn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(b){o(this,"throw",b)}var m=arguments.length<2,w=m?void 0:arguments[1];if(h)return a(h,this,m?[f]:[f,w]);var y=i(this),T=0;if(e(y,function(b){m?(m=!1,w=b):w=f(w,b,T),T++},{IS_RECORD:!0}),m)throw new u("Reduce of empty iterator with no initial value");return w}}),Zx}var Jx;function LG(){return Jx||(Jx=1,kG()),Xx}LG();function aL(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function GR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Id(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function gn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function La(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ge(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function P(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function lL(t){return gn(t,(e,n)=>e+n,0)}function $G(t){return gn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function FG(t){return gn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function VG(t){return t.length?lL(t)/t.length:0}function uL(t){return gn(t,(e,n)=>e.concat(Array.isArray(n)?uL(n):n),[])}function cL(t){const e=[];return P(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function qR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function WG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>s.includes(a))}),o}function BG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return P(i,s=>{P(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function KR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const jG=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:VG,arrayEach:P,arrayFilter:La,arrayFlatten:uL,arrayMap:Ge,arrayMax:$G,arrayMin:FG,arrayReduce:gn,arraySum:lL,arrayUnique:cL,extendArray:GR,getDifferenceOfArrays:qR,getIntersectionOfArrays:WG,getUnionOfArrays:BG,pivot:Id,stringToArray:KR,to2dArray:aL},Symbol.toStringTag,{value:"Module"}));function Qe(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return gn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function hL(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=document.createElement("template");i.innerHTML=t.reduce((a,l,u)=>{var c;return a+l+((c=n[u])!==null&&c!==void 0?c:"")},"");const o=i.content.cloneNode(!0),s={};return o.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),s[l]=a}),{fragment:o,refs:s}}function Ct(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function oe(t){return typeof t<"u"}function _t(t){return typeof t>"u"}function Wt(t){return t===null||t===""||_t(t)}function dL(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const vd="length",Od=t=>parseInt(t,16),eA=t=>parseInt(t,10),mp=(t,e,n)=>t.substr(e,n),xd=t=>t.codePointAt(0)-65,XR=t=>`${t}`.replace(/\-/g,""),UG=t=>Od(mp(XR(t),Od("12"),xd("F")))/(Od(mp(XR(t),xd("B"),~~![][vd]))||9),zG=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let tA=!1;const nA={invalid:()=>Qe`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Qe`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Qe`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},rA={invalid:()=>Qe`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Qe`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Qe`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function fL(t,e){const n=!Wt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.1";let o,s="invalid",a="invalid";t=XR(t||"");const l=YG(t);if(n||r||l)if(l){const u=K("23/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=UG(t);o=K((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(zG()&&(s="valid",a="valid"),!tA&&s!=="valid"&&(nA[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](nA[s]({keyValidityDate:o,hotVersion:i})),tA=!0),a!=="valid"&&e&&rA[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=rA[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function YG(t){let e=[][vd],n=e;if(t[vd]!==xd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=xd(i.shift());o;o=xd(i.shift()||"A"))--o<""[vd]?n=n|(eA(`${eA(Od(r)+(Od(mp(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=mp(t,o,o?i[vd]===1?9:8:6);return n===e}function pp(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function wp(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const GG=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:fL,getMostBottomEndPosition:wp,getMostTopStartPosition:pp,isDefined:oe,isEmpty:Wt,isRegExp:dL,isUndefined:_t,stringify:Ct},Symbol.toStringTag,{value:"Module"}));function Kn(t){return t[0].toUpperCase()+t.substr(1)}function qG(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Ct(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function P0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function gL(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function I0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Aw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Bm(t){return Hw(`${t}`,{ALLOWED_TAGS:[]})}function Hw(t,e){return Dj.sanitize(t,e)}const KG=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:qG,isJSON:gL,isPercentValue:I0,randomString:P0,sanitize:Hw,stripTags:Bm,substitute:Aw,toUpperCaseFirst:Kn},Symbol.toStringTag,{value:"Module"})),Ir=t=>["tabindex",t],XG=()=>["role","treegrid"],Ms=()=>["role","presentation"],ZG=()=>["role","gridcell"],QG=()=>["role","gridcell button"],JG=()=>["role","rowheader"],mL=()=>["role","rowgroup"],e2=()=>["role","columnheader"],pL=()=>["role","row"],t2=()=>["role","menu"],n2=()=>["role","menuitem"],r2=()=>["role","menuitemcheckbox"],i2=()=>["role","combobox"],wL=()=>["role","listbox"],o2=()=>["role","option"],s2=()=>["role","checkbox"],a2=()=>["role","dialog"],l2=()=>["role","alertdialog"],u2=()=>["scope","col"],c2=()=>["scope","row"],h2=()=>["type","text"],ti=t=>["aria-label",t],d2=t=>["aria-labelledby",t],f2=t=>["aria-describedby",t],vu=()=>["aria-hidden","true"],Cd=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},g2=()=>["aria-multiselectable","true"],vL=t=>["aria-haspopup",t],CL=t=>["aria-rowcount",t],Nw=t=>["aria-colcount",t],yL=t=>["aria-rowindex",t],O0=t=>["aria-colindex",t],Ei=t=>["aria-expanded",t],m2=t=>["aria-sort",t],iA=()=>["aria-readonly","true"],oA=()=>["aria-invalid","true"],SL=t=>["aria-checked",t],x0=()=>["aria-selected","true"],p2=()=>["aria-autocomplete","list"],w2=t=>["aria-controls",t],v2=t=>["aria-activedescendant",t],C2=t=>["aria-live",t],y2=t=>["aria-relevant",t],S2=t=>["aria-setsize",t],b2=t=>["aria-posinset",t],R2=()=>["aria-modal","true"];var sA={},nS,aA;function E2(){if(aA)return nS;aA=1;var t=rn(),e=QD(),n=dn(),r=du(),i=yw(),o=t([].push);return nS=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var w=0;w<h;w++)if(l[w]===f)return m}}},nS}var lA;function T2(){if(lA)return sA;lA=1;var t=yt(),e=Jc(),n=Pf(),r=hn(),i=rn(),o=cn(),s=dn(),a=YE(),l=o0(),u=E2(),c=zE(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),w=i("".charCodeAt),y=i("".replace),T=i(1.1.toString),b=/[\uD800-\uDFFF]/g,M=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,D=!c||o(function(){var G=e("Symbol")("stringify detection");return d([G])!=="[null]"||d({a:G})!=="{}"||d(Object(G))!=="{}"}),I=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),O=function(G,W){var X=l(arguments),z=u(W);if(!(!s(z)&&(G===void 0||a(G))))return X[1]=function(ae,ee){if(s(z)&&(ee=r(z,this,h(ae),ee)),!a(ee))return ee},n(d,null,X)},U=function(G,W,X){var z=m(X,W-1),ae=m(X,W+1);return f(M,G)&&!f(R,ae)||f(R,G)&&!f(M,z)?"\\u"+T(w(G,0),16):G};return d&&t({target:"JSON",stat:!0,arity:3,forced:D||I},{stringify:function(W,X,z){var ae=l(arguments),ee=n(D?O:d,null,ae);return I&&typeof ee=="string"?y(ee,b,U):ee}}),sA}T2();function jc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},He(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=jc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[jc(n[0])]:e[r]=[]:e[r]=null)})),e}function bL(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const r=Array.isArray(n);return He(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Df(t,e){He(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Df(t[r],e[r])):t[r]=e[r]})}function Xn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function io(t){const e={};return He(t,(n,r)=>{e[r]=n}),e}function rt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return P(n,i=>{t.MIXINS.push(i.MIXIN_NAME),He(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let w=m;return(Array.isArray(w)||ye(w))&&(w=Xn(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function kf(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ye(t){return Object.prototype.toString.call(t)==="[object Object]"}function Xo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function He(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function vp(t,e){const n=e.split(".");let r=t;return He(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function jm(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Vt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function Dw(t){if(!ye(t))return 0;const e=function(n){let r=0;return ye(n)?He(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Or(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ad(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(r=>{typeof e[r]=="object"&&e[r]!==null&&!Array.isArray(e[r])?n[r]=Ad(t[r],e[r]):n[r]=Vt(t,r)&&t[r]!==void 0?t[r]:e[r]}),Object.keys(t).forEach(r=>{Vt(n,r)||(n[r]=t[r])}),n}const _2=Object.freeze(Object.defineProperty({__proto__:null,assignObjectDefaults:Ad,clone:io,createObjectPropListener:Or,deepClone:Xn,deepExtend:Df,deepObjectSize:Dw,defineGetter:Xo,duckSchema:jc,extend:tn,getProperty:vp,hasOwnProperty:Vt,inherit:bL,isObject:ye,isObjectEqual:kf,mixin:rt,objectEach:He,setProperty:jm},Symbol.toStringTag,{value:"Module"}));function of(t){return window.requestAnimationFrame(t)}function sf(t){window.cancelAnimationFrame(t)}function A0(){return"ontouchstart"in window}function RL(){return typeof window<"u"}let Eu;function EL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eu||(typeof Intl=="object"?Eu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Eu=(n,r)=>`${n}`.localeCompare(r):Eu=(n,r)=>n===r?0:n>r?-1:1,Eu)}const M2=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:sf,getComparisonFunction:EL,isCSR:RL,isTouchSupported:A0,requestAnimationFrame:of},Symbol.toStringTag,{value:"Module"})),mi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Vs={chrome:mi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:mi(t=>/CriOS/.test(t)),edge:mi(t=>/Edge/.test(t)),edgeWebKit:mi(t=>/EdgiOS/.test(t)),firefox:mi(t=>/Firefox/.test(t)),firefoxWebKit:mi(t=>/FxiOS/.test(t)),mobile:mi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:mi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ah={mac:mi(t=>/^Mac/.test(t)),win:mi(t=>/^Win/.test(t)),linux:mi(t=>/^Linux/.test(t)),ios:mi(t=>/iPhone|iPad|iPod/i.test(t))};function TL(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(Vs,n=>{let{test:r}=n;return void r(t,e)})}function _L(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(ah,e=>{let{test:n}=e;return void n(t)})}RL()&&(TL(),_L());function H0(){return Vs.chrome.value}function ML(){return Vs.chromeWebKit.value}function Um(){return Vs.firefox.value}function PL(){return Vs.firefoxWebKit.value}function Lf(){return Vs.safari.value}function IL(){return Vs.edge.value}function P2(){return Vs.edgeWebKit.value}function eo(){return Vs.mobile.value}function N0(){return ah.ios.value}function D0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ah.mac.value}function Cp(){return ah.win.value}function yp(){return ah.mac.value}function I2(){return ah.linux.value}const O2=Object.freeze(Object.defineProperty({__proto__:null,isChrome:H0,isChromeWebKit:ML,isEdge:IL,isEdgeWebKit:P2,isFirefox:Um,isFirefoxWebKit:PL,isIOS:N0,isIpadOS:D0,isLinuxOS:I2,isMacOS:yp,isMobileBrowser:eo,isSafari:Lf,isWindowsOS:Cp,setBrowserMeta:TL,setPlatformMeta:_L},Symbol.toStringTag,{value:"Module"}));function OL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Hd(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function xL(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function iu(t){return xL(t)&&t.parent}function x2(t){return!!Object.getPrototypeOf(t.parent)}function $a(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function yd(t,e,n){const r=[];let i=t;for(;i&&(i=$a(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function AL(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Ha(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function HL(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function NL(t){return!t||!t.length?[]:t.filter(e=>!!e)}function DL(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Y(t,e){typeof e=="string"&&(e=e.split(" ")),e=NL(e),e.length>0&&t.classList.add(...e)}function le(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=DL(e,!0);n=NL(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function de(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Wo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=DL(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function k0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)k0(e[n])}}function zo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const kL=/(<(.*)>|&(.*);)/;function Ya(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;kL.test(e)?t.innerHTML=n?Hw(e):e:Fa(t,e)}function Fa(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(zo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ou(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ou(r.host.impl);if(r.host)return ou(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function LL(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Dn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function L0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function kw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Lw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?L0(e):t.scrollTop}function $0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?kw(e):t.scrollLeft}function af(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function $L(t){return t.scrollHeight-t.clientHeight}function FL(t){return t.scrollWidth-t.clientWidth}function Uc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function lf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function A2(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Gt(t){return t.offsetWidth}function Jt(t){return t.getBoundingClientRect().height}function Dc(t){return t.clientHeight||t.innerHeight}function F0(t){return t.clientWidth||t.innerWidth}function H2(t,e,n){t.addEventListener(e,n,!1)}function N2(t,e,n){t.removeEventListener(e,n,!1)}function V0(t){return t.selectionStart?t.selectionStart:0}function VL(t){return t.selectionEnd?t.selectionEnd:0}function D2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function ZR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function $f(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let rS;function WL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Cp()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function k2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Lf()&&!eo()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.getBoundingClientRect().width;n.style.overflow="scroll";let i=e.getBoundingClientRect().width;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((r-i).toFixed(3))}function en(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return rS===void 0&&(rS=k2(t)),rS}function W0(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function B0(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function $w(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function L2(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Ff(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Nd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Fw(t){return Nd(t)&&t.hasAttribute("data-hot-input")===!1}function $2(t){const e=t.ownerDocument.activeElement;Fw(e)||t.select()}function j0(t){return!t.parentNode}function BL(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function U0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();de(t,"contenteditable",!0),n&&de(t,...vu()),e&&Y(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function z0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&le(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function jL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;U0(t,n),e(),z0(t,n)}function Bo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const F2=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:kL,addClass:Y,addEvent:H2,clearTextSelection:ZR,closest:$a,closestDown:yd,empty:zo,fastInnerHTML:Ya,fastInnerText:Fa,findFirstParentWithClass:AL,getCaretPosition:V0,getCssTransform:L2,getFractionalScalingCompensation:WL,getFrameElement:xL,getMaximumScrollLeft:FL,getMaximumScrollTop:$L,getParent:OL,getParentWindow:iu,getScrollLeft:$0,getScrollTop:Lw,getScrollableElement:af,getScrollbarWidth:en,getSelectionEndPosition:VL,getSelectionText:D2,getStyle:lf,getTrimmingContainer:Uc,getWindowScrollLeft:kw,getWindowScrollTop:L0,hasAccessToParentWindow:x2,hasClass:ve,hasHorizontalScrollbar:B0,hasVerticalScrollbar:W0,hasZeroHeight:LL,index:HL,innerHeight:Dc,innerWidth:F0,isChildOf:Ha,isDetached:j0,isHTMLElement:Bo,isInput:Nd,isInternalElement:Hd,isOutsideInput:Fw,isVisible:ou,makeElementContentEditableAndSelectItsContent:U0,matchesCSSRules:A2,observeVisibilityChangeOnce:BL,offset:Dn,outerHeight:Jt,outerWidth:Gt,overlayContainsElement:fa,removeAttribute:Wo,removeClass:le,removeContentEditableFromElementAndDeselect:z0,removeEvent:N2,removeTextNodes:k0,resetCssTransform:Ff,runWithSelectedContendEditableElement:jL,selectElementIfAllowed:$2,setAttribute:de,setCaretPosition:$f,setOverlayPosition:$w},Symbol.toStringTag,{value:"Module"}));function Ze(t){return typeof t=="function"}function UL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function V2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=UL(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Vf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function W2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return gn(i,(u,c)=>c(u),r.apply(this,a))}}function Y0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function zL(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function B2(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Sp(t,e,n,r,i,o,s,a){return oe(a)?t.call(e,n,r,i,o,s,a):oe(s)?t.call(e,n,r,i,o,s):oe(o)?t.call(e,n,r,i,o):oe(i)?t.call(e,n,r,i):oe(r)?t.call(e,n,r):oe(n)?t.call(e,n):t.call(e)}const j2=Object.freeze(Object.defineProperty({__proto__:null,curry:zL,curryRight:B2,debounce:Vf,fastCall:Sp,isFunction:Ze,partial:Y0,pipe:W2,throttle:UL,throttleAfterHits:V2},Symbol.toStringTag,{value:"Module"})),pe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Um()?182:174,AUDIO_MUTE:Um()?181:173,AUDIO_UP:Um()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},U2=[pe.ALT,pe.ARROW_DOWN,pe.ARROW_LEFT,pe.ARROW_RIGHT,pe.ARROW_UP,pe.AUDIO_DOWN,pe.AUDIO_MUTE,pe.AUDIO_UP,pe.BACKSPACE,pe.CAPS_LOCK,pe.DELETE,pe.END,pe.ENTER,pe.ESCAPE,pe.F1,pe.F2,pe.F3,pe.F4,pe.F5,pe.F6,pe.F7,pe.F8,pe.F9,pe.F10,pe.F11,pe.F12,pe.F13,pe.F14,pe.F15,pe.F16,pe.F17,pe.F18,pe.F19,pe.HOME,pe.INSERT,pe.MEDIA_NEXT,pe.MEDIA_PLAY_PAUSE,pe.MEDIA_PREV,pe.MEDIA_STOP,pe.NULL,pe.NUM_LOCK,pe.PAGE_DOWN,pe.PAGE_UP,pe.PAUSE,pe.SCROLL_LOCK,pe.SHIFT,pe.TAB];function YL(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function G0(t){return U2.includes(t)}function z2(t){const e=[];return yp()?e.push(pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX):e.push(pe.CONTROL),e.includes(t)}function GL(t){return[pe.CONTROL,pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX].includes(t)}function lh(t,e){const n=e.split("|");let r=!1;return P(n,i=>{if(t===pe[i])return r=!0,!1}),r}const Y2=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:pe,isCtrlKey:z2,isCtrlMetaKey:GL,isFunctionKey:G0,isKey:lh,isPrintableChar:YL},Symbol.toStringTag,{value:"Module"}));function Ai(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ba(t){return t.isImmediatePropagationEnabled===!1}function Va(t){return t.button===2}function Vw(t){return t.button===0}function qL(t){return t instanceof TouchEvent}function KL(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!Bo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const G2=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ba,isLeftClick:Vw,isRightClick:Va,isTouchEvent:qL,offsetRelativeTo:KL,stopImmediatePropagation:Ai},Symbol.toStringTag,{value:"Module"}));function We(){oe(console)&&console.warn(...arguments)}function XL(t){oe(console)&&console.warn(`Deprecated: ${t}`)}function q0(){oe(console)&&console.error(...arguments)}const Wl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],iS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),oS=new Map([[]]);var uA={},sS,cA;function q2(){if(cA)return sS;cA=1;var t=nh();return sS=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},sS}var aS,hA;function K2(){if(hA)return aS;hA=1;var t=nn();return aS=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},aS}var lS,dA;function Ww(){if(dA)return lS;dA=1;var t=oo(),e=n0(),n=Ua().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),lS=function(o){i[r][o]=!0},lS}var fA;function X2(){if(fA)return uA;fA=1;var t=yt(),e=rn(),n=xr(),r=Ef(),i=q2(),o=K2(),s=Ww(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),uA}X2();var gA={},mA={},pA;function Z2(){if(pA)return mA;pA=1;var t=yt(),e=hn(),n=rh(),r=xr(),i=fn(),o=Go(),s=Ar(),a=za(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),mA}var wA;function Q2(){return wA||(wA=1,Z2()),gA}Q2();function J2(t,e){ZL(t,e),e.add(t)}function uS(t,e,n){ZL(t,e),e.set(t,n)}function ZL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vA(t,e,n){return t.set(bp(t,e),n),n}function Nn(t,e){return t.get(bp(t,e))}function bp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eq=100;var jr=new WeakMap,dc=new WeakMap,cS=new WeakMap,hS=new WeakSet;class CA{constructor(){J2(this,hS),uS(this,jr,new Map),uS(this,dc,new Map),uS(this,cS,new Set),Wl.forEach(e=>bp(hS,this,yA).call(this,e))}getHooks(e){var n;return(n=Nn(jr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Nn(jr,this).has(e)||(bp(hS,this,yA).call(this,e),Wl.push(e));const i=Nn(jr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Nn(cS,this).has(e);!u&&o!==0&&(u=!0,Nn(cS,this).add(e)),u&&i.length>1&&Nn(jr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Nn(jr,this).has(e)&&Nn(jr,this).get(e).length>0}remove(e,n){if(!Nn(jr,this).has(e))return!1;const r=Nn(jr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Nn(dc,this).get(e);return i.skip=!0,o+=1,o>eq&&(Nn(jr,this).set(e,r.filter(s=>!s.skip)),o=0),Nn(dc,this).set(e,o),!0}return!1}destroy(){Nn(jr,this).clear(),Nn(dc,this).clear(),vA(jr,this,null),vA(dc,this,null)}}function yA(t){Nn(jr,this).set(t,[]),Nn(dc,this).set(t,0)}function tq(t,e,n){return(e=nq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nq(t){var e=rq(t,"string");return typeof e=="symbol"?e:e+""}function rq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const iq=Qe`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class re{constructor(){tq(this,"globalBucket",new CA)}static getSingleton(){return sq()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new CA),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.add(e,o,r)):(iS.has(e)&&We(Aw(iq,{hookName:e,removedInVersion:iS.get(e)})),oS.has(e)&&We(oS.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?P(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?P(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sp(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sp(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Wl.push(e)}deregister(e){this.isRegistered(e)&&Wl.splice(Wl.indexOf(e),1)}isDeprecated(e){return oS.has(e)||iS.has(e)}isRegistered(e){return Wl.indexOf(e)>=0}getRegistered(){return Wl}}const oq=new re;function sq(){return oq}const Gl=new Map;function Hi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Gl.has(t)||Gl.set(t,new Map);const e=Gl.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Gl.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function aq(t,e){var n;return Gl==null||(n=Gl.get(t.guid))===null||n===void 0?void 0:n.get(e)}const QR=new WeakMap,{register:lq,getItem:QL,hasItem:JL,getNames:uq,getValues:qde}=Hi("editors");function cq(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},re.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function e$(t,e){let n;if(typeof t=="function")QR.get(t)||Rr(null,t),n=QR.get(t);else if(typeof t=="string")n=QL(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Rp(t){if(typeof t=="function")return t;if(!JL(t))throw Error(`No registered editor found under "${t}" name`);return QL(t).getConstructor()}function Rr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new cq(e);typeof t=="string"&&lq(t,n),QR.set(e,n)}function hq(t,e,n){return(e=dq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:e+""}function fq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let zm=0;class _i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;hq(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,gq(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),zm+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),zm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),zm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function gq(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ai(this)},t}function mq(){return zm}function pq(t,e){wq(t,e),e.add(t)}function wq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qa(t,e,n){return(e=vq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=Cq(t,"string");return typeof e=="symbol"?e:e+""}function Cq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sg=new WeakSet;class JR{constructor(e,n,r){pq(this,sg),Qa(this,"hot",void 0),Qa(this,"tableMeta",void 0),Qa(this,"selection",void 0),Qa(this,"eventManager",void 0),Qa(this,"destroyed",!1),Qa(this,"activeEditor",void 0),Qa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new _i(e),this.hot.addHook("afterDocumentKeyDown",i=>dS(sg,this,SA).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>dS(sg,this,SA).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>dS(sg,this,yq).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=e$(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function SA(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ba(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!G0(n)&&!GL(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function yq(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const bA=new WeakMap;JR.getInstance=function(t,e,n){let r=bA.get(t);return r||(r=new JR(t,e,n),bA.set(t,r)),r};function Sq(t,e){t$(t,e),e.add(t)}function Eh(t,e,n){t$(t,e),e.set(t,n)}function t$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(t,e){return t.get(Es(t,e))}function Th(t,e,n){return t.set(Es(t,e),n),n}function Es(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kc=Object.freeze({CELL:"cell",MIXED:"mixed"});var ln=new WeakMap,ag=new WeakMap,lg=new WeakMap,ug=new WeakMap,cg=new WeakMap,wa=new WeakSet;class bq{constructor(e){var n=this;Sq(this,wa),Eh(this,ln,void 0),Eh(this,ag,void 0),Eh(this,lg,1),Eh(this,ug,null),Eh(this,cg,new Map);const r=e.getSettings();Th(ln,this,e),Th(ag,this,r.imeFastEdit?kc.MIXED:kc.CELL),Rt(ln,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Es(wa,n,Eq).call(n,...o)}),Rt(ln,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Es(wa,n,RA).call(n,...o)}),Rt(ln,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Es(wa,n,RA).call(n,...o)}),Rt(ln,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Es(wa,n,Rq).call(n,...o)})}getFocusMode(){return Rt(ag,this)}setFocusMode(e){Object.values(kc).includes(e)?Th(ag,this,e):We(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Rt(lg,this)}setRefocusDelay(e){Th(lg,this,e)}setRefocusElementGetter(e){Th(ug,this,e)}getRefocusElement(){var e;return typeof Rt(ug,this)=="function"?Rt(ug,this).call(this):(e=Rt(ln,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Rt(ln,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Rt(ln,this).runHooks("modifyFocusedElement",s.row,s.col,r);Bo(a)||(a=r),a&&!((o=Rt(ln,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Es(wa,this,K0).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rt(lg,this);if(Rt(ln,this).getSettings().imeFastEdit&&!((e=Rt(ln,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=Rt(ln,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),Rt(cg,this).has(n)||Rt(cg,this).set(n,Vf(()=>{if(!Rt(ln,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),Rt(cg,this).get(n)()}}}function K0(t){var e;const n=(e=Rt(ln,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!Rt(ln,this).selection.isCellVisible(n)){t(null);return}const r=Rt(ln,this).getCell(n.row,n.col,!0);r===null?Rt(ln,this).addHookOnce("afterScroll",()=>{t(Rt(ln,this).getCell(n.row,n.col,!0))}):t(r)}function RA(){Es(wa,this,K0).call(this,t=>{const{activeElement:e}=Rt(ln,this).rootDocument;e&&Fw(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Rq(){Es(wa,this,K0).call(this,t=>{this.getFocusMode()===kc.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function Eq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?kc.MIXED:kc.CELL)}var EA={},fS,TA;function Tq(){if(TA)return fS;TA=1;var t=Pi(),e=du(),n=oo(),r=n("match");return fS=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},fS}var gS,_A;function _q(){if(_A)return gS;_A=1;var t=nn(),e=cn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return gS={correct:r},gS}var mS,MA;function Mq(){if(MA)return mS;MA=1;var t=fn();return mS=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},mS}var pS,PA;function Pq(){if(PA)return pS;PA=1;var t=hn(),e=Ii(),n=Tf(),r=_q(),i=Mq(),o=RegExp.prototype;return pS=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},pS}var wS,IA;function Iq(){if(IA)return wS;IA=1;var t=rn(),e=eh(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return wS=function(l,u,c,h,d,f){var m=c+l.length,w=h.length,y=a;return d!==void 0&&(d=e(d),y=s),i(f,y,function(T,b){var M;switch(r(b,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,m);case"<":M=d[o(b,1,-1)];break;default:var R=+b;if(R===0)return T;if(R>w){var D=n(R/10);return D===0?T:D<=w?h[D-1]===void 0?r(b,1):h[D-1]+r(b,1):T}M=h[R-1]}return M===void 0?"":M})},wS}var OA;function Oq(){if(OA)return EA;OA=1;var t=yt(),e=hn(),n=rn(),r=Rf(),i=dn(),o=Pi(),s=Tq(),a=yw(),l=_f(),u=Pq(),c=Iq(),h=oo(),d=ja(),f=h("replace"),m=TypeError,w=n("".indexOf),y=n("".replace),T=n("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(R,D){var I=r(this),O,U,G,W,X,z,ae,ee,ce,Et,$e=0,Ye="";if(o(R)){if(O=s(R),O&&(U=a(r(u(R))),!~w(U,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(G=l(R,f),G)return e(G,R,I,D);if(d&&O)return y(a(I),R,D)}for(W=a(I),X=a(R),z=i(D),z||(D=a(D)),ae=X.length,ee=b(1,ae),ce=w(W,X);ce!==-1;)Et=z?a(D(X,ce,W)):c(X,W,ce,[],void 0,D),Ye+=T(W,$e,ce)+Et,$e=ce+ae,ce=ce+ee>W.length?-1:w(W,X,ce+ee);return $e<W.length&&(Ye+=T(W,$e)),Ye}}),EA}Oq();const n$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},xq=new RegExp(Object.keys(n$).map(t=>`(${t})`).join("|"),"gi");function Aq(t){return(t&&t.nodeName||"")==="TABLE"}function eE(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let y=0;y<s;y+=1){const T=!f&&n&&y===0;let b="";if(f)b=`<th>${t.getColHeader(y-c)}</th>`;else if(T)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][y],{hidden:R,rowspan:D,colspan:I}=t.getCellMeta(d-h,y-c);if(!R){const O=[];if(D&&O.push(`rowspan="${D}"`),I&&O.push(`colspan="${I}"`),Wt(M))b=`<td ${O.join(" ")}></td>`;else{const U=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${O.join(" ")}>${U}</td>`}}}m.push(b)}const w=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function tE(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function nE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,R=>{const D=R.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,O=R.substring(D.length,R.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${D}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!Aq(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,R)=>M+R.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(R=>{const D=R.querySelector("td")!==null;return D&&h.push(R),!D});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((R,D)=>{const I=Array.from(D.cells).reduce((O,U,G)=>{if(a&&G===0)return O;const{colSpan:W,innerHTML:X}=U,z=W>1?{label:X,colspan:W}:X;return O.push(z),O},[]);return R.push(I),R},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((R,D,I)=>(a&&I===0||R.push(D.innerHTML),R),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((M,R)=>(M.push(...Array.from(R.rows)),M),[]),...c];m=w.length;const y=new Array(m);for(let M=0;M<m;M++)y[M]=new Array(u);const T=[],b=[];for(let M=0;M<m;M++){const R=w[M],D=Array.from(R.cells),I=D.length;for(let O=0;O<I;O++){const U=D[O],{nodeName:G,innerHTML:W,rowSpan:X,colSpan:z}=U,ae=y[M].findIndex(ee=>ee===void 0);if(G==="TD"){if(X>1||z>1){for(let $e=M;$e<M+X;$e++)if($e<m)for(let Ye=ae;Ye<ae+z;Ye++)y[$e][Ye]=null;const ce=U.getAttribute("style");ce&&ce.includes("mso-ignore:colspan")||T.push({col:ae,row:M,rowspan:X,colspan:z})}let ee="";s&&/excel/gi.test(s.content)?ee=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[M][ae]=ee.replace(xq,ce=>n$[ce])}else b.push(W)}}return T.length&&(n.mergeCells=T),b.length&&(n.rowHeaders=b),y.length&&(n.data=y),n}const Hq=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:tE,htmlToGridSettings:nE,instanceToHTML:eE},Symbol.toStringTag,{value:"Module"}));function Yn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function r$(t){return Yn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function rE(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function X0(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ke(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function i$(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function nu(t){return Number.isInteger(t)&&t>=0}const Nq=Object.freeze(Object.defineProperty({__proto__:null,clamp:ke,getParsedNumber:i$,isNumeric:Yn,isNumericLike:r$,isUnsignedNumber:nu,rangeEach:fe,rangeEachReverse:rE,valueAccordingPercent:X0},Symbol.toStringTag,{value:"Module"})),iE="asc",Dq="desc",xA=new Map([[iE,[-1,1]],[Dq,[1,-1]]]),kq=t=>`The priority '${t}' is already declared in a map.`,Lq=t=>`The priority '${t}' is not a number.`;function $q(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ze(t)?t:kq,e=Ze(e)?e:Lq;function r(o,s){if(!Yn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iE;const[s,a]=xA.get(o)||xA.get(iE);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Fq=t=>`The id '${t}' is already declared in a map.`;function Bw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ze(t)?t:Fq;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const Vq=t=>`'${t}' value is already declared in a unique set.`;function Wq(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ze(t)?t:Vq;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const Z0=t=>`There is already registered "${t}" plugin.`,Bq=t=>`There is already registered plugin on priority "${t}".`,jq=t=>`The priority "${t}" is not a number.`,o$=$q({errorPriorityExists:Bq,errorPriorityNaN:jq}),s$=Wq({errorItemExists:Z0}),oE=Bw({errorIdExists:Z0});function Q0(){return[...o$.getItems(),...s$.getItems()]}function Wf(t){const e=Kn(t);return oE.getItem(e)}function Uq(t){return!!Wf(t)}function Fe(t,e,n){[t,e,n]=Yq(t,e,n),Wf(t)===void 0&&zq(t,e,n)}function zq(t,e,n){const r=Kn(t);if(oE.hasItem(r))throw new Error(Z0(r));n===void 0?s$.addItem(r):o$.addItem(n,r),oE.addItem(r,e)}function Yq(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Gq,getItem:qq,hasItem:a$,getNames:Kq,getValues:Kde}=Hi("renderers");function Ep(t){if(typeof t=="function")return t;if(!a$(t))throw Error(`No registered renderer found under "${t}" name`);return qq(t)}function Yr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Gq(t,e)}const{register:Xq,getItem:Zq,hasItem:l$,getNames:Qq,getValues:Xde}=Hi("validators");function J0(t){if(typeof t=="function")return t;if(!l$(t))throw Error(`No registered validator found under "${t}" name`);return Zq(t)}function Bl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Xq(t,e)}var AA={},HA;function Jq(){if(HA)return AA;HA=1;var t=yt(),e=eh(),n=nh(),r=Mf(),i=Ww();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),AA}Jq();var NA={},DA;function eK(){if(DA)return NA;DA=1;var t=yt(),e=rn(),n=Rf(),r=Mf(),i=yw(),o=cn(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),NA}eK();function _h(t,e,n){return(e=tK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tK(t){var e=nK(t,"string");return typeof e=="symbol"?e:e+""}function nK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rK{constructor(){_h(this,"count",0),_h(this,"startColumn",null),_h(this,"endColumn",null),_h(this,"startPosition",null),_h(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Mh(t,e,n){return(e=iK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iK(t){var e=oK(t,"string");return typeof e=="symbol"?e:e+""}function oK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sK{constructor(){Mh(this,"count",0),Mh(this,"startRow",null),Mh(this,"endRow",null),Mh(this,"startPosition",null),Mh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ph(t,e,n){return(e=aK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aK(t){var e=lK(t,"string");return typeof e=="symbol"?e:e+""}function lK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u${constructor(){Ph(this,"count",0),Ph(this,"startColumn",null),Ph(this,"endColumn",null),Ph(this,"startPosition",null),Ph(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ih(t,e,n){return(e=uK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:e+""}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c${constructor(){Ih(this,"count",0),Ih(this,"startRow",null),Ih(this,"endRow",null),Ih(this,"startPosition",null),Ih(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Oh(t,e,n){return(e=hK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:e+""}function dK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fK{constructor(){Oh(this,"count",0),Oh(this,"startColumn",0),Oh(this,"endColumn",0),Oh(this,"startPosition",0),Oh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function xh(t,e,n){return(e=gK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gK(t){var e=mK(t,"string");return typeof e=="symbol"?e:e+""}function mK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pK{constructor(){xh(this,"count",0),xh(this,"startRow",0),xh(this,"endRow",0),xh(this,"startPosition",0),xh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function kA(t,e,n){return(e=wK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wK(t){var e=vK(t,"string");return typeof e=="symbol"?e:e+""}function vK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CK extends u${constructor(){super(...arguments),kA(this,"columnStartOffset",0),kA(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function LA(t,e,n){return(e=yK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=SK(t,"string");return typeof e=="symbol"?e:e+""}function SK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bK extends c${constructor(){super(...arguments),LA(this,"rowStartOffset",0),LA(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function $A(t,e,n){return(e=RK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RK(t){var e=EK(t,"string");return typeof e=="symbol"?e:e+""}function EK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h${constructor(e){$A(this,"calculationTypes",[]),$A(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Di(t,e,n){return(e=TK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zc=50;class MK extends h${constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Di(this,"viewportWidth",0),Di(this,"scrollOffset",0),Di(this,"zeroBasedScrollOffset",0),Di(this,"totalColumns",0),Di(this,"columnWidthFn",null),Di(this,"columnWidth",0),Di(this,"overrideFn",null),Di(this,"inlineStartOffset",0),Di(this,"totalCalculatedWidth",0),Di(this,"startPositions",[]),Di(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?zc:n}}function oi(t,e,n){return(e=PK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=IK(t,"string");return typeof e=="symbol"?e:e+""}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OK extends h${constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),oi(this,"viewportHeight",0),oi(this,"scrollOffset",0),oi(this,"zeroBasedScrollOffset",0),oi(this,"totalRows",0),oi(this,"rowHeightFn",null),oi(this,"rowHeight",0),oi(this,"overrideFn",null),oi(this,"horizontalScrollbarHeight",0),oi(this,"innerViewportHeight",0),oi(this,"totalCalculatedHeight",0),oi(this,"startPositions",[]),oi(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function xK(t,e,n){AK(t,e),e.set(t,n)}function AK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FA(t,e,n){return(e=HK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HK(t){var e=NK(t,"string");return typeof e=="symbol"?e:e+""}function NK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tu(t,e){return t.get(d$(t,e))}function VA(t,e,n){return t.set(d$(t,e),n),n}function d$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ns=new WeakMap;class su{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;FA(this,"row",null),FA(this,"col",null),xK(this,ns,!1),VA(ns,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Tu(ns,this)}isSouthEastOf(e){return this.row>=e.row&&(Tu(ns,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Tu(ns,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Tu(ns,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Tu(ns,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof su&&VA(ns,this,e.isRtl()),this}clone(){return new su(this.row,this.col,Tu(ns,this))}toObject(){return{row:this.row,col:this.col}}}function DK(t,e,n){kK(t,e),e.set(t,n)}function kK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vS(t,e,n){return(e=LK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=$K(t,"string");return typeof e=="symbol"?e:e+""}function $K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function si(t,e){return t.get(f$(t,e))}function FK(t,e,n){return t.set(f$(t,e),n),n}function f$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fr=new WeakMap;class uh{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;vS(this,"highlight",null),vS(this,"from",null),vS(this,"to",null),DK(this,fr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),FK(fr,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return si(fr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return si(fr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return si(fr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return si(fr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return si(fr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return si(fr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return si(fr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return si(fr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof su))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(si(fr,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(si(fr,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new uh(this.highlight,this.from,this.to,si(fr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new su(e,n,si(fr,this))}}function uo(t,e,n){VK(t,e),e.set(t,n)}function VK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function me(t,e){return t.get(g$(t,e))}function zs(t,e,n){return t.set(g$(t,e),n),n}function g$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ai=new WeakMap,CS=new WeakMap,Tn=new WeakMap,_u=new WeakMap,hg=new WeakMap,ki=new WeakMap,yS=new WeakMap,Ah=new WeakMap,Ja=new WeakMap,co=new WeakMap;let m$=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;uo(this,ai,void 0),uo(this,CS,void 0),uo(this,Tn,void 0),uo(this,_u,void 0),uo(this,hg,void 0),uo(this,ki,void 0),uo(this,yS,void 0),uo(this,Ah,void 0),uo(this,Ja,[null,null]),uo(this,co,[null,null]),zs(ai,this,r),zs(CS,this,n),zs(Tn,this,o),zs(_u,this,s),zs(hg,this,a),zs(ki,this,i),zs(yS,this,e),this.registerEvents()}registerEvents(){me(ki,this).addEventListener(me(Tn,this).holder,"contextmenu",r=>this.onContextMenu(r)),me(ki,this).addEventListener(me(Tn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),me(ki,this).addEventListener(me(Tn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{me(ki,this).addEventListener(me(Tn,this).holder,"touchstart",r=>this.onTouchStart(r)),me(ki,this).addEventListener(me(Tn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),me(ki,this).addEventListener(me(Tn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||me(ai,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,me(ai,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{me(ki,this).addEventListener(me(Tn,this).holder,"mouseup",r=>this.onMouseUp(r)),me(ki,this).addEventListener(me(Tn,this).holder,"mousedown",r=>this.onMouseDown(r))};eo()?e():(A0()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(me(Ah,this)&&r){const[i,o]=[r.row,me(Ah,this).from.row],[s,a]=[r.col,me(Ah,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=me(Tn,this).TABLE,i=yd(e,["TD","TH"],r);return i?(n.coords=me(Tn,this).getCoords(i),n.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(n.coords=me(_u,this).getFocusSelection().cellRange.highlight,n.TD=me(Tn,this).getCell(n.coords)):ve(e,"wtBorder")&&ve(e,"area")&&me(_u,this).getAreaSelection().cellRange&&(n.coords=me(_u,this).getAreaSelection().cellRange.to,n.TD=me(Tn,this).getCell(n.coords)),n}onMouseDown(e){const n=me(CS,this).rootDocument.activeElement,r=Y0(OL,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ve(i,"corner")?me(ai,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&me(ai,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(me(co,this)[0]=o.TD,clearTimeout(me(Ja,this)[0]),me(Ja,this)[0]=setTimeout(()=>{me(co,this)[0]=null},1e3))}onContextMenu(e){if(me(ai,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!me(ai,this).has("onCellMouseOver"))return;const n=me(Tn,this).TABLE,r=yd(e.target,["TD","TH"],n),i=me(hg,this)||this;r&&r!==i.lastMouseOver&&Ha(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,me(Tn,this).getCoords(r),r))}onMouseOut(e){if(!me(ai,this).has("onCellMouseOut"))return;const n=me(Tn,this).TABLE,r=yd(e.target,["TD","TH"],n),i=yd(e.relatedTarget,["TD","TH"],n),o=me(hg,this)||this;r&&r!==i&&Ha(r,n)&&(this.callListener("onCellMouseOut",e,me(Tn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&me(ai,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===me(co,this)[0]&&n.TD===me(co,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),me(co,this)[0]=null,me(co,this)[1]=null):n.TD===me(co,this)[0]&&(me(co,this)[1]=n.TD,clearTimeout(me(Ja,this)[1]),me(Ja,this)[1]=setTimeout(()=>{me(co,this)[1]=null},500)))}onTouchStart(e){zs(Ah,this,me(_u,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=oe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&me(ai,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];N0()&&(ML()||PL())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=me(ai,this).getSettingPure(e);o&&o(n,r,i,me(yS,this).call(this))}destroy(){clearTimeout(me(Ja,this)[0]),clearTimeout(me(Ja,this)[1]),me(ki,this).destroy()}};function SS(t,e,n){return(e=WK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WK(t){var e=BK(t,"string");return typeof e=="symbol"?e:e+""}function BK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jK{constructor(e,n,r){SS(this,"offset",void 0),SS(this,"total",void 0),SS(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function bS(t,e,n){return(e=UK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UK(t){var e=zK(t,"string");return typeof e=="symbol"?e:e+""}function zK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YK{constructor(e,n,r){bS(this,"offset",void 0),bS(this,"total",void 0),bS(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function dg(t,e,n){return(e=GK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=qK(t,"string");return typeof e=="symbol"?e:e+""}function qK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KK{constructor(){dg(this,"currentSize",0),dg(this,"nextSize",0),dg(this,"currentOffset",0),dg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const XK=0,WA=1,sE=2;function RS(t,e,n){return(e=ZK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZK(t){var e=QK(t,"string");return typeof e=="symbol"?e:e+""}function QK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JK{constructor(){RS(this,"size",new KK),RS(this,"workingSpace",XK),RS(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WA,e.workingSpace=sE,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=sE,e.workingSpace=WA,this.sharedSize=e.getViewSize()}}var BA={},ES,jA;function e3(){if(jA)return ES;jA=1;var t=Cw(),e=TypeError;return ES=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},ES}var UA;function t3(){if(UA)return BA;UA=1;var t=yt(),e=eh(),n=nh(),r=JD(),i=e3(),o=ek(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var m=d;m--;){var w=m+f;m in h?h[w]=h[m]:i(h,w)}for(var y=0;y<f;y++)h[y]=arguments[y]}return r(h,d+f)}}),BA}t3();function n3(t,e,n){return(e=r3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r3(t){var e=i3(t,"string");return typeof e=="symbol"?e:e+""}function i3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zA{constructor(e,n){n3(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function o3(t,e,n){return(e=s3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l3{constructor(e){o3(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new zA(o,n),l=new zA(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(sE)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Mu(t,e,n){return(e=u3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u3(t){var e=c3(t,"string");return typeof e=="symbol"?e:e+""}function c3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p${constructor(e,n){Mu(this,"rootNode",void 0),Mu(this,"nodesPool",void 0),Mu(this,"sizeSet",new JK),Mu(this,"collectedNodes",[]),Mu(this,"viewDiffer",new l3(this.sizeSet)),Mu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class w$ extends p${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function YA(t,e,n){return(e=h3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h3(t){var e=d3(t,"string");return typeof e=="symbol"?e:e+""}function d3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f3{constructor(e){YA(this,"nodeType",void 0),YA(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Hh(t,e,n){return(e=g3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:e+""}function m3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bf{constructor(e,n){Hh(this,"nodesPool",null),Hh(this,"nodeType",void 0),Hh(this,"rootNode",void 0),Hh(this,"table",null),Hh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new f3(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function GA(t,e,n){return(e=p3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:e+""}function w3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v3 extends Bf{constructor(){super("TH"),GA(this,"orderViews",new WeakMap),GA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new w$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Wo(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&de(d,[JG(),c2(),O0(h+1),Ir(-1)]),n[h](a,d,h)}u.end()}}}class C3 extends Bf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&zo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&de(this.rootNode,[mL()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&de(s,[pL(),yL(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Wo(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&de(u,[O0(a+1+this.table.rowHeadersCount),Ir(-1),e2(),...a>=0?[u2()]:[QG(),ti("Select whole grid")]]),r[n](l,u,n)}}}}let qA=!1;class y3 extends Bf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!qA&&e>1e3&&(qA=!0,We(Qe`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Y(r,"rowHeader")}}function S3(t,e,n){return(e=b3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b3(t){var e=R3(t,"string");return typeof e=="symbol"?e:e+""}function R3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Pu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let KA=!1;class E3 extends Bf{constructor(e){super("TR",e),S3(this,"orderView",void 0),this.orderView=new p$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!KA&&e>1e3&&(KA=!0,We(Qe`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&de(this.rootNode,[mL()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;de(o,[pL(),yL(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ve(o,Pu.rowEven)||(le(o,Pu.rowOdd),Y(o,Pu.rowEven)):ve(o,Pu.rowOdd)||(le(o,Pu.rowEven),Y(o,Pu.rowOdd))}this.orderView.end()}}function XA(t,e,n){return(e=T3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T3(t){var e=_3(t,"string");return typeof e=="symbol"?e:e+""}function _3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M3 extends Bf{constructor(){super("TD"),XA(this,"orderViews",new WeakMap),XA(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new w$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(ve(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Wo(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;de(m,[...m.hasAttribute("role")?[]:[ZG()],Ir(-1),O0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function an(t,e,n){return(e=P3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=I3(t,"string");return typeof e=="symbol"?e:e+""}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O3{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};an(this,"rootNode",void 0),an(this,"rootDocument",void 0),an(this,"rowHeaders",null),an(this,"columnHeaders",null),an(this,"colGroup",null),an(this,"rows",null),an(this,"cells",null),an(this,"rowFilter",null),an(this,"columnFilter",null),an(this,"rowUtils",null),an(this,"columnUtils",null),an(this,"rowsToRender",0),an(this,"columnsToRender",0),an(this,"rowHeaderFunctions",[]),an(this,"rowHeadersCount",0),an(this,"columnHeaderFunctions",[]),an(this,"columnHeadersCount",0),an(this,"cellRenderer",void 0),an(this,"activeOverlayName",void 0),an(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class x3{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new O3(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new v3,columnHeaders:new C3(n),colGroup:new y3(r),rows:new E3(i),cells:new M3}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function TS(t,e,n){return(e=A3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3(t){var e=H3(t,"string");return typeof e=="symbol"?e:e+""}function H3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N3{constructor(e,n){TS(this,"dataAccessObject",void 0),TS(this,"wtSettings",void 0),TS(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function ZA(t,e,n){return(e=D3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D3(t){var e=k3(t,"string");return typeof e=="symbol"?e:e+""}function k3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L3{constructor(e,n){ZA(this,"dataAccessObject",void 0),ZA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function ho(t,e,n){return(e=$3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3(t){var e=F3(t,"string");return typeof e=="symbol"?e:e+""}function F3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ch{constructor(e,n,r,i,o){ho(this,"wtSettings",null),ho(this,"domBindings",void 0),ho(this,"TBODY",null),ho(this,"THEAD",null),ho(this,"COLGROUP",null),ho(this,"hasTableHeight",!0),ho(this,"hasTableWidth",!0),ho(this,"isTableVisible",!1),ho(this,"tableOffset",0),ho(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,k0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new L3(this.dataAccessObject,this.wtSettings),this.columnUtils=new N3(this.dataAccessObject,this.wtSettings),this.tableRenderer=new x3({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&de(r,[Ms()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&de(r,[Ms()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&de(r,[Ir(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&de(r.parentNode,[Ms()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&de(r,[Ms()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Dn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Dn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new YK(f,o,c),this.columnFilter=new jK(m,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),w=y.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Lo)||this.is(Na))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Lo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Lo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Dc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Lo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=$a(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=HL(r),s=n.cellIndex;fa(uu,n,this.wtRootElement)||fa(au,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):fa(Na,n,this.wtRootElement)||fa(Lo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),fa(uu,n,this.wtRootElement)||fa(lu,n,this.wtRootElement)||fa(Na,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Dc(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?Jt:Dc,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-m||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Gt(this.TABLE)}getHeight(){return Jt(this.TABLE)}getTotalWidth(){const e=Gt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Jt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ou(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ze(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const V3="stickyRowsBottom",eT={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Xo(eT,"MIXIN_NAME",V3,{writable:!1,enumerable:!1});const W3="stickyColumnsStart",jw={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xo(jw,"MIXIN_NAME",W3,{writable:!1,enumerable:!1});class tT extends ch{constructor(e,n,r,i){super(e,n,r,i,Na)}}rt(tT,eT);rt(tT,jw);const au="top",Lo="bottom",lu="inline_start",uu="top_inline_start_corner",Na="bottom_inline_start_corner",v$=[au,Lo,lu,uu,Na],B3=new Map([[au,`ht_clone_${au}`],[Lo,`ht_clone_${Lo}`],[lu,`ht_clone_${lu} ht_clone_left`],[uu,`ht_clone_${uu} ht_clone_top_left_corner`],[Na,`ht_clone_${Na} ht_clone_bottom_left_corner`]]);function j3(t,e){U3(t,e),e.add(t)}function U3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z3(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nh=new WeakSet;class q3{constructor(e){j3(this,Nh),z3(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Or(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return fg(Nh,this,JA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return fg(Nh,this,JA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return fg(Nh,this,QA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return fg(Nh,this,QA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function QA(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Dn(r.wtRootElement).left;const u=Math.abs($0(s,s));if(l>u){const c=F0(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function JA(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Dn(n.wtRootElement),a=Lw(o,o);if(s.top>a){const l=Dc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function li(t,e,n){return(e=K3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:e+""}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nT{get eventManager(){return new _i(this)}constructor(e,n){li(this,"wtTable",void 0),li(this,"wtScroll",void 0),li(this,"wtViewport",void 0),li(this,"wtOverlays",void 0),li(this,"selectionManager",void 0),li(this,"wtEvent",void 0),li(this,"guid",`wt_${P0()}`),li(this,"drawInterrupted",!1),li(this,"drawn",!1),li(this,"activeOverlayName","master"),li(this,"domBindings",void 0),li(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new q3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Fa(r,e[n])}])}}createCellCoords(e,n){return new su(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new uh(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||LL(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function eH(t,e,n){return(e=Z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z3(t){var e=Q3(t,"string");return typeof e=="symbol"?e:e+""}function Q3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J3 extends nT{constructor(e,n,r){super(e,n),eH(this,"cloneSource",void 0),eH(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new m$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function eX(t,e,n){return(e=tX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jf{constructor(e,n,r,i,o){eX(this,"wtSettings",null),Xo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Uc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Uc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=af(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){We(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+en())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(v$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${B3.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&de(o,[Ms()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===au||u==="vertical"&&this.type===lu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=af(e.TABLE),new J3(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class rX extends jf{constructor(e,n,r,i,o,s){super(e,n,Na,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new tT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Ff(n),this.repositionOverlay();let r=Jt(this.clone.wtTable.TABLE);const i=Gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=en(r)),i.style.bottom=`${o}px`}}const iX="calculatedColumns",Uw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xo(Uw,"MIXIN_NAME",iX,{writable:!1,enumerable:!1});class rT extends ch{constructor(e,n,r,i){super(e,n,r,i,Lo)}}rt(rT,eT);rt(rT,Uw);function oX(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:e+""}function aX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lX extends jf{constructor(e,n,r,i){super(e,n,Lo,r,i),oX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new rT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=en(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(kw(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=en(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Jt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=en(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Lw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(s,"innerBorderBottom"),o=!a):(le(s,"innerBorderBottom"),o=a)}return o}}const uX="calculatedRows",iT={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xo(iT,"MIXIN_NAME",uX,{writable:!1,enumerable:!1});class oT extends ch{constructor(e,n,r,i){super(e,n,r,i,lu)}}rt(oT,iT);rt(oT,jw);const cX="localHooks",bn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Sp(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Xo(bn,"MIXIN_NAME",cX,{writable:!1,enumerable:!1});let C$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};rt(C$,bn);const y$="active-header",sT="header",aT="area",Tp="focus",hX="fill",dX="row",fX="column",gX="custom-selection",lT=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var tH={},nH;function mX(){if(nH)return tH;nH=1;var t=Ww();return t("flat"),tH}mX();function pX(t,e){S$(t,e),e.add(t)}function rH(t,e,n){S$(t,e),e.set(t,n)}function S$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(Dd(t,e))}function iH(t,e,n){return t.set(Dd(t,e),n),n}function Dd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bi=new WeakMap,Bn=new WeakMap,gg=new WeakSet;class wX{constructor(){pX(this,gg),rH(this,Bi,void 0),rH(this,Bn,void 0)}setActiveOverlay(e){return iH(Bn,this,e),this}setActiveSelection(e){return iH(Bi,this,e),this}scan(){const e=kt(Bi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=kt(Bi,this).getCorners(),{wtTable:s}=kt(Bn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=s.getColumnHeader(h,f);const w=kt(Bn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:kt(Bi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(m=s.getColumnHeader(w,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=kt(Bi,this).getCorners(),{wtTable:s}=kt(Bn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const w=kt(Bn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:kt(Bi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(m=s.getRowHeader(w,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=kt(Bn,this);Dd(gg,this,vX).call(this,(r,i)=>{const o=n.getCell(kt(Bn,this).createCellCoords(r,i)),s=kt(Bn,this).getSetting("onAfterDrawSelection",r,i,kt(Bi,this).settings.layerLevel);typeof s=="string"&&Y(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=kt(Bi,this).getCorners(),{wtTable:i}=kt(Bn,this);Dd(gg,this,oH).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(kt(Bn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=kt(Bi,this).getCorners(),{wtTable:i}=kt(Bn,this);Dd(gg,this,oH).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(kt(Bn,this).createCellCoords(o,s));e(a)}})}}function vX(t){let[e,n,r,i]=kt(Bi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=kt(Bn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(kt(Bn,this).createCellCoords(e,n));if(!Bo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function oH(t){const{wtTable:e}=kt(Bn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class sH{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=lT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ai(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),eo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};He(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};He(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),w=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const b=Math.min(parseInt(i+o,10),y-m-f*2),M=Math.min(parseInt(i+o-w/4,10),y-w-f*2);h[l]=`${b}px`,d[l]=`${M}px`;const R=Math.min(parseInt(r+s,10),T-m-f*2),D=Math.min(parseInt(r+s-w/4,10),T-w-f*2);h.top=`${R}px`,d.top=`${D}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),m=s.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let w;if(u){if(r=Math.max(r,f),o=Math.min(o,m),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}w=s.getCell(this.wot.createCellCoords(n,r))}else if(w=s.getCell(this.wot.createCellCoords(n,r)),!Bo(w)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(i,o)):w,T=Dn(w),b=u?Dn(y):T,M=Dn(s.TABLE),R=T.top,D=T.left,I=this.wot.wtSettings.getSetting("rtlMode");let O=0,U=0;if(I){const Ye=Gt(s.TABLE),St=Gt(w),ut=l.innerWidth-M.left-Ye;U=D+St-b.left,O=l.innerWidth-D-St-ut-1}else U=b.left+Gt(y)-D,O=D-M.left-1;if(this.isEntireColumnSelected(n,i)){const Ye=n,St=this.getDimensionsFromHeader("columns",r,o,Ye,M);let ut=null;St&&([ut,O,U]=St),ut&&(w=ut)}let G=R-M.top-1,W=b.top+Jt(y)-R;if(this.isEntireRowSelected(r,o)){const Ye=r,St=this.getDimensionsFromHeader("rows",n,i,Ye,M);let ut=null;St&&([ut,G,W]=St),ut&&(w=ut)}const X=l.getComputedStyle(w);parseInt(X.borderTopWidth,10)>0&&(G+=1,W=W>0?W-1:0),parseInt(X[I?"borderRightWidth":"borderLeftWidth"],10)>0&&(O+=1,U=U>0?U-1:0);const z=I?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${G}px`,this.topStyle[z]=`${O}px`,this.topStyle.width=`${U+ae}px`,this.topStyle.display="block",this.startStyle.top=`${G}px`,this.startStyle[z]=`${O}px`,this.startStyle.height=`${W+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${G+W-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[z]=`${O}px`,this.bottomStyle.width=`${U+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${G}px`,this.endStyle[z]=`${O+U-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${W+ae}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const ce=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Et,$e]=[i,o];if(ce&&Array.isArray(ce)&&([,,Et,$e]=ce),eo()||!ee||this.isPartRange(Et,$e))this.cornerStyle.display="none";else{this.cornerStyle.top=`${G+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[z]=`${O+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ye=Uc(s.TABLE);const St=Ye===l;St&&(Ye=a.documentElement);const ut=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,ct=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),kn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const it=St?y.getBoundingClientRect().left:y.offsetLeft;let g=!1,p=0;if(I?(p=it-parseInt(this.cornerDefaultStyle.width,10)/2,g=p<0):(p=it+Gt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,g=p>=F0(Ye)),g){const C=Math.floor(O+U+this.cornerCenterPointOffset-ct-ut);c?(this.cornerStyle[z]=`${C}px`,this.cornerStyle[I?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[z]=`${C-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(St?y.getBoundingClientRect().top:y.offsetTop)+Jt(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=Dc(Ye)){const C=Math.floor(G+W+this.cornerCenterPointOffset-kn-ut);c?(this.cornerStyle.top=`${C}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${C-1}px`}this.cornerStyle.display="block"}eo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,G,O,U,W)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Jt(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Gt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(m=l(n,y-i),w=l(r,y-i),!m||!w)return!1;const T=Dn(m),b=Dn(w);return m&&w&&(h=T[f]-o[f]-1,d=b[f]+u(w)-T[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Y(this[e],"hidden"):(ve(this[e],"hidden")&&le(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Y(this[e],"hidden"):le(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",eo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function CX(t,e){b$(t,e),e.add(t)}function Iu(t,e,n){b$(t,e),e.set(t,n)}function b$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get(uT(t,e))}function aH(t,e,n){return t.set(uT(t,e),n),n}function uT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jn=new WeakMap,Er=new WeakMap,_S=new WeakMap,Sd=new WeakMap,MS=new WeakMap,el=new WeakMap,lH=new WeakSet;class yX{constructor(e){CX(this,lH),Iu(this,jn,void 0),Iu(this,Er,void 0),Iu(this,_S,new wX),Iu(this,Sd,new WeakMap),Iu(this,MS,new WeakSet),Iu(this,el,new Map),aH(Er,this,e)}setActiveOverlay(e){return aH(jn,this,e),De(_S,this).setActiveOverlay(De(jn,this)),De(Sd,this).has(De(jn,this))||De(Sd,this).set(De(jn,this),new Set),this}getFocusSelection(){return De(Er,this)!==null?De(Er,this).getFocus():null}getAreaSelection(){return De(Er,this)!==null?De(Er,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(De(el,this).has(e)){const r=De(el,this).get(e);if(r.has(De(jn,this)))return r.get(De(jn,this));const i=new sH(De(jn,this),e.settings);return r.set(De(jn,this),i),i}const n=new sH(De(jn,this),e.settings);return De(el,this).set(e,new Map([[De(jn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=De(el,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){De(el,this).get(e).forEach(n=>n.destroy()),De(el,this).delete(e)}render(e){if(De(Er,this)===null)return;e&&uT(lH,this,SX).call(this);const n=Array.from(De(Er,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;De(MS,this).has(s)||(De(MS,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&De(_S,this).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){const w=r.get(m);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=s.getCorners();De(jn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>De(Sd,this).get(De(jn,this)).add(u)),Y(s,l),s.nodeName==="TD"&&Array.isArray((a=De(Er,this).options)===null||a===void 0?void 0:a.cellAttributes)&&de(s,De(Er,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{de(o,[...i.get(o)])})}}function SX(){const t=De(Sd,this).get(De(jn,this)),e=De(jn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=De(jn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=De(Er,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=De(Er,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=De(Er,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...De(Er,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)le(o[a],n),Wo(o[a],s)}),t.clear()}class bX extends jf{constructor(e,n,r,i){super(e,n,lu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new oT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),$w(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Ff(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,L0(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=en(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Gt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=lT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=en(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,FL(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs($0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?le(r,"emptyRows"):Y(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Y(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(r,"innerBorderInlineStart");e?(Y(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(le(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const RX="stickyRowsTop",cT={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xo(cT,"MIXIN_NAME",RX,{writable:!1,enumerable:!1});class hT extends ch{constructor(e,n,r,i){super(e,n,r,i,uu)}}rt(hT,cT);rt(hT,jw);function uH(t,e,n){return(e=EX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=TX(t,"string");return typeof e=="symbol"?e:e+""}function TX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _X extends jf{constructor(e,n,r,i,o,s){super(e,n,uu,r,i),uH(this,"topOverlay",void 0),uH(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();$w(e,`${i}px`,`${o}px`)}else Ff(e);let n=Jt(this.clone.wtTable.TABLE);const r=Gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class dT extends ch{constructor(e,n,r,i){super(e,n,r,i,au)}}rt(dT,cT);rt(dT,Uw);function MX(t,e,n){return(e=PX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PX(t){var e=IX(t,"string");return typeof e=="symbol"?e:e+""}function IX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OX extends jf{constructor(e,n,r,i){super(e,n,au,r,i),MX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new dT(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),$w(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Ff(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(kw(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=en(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Jt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=lT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=en(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,$L(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Lw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?le(i,"emptyColumns"):Y(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Y(i,"innerBorderTop"),a=!h):(le(i,"innerBorderTop"),a=h)}}return a}}function mg(t,e,n){xX(t,e),e.set(t,n)}function xX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rs(t,e,n){return(e=AX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AX(t){var e=HX(t,"string");return typeof e=="symbol"?e:e+""}function HX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tl(t,e,n){return t.set(R$(t,e),n),n}function is(t,e){return t.get(R$(t,e))}function R$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ou=new WeakMap,pg=new WeakMap,xu=new WeakMap,wg=new WeakMap;class NX{constructor(e,n,r,i,o,s){rs(this,"wot",null),mg(this,Ou,[]),rs(this,"topOverlay",null),rs(this,"bottomOverlay",null),rs(this,"inlineStartOverlay",null),rs(this,"topInlineStartCornerOverlay",null),rs(this,"bottomInlineStartCornerOverlay",null),rs(this,"browserLineHeight",void 0),rs(this,"wtSettings",null),mg(this,pg,!1),mg(this,xu,0),mg(this,wg,null),rs(this,"resizeObserver",new ResizeObserver(c=>{of(()=>{!Array.isArray(c)||!c.length||(tl(xu,this,is(xu,this)+1),is(xu,this)===300&&(We("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),is(wg,this)!==null&&clearTimeout(is(wg,this)),tl(wg,this,setTimeout(()=>{tl(xu,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=en(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:af(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...is(Ou,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new OX(...e),this.bottomOverlay=new lX(...e),this.inlineStartOverlay=new bX(...e),this.topInlineStartCornerOverlay=new _X(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new rX(...e,this.bottomOverlay,this.inlineStartOverlay),tl(Ou,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){tl(pg,this,is(Ou,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),is(Ou,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),is(Ou,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!H0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{of(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{tl(xu,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=lh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!is(pg,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),tl(pg,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=af(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),f=n.hider.style,m=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-n.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-n.holder.clientWidth),y=m()?1:0,T=w()?1:0;f.width=`${h+T}px`,f.height=`${c+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function cH(t,e,n){return(e=DX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DX(t){var e=kX(t,"string");return typeof e=="symbol"?e:e+""}function kX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LX{constructor(e){cH(this,"settings",{}),cH(this,"defaults",Object.freeze(this.getDefaults())),He(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Fa(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?He(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class fT extends ch{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Uc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=lf(e,"height",n),o=lf(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ou(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}rt(fT,iT);rt(fT,Uw);class $X{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new pK:new bK],["fullyVisible",()=>new sK],["partiallyVisible",()=>new c$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new fK:new CK],["fullyVisible",()=>new rK],["partiallyVisible",()=>new u$]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Jt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,r=this.hasVerticalScroll()?en():0;return n>this.getWorkspaceWidth()-r}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Dn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Jt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Gt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=en(this.domBindings.rootDocument),new OK({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=en(this.domBindings.rootDocument)),new MK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible"),s=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;const{startRow:o,endRow:s}=n;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;r=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;const{startColumn:o,endColumn:s}=n;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;r=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),r<a||r===a&&r>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){He(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class FX extends nT{constructor(e,n){super(e,new LX(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new fT(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new $X(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new yX(this.wtSettings.getSetting("selections")),this.wtEvent=new m$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new NX(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];He(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),le(this.wtTable.wtRootElement.parentNode,n),Y(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!v$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class gT{constructor(e){e instanceof nT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new gT(n);return()=>r},this._wot=new FX(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function hH(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function VX(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function dH(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const WX=new Map([["touchstart",hH],["touchend",dH],["mousedown",hH],["mouseover",VX],["mouseup",dH]]);function PS(t,e){WX.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:Vw(t)||t.type==="touchstart",isRightClick:Va(t),...e})}const E$=new WeakMap,mT=Symbol("rootInstance");function BX(t){E$.set(t,!0)}function jX(t){return t===mT}function kl(t){return E$.has(t)}function UX(t,e){T$(t,e),e.add(t)}function Ys(t,e,n){T$(t,e),e.set(t,n)}function T$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return(e=zX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zX(t){var e=YX(t,"string");return typeof e=="symbol"?e:e+""}function YX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kt(t,e){return t.get(Lc(t,e))}function gr(t,e,n){return t.set(Lc(t,e),n),n}function Lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var IS=new WeakMap,vg=new WeakMap,Cg=new WeakMap,os=new WeakMap,Li=new WeakMap,OS=new WeakMap,xS=new WeakMap,Au=new WeakMap,bd=new WeakSet;class GX{constructor(e){UX(this,bd),Gs(this,"hot",void 0),Gs(this,"eventManager",void 0),Gs(this,"settings",void 0),Gs(this,"THEAD",void 0),Gs(this,"TBODY",void 0),Gs(this,"_wt",void 0),Gs(this,"activeWt",void 0),Ys(this,IS,0),Ys(this,vg,0),Gs(this,"postponedAdjustElementsSize",!1),Ys(this,Cg,!1),Ys(this,os,void 0),Ys(this,Li,void 0),Ys(this,OS,0),Ys(this,xS,0),Ys(this,Au,null),this.hot=e,this.eventManager=new _i(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Lc(bd,this,KX).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Y(e,"handsontable"),gr(Li,this,n.createElement("TABLE")),Y(Kt(Li,this),"htCore"),this.hot.getSettings().tableClassName&&Y(Kt(Li,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(de(Kt(Li,this),[Ms()]),de(e,[XG(),CL(-1),Nw(this.hot.countCols()),g2()])),this.THEAD=n.createElement("THEAD"),Kt(Li,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Kt(Li,this).appendChild(this.TBODY),this.hot.table=Kt(Li,this),this.hot.container.insertBefore(Kt(Li,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:r,selection:i,rootWindow:o}=this.hot,s=r.documentElement;this.eventManager.addEventListener(n,"mousedown",l=>{gr(Cg,this,!0),this.isTextSelectionAllowed(l.target)||(ZR(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{gr(Cg,this,!1)}),this.eventManager.addEventListener(n,"mousemove",l=>{Kt(Cg,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&ZR(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&Vw(l)&&i.finish(),gr(os,this,!1);const c=Fw(r.activeElement),h=(u=r.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(r.activeElement);Nd(r.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??n).contains(l.target)&&!Va(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&Va(l)&&(i.finish(),gr(os,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),gr(os,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(Kt(os,this)||!n||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const w=en(r);if(r.elementFromPoint(c+w,h)!==f||r.elementFromPoint(c,h+w)!==f)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===n)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=iu(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=iu(a);this.eventManager.addEventListener(Kt(Li,this),"selectstart",l=>{this.settings.fragmentSelection||Nd(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Y(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&le(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Kt(Li,this),isDataViewInstance:()=>kl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),gr(vg,this,o.length),this.hot.getSettings().ariaTags&&Lc(bd,this,_$).call(this)===this.hot.countCols()&&Lc(bd,this,qX).call(this,Kt(vg,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),gr(IS,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,w,f),this.hot.runHooks("afterRenderer",a,l,u,m,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ou(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,gr(os,this,!0),gr(Au,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ba(o)&&(PS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,gr(os,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ba(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ba(o)&&(Kt(os,this)&&(!Kt(Au,this)||Kt(Au,this).x!==o.clientX||Kt(Au,this).y!==o.clientY)&&PS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,gr(Au,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ba(o)||this.hot.isDestroyed)&&(PS(o,{coords:u,selection:this.hot.selection,cellRangeMapper:aq(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,w,y,T]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new gT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,r;if(Nd(e))return!0;const i=Ha(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(n=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return Kt(os,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ve(r,"relative")){zo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",Y(s,["relative",...o()])):(zo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(de(a,...Ms()),de(l,...Ms())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ya(e,r(n,i)):(Fa(e,"Â "),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){gr(OS,this,e),gr(xS,this,n)}getLastSize(){return{width:Kt(OS,this),height:Kt(xS,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Kt(IS,this)}getRowHeadersCount(){return Kt(vg,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _$(){return parseInt(this.hot.rootElement.getAttribute(Nw()[0]),10)}function qX(t){const e=Lc(bd,this,_$).call(this)+t;de(this.hot.rootElement,...Nw(e))}function KX(){const t=this.hot.rootElement;this.hasVerticalScroll()?Y(t,"htHasScrollY"):le(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?Y(t,"htVerticallyScrollableByWindow"):le(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?Y(t,"htHasScrollX"):le(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?Y(t,"htHorizontallyScrollableByWindow"):le(t,"htHorizontallyScrollableByWindow")}var fH={},gH={},mH;function XX(){if(mH)return gH;mH=1;var t=yt(),e=hn(),n=rh(),r=xr(),i=fn(),o=Go(),s=Ar(),a=za(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,m){if(!c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),gH}var pH;function ZX(){return pH||(pH=1,XX()),fH}ZX();const M$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",aE=M$.length;function zw(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%aE,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/aE,10);return n}function QX(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=aE**r*(M$.indexOf(t[n])+1);return e-=1,e}function JX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(zw(i)+(r+1));n.push(o)}return n}function e4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=zw(i)+(r+1);n.push(o)}return n}function t4(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function pT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function wT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ye(t[0])&&(e=Dw(t[0]))),e}function P$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function I$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const n4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:wT,createEmptySpreadsheetData:t4,createSpreadsheetData:JX,createSpreadsheetObjectData:e4,dataRowToChangesArray:pT,isArrayOfArrays:P$,isArrayOfObjects:I$,spreadsheetColumnIndex:QX,spreadsheetColumnLabel:zw},Symbol.toStringTag,{value:"Module"}));function Dh(t,e,n){return(e=r4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r4(t){var e=i4(t,"string");return typeof e=="symbol"?e:e+""}function i4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Dh(this,"hot",void 0),Dh(this,"data",void 0),Dh(this,"dataType","array"),Dh(this,"colToProp",()=>{}),Dh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return P(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(ye(a)||Ze(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?jm(l,d,f):l[d]=f}})}else He(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?jm(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Or(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:jm(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?vp(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Or(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}getCopyable(e,n){const r=this.propToCol(n);return this.hot.getCellMeta(e,r).copyable?this.getAtCell(this.hot.toPhysicalRow(e),r):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return wT(this.data)}destroy(){this.data=null,this.hot=null}}var wH={},vH={},CH;function s4(){if(CH)return vH;CH=1;var t=yt(),e=hn(),n=rh(),r=xr(),i=fn(),o=Go(),s=Ar(),a=za(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),vH}var yH;function a4(){return yH||(yH=1,s4()),wH}a4();function SH(t,e,n){return(e=l4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l4(t){var e=u4(t,"string");return typeof e=="symbol"?e:e+""}function u4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;SH(this,"indexedValues",[]),SH(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ze(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}rt(Cu,bn);function vT(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Ze(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function CT(t,e){return La(t,(n,r)=>e.includes(r)===!1)}class Ga extends Cu{insert(e,n){this.indexedValues=vT(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=CT(this.indexedValues,e),super.remove(e)}}class Yw extends Ga{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return gn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function yT(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function uf(t,e){return La(t,n=>e.includes(n)===!1)}function ST(t,e){return Ge(t,n=>n-e.filter(r=>r<n).length)}function bT(t,e){const n=e[0],r=e.length;return Ge(t,i=>i>=n?i+r:i)}function c4(t,e,n){return(e=h4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h4(t){var e=d4(t,"string");return typeof e=="symbol"?e:e+""}function d4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gw extends Cu{constructor(){super(...arguments),c4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=uf(this.orderOfIndexes,[e]),Ze(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=vT(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=bT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=CT(this.indexedValues,e),this.orderOfIndexes=uf(this.orderOfIndexes,e),this.orderOfIndexes=ST(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Uf extends Ga{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return gn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const bH=new Map([["indexesSequence",{getListWithInsertedItems:yT,getListWithRemovedItems:uf}],["physicallyIndexed",{getListWithInsertedItems:vT,getListWithRemovedItems:CT}]]),O$=t=>{if(bH.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return bH.get(t)};class x$ extends Cu{constructor(){super(e=>e)}insert(e,n){const r=bT(this.indexedValues,n);this.indexedValues=yT(r,e,n),super.insert(e,n)}remove(e){const n=uf(this.indexedValues,e);this.indexedValues=ST(n,e),super.remove(e)}}const RH=new Map([["hiding",Yw],["index",Cu],["linkedPhysicalIndexToValue",Gw],["physicalIndexToValue",Ga],["trimming",Uf]]);function f4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!RH.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(RH.get(t))(e)}function g4(t,e,n){return(e=m4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m4(t){var e=p4(t,"string");return typeof e=="symbol"?e:e+""}function p4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let lE=0;class RT{constructor(){g4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),lE+=1)}unregister(e){const n=this.collection.get(e);oe(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),lE-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return _t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}rt(RT,bn);function w4(){return lE}function AS(t,e,n){return(e=v4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t){var e=C4(t,"string");return typeof e=="symbol"?e:e+""}function C4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EH extends RT{constructor(e,n){super(),AS(this,"mergedValuesCache",[]),AS(this,"aggregationFunction",void 0),AS(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ge(this.get(),o=>o.getValues()),r=[],i=oe(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ge(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return oe(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function y4(t,e,n){S4(t,e),e.set(t,n)}function S4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b4(t,e,n){return t.set(A$(t,e),n),n}function R4(t,e){return t.get(A$(t,e))}function A$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var HS=new WeakMap;class H${constructor(){y4(this,HS,[])}subscribe(e){return this.addLocalHook("change",e),this._write(R4(HS,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){b4(HS,this,e)}}rt(H$,bn);function TH(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function kh(t,e,n){E4(t,e),e.set(t,n)}function E4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ui(t,e){return t.get(N$(t,e))}function yg(t,e,n){return t.set(N$(t,e),n),n}function N$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Sg=new WeakMap,Lh=new WeakMap,bg=new WeakMap,Rg=new WeakMap,Eg=new WeakMap;class T4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};kh(this,Sg,new Set),kh(this,Lh,[]),kh(this,bg,[]),kh(this,Rg,!1),kh(this,Eg,!1),yg(Eg,this,e??!1)}createObserver(){const e=new H$;return ui(Sg,this).add(e),e.addLocalHook("unsubscribe",()=>{ui(Sg,this).delete(e)}),e._writeInitialChanges(TH(ui(Lh,this),ui(bg,this))),e}emit(e){let n=ui(bg,this);(!ui(Rg,this)||ui(Lh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ui(Eg,this)):yg(Lh,this,new Array(e.length).fill(ui(Eg,this))),ui(Rg,this)||(yg(Rg,this,!0),n=ui(Lh,this)));const r=TH(n,e);ui(Sg,this).forEach(i=>i._write(r)),yg(bg,this,e)}}function Jn(t,e,n){return(e=_4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=M4(t,"string");return typeof e=="symbol"?e:e+""}function M4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uE{constructor(){Jn(this,"indexesSequence",new x$),Jn(this,"trimmingMapsCollection",new EH(e=>e.some(n=>n===!0),!1)),Jn(this,"hidingMapsCollection",new EH(e=>e.some(n=>n===!0),!1)),Jn(this,"variousMapsCollection",new RT),Jn(this,"hidingChangesObservable",new T4({initialIndexValue:!1})),Jn(this,"notTrimmedIndexesCache",[]),Jn(this,"notHiddenIndexesCache",[]),Jn(this,"isBatched",!1),Jn(this,"indexesSequenceChanged",!1),Jn(this,"indexesChangeSource",void 0),Jn(this,"trimmedIndexesChanged",!1),Jn(this,"hiddenIndexesChanged",!1),Jn(this,"renderablePhysicalIndexesCache",[]),Jn(this,"fromPhysicalToVisualIndexesCache",new Map),Jn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,f4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Uf?this.trimmingMapsCollection.register(e,n):n instanceof Yw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return oe(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return oe(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return oe(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return oe(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ge(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=uf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(yT(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=oe(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Ge(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}rt(uE,bn);function P4(t,e){return He(e,(n,r)=>{_t(t[r])&&(t[r]=n)}),t}function D$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function k$(t){oe(t)&&q0(Qe`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function I4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function L$(t,e){return Array.isArray(t)?t.map(n=>L$(n,e)):Aw(t,e)}const{register:O4,getValues:x4}=Hi("phraseFormatters");function $$(t,e){O4(t,e)}function A4(){return x4()}$$("pluralize",I4);$$("substitute",L$);const F$="ContextMenu:items",_e=F$,ET=`${_e}.noItems`,TT=`${_e}.insertRowAbove`,_T=`${_e}.insertRowBelow`,MT=`${_e}.insertColumnOnTheLeft`,PT=`${_e}.insertColumnOnTheRight`,IT=`${_e}.removeRow`,OT=`${_e}.removeColumn`,xT=`${_e}.undo`,AT=`${_e}.redo`,_p=`${_e}.readOnly`,HT=`${_e}.clearColumn`,NT=`${_e}.copy`,DT=`${_e}.copyWithHeaders`,kT=`${_e}.copyWithGroupHeaders`,LT=`${_e}.copyHeadersOnly`,$T=`${_e}.cut`,FT=`${_e}.freezeColumn`,VT=`${_e}.unfreezeColumn`,WT=`${_e}.mergeCells`,BT=`${_e}.unmergeCells`,jT=`${_e}.addComment`,UT=`${_e}.editComment`,zT=`${_e}.removeComment`,YT=`${_e}.readOnlyComment`,GT=`${_e}.align`,qT=`${_e}.align.left`,KT=`${_e}.align.center`,XT=`${_e}.align.right`,ZT=`${_e}.align.justify`,QT=`${_e}.align.top`,JT=`${_e}.align.middle`,e_=`${_e}.align.bottom`,t_=`${_e}.borders`,n_=`${_e}.borders.top`,r_=`${_e}.borders.right`,i_=`${_e}.borders.bottom`,o_=`${_e}.borders.left`,s_=`${_e}.borders.remove`,a_=`${_e}.nestedHeaders.insertChildRow`,l_=`${_e}.nestedHeaders.detachFromParent`,u_=`${_e}.hideColumn`,c_=`${_e}.showColumn`,h_=`${_e}.hideRow`,d_=`${_e}.showRow`,hr="Filters:",Bt=`${hr}conditions`,qw=`${Bt}.none`,f_=`${Bt}.isEmpty`,g_=`${Bt}.isNotEmpty`,m_=`${Bt}.isEqualTo`,p_=`${Bt}.isNotEqualTo`,w_=`${Bt}.beginsWith`,v_=`${Bt}.endsWith`,C_=`${Bt}.contains`,y_=`${Bt}.doesNotContain`,H4=`${Bt}.byValue`,S_=`${Bt}.greaterThan`,b_=`${Bt}.greaterThanOrEqualTo`,R_=`${Bt}.lessThan`,E_=`${Bt}.lessThanOrEqualTo`,T_=`${Bt}.isBetween`,__=`${Bt}.isNotBetween`,M_=`${Bt}.after`,P_=`${Bt}.before`,I_=`${Bt}.today`,O_=`${Bt}.tomorrow`,x_=`${Bt}.yesterday`,A_=`${hr}labels.filterByCondition`,H_=`${hr}labels.filterByValue`,N_=`${hr}labels.conjunction`,Kw=`${hr}labels.disjunction`,Mp=`${hr}values.blankCells`,D_=`${hr}buttons.selectAll`,k_=`${hr}buttons.clear`,L_=`${hr}buttons.ok`,$_=`${hr}buttons.cancel`,F_=`${hr}buttons.placeholder.search`,V_=`${hr}buttons.placeholder.value`,W_=`${hr}buttons.placeholder.secondValue`,Zo="Pagination:",B_=`${Zo}section.pagination`,j_=`${Zo}.pageSize.auto`,Pp=`${Zo}section.pageSize`,U_=`${Zo}section.counter`,z_=`${Zo}section.navigation`,Y_=`${Zo}firstPage`,G_=`${Zo}prevPage`,q_=`${Zo}nextPage`,K_=`${Zo}lastPage`,X_="CheckboxRenderer:",Z_=`${X_}checked`,Q_=`${X_}unchecked`,V$="Loading:",J_=`${V$}title`,N4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Z_,CHECKBOX_RENDERER_NAMESPACE:X_,CHECKBOX_UNCHECKED:Q_,CONTEXTMENU_ITEMS_ADD_COMMENT:jT,CONTEXTMENU_ITEMS_ALIGNMENT:GT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:e_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:KT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ZT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:qT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:JT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:XT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:QT,CONTEXTMENU_ITEMS_BORDERS:t_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:i_,CONTEXTMENU_ITEMS_BORDERS_LEFT:o_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:r_,CONTEXTMENU_ITEMS_BORDERS_TOP:n_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:HT,CONTEXTMENU_ITEMS_COPY:NT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:LT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:kT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:DT,CONTEXTMENU_ITEMS_CUT:$T,CONTEXTMENU_ITEMS_EDIT_COMMENT:UT,CONTEXTMENU_ITEMS_FREEZE_COLUMN:FT,CONTEXTMENU_ITEMS_HIDE_COLUMN:u_,CONTEXTMENU_ITEMS_HIDE_ROW:h_,CONTEXTMENU_ITEMS_INSERT_LEFT:MT,CONTEXTMENU_ITEMS_INSERT_RIGHT:PT,CONTEXTMENU_ITEMS_MERGE_CELLS:WT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:l_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:a_,CONTEXTMENU_ITEMS_NO_ITEMS:ET,CONTEXTMENU_ITEMS_READ_ONLY:_p,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YT,CONTEXTMENU_ITEMS_REDO:AT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:s_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:OT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:zT,CONTEXTMENU_ITEMS_REMOVE_ROW:IT,CONTEXTMENU_ITEMS_ROW_ABOVE:TT,CONTEXTMENU_ITEMS_ROW_BELOW:_T,CONTEXTMENU_ITEMS_SHOW_COLUMN:c_,CONTEXTMENU_ITEMS_SHOW_ROW:d_,CONTEXTMENU_ITEMS_UNDO:xT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:VT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:BT,CONTEXT_MENU_ITEMS_NAMESPACE:F$,FILTERS_BUTTONS_CANCEL:$_,FILTERS_BUTTONS_CLEAR:k_,FILTERS_BUTTONS_OK:L_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:F_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:W_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:V_,FILTERS_BUTTONS_SELECT_ALL:D_,FILTERS_CONDITIONS_AFTER:M_,FILTERS_CONDITIONS_BEFORE:P_,FILTERS_CONDITIONS_BEGINS_WITH:w_,FILTERS_CONDITIONS_BETWEEN:T_,FILTERS_CONDITIONS_BY_VALUE:H4,FILTERS_CONDITIONS_CONTAINS:C_,FILTERS_CONDITIONS_EMPTY:f_,FILTERS_CONDITIONS_ENDS_WITH:v_,FILTERS_CONDITIONS_EQUAL:m_,FILTERS_CONDITIONS_GREATER_THAN:S_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:b_,FILTERS_CONDITIONS_LESS_THAN:R_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:E_,FILTERS_CONDITIONS_NAMESPACE:Bt,FILTERS_CONDITIONS_NONE:qw,FILTERS_CONDITIONS_NOT_BETWEEN:__,FILTERS_CONDITIONS_NOT_CONTAIN:y_,FILTERS_CONDITIONS_NOT_EMPTY:g_,FILTERS_CONDITIONS_NOT_EQUAL:p_,FILTERS_CONDITIONS_TODAY:I_,FILTERS_CONDITIONS_TOMORROW:O_,FILTERS_CONDITIONS_YESTERDAY:x_,FILTERS_DIVS_FILTER_BY_CONDITION:A_,FILTERS_DIVS_FILTER_BY_VALUE:H_,FILTERS_LABELS_CONJUNCTION:N_,FILTERS_LABELS_DISJUNCTION:Kw,FILTERS_NAMESPACE:hr,FILTERS_VALUES_BLANK_CELLS:Mp,LOADING_NAMESPACE:V$,LOADING_TITLE:J_,PAGINATION_COUNTER_SECTION:U_,PAGINATION_FIRST_PAGE:Y_,PAGINATION_LAST_PAGE:K_,PAGINATION_NAMESPACE:Zo,PAGINATION_NAV_SECTION:z_,PAGINATION_NEXT_PAGE:q_,PAGINATION_PAGE_SIZE_AUTO:j_,PAGINATION_PAGE_SIZE_SECTION:Pp,PAGINATION_PREV_PAGE:G_,PAGINATION_SECTION:B_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const W$={languageCode:"en-US",[ET]:"No available options",[TT]:"Insert row above",[_T]:"Insert row below",[MT]:"Insert column left",[PT]:"Insert column right",[IT]:["Remove row","Remove rows"],[OT]:["Remove column","Remove columns"],[xT]:"Undo",[AT]:"Redo",[_p]:"Read only",[HT]:"Clear column",[GT]:"Alignment",[qT]:"Left",[KT]:"Center",[XT]:"Right",[ZT]:"Justify",[QT]:"Top",[JT]:"Middle",[e_]:"Bottom",[FT]:"Freeze column",[VT]:"Unfreeze column",[t_]:"Borders",[n_]:"Top",[r_]:"Right",[i_]:"Bottom",[o_]:"Left",[s_]:"Remove border(s)",[jT]:"Add comment",[UT]:"Edit comment",[zT]:"Delete comment",[YT]:"Read-only comment",[WT]:"Merge cells",[BT]:"Unmerge cells",[NT]:"Copy",[DT]:["Copy with header","Copy with headers"],[kT]:["Copy with group header","Copy with group headers"],[LT]:["Copy header only","Copy headers only"],[$T]:"Cut",[a_]:"Insert child row",[l_]:"Detach from parent",[u_]:["Hide column","Hide columns"],[c_]:["Show column","Show columns"],[h_]:["Hide row","Hide rows"],[d_]:["Show row","Show rows"],[qw]:"None",[f_]:"Is empty",[g_]:"Is not empty",[m_]:"Is equal to",[p_]:"Is not equal to",[w_]:"Begins with",[v_]:"Ends with",[C_]:"Contains",[y_]:"Does not contain",[S_]:"Greater than",[b_]:"Greater than or equal to",[R_]:"Less than",[E_]:"Less than or equal to",[T_]:"Is between",[__]:"Is not between",[M_]:"After",[P_]:"Before",[I_]:"Today",[O_]:"Tomorrow",[x_]:"Yesterday",[Mp]:"Blank cells",[A_]:"Filter by condition",[H_]:"Filter by value",[N_]:"And",[Kw]:"Or",[D_]:"Select all",[k_]:"Clear",[L_]:"OK",[$_]:"Cancel",[F_]:"Search",[V_]:"Value",[W_]:"Second value",[B_]:"Pagination",[Pp]:"Page size",[j_]:"Auto",[U_]:"[start] - [end] of [total]",[z_]:"Page [currentPage] of [totalPages]",[Y_]:"Go to first page",[G_]:"Go to previous page",[q_]:"Go to next page",[K_]:"Go to last page",[Z_]:"Checked",[Q_]:"Unchecked",[J_]:"Loading..."},D4=N4,cE=W$.languageCode,{register:k4,getItem:B$,hasItem:L4,getValues:$4}=Hi("languagesDictionaries");j$(W$);function j$(t,e){let n=t,r=e;return ye(t)&&(r=t,n=r.languageCode),F4(n,r),k4(n,Xn(r)),Xn(r)}function F4(t,e){t!==cE&&P4(e,B$(cE))}function U$(t){return eM(t)?Xn(B$(t)):null}function eM(t){return L4(t)}function V4(){return $4()}function z$(t,e,n){const r=U$(t);if(r===null)return null;const i=r[e];if(_t(i))return null;const o=W4(i,n);return Array.isArray(o)?o[0]:o}function W4(t,e){return A4().reduce((n,r)=>r(n,e),t)}function B4(t){let e=D$(t);return eM(e)||(e=cE,k$(t)),e}function j4(t,e,n){return(e=U4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=z4(t,"string");return typeof e=="symbol"?e:e+""}function z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ws extends C${constructor(e,n){super(e,null),j4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function NS(t){let{activeHeaderClassName:e,...n}=t;return new Ws({className:e,...n,selectionType:y$})}function Y4(t){let{areaCornerVisible:e,...n}=t;return new Ws({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:aT})}function G4(t){let{...e}=t;return new Ws({className:"highlight",...e,selectionType:aT})}function q4(t){let{columnClassName:e,...n}=t;return new Ws({className:e,...n,selectionType:fX})}function K4(t){let{cellCornerVisible:e,...n}=t;return new Ws({className:"current",headerAttributes:[x0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Tp})}function X4(t){let{border:e,visualCellRange:n,...r}=t;return new Ws({...e,...r,selectionType:gX},n)}function Z4(t){let{...e}=t;return new Ws({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:hX})}function _H(t){let{headerClassName:e,...n}=t;return new Ws({className:e,...n,selectionType:sT})}function Q4(t){let{rowClassName:e,...n}=t;return new Ws({className:e,...n,selectionType:dX})}function J4(t,e){e6(t,e),e.add(t)}function e6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mr(t,e,n){return(e=t6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t6(t){var e=n6(t,"string");return typeof e=="symbol"?e:e+""}function n6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ss(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fo=new WeakSet;class r6{constructor(e){J4(this,fo),mr(this,"options",void 0),mr(this,"layerLevel",0),mr(this,"focus",void 0),mr(this,"fill",void 0),mr(this,"layeredAreas",new Map),mr(this,"areas",new Map),mr(this,"rowHeaders",new Map),mr(this,"columnHeaders",new Map),mr(this,"activeRowHeaders",new Map),mr(this,"activeColumnHeaders",new Map),mr(this,"activeCornerHeaders",new Map),mr(this,"rowHighlights",new Map),mr(this,"columnHighlights",new Map),mr(this,"customSelections",[]),this.options=e,this.focus=K4(e),this.fill=Z4(e)}isEnabledFor(e,n){let r=e;e===Tp&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return ss(fo,this,as).call(this,this.layeredAreas,Y4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return ss(fo,this,as).call(this,this.areas,G4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return ss(fo,this,as).call(this,this.rowHeaders,_H)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return ss(fo,this,as).call(this,this.columnHeaders,_H)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return ss(fo,this,as).call(this,this.activeRowHeaders,NS)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return ss(fo,this,as).call(this,this.activeColumnHeaders,NS)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return ss(fo,this,as).call(this,this.activeCornerHeaders,NS)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return ss(fo,this,as).call(this,this.rowHighlights,Q4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return ss(fo,this,as).call(this,this.columnHighlights,q4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(X4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.layeredAreas.values(),e=>void e.clear()),P(this.rowHeaders.values(),e=>void e.clear()),P(this.columnHeaders.values(),e=>void e.clear()),P(this.activeRowHeaders.values(),e=>void e.clear()),P(this.activeColumnHeaders.values(),e=>void e.clear()),P(this.activeCornerHeaders.values(),e=>void e.clear()),P(this.rowHighlights.values(),e=>void e.clear()),P(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function as(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function MH(t,e,n){return(e=i6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=o6(t,"string");return typeof e=="symbol"?e:e+""}function o6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tM{constructor(e){MH(this,"ranges",[]),MH(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new tM(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function s6(t,e){Y$(t,e),e.add(t)}function a6(t,e,n){return(e=l6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l6(t){var e=u6(t,"string");return typeof e=="symbol"?e:e+""}function u6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DS(t,e,n){Y$(t,e),e.set(t,n)}function Y$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(t,e){return t.get(at(t,e))}function bc(t,e,n){return t.set(at(t,e),n),n}function at(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cs=new WeakMap,jl=new WeakMap,ri=new WeakMap,dt=new WeakSet;class nM{constructor(e,n){s6(this,dt),DS(this,Cs,void 0),DS(this,jl,0),DS(this,ri,{x:0,y:0}),a6(this,"tableApi",void 0),bc(Cs,this,e),this.tableApi=n}setActiveLayerIndex(e){bc(jl,this,e)}getCurrentSelection(){return un(Cs,this).peekByIndex(un(jl,this))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;bc(ri,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=at(dt,this,hE).call(this);const{row:h,col:d}=at(dt,this,xH).call(this,o),f=this.tableApi.fixedRowsBottom(),m=this.tableApi.minSpareRows(),w=this.tableApi.minSpareCols(),y=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),b=this.tableApi.createCellCoords(h+i.row,d+i.col);if(b.row>=c){const D=Or(r&&m>0&&f===0),I=b.col+1,O=I>=u,U=this.tableApi.createCellCoords(b.row-c,O?I-u:I);if(this.runLocalHooks("beforeColumnWrap",D,at(dt,this,Hu).call(this,U),O),D.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&O&&un(Cs,this).size()>1){at(dt,this,PH).call(this);const G=at(dt,this,Tg).call(this,"forward");G!==null&&U.assign(G)}b.assign(U)}}else if(b.row<0){const D=Or(T),I=b.col-1,O=I<0,U=this.tableApi.createCellCoords(c+b.row,O?u+I:I);if(this.runLocalHooks("beforeColumnWrap",D,at(dt,this,Hu).call(this,U),O),T){if(this.shouldSwitchSelectionLayer()&&O&&un(Cs,this).size()>1){at(dt,this,IH).call(this);const G=at(dt,this,Tg).call(this,"backward");G!==null&&U.assign(G)}b.assign(U)}}if({width:u,height:c}=at(dt,this,hE).call(this),b.col>=u){const D=Or(r&&w>0),I=b.row+1,O=I>=c,U=this.tableApi.createCellCoords(O?I-c:I,b.col-u);if(this.runLocalHooks("beforeRowWrap",D,at(dt,this,Hu).call(this,U),O),D.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(y){if(this.shouldSwitchSelectionLayer()&&O&&un(Cs,this).size()>1){at(dt,this,PH).call(this);const G=at(dt,this,Tg).call(this,"forward");G!==null&&U.assign(G)}b.assign(U)}}else if(b.col<0){const D=Or(y),I=b.row-1,O=I<0,U=this.tableApi.createCellCoords(O?c+I:I,u+b.col);if(this.runLocalHooks("beforeRowWrap",D,at(dt,this,Hu).call(this,U),O),y){if(this.shouldSwitchSelectionLayer()&&O&&un(Cs,this).size()>1){at(dt,this,IH).call(this);const G=at(dt,this,Tg).call(this,"backward");G!==null&&U.assign(G)}b.assign(U)}}const{rowDir:M,colDir:R}=at(dt,this,OH).call(this,b);a=M,l=R,o=at(dt,this,Hu).call(this,b)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:un(jl,this),visualCoords:o}}transformEnd(e,n){bc(ri,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=at(dt,this,Ym).call(this,i.to.row,i.from.row),a=at(dt,this,Gm).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=at(dt,this,xH).call(this,i.highlight),f=this.tableApi.createCellCoords(s+r.row,a+r.col),m=i.getTopStartCorner(),w=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const R=f.col-d;f.col=at(dt,this,Gm).call(this,m.col,w.col)+R}else if(r.col>0&&a<=d&&f.col>d){const R=at(dt,this,Gm).call(this,w.col,m.col),D=Math.max(f.col-R,1);f.col=R+D}if(r.row<0&&s>=h&&f.row<h){const R=f.row-h;f.row=at(dt,this,Ym).call(this,m.row,y.row)+R}else if(r.row>0&&s<=h&&f.row>h){const R=at(dt,this,Ym).call(this,y.row,m.row),D=Math.max(f.row-R,1);f.row=R+D}const{rowDir:T,colDir:b}=at(dt,this,OH).call(this,f);u=T,c=b;const M=at(dt,this,Hu).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:un(jl,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function PH(){const t=un(jl,this)+1;this.setActiveLayerIndex(t>=un(Cs,this).size()?0:t),bc(ri,this,this.calculateOffset())}function IH(){const t=un(jl,this)-1;this.setActiveLayerIndex(t<0?un(Cs,this).size()-1:t),bc(ri,this,this.calculateOffset())}function OH(t){const{width:e,height:n}=at(dt,this,hE).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function hE(){return{width:un(ri,this).x+this.countRenderableColumns(),height:un(ri,this).y+this.countRenderableRows()}}function Tg(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[r,i,o,s]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],a=at(dt,this,Ym).call(this,r,i),l=at(dt,this,Gm).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Ym(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:un(ri,this).y+n}function Gm(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:un(ri,this).x+n}function xH(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(un(ri,this).y+e,un(ri,this).x+n)}function Hu(t){const e=t.clone();return e.col=t.col-un(ri,this).x,e.row=t.row-un(ri,this).y,this.tableApi.renderableToVisualCoords(e)}rt(nM,bn);class c6 extends nM{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class h6 extends nM{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:r}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,r-1),o=this.tableApi.countRenderableRowsInRange(0,n-1),s=e.highlight.isHeader(),a=s?Math.abs(r):0,l=s?Math.abs(n):0;return{x:r<0?a:-i,y:n<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const Xw=0,Zw=1,G$=2,rM=3,d6=[rM,G$],f6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],kS=Symbol("root"),AH=Symbol("child");function Yc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:kS;if(e!==kS&&e!==AH)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===kS;let i=Xw;if(n){const o=t[0];t.length===0?i=Zw:r&&o instanceof uh?i=rM:r&&Array.isArray(o)?i=Yc(o,AH):t.length>=2&&t.length<=4&&!t.some((a,l)=>!f6[l].includes(typeof a))&&(i=G$)}return i}function cf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!d6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===rM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),_t(u)&&(u=a),_t(c)&&(c=l),!r){const m=a,w=l,y=u,T=c;a=Math.min(m,y),l=Math.min(w,T),u=Math.max(m,y),c=Math.max(w,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),f=e(u,c);return n(h,d,f)}}function g6(t){const e=Yc(t.getSelected());if(e===Xw||e===Zw)return[];const n=cf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return gn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function m6(t){const e=Yc(t.getSelected());if(e===Xw||e===Zw)return[];const n=cf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;P(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return gn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function nl(t,e,n){p6(t,e),e.set(t,n)}function p6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rl(t,e,n){return(e=w6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=v6(t,"string");return typeof e=="symbol"?e:e+""}function v6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ot(t,e){return t.get(q$(t,e))}function Lr(t,e,n){return t.set(q$(t,e),n),n}function q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $r=new WeakMap,Nu=new WeakMap,_g=new WeakMap,qs=new WeakMap,Mg=new WeakMap,$h=new WeakMap,Pg=new WeakMap;class K${constructor(e,n){var r=this;rl(this,"settings",void 0),rl(this,"tableProps",void 0),rl(this,"inProgress",!1),rl(this,"selectedRange",new tM((i,o,s)=>this.tableProps.createCellRange(i,o,s))),rl(this,"highlight",void 0),nl(this,$r,void 0),nl(this,Nu,void 0),rl(this,"selectedByRowHeader",new Set),rl(this,"selectedByColumnHeader",new Set),nl(this,_g,!1),nl(this,qs,!1),nl(this,Mg,"unknown"),nl(this,$h,-1),nl(this,Pg,0),this.settings=e,this.tableProps=n,this.highlight=new r6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[x0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Lr($r,this,new c6(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Lr(Nu,this,new h6(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ot($r,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),Ot($r,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),Ot($r,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),Ot($r,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),Ot($r,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),Ot($r,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),Ot($r,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),Ot($r,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),Ot(Nu,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),Ot(Nu,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Ot(Pg,this))}getActiveSelectionLayerIndex(){return Ot(Pg,this)}setActiveSelectionLayerIndex(e){Lr(Pg,this,e)}markSource(e){Lr(Mg,this,e)}markEndSource(){Lr(Mg,this,"unknown")}getSelectionSource(){return Ot(Mg,this)}setExpectedLayers(e){Lr($h,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Lr($h,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=_t(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Lr(qs,this,!1),Lr(_g,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&_t(n))&&(this.selectedRange.clear(),P(this.highlight.getAreas(),l=>void l.clear()),P(this.highlight.getLayeredAreas(),l=>void l.clear()),P(this.highlight.getRowHeaders(),l=>void l.clear()),P(this.highlight.getColumnHeaders(),l=>void l.clear()),P(this.highlight.getActiveRowHeaders(),l=>void l.clear()),P(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),P(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),P(this.highlight.getRowHighlights(),l=>void l.clear()),P(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const r=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&r.col<0&&!s||o===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(r),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const l=Ot($h,this)===-1||this.selectedRange.size()===Ot($h,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(aT,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(sT,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(b).commit(),d.add(y).commit(),f.add(b).commit()):(a.add(y).add(T).commit(),l.add(b).add(M).commit(),d.add(y).add(T).commit(),f.add(b).add(M).commit())}const m=!Ot(qs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!Ot(qs,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Ot($r,this).setActiveLayerIndex(n),Ot(Nu,this).setActiveLayerIndex(n);const r=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Tp,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(Lr(_g,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=Ot($r,this).transformStart(e,n,r);this.setRangeStart(i)}transformEnd(e,n){const{visualCoords:r,selectionLayer:i}=Ot($r,this).transformEnd(e,n);this.setRangeEnd(r,i)}transformFocus(e,n){const{selectionLayer:r,visualCoords:i}=Ot(Nu,this).transformStart(e,n);this.setRangeFocus(i.normalize(),r)}shiftRows(e,n){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ke(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(ke(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ke(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,ke(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,ke(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,ke(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=Or(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Ot(_g,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(ke(d.row,u,o-1),ke(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",m,w,h),this.setRangeStartOnly(m,void 0,h),Lr(qs,this,f),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectAll",m,w,h),this.finish()}selectCells(e){var n=this;const r=Yc(e);if(r===Zw)return!1;if(r===Xw)throw new Error(Qe`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=cf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),P(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=ke(r.row,u,s-1),m=ke(r.col,Math.min(i,o),Math.max(i,o))):(f=ke(r,u,s-1),m=i);const w=this.tableProps.createCellCoords(f,m),y=l===0?0:ke(w.row,u,-1),T=s-1,b=this.tableProps.createCellCoords(y,i),M=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",b,M,w),this.setRangeStartOnly(b,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",b,M,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=ke(r.row,Math.min(e,n),Math.max(e,n)),d=ke(r.col,a,o-1)):(h=e,d=ke(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:ke(f.col,a,-1),w=o-1,y=this.tableProps.createCellCoords(e,m),T=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",y,T,f),this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",y,T,f),this.finish()}return c}importSelection(e){let{ranges:n,activeRange:r,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,Lr(qs,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),n.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(r.highlight,i),Lr(qs,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Ot(qs,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:ke(u.row,this.settings.navigableHeaders?-1/0:0,c),col:ke(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:ke(a.row,-1/0,c),col:ke(a.col,-1/0,h)}),l.assign({row:ke(l.row,-1/0,c),col:ke(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.getActiveSelectedRange();this.highlight.isEnabledFor(Tp,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}rt(K$,bn);const HH=/^(\r\n|\n\r|\r|\n)/,C6=/^[^\t\r\n]+/,NH=/^\t/;function y6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(NH))t=t.replace(NH,""),n+=1,e[r][n]="";else if(t.match(HH))t=t.replace(HH,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(C6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Ip(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function LS(t,e){const{instance:n,visualRow:r,visualCol:i,valueSetter:o}=e;return Ze(o)?o.call(n,t,r,i,e):t}function S6(t,e){const{instance:n,visualRow:r,visualCol:i,valueGetter:o}=e;return Ze(o)?o.call(n,t,r,i,e):t}function il(t,e,n){return(e=b6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b6(t){var e=R6(t,"string");return typeof e=="symbol"?e:e+""}function R6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){il(this,"hot",void 0),il(this,"metaManager",void 0),il(this,"tableMeta",void 0),il(this,"dataSource",void 0),il(this,"duckSchema",void 0),il(this,"colToPropCache",void 0),il(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Dw(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(ye(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return wT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&He(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&oe(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(oe(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?jc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Xn(this.getSchema()):(m=[],fe(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Df(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<n&&l+f<s;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let w=0;w<u;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<u;w++)o[w].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=oe(this.tableMeta.columns)||oe(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];GR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return aL(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];GR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Vt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let c=i;if(!c)return null;const h=n.split(".");for(let d=0,f=h.length;d<f;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));const l=this.propToCol(n),u=this.hot.toPhysicalColumn(l);if(nu(r)&&nu(u)&&(a=S6(a,this.metaManager.getCellMeta(r,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=Or(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Or(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Vt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Rc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Rc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Ip(this.getRange(e,n,Rc.DESTINATION_RENDERER))}getCopyableText(e,n){return Ip(this.getRange(e,n,Rc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:E6,getItem:T6,hasItem:X$,getNames:_6,getValues:Jde}=Hi("cellTypes");function iM(t){if(!X$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return T6(t)}function hi(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Rr(t,n),r&&Yr(t,r),i&&Bl(t,i),E6(t,e)}function M6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Vt(e,t)}function Qw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?iM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&He(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!ye(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};He(r,(o,s)=>{if(M6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),tn(t,i)}function P6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}bL(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function qm(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Rd(t){return t==null}const Z$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Wt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Wt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),kf(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function DH(t,e,n){return(e=I6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I6(t){var e=O6(t,"string");return typeof e=="symbol"?e:e+""}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x6(){return class{}}class A6{constructor(e){DH(this,"metaCtor",x6()),DH(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,Z$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),Qw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function H6(t,e,n){return(e=N6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N6(t){var e=D6(t,"string");return typeof e=="symbol"?e:e+""}function D6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k6{constructor(e){H6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),Qw(this.meta,e,e)}}function Ig(t,e,n){return(e=L6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L6(t){var e=$6(t,"string");return typeof e=="symbol"?e:e+""}function $6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Op{constructor(e){Ig(this,"valueFactory",void 0),Ig(this,"data",[]),Ig(this,"index",[]),Ig(this,"holes",new Set),this.valueFactory=e}obtain(e){qm(()=>nu(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;qm(()=>nu(e)||Rd(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Rd(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;qm(()=>nu(e)||Rd(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Rd(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function kH(t,e,n){return(e=F6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=V6(t,"string");return typeof e=="symbol"?e:e+""}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const W6=["data","width"];class B6{constructor(e){kH(this,"globalMeta",void 0),kH(this,"metas",new Op(()=>this._createMeta())),this.globalMeta=e,this.metas=new Op(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);tn(r,n),Qw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return P6(this.globalMeta.getMetaConstructor(),W6).prototype}}function LH(t,e,n){return(e=j6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j6(t){var e=U6(t,"string");return typeof e=="symbol"?e:e+""}function U6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z6{constructor(e){LH(this,"columnMeta",void 0),LH(this,"metas",new Op(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);tn(i,r),Qw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)oe(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){qm(()=>nu(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Op(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Q${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new A6(e),this.tableMeta=new k6(this.globalMeta),this.columnMeta=new B6(this.globalMeta),this.cellMeta=new z6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}rt(Q$,bn);function $H(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Kn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ze(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Rc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let w,y=0,T=0;for(y=0,T=d.startRows;y<T;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=Xn(m),t.push(w);else if(i.dataType==="array")w=Xn(m[0]),t.push(w);else{w=[];for(let b=0,M=d.startCols;b<M;b++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&de(i.rootElement,[CL(-1),Nw(i.countCols()+(i.view?i.countRowHeaders():0))])}function FH(t,e,n){return(e=Y6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:e+""}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q6{constructor(e){var n=this;FH(this,"metaManager",void 0),FH(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),re.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Vt(e,"type")?e.type:null;let c=Ze(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function K6(t,e,n){X6(t,e),e.set(t,n)}function X6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $S(t,e,n){return(e=Z6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z6(t){var e=Q6(t,"string");return typeof e=="symbol"?e:e+""}function Q6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J6(t,e){return t.get(e9(t,e))}function e9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var VH=new WeakMap;class t9{constructor(e){$S(this,"metaManager",void 0),$S(this,"usageTracker",new Set),$S(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),K6(this,VH,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,J6(VH,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const J$="gridDefault",qa="editorManager.handlingEditor",n9={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},r9="hooksRefRegisterer",eF={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){P(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){He(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Xo(eF,"MIXIN_NAME",r9,{writable:!1,enumerable:!1});function $i(t,e,n){return(e=i9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9(t){var e=o9(t,"string");return typeof e=="symbol"?e:e+""}function o9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const s9="base",zt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class hh{static get EDITOR_TYPE(){return s9}constructor(e){$i(this,"hot",void 0),$i(this,"state",zt.VIRGIN),$i(this,"_opened",!1),$i(this,"_fullEditMode",!1),$i(this,"_closeCallback",null),$i(this,"TD",null),$i(this,"row",null),$i(this,"col",null),$i(this,"prop",null),$i(this,"originalValue",null),$i(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:zt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();r=u.row,i=u.col,o=c.row,s=c.col}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==zt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=zt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Ct(l);this.setValue(u)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===zt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===zt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=zt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=zt.FINISHED,this.discardEditor(s)}):(this.state=zt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=zt.FINISHED,this.discardEditor()}discardEditor(e){this.state===zt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=zt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=zt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===zt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Dn(n),a=Gt(n),l=Dn(this.hot.rootElement),u=Gt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=w.name,T=["master","inline_start"].includes(y)?d:0,b=["master","top","bottom"].includes(y)?f:0,M=s.top===l.top?0:1;let R=s.top-l.top-M-T,D=0;this.hot.isRtl()?D=o.innerWidth-s.left-a-m-1+b:D=s.left-l.left-1-b,["top","top_inline_start_corner"].includes(y)&&(R+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(D+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&O<=0||O===W)&&(R+=1),U<=0&&(D+=1);const X=i.rowsRenderCalculator.startPosition,z=i.columnsRenderCalculator.startPosition,ae=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),ce=en(this.hot.rootDocument);let Et=n.offsetTop;if(["inline_start","master"].includes(y)&&(Et+=X-ee),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:F,wtTable:j}=r.bottomOverlay.clone;Et+=F.getWorkspaceHeight()-j.getHeight()-ce}let $e=n.offsetLeft;this.hot.isRtl()?($e>=0?$e=w.getWidth()-n.offsetLeft:$e=Math.abs($e),$e+=z-ae-a):["top","master","bottom"].includes(y)&&($e+=z-ae);const Ye=o.getComputedStyle(this.TD),St=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",ut=parseInt(Ye[St],10)>0?0:1,ct=parseInt(Ye.borderTopWidth,10)>0?0:1,kn=Gt(n)+ut,it=Jt(n)+ct,g=W0(c)?ce:0,p=B0(h)?ce:0,C=this.hot.view.maximumVisibleElementWidth($e)-g+ut,k=Math.max(this.hot.view.maximumVisibleElementHeight(Et)-p+ct,this.hot.stylesHandler.getDefaultRowHeight());return{top:R,start:D,height:it,maxHeight:k,width:kn,maxWidth:C}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}rt(hh,eF);const a9={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===zt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},l9={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},u9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},c9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},h9={name:"editorOpen",callback(t,e,n){const{selection:r}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>r.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;n.includes("shift")?r.transformFocus(-u.row,-u.col):r.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Ai(e))}};function d9(){return[n9,a9,l9,u9,c9,h9]}const f9={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},g9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeActive(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},m9={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},p9={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},w9={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},v9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},C9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},y9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},S9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},b9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},R9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeActive(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},E9={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},T9={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},_9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeActive(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function M9(){return[f9,g9,m9,p9,w9,v9,C9,y9,S9,b9,R9,E9,T9,_9]}const P9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},I9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},O9={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),(i.some(a=>n.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-s.row,-s.col):n.transformStart(-s.row,-s.col),n.markEndSource()}},x9={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),(i.some(a=>n.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(s.row,s.col):n.transformStart(s.row,s.col),n.markEndSource()}},A9={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},H9={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},N9={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},D9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},k9={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},L9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},$9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeActive().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},F9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeActive().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},V9={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},W9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},B9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},j9={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function U9(){return[P9,I9,O9,x9,A9,H9,N9,D9,k9,L9,$9,F9,V9,W9,B9,j9]}const z9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Y9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},G9={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},q9={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},K9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},X9=[...d9(),...M9(),...U9(),z9,Y9,G9,q9,K9];function tF(t){const e={};return X9.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Z9(t){const e=t.getShortcutManager().addContext("editor"),n=tF(t),r={group:qa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Q9(t){const e=t.getShortcutManager().addContext("grid"),n=tF(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return oe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:J$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:qa,runOnlyIf:()=>oe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function J9(t){[Q9,Z9].forEach(e=>e(t))}function oM(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=WH(t),i=WH(t);return r.addEventListener("focus",()=>n==null?void 0:n.onFocus("from_above")),i.addEventListener("focus",()=>n==null?void 0:n.onFocus("from_below")),e.prepend(r),e.append(i),{focus(o){o==="from_above"?r.focus():i.focus()},activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function WH(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&de(n,[ti("Focus catcher")]),n}function e8(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:r}=t;if(n.isHidden(e.row)||r.isHidden(e.col))return null;const i=pp(t),o=wp(t);return e.row=ke(e.row,i.row,o.row),e.col=ke(e.col,i.col,o.col),e}}function t8(t){const e=e8(t);let n;const{activate:r,deactivate:i}=oM(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const m=(d=e(n))!==null&&d!==void 0?d:pp(t),w=t.runHooks("modifyFocusOnTabNavigation","from_above",m);m&&w!==!1&&t.selectCell(m.row,m.col)}else{var f;const m=(f=e(n))!==null&&f!==void 0?f:wp(t),w=t.runHooks("modifyFocusOnTabNavigation","from_below",m);m&&w!==!1&&t.selectCell(m.row,m.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);(d==null?void 0:d.scope)==="table"&&r()}),t.addHook("afterSelection",(h,d,f,m,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var y;n=(y=t.getSelectedRangeActive())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:J$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?pp(t):wp(t)),u(),!1;h.preventDefault()},position:"after"}])}function dh(t){Bo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Jw(t){const{selection:e,view:n}=t,r=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,w=f<=h,y=m>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?r.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:w&&y?r.highlight.row:w?f:y?m:T.row}}}function n8(t){return e=>{const n=Jw(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;dh(t.getCell(r?-1:0,n,!0))})}}function r8(){return()=>{}}function i8(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:r,col:i}=n.highlight;dh(t.getCell(r,i,!0))})}}function o8(t){return e=>{const n=Jw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;dh(t.getCell(i,o,!0))})}}function s8(t){return e=>{const n=Jw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;dh(t.getCell(i,o,!0))})}}function a8(t){return e=>{const n=Jw(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;dh(t.getCell(n,r?-1:0,!0))})}}function l8(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{dh(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function u8(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=i8(t):e.isSelectedByCorner()?s=r8():e.isSelectedByRowHeader()?s=a8(t):e.isSelectedByColumnHeader()?s=n8(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=o8(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=l8(t):e.getSelectedRange().size()>1&&(s=s8(t)),(o=s)===null||o===void 0||o(i)}}}const BH=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Og=t=>t.map(e=>{const n=e.toLowerCase();return BH.has(n)?BH.get(n):n}).sort().join("+"),c8=t=>t.split("+"),jH=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),FS=t=>{let{which:e,key:n}=t;if(jH.has(e))return jH.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},nF=Symbol("shortcut-context");function dE(t){return ye(t)&&t.__kindOf===nF}const h8=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=Bw({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:w=!1,relativeToGroup:y,position:T,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_t(h))throw new Error("You need to define the shortcut's group.");if(Ze(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(Qe`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const M={callback:c,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:w};oe(y)&&(M.relativeToGroup=y,M.position=T),dE(b)&&(M.forwardToContext=b),u.forEach(R=>{const D=Og(R);if(n.hasItem(D)){const O=n.getItem(D);let U=O.findIndex(G=>G.group===y);U!==-1?T==="before"?U-=1:U+=1:U=O.length,O.splice(U,0,M)}else n.addItem(D,[M])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{He(c,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=c[f])}),r(h)})},o=u=>{const c=Og(u);n.removeItem(c)};return{__kindOf:nF,scope:e,addShortcut:r,addShortcuts:i,getShortcuts:u=>{const c=Og(u),h=n.getItem(c);return oe(h)?h.slice():[]},hasShortcut:u=>{const c=Og(u);return n.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{n.getItems().forEach(h=>{let[d,f]=h;const m=f.filter(w=>w.group!==u);m.length===0?o(c8(d)):(f.length=0,f.push(...m))})}}};function d8(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const f8=["meta","alt","shift","control"],Fh=d8(),Vh=[];let xg=0;function g8(t,e,n,r,i){const o=f=>f8.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),m&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ba(f))return;const w=FS(f);let y=[];o(w)||(y=s(f));const T=[w].concat(y);!i(f,T)&&(yp()&&y.includes("meta")||!yp()&&y.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=FS(f);o(m)&&Fh.press(m)}},u=f=>{if(typeof f.key=="string"){const m=FS(f);o(m)&&Fh.release(m)}},c=()=>{Fh.releaseAll()};return{mount:()=>{let f=t;for(xg+=1;f;)xg===1&&(f.document.documentElement.addEventListener("keydown",l),Vh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Vh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=iu(f)},unmount:()=>{let f=t;for(xg-=1;f;){if(xg===0){for(let m=0;m<Vh.length;m++){const{event:w,listener:y}=Vh[m];f.document.documentElement.removeEventListener(w,y)}Vh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=iu(f)}},isPressed:f=>Fh.isPressed(f),releasePressedKeys:()=>Fh.releaseAll()}}const m8=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Bw({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=function(w){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const T=h8(w,y);return o.addItem(w,T),T},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(Qe`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const d=function(w,y){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=dE(T)?T:u(T);let M=!1;if(!b.hasShortcut(y))return M;const R=b.getShortcuts(y);for(let D=0;D<R.length;D++){const{callback:I,runOnlyIf:O,preventDefault:U,stopPropagation:G,captureCtrl:W,forwardToContext:X}=R[D];if(O(w)===!0){if(h=W,M=I(w,y)===!1,h=!1,U&&w.preventDefault(),G&&(Ai(w),w.stopPropagation()),M)break;X&&d(w,y,X)}}return M},m=g8(e,w=>{const y=l(),T=dE(y)?y:u(y);return n(w,T.scope)},r,i,d);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function UH(t){const{classNames:e}=AL(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function p8(t,e){rF(t,e),e.add(t)}function Ks(t,e,n){rF(t,e),e.set(t,n)}function rF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e){return t.get(Xi(t,e))}function qr(t,e,n){return t.set(Xi(t,e),n),n}function Xi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zH=23;var go=new WeakMap,xp=new WeakMap,sM=new WeakMap,fE=new WeakMap,ga=new WeakMap,Ed=new WeakMap,hf=new WeakMap,Wh=new WeakMap,xo=new WeakSet;class w8{constructor(e){let{rootElement:n,rootDocument:r,onThemeChange:i=()=>{}}=e;p8(this,xo),Ks(this,go,void 0),Ks(this,xp,void 0),Ks(this,sM,void 0),Ks(this,fE,void 0),Ks(this,ga,!0),Ks(this,Ed,{}),Ks(this,hf,{}),Ks(this,Wh,void 0),qr(xp,this,n),qr(fE,this,r),qr(Wh,this,i)}isClassicTheme(){return Ut(ga,this)}getCSSVariableValue(e){var n;if(Ut(ga,this))return null;if(Ut(Ed,this)[`--ht-${e}`])return Ut(Ed,this)[`--ht-${e}`];const r=(n=Xi(xo,this,y8).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Xi(xo,this,iF).call(this,`--ht-${e}`);if(r!==null)return Ut(Ed,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=Ut(hf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Ut(ga,this))return zH;const e=Xi(xo,this,v8).call(this);return e||zH}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){qr(go,this,void 0),qr(ga,this,!0),Ut(Wh,this).call(this,Ut(go,this)),Xi(xo,this,VS).call(this);return}if(e&&e!==Ut(go,this)){if(!/ht-theme-.*/.test(e)){We(`Invalid theme name: ${e}. Please provide a valid theme name.`),qr(go,this,void 0),qr(ga,this,!1),Ut(Wh,this).call(this,Ut(go,this)),Xi(xo,this,VS).call(this);return}Ut(go,this)&&Xi(xo,this,S8).call(this),qr(go,this,e),qr(ga,this,!1),Ut(Wh,this).call(this,Ut(go,this)),Xi(xo,this,VS).call(this)}}getThemeName(){return Ut(go,this)}}function v8(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function VS(){this.isClassicTheme()||qr(sM,this,getComputedStyle(Ut(xp,this)));const t=Xi(xo,this,C8).call(this,["box-sizing","border-bottom-width"]);Ut(hf,this).td={...Ut(hf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function C8(t){const e=Ut(fE,this),n=Ut(xp,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function y8(t){const e=Math.ceil(parseFloat(Xi(xo,this,iF).call(this,t)));return Number.isNaN(e)?null:e}function iF(t){const e=Ut(sM,this).getPropertyValue(t);return e===""?null:e}function S8(){qr(hf,this,{}),qr(Ed,this,{}),qr(ga,this,!0)}function b8(t,e){oF(t,e),e.add(t)}function YH(t,e,n){oF(t,e),e.set(t,n)}function oF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GH(t,e){return t.get(Gc(t,e))}function qH(t,e,n){return t.set(Gc(t,e),n),n}function Gc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gE=new WeakMap,mE=new WeakMap,kd=new WeakSet;class R8{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;b8(this,kd),YH(this,gE,void 0),YH(this,mE,void 0),qH(gE,this,n),qH(mE,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=Gc(kd,this,KH).call(this,e.from,n,r);if(i===null)return null;const o=Gc(kd,this,KH).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function KH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=Gc(kd,this,XH).call(this,GH(gE,this),t.row,e);if(r===null)return null;const i=Gc(kd,this,XH).call(this,GH(mE,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function XH(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let ei=null,Km=0;function E8(t){const e=t.ownerDocument;if(!ei){ei=e.createElement("div"),ei.setAttribute("role","status"),ei.setAttribute("aria-live","assertive"),ei.setAttribute("aria-atomic","true");const n=ei.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(ei)}Km+=1}function T8(){Km!==0&&(Km===1&&(ei.remove(),ei=null),Km-=1)}function _8(t){ei&&(ei.textContent="",setTimeout(()=>{ei&&(ei.textContent=t)},100))}let WS=null;const Ag=new WeakSet,BS=new Map;function sF(t,e){var n,r,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new _i(s);let l,u,c,h,d,f,m=!0;const w={...e.initialState,...e};jX(o)&&BX(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=kl(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,kl(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Y(this.rootElement,["ht-wrapper","handsontable"]),Y(this.rootWrapperElement,"ht-root-wrapper"),Y(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),Y(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const y=(n=w==null?void 0:w.layoutDirection)!==null&&n!==void 0?n:"inherit",T=["rtl","ltr"].includes(y)?y:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(r=this.rootWrapperElement)===null||r===void 0||r.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new w8({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:g=>{kl(this)&&(le(this.rootWrapperElement,/ht-theme-.*/g),le(this.rootPortalElement,/ht-theme-.*/g),g&&(Y(this.rootWrapperElement,g),Y(this.rootPortalElement,g),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||We(`The "${g}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),w.language=B4(w.language);const b=Object.fromEntries(Object.entries(w).filter(g=>{let[p]=g;return!(re.getSingleton().isRegistered(p)||re.getSingleton().isDeprecated(p))})),M=new Q$(s,b,[q6,t9]),R=M.getTableMeta(),D=M.getGlobalMeta(),I=Bw();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${P0()}`,BS.set(this.guid,this),this.columnIndexMapper=new uE,this.rowIndexMapper=new uE,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{s.runHooks("beforeCompositionStart",g)}),u=new o4(s);const O=Hi(this.guid);O.register("cellRangeMapper",new R8({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const U=g=>{const{row:p,col:C}=g;return s._createCellCoords(p>=0?s.rowIndexMapper.getRenderableFromVisualIndex(p):p,C>=0?s.columnIndexMapper.getRenderableFromVisualIndex(C):C)},G=g=>{const{row:p,col:C}=g;return s._createCellCoords(p>=0?s.rowIndexMapper.getVisualFromRenderableIndex(p):p,C>=0?s.columnIndexMapper.getVisualFromRenderableIndex(C):C)},W=(g,p)=>{const C=p>g?1:-1,k=Math.min(g,p),F=Math.max(g,p),j=s.rowIndexMapper.getNearestNotHiddenIndex(g,C);return j===null||C===1&&j>F||C===-1&&j<k?null:j>=0?s.rowIndexMapper.getRenderableFromVisualIndex(j):j},X=(g,p)=>{const C=p>g?1:-1,k=Math.min(g,p),F=Math.max(g,p),j=s.columnIndexMapper.getNearestNotHiddenIndex(g,C);return j===null||C===1&&j>F||C===-1&&j<k?null:j>=0?s.columnIndexMapper.getRenderableFromVisualIndex(j):j};let z=new K$(R,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,p)=>s._createCellCoords(g,p),createCellRange:(g,p,C)=>s._createCellRange(g,p,C),visualToRenderableCoords:U,renderableToVisualCoords:G,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:X,isDisabledCellSelection:(g,p)=>g<0||p<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,p).disableVisualSelection});this.selection=z;const ae=g=>{let{hiddenIndexesChanged:p}=g;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ae),this.rowIndexMapper.addLocalHook("cacheUpdated",ae),this.selection.addLocalHook("afterSetRangeEnd",(g,p)=>{const C=Or(!1),k=this.selection.getSelectedRange(),{from:F,to:j}=k.current(),v=k.size()-1;this.runHooks("afterSelection",F.row,F.col,j.row,j.col,C,v),this.runHooks("afterSelectionByProp",F.row,s.colToProp(F.col),j.row,s.colToProp(j.col),C,v),p&&(!C.isTouched()||C.isTouched()&&!C.value)&&f.scrollTo(g);const S=z.isSelectedByRowHeader(),_=z.isSelectedByColumnHeader();S&&_?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):S?(le(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):_?(le(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(z.getSelectionSource())||h.closeEditor(null),z.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const p=Or(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&f.scrollTo(g),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const p=g.length-1,{from:C,to:k}=g[p];this.runHooks("afterSelectionEnd",C.row,C.col,k.row,k.col,p),this.runHooks("afterSelectionEndByProp",C.row,s.colToProp(C.col),k.row,s.colToProp(k.col),p),z.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const p=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterSelectRows",...p)}).addLocalHook("beforeSelectAll",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeSelectAll",...p)}).addLocalHook("afterSelectAll",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterSelectAll",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,p=new Array(g),C=0;C<g;C++)p[C]=arguments[C];return i.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,k=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const j=v=>{if(v.length===0)return[];const S=[...v];return S.sort((x,E)=>{let[H]=x,[$]=E;return H===$?0:H>$?1:-1}),gn(S,(x,E)=>{let[H,$]=E;const A=x[x.length-1],[L,B]=A,V=L+B;if(H<=V){const q=Math.max($-(V-H),0);A[1]+=q}else x.push([H,$]);return x},[S[0]])};switch(g){case"insert_row_below":case"insert_row_above":const v=s.countSourceRows();if(R.maxRows===v)return;const S=g==="insert_row_below"?"below":"above";p=p??(S==="below"?v:0);const{delta:_,startPhysicalIndex:x}=l.createRow(p,C,{source:k,mode:S});z.shiftRows(s.toVisualRow(x),_);break;case"insert_col_start":case"insert_col_end":const E=g==="insert_col_end"?"end":"start";p=p??(E==="end"?s.countSourceCols():0);const{delta:H,startPhysicalIndex:$}=l.createCol(p,C,{source:k,mode:E});if(H){if(Array.isArray(R.colHeaders)){const B=[s.toVisualColumn($),0];B.length+=H,Array.prototype.splice.apply(R.colHeaders,B)}z.shiftColumns(s.toVisualColumn($),H)}break;case"remove_row":const A=B=>{let V=0;P(B,q=>{let[J,se]=q;const be=Wt(J)?s.countRows()-1:Math.max(J-V,0);if(Number.isInteger(J)&&(J=Math.max(J-V,0)),!l.removeRow(J,se,k))return;if(z.isSelected()){const{row:qe}=s.getSelectedRangeActive().highlight;qe>=J&&qe<=J+se-1&&h.closeEditor(!0)}const Xe=s.countRows(),Re=R.fixedRowsTop;Re>=be+1&&(R.fixedRowsTop-=Math.min(se,Re-be));const Te=R.fixedRowsBottom;if(Te&&be>=Xe-Te&&(R.fixedRowsBottom-=Math.min(se,Te)),Xe===0)z.deselect();else if(k==="ContextMenu.removeRow"){const qe=z.getSelectedRange(),xn=qe.pop();qe.clear().set(xn.from).current().setTo(xn.to),z.refresh()}else z.shiftRows(J,-se);V+=se})};Array.isArray(p)?A(j(p)):A([[p,C]]);break;case"remove_col":const L=B=>{let V=0;P(B,q=>{let[J,se]=q;const be=Wt(J)?s.countCols()-1:Math.max(J-V,0);let je=s.toPhysicalColumn(be);if(Number.isInteger(J)&&(J=Math.max(J-V,0)),!l.removeCol(J,se,k))return;if(z.isSelected()){const{col:qe}=s.getSelectedRangeActive().highlight;qe>=J&&qe<=J+se-1&&h.closeEditor(!0)}if(s.countCols()===0)z.deselect();else if(k==="ContextMenu.removeColumn"){const qe=z.getSelectedRange(),xn=qe.pop();qe.clear().set(xn.from).current().setTo(xn.to),z.refresh()}else z.shiftColumns(J,-se);const Te=R.fixedColumnsStart;Te>=be+1&&(R.fixedColumnsStart-=Math.min(se,Te-be)),Array.isArray(R.colHeaders)&&(typeof je>"u"&&(je=-1),R.colHeaders.splice(je,se)),V+=se})};Array.isArray(p)?L(j(p)):L([[p,C]]);break;default:throw new Error(`There is no such action "${g}"`)}F||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const g=R.minRows,p=R.minSpareRows,C=R.minCols,k=R.minSpareCols;if(g){const F=s.countRows();F<g&&l.createRow(F,g-F,{source:"auto"})}if(p){const F=s.countEmptyRows(!0);if(F<p){const j=p-F,v=Math.min(j,R.maxRows-s.countSourceRows());l.createRow(s.countRows(),v,{source:"auto"})}}{let F;(C||k)&&(F=s.countEmptyCols(!0));let j=s.countCols();if(C&&!R.columns&&j<C){const v=C-j;F+=v,l.createCol(j,v,{source:"auto"})}if(k&&!R.columns&&s.dataType==="array"&&F<k){j=s.countCols();const v=k-F,S=Math.min(v,R.maxCols-j);l.createCol(j,S,{source:"auto"})}}},populateFromArray(g,p,C,k,F){let j,v,S,_;const x=[],E={},H=[],$=g.row,A=g.col;if(v=p.length,v===0)return!1;let L=0,B=0;switch(ye(C)&&(L=C.col-A+1,B=C.row-$+1),F){case"shift_down":const q=Id(p),J=q.length,se=Math.max(J,L),be=s.getData().slice($),je=Id(be).slice(A,A+se);for(S=0;S<se;S+=1)if(S<J){for(j=0,v=q[S].length;j<B-v;j+=1)q[S].push(q[S][j%v]);S<je.length?H.push(q[S].concat(je[S])):H.push(q[S].concat(new Array(be.length).fill(null)))}else H.push(q[S%J].concat(je[S]));s.populateFromArray($,A,Id(H));break;case"shift_right":const Xe=p.length,Re=Math.max(Xe,B),Te=s.getData().slice($).map(Je=>Je.slice(A));for(j=0;j<Re;j+=1)if(j<Xe){for(S=0,_=p[j].length;S<L-_;S+=1)p[j].push(p[j][S%_]);if(j<Te.length)for(let Je=0;Je<Te[j].length;Je+=1)p[j].push(Te[j][Je]);else p[j].push(...new Array(Te[0].length).fill(null))}else p.push(p[j%v].slice(0,Re).concat(Te[j]));s.populateFromArray($,A,p);break;case"overwrite":default:E.row=g.row,E.col=g.col;let qe=0,xn=0,Hr=!0,Nr;const Rn=function(ot){let ao=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ka=p[ot%p.length];return ao!==null?Ka[ao%Ka.length]:Ka},Dr=p.length,bt=C?C.row-g.row+1:0;for(C?v=bt:v=Math.max(Dr,bt),j=0;j<v&&!(C&&E.row>C.row&&bt>Dr||!R.allowInsertRow&&E.row>s.countRows()-1||E.row>=R.maxRows);j++){const Je=j-qe,ot=Rn(Je).length,ao=C?C.col-g.col+1:0;if(C?_=ao:_=Math.max(ot,ao),E.col=g.col,Nr=s.getCellMeta(E.row,E.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&Nr.skipRowOnPaste){qe+=1,E.row+=1,v+=1;continue}for(xn=0,S=0;S<_;S++){var V;if(C&&E.col>C.col&&ao>ot||!R.allowInsertColumn&&E.col>s.countCols()-1||E.col>=R.maxCols)break;if(Nr=s.getCellMeta(E.row,E.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&Nr.skipColumnOnPaste){xn+=1,E.col+=1,_+=1;continue}if(Nr.readOnly&&k!=="UndoRedo.undo"){E.col+=1;continue}const Ka=S-xn,js=!!Nr.valueSetter;let Zn=Rn(Je,Ka),kr=(V=s.getSourceDataAtCell(E.row,E.col))!==null&&V!==void 0?V:null;if(Zn!==null&&typeof Zn=="object"){if(Array.isArray(Zn)&&kr===null&&(kr=[]),!js&&(typeof kr!="object"||kr===null))Hr=!1;else if(kr!==null){const Us=jc(Array.isArray(kr)?kr:kr[0]||kr),tg=jc(Array.isArray(Zn)?Zn:Zn[0]||Zn);js||kf(Us,tg)||Array.isArray(Us)&&Array.isArray(tg)?Zn=Xn(Zn):Hr=!1}}else!js&&kr!==null&&typeof kr=="object"&&(Hr=!1);Hr&&x.push([E.row,E.col,Zn]),Hr=!0,E.col+=1}E.row+=1}s.setDataAtCell(x,null,null,k||"populateFromArray");break}}};function ee(g){const p=D$(g);eM(p)?(s.runHooks("beforeLanguageChange",p),D.language=p,s.runHooks("afterLanguageChange",p)):k$(g)}function ce(g,p){const C=g==="className"?s.rootElement:s.table;if(m)Y(C,p);else{let k=[],F=[];D[g]&&(k=Array.isArray(D[g])?D[g]:KR(D[g])),p&&(F=Array.isArray(p)?p:KR(p));const j=qR(k,F),v=qR(F,k);j.length&&le(C,j),v.length&&Y(C,v)}D[g]=p}this.init=function(){u.setData(R.data),s.runHooks("beforeInit"),(eo()||D0())&&Y(s.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new GX(this),h=JR.getInstance(s,R,z),f=u8(s),d=new bq(s),kl(this)&&(t8(s),E8(s.rootPortalElement),fL(w.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),m&&s.rootElement.offsetParent===null&&BL(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof m=="object"&&(s.runHooks("afterChange",m[0],m[1]),m=!1),s.runHooks("afterInit")};function Et(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function $e(g,p,C){if(!g.length){C();return}const k=s.getActiveEditor(),F=new Et;let j=!0;F.onQueueEmpty=()=>{k&&j&&k.cancelChanges(),C()};for(let v=g.length-1;v>=0;v--){const[S,_,,x]=g[v],E=l.propToCol(_);let H;Number.isInteger(E)?H=s.getCellMeta(S,E):H={...Object.getPrototypeOf(R),...R},s.getCellValidator(H)&&(F.addValidatorToQueue(),s.validateCell(x,H,function($,A){return function(L){if(typeof L!="boolean")throw new Error("Validation error: result is not boolean");L===!1&&A.allowInvalid===!1&&(j=!1,g.splice($,1),A.valid=!0),F.removeValidatorFormQueue()}}(v,H),p))}F.checkIfQueueIsEmpty()}function Ye(g,p){for(let k=g.length-1;k>=0;k--){let F=!1;if(g[k]===null){g.splice(k,1);continue}if(!((g[k][2]===null||g[k][2]===void 0)&&(g[k][3]===null||g[k][3]===void 0))){if(R.allowInsertRow)for(;g[k][0]>s.countRows()-1;){const{delta:j}=l.createRow(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}if(s.dataType==="array"&&(!R.columns||R.columns.length===0)&&R.allowInsertColumn)for(;l.propToCol(g[k][1])>s.countCols()-1;){const{delta:j}=l.createCol(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}F||l.set(g[k][0],g[k][1],g[k][3])}}if(g.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,p),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",g,p||"edit");const k=s.getActiveEditor();k&&oe(k.refreshValue)&&k.refreshValue()}else s.render()}this._createCellCoords=function(g,p){return s.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,C){return s.view._wt.createCellRange(g,p,C)},this.validateCell=function(g,p,C,k){let F=s.getCellValidator(p);function j(v){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){C(v);return}const _=p.visualCol,x=p.visualRow,E=s.getCell(x,_,!0);if(E&&E.nodeName!=="TH"){const H=s.rowIndexMapper.getRenderableFromVisualIndex(x),$=s.columnIndexMapper.getRenderableFromVisualIndex(_);s.view._wt.getSetting("cellRenderer",H,$,E)}C(v)}dL(F)&&(F=function(v){return function(S,_){_(v.test(S))}}(F)),Ze(F)?(g=s.runHooks("beforeValidate",g,p.visualRow,p.prop,k),s._registerImmediate(()=>{F.call(p,g,v=>{s&&(v=s.runHooks("afterValidate",v,g,p.visualRow,p.prop,k),p.valid=v,j(v),s.runHooks("postAfterValidate",v,g,p.visualRow,p.prop,k))})})):s._registerImmediate(()=>{p.valid=!0,j(p.valid,!1)})};function St(g,p,C){return Array.isArray(g)?g:[[g,p,C]]}function ut(g,p){const C=s.runHooks("beforeChange",g,p||"edit"),k=g.filter(j=>j!==null);if(C===!1||k.length===0){var F;return(F=s.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let j=k.length-1;j>=0;j--){const[v,S,,_]=k[j],x=l.propToCol(S);let E;Number.isInteger(x)?E=s.getCellMeta(v,x):E={...Object.getPrototypeOf(R),...R},k[j][3]=LS(_,E)}return k}this.setDataAtCell=function(g,p,C,k){const F=St(g,p,C),j=[];let v=k,S,_,x;for(S=0,_=F.length;S<_;S++){const[H,$,A]=F[S];if(typeof F[S]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof $!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");$>=this.countCols()?x=$:x=l.colToProp($),j.push([H,x,u.getAtCell(this.toPhysicalRow(H),$),A])}!v&&typeof g=="object"&&(v=p);const E=ut(j,v);s.runHooks("afterSetDataAtCell",E,v),$e(E,v,()=>{Ye(E,v)})},this.setDataAtRowProp=function(g,p,C,k){const F=St(g,p,C),j=[];let v=k,S,_;for(S=0,_=F.length;S<_;S++){const[E,H,$]=F[S];j.push([E,H,u.getAtCell(this.toPhysicalRow(E),H),$])}!v&&typeof g=="object"&&(v=p);const x=ut(j,k);s.runHooks("afterSetDataAtRowProp",x,v),$e(x,v,()=>{Ye(x,v)})},this.listen=function(){s&&!s.isListening()&&(BS.forEach(g=>{s!==g&&g.unlisten()}),WS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(WS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return WS===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(g),s.view.render(),p&&z.isSelected()&&h.prepareEditor()},this.populateFromArray=function(g,p,C,k,F,j,v){if(!(typeof C=="object"&&typeof C[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const S=typeof k=="number"?s._createCellCoords(k,F):null;return c.populateFromArray(s._createCellCoords(g,p),C,S,j,v)},this.spliceCol=function(g,p,C){for(var k=arguments.length,F=new Array(k>3?k-3:0),j=3;j<k;j++)F[j-3]=arguments[j];return l.spliceCol(g,p,C,...F)},this.spliceRow=function(g,p,C){for(var k=arguments.length,F=new Array(k>3?k-3:0),j=3;j<k;j++)F[j-3]=arguments[j];return l.spliceRow(g,p,C,...F)},this.getSelected=function(){if(z.isSelected())return Ge(z.getSelectedRange(),g=>{let{from:p,to:C}=g;return[p.row,p.col,C.row,C.col]})},this.getSelectedLast=function(){const g=this.getSelected();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedActive=function(){const g=this.getSelectedRangeActive();if(!g)return;const{from:p,to:C}=g;return[p.row,p.col,C.row,C.col]},this.getSelectedRange=function(){if(z.isSelected())return Array.from(z.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRangeActive=function(){return z.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return z.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(g){if(!z.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];P(z.getSelectedRange(),C=>{if(C.isSingleHeader())return;const k=C.getTopStartCorner(),F=C.getBottomEndCorner();fe(k.row,F.row,j=>{fe(k.col,F.col,v=>{this.getCellMeta(j,v).readOnly||p.push([j,v,null])})})}),p.length>0&&this.setDataAtCell(p,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const C=g();return this.resumeExecution(p),C},this.batch=function(g){this.suspendRender(),this.suspendExecution();const p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!s.view)return;const g=s.view,{width:p,height:C}=g.getLastSize(),{width:k,height:F}=s.rootElement.getBoundingClientRect(),j=k!==p||F!==C;s.runHooks("beforeRefreshDimensions",{width:p,height:C},{width:k,height:F},j)!==!1&&((j||g._wt.wtOverlays.scrollableElement===s.rootWindow)&&(g.setLastSize(k,F),g.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:p,height:C},{width:k,height:F},j))},this.updateData=function(g,p){$H(g,C=>{l=C},C=>{l=C,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),z.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:p,metaManager:M,firstRun:m})},this.loadData=function(g,p){$H(g,C=>{l=C},()=>{M.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),z.refresh(),m&&(m=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:p,metaManager:M,firstRun:m})},this.getInitialColumnCount=function(){const g=R.columns;let p=0;if(Array.isArray(g))p=g.length;else if(Ze(g))if(s.dataType==="array"){const C=this.countSourceCols();for(let k=0;k<C;k+=1)g(k)&&(p+=1)}else(s.dataType==="object"||s.dataType==="function")&&(p=l.colToPropCache.length);else if(oe(R.dataSchema)){const C=l.getSchema();p=Array.isArray(C)?C.length:Dw(C)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,C,k){return _t(g)?l.getAll():l.getRange(s._createCellCoords(g,p),s._createCellCoords(C,k),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,C,k){return l.getCopyableText(s._createCellCoords(g,p),s._createCellCoords(C,k))},this.getCopyableData=function(g,p){return l.getCopyable(g,l.colToProp(p))},this.getCopyableSourceData=function(g,p){return u.getCopyable(g,l.colToProp(p))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=(m?s.loadData:s.updateData).bind(this);let k=!1,F,j;if(oe(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(oe(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(oe(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(F in g)if(!(F==="data"||F==="language"))if(F==="className")ce("className",g.className);else if(F==="tableClassName"&&s.table)ce("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(re.getSingleton().isRegistered(F)||re.getSingleton().isDeprecated(F)){const E=g[F];Ze(E)?(re.getSingleton().addAsFixed(F,E,s),R[F]=E):Array.isArray(E)&&(re.getSingleton().add(F,E,s),R[F]=E)}else!p&&Vt(g,F)&&(D[F]=g[F]);if(p)s.useTheme(R.themeName||UH(s.rootContainer));else{const E=s.getCurrentThemeName();Vt(g,"themeName")&&E!==g.themeName&&s.useTheme(g.themeName)}Ag.has(s)&&s.stylesHandler.getThemeName()!==void 0&&Ag.delete(s),kl(s)&&!Ag.has(s)&&s.stylesHandler.isClassicTheme()&&(XL("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),Ag.add(s)),g.data===void 0&&R.data===void 0?C(null,"updateSettings"):g.data!==void 0?C(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!m&&g.language&&ee(g.language);const v=s.countCols(),S=R.columns;if(S&&Ze(S)&&(k=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&M.clearCache(),v>0)for(F=0,j=0;F<v;F++){if(S){const E=k?S(F):S[j];E&&M.updateColumnMeta(j,E)}j+=1}oe(g.cell)&&He(g.cell,E=>{s.setCellMetaObject(E.row,E.col,E)}),s.runHooks("afterCellMetaReset");let _=s.rootElement.style.height;_!==""&&(_=parseInt(s.rootElement.style.height,10)),p&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let x=g.height;if(typeof g.height<"u")if(Ze(x)&&(x=x()),x=s.runHooks("beforeHeightChange",x),x===null){const E=s.rootElement.getAttribute("data-initialstyle");E&&(E.indexOf("height")>-1||E.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",E):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else x!==void 0&&(s.rootElement.style.height=isNaN(x)?`${x}`:`${x}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let E=g.width;Ze(E)&&(E=E()),E=s.runHooks("beforeWidthChange",E),s.rootElement.style.width=isNaN(E)?`${E}`:`${E}px`}p||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!m&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!p&&s.view&&(_===""||x===""||x===void 0)&&_!==x&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedRangeActive();if(R.getValue){if(Ze(R.getValue))return R.getValue.call(s);if(g)return s.getData()[g.highlight.row][R.getValue]}else if(g)return s.getDataAtCell(g.highlight.row,g.highlight.col);return null},this.getSettings=function(){return R},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,C,k,F){c.alter(g,p,C,k,F)},this.getCell=function(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=p,F=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;k=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return F===null||k===null||F===void 0||k===void 0?null:s.view.getCellAtCoords(s._createCellCoords(F,k),C)},this.getCoords=function(g){const p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;const{row:C,col:k}=p;let F=C,j=k;return C>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(C)),k>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(k)),s._createCellCoords(F,j)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,p){return l.get(g,l.colToProp(p))},this.getDataAtRowProp=function(g,p){return l.get(g,p)},this.getDataAtCol=function(g){const p=[],C=l.getRange(s._createCellCoords(0,g),s._createCellCoords(R.data.length-1,g),l.DESTINATION_RENDERER);for(let k=0;k<C.length;k+=1)for(let F=0;F<C[k].length;F+=1)p.push(C[k][F]);return p},this.getDataAtProp=function(g){const p=[],C=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(R.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let k=0;k<C.length;k+=1)for(let F=0;F<C[k].length;F+=1)p.push(C[k][F]);return p},this.getSourceData=function(g,p,C,k){let F;return g===void 0?F=u.getData():F=u.getByRange(s._createCellCoords(g,p),s._createCellCoords(C,k)),F},this.getSourceDataArray=function(g,p,C,k){let F;return g===void 0?F=u.getData(!0):F=u.getByRange(s._createCellCoords(g,p),s._createCellCoords(C,k),!0),F},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,C,k){const F=St(g,p,C),j=this.hasHook("afterSetSourceDataAtCell"),v=[],S=(x,E)=>{const H=this.toVisualRow(x),$=this.toVisualColumn(E);return Number.isInteger($)?this.getCellMeta(H,$):{...Object.getPrototypeOf(R),...R}};j&&P(F,x=>{let[E,H,$]=x;const A=LS($,S(E,H));v.push([E,H,u.getAtCell(E,H),A])}),P(F,x=>{let[E,H,$]=x;const A=LS($,S(E,H));u.setAtCell(E,H,A)}),j&&this.runHooks("afterSetSourceDataAtCell",v,k),this.render();const _=s.getActiveEditor();_&&oe(_.refreshValue)&&_.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return u.getAtCell(g,p)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,p,C,k){const F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,C,k],[j,v]=F;let[,,S,_]=F,x=null,E=null;S===void 0&&(S=j),_===void 0&&(_=v);let H="mixed";return fe(Math.max(Math.min(j,S),0),Math.max(j,S),$=>{let A=!0;return fe(Math.max(Math.min(v,_),0),Math.max(v,_),L=>(E=this.getCellMeta($,L).type,x?A=x===E:x=E,A)),H=A?E:"mixed",A}),H},this.removeCellMeta=function(g,p,C){const[k,F]=[this.toPhysicalRow(g),this.toPhysicalColumn(p)];let j=M.getCellMetaKeyValue(k,F,C);s.runHooks("beforeRemoveCellMeta",g,p,C,j)!==!1&&(M.removeCellMeta(k,F,C),s.runHooks("afterRemoveCellMeta",g,p,C,j)),j=null},this.spliceCellsMeta=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var C=arguments.length,k=new Array(C>2?C-2:0),F=2;F<C;F++)k[F-2]=arguments[F];if(k.length>0&&!Array.isArray(k[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&M.removeRow(this.toPhysicalRow(g),p),k.length>0&&P(k.reverse(),j=>{M.createRow(this.toPhysicalRow(g)),P(j,(v,S)=>this.setCellMetaObject(g,S,v))}),s.render()},this.setCellMetaObject=function(g,p,C){typeof C=="object"&&He(C,(k,F)=>{this.setCellMeta(g,p,F,k)})},this.setCellMeta=function(g,p,C,k){if(s.runHooks("beforeSetCellMeta",g,p,C,k)===!1)return;let j=g,v=p;g<this.countRows()&&(j=this.toPhysicalRow(g)),p<this.countCols()&&(v=this.toPhysicalColumn(p)),M.setCellMeta(j,v,C,k),s.runHooks("afterSetCellMeta",g,p,C,k)},this.getCellsMeta=function(){return M.getCellsMeta()},this.getCellMeta=function(g,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},k=this.toPhysicalRow(g),F=this.toPhysicalColumn(p);return k===null&&(k=g),F===null&&(F=p),M.getCellMeta(k,F,{visualRow:g,visualColumn:p,...C})},this.getColumnMeta=function(g){return M.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return M.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||R.columns)},this.getCellRenderer=function(g,p){const C=typeof g=="number"?s.getCellMeta(g,p).renderer:g.renderer;return typeof C=="string"?Ep(C):_t(C)?Ep("text"):C},this.getCellEditor=function(g,p){const C=typeof g=="number"?s.getCellMeta(g,p).editor:g.editor;return typeof C=="string"?Rp(C):_t(C)?Rp("text"):C},this.getCellValidator=function(g,p){const C=typeof g=="number"?s.getCellMeta(g,p).validator:g.validator;return typeof C=="string"?J0(C):C},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,C){const k=new Et;g&&(k.onQueueEmpty=g);let F=s.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let j=s.countCols()-1;for(;j>=0;){if(C!==void 0&&C.indexOf(j)===-1){j-=1;continue}k.addValidatorToQueue(),s.validateCell(s.getDataAtCell(F,j),s.getCellMeta(F,j),v=>{if(typeof v!="boolean")throw new Error("Validation error: result is not boolean");v===!1&&(k.valid=!1),k.removeValidatorFormQueue()},"validateCells"),j-=1}F-=1}k.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let p=R.rowHeaders,C=g;return C!==void 0&&(C=s.runHooks("modifyRowHeader",C)),C===void 0?(p=[],fe(s.countRows()-1,k=>{p.push(s.getRowHeader(k))})):Array.isArray(p)&&p[C]!==void 0?p=p[C]:Ze(p)?p=p(C):p&&typeof p!="string"&&typeof p!="number"&&(p=C+1),p},this.hasRowHeaders=function(){return!!R.rowHeaders},this.hasColHeaders=function(){if(R.colHeaders!==void 0&&R.colHeaders!==null)return!!R.colHeaders;for(let g=0,p=s.countCols();g<p;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const C=s.runHooks("modifyColHeader",g);if(C===void 0){const S=[],_=s.countCols();for(let x=0;x<_;x++)S.push(s.getColHeader(x));return S}let k=R.colHeaders;const F=function(S){const _=[],x=s.countCols();let E=0;for(;E<x;E++)Ze(R.columns)&&R.columns(E)&&_.push(E);return _[S]},j=s.toPhysicalColumn(C),v=F(j);return R.colHeaders===!1?k=null:R.columns&&Ze(R.columns)&&R.columns(v)&&R.columns(v).title?k=R.columns(v).title:R.columns&&R.columns[j]&&R.columns[j].title?k=R.columns[j].title:Array.isArray(R.colHeaders)&&R.colHeaders[j]!==void 0?k=R.colHeaders[j]:Ze(R.colHeaders)?k=R.colHeaders(j):R.colHeaders&&typeof R.colHeaders!="string"&&typeof R.colHeaders!="number"&&(k=zw(C)),k=s.runHooks("modifyColumnHeaderValue",k,g,p),k},this._getColWidthFromSettings=function(g){let p;if(g>=0&&(p=s.getCellMeta(0,g).width),(p===void 0||p===R.width)&&(p=R.colWidths),p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g,p){let C=s._getColWidthFromSettings(g);return C=s.runHooks("modifyColWidth",C,g,p),C===void 0&&(C=zc),C},this._getRowHeightFromSettings=function(g){const p=s.stylesHandler.getDefaultRowHeight();let C=R.rowHeights;if(C!=null){switch(typeof C){case"object":C=C[g];break;case"function":C=C(g);break}typeof C=="string"&&(C=parseInt(C,10))}return C!=null&&C<p?p:C},this.getRowHeight=function(g,p){let C=s._getRowHeightFromSettings(g);return C=s.runHooks("modifyRowHeight",C,g,p),C},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=R.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return rE(s.countRows()-1,C=>{if(s.isEmptyRow(C))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return rE(s.countCols()-1,C=>{if(s.isEmptyCol(C))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return R.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return R.isEmptyCol.call(s,g)},this.selectCell=function(g,p,C,k){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return _t(g)||_t(p)?!1:this.selectCells([[g,p,C,k]],F,j)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&f.suspend();const k=z.selectCells(g);return k&&C&&s.listen(),f.resume(),k},this.selectColumns=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;return z.selectColumns(g,p,C)},this.selectRows=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;return z.selectRows(g,p,C)},this.deselectCell=function(){z.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,C=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),z.selectAll(g,p,C)};const ct=(g,p)=>g.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(g,p){if(typeof g=="number"){var C;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(C=arguments[4])!==null&&C!==void 0?C:!0}}const{row:k,col:F,considerHiddenIndexes:j}=g??{};let v=k,S=F;if(Ze(p)&&this.addHookOnce("afterScroll",p),j===void 0||j){const H=Number.isInteger(k)&&k>=0,$=Number.isInteger(F)&&F>=0,A=H?ct(this.rowIndexMapper,k):void 0,L=$?ct(this.columnIndexMapper,F):void 0;if(A===null||L===null)return!1;v=H?s.rowIndexMapper.getRenderableFromVisualIndex(A):k,S=$?s.columnIndexMapper.getRenderableFromVisualIndex(L):F}const _=Number.isInteger(v),x=Number.isInteger(S);let E=!1;return _&&v>=0&&x&&S>=0?E=s.view.scrollViewport(s._createCellCoords(v,S),g.horizontalSnap,g.verticalSnap):_&&v>=0&&(x&&S<0||!x)?E=s.view.scrollViewportVertically(v,g.verticalSnap):x&&S>=0&&(_&&v<0||!_)&&(E=s.view.scrollViewportHorizontally(S,g.horizontalSnap)),Ze(p)&&(E?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),E},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;Ze(g)&&this.addHookOnce("afterScroll",g);const{highlight:p}=this.getSelectedRangeActive(),C=this.scrollViewportTo(p.toObject());return C?this.view.render():Ze(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),C},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,kl(this)&&T8(),this.getShortcutManager().destroy(),O.clear(),M.clearCache(),BS.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&zo(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),I.getItems().forEach(g=>{let[,p]=g;p.destroy()}),I.clear(),s.runHooks("afterDestroy")},!0),re.getSingleton().destroy(s),He(s,(g,p,C)=>{Ze(g)?C[p]=kn(p):p!=="guid"&&(C[p]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,z=null,h=null,s=null};function kn(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return I.getItem(Kn(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,p,C){re.getSingleton().add(g,p,s,C)},this.hasHook=function(g){return re.getSingleton().has(g,s)||re.getSingleton().has(g)},this.addHookOnce=function(g,p,C){re.getSingleton().once(g,p,s,C)},this.removeHook=function(g,p){re.getSingleton().remove(g,p,s)},this.runHooks=function(g,p,C,k,F,j,v){return re.getSingleton().run(s,g,p,C,k,F,j,v)},this.getTranslatedPhrase=function(g,p){return z$(R.language,g,p)},this.toHTML=()=>eE(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",eE(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const p=!!m;this.stylesHandler.useTheme(g);const C=this.stylesHandler.getThemeName();p||(s.render(),s.scrollViewportTo(0,0),UH(this.rootContainer)&&(le(this.rootContainer,/ht-theme-.*/g),C&&Y(this.rootContainer,C))),this.runHooks("afterSetTheme",C,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=g;typeof C=="function"&&(C=setTimeout(C,p)),this.timeouts.push(C)},this._clearTimeouts=function(){P(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){P(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return h};const it=m8({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&it.releasePressedKeys()}),this.getShortcutManager=function(){return it},this.getFocusManager=function(){return d},Q0().forEach(g=>{const p=Wf(g);I.addItem(g,new p(this))}),J9(s),it.setActiveContextName("grid"),re.getSingleton().run(s,"construct")}function ZH(t,e,n){t.addEventListener(e,n,!1)}function QH(t,e,n){t.removeEventListener(e,n,!1)}function Hg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function aF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Hg(s).fontSize,o.style.fontFamily=Hg(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Hg(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=Hg(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+m+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>w?y.width=`${n.minWidth}px`:w>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${w}px`;const T=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>T?y.height=`${n.minHeight}px`:n.maxHeight<T?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(ZH(s,"input",a),ZH(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){QH(s,"input",a),QH(s,"keydown",l)}}}function JH(t,e){const n=V0(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}$f(e,i)}function ol(t,e,n){return(e=M8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M8(t){var e=P8(t,"string");return typeof e=="symbol"?e:e+""}function P8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const I8="ht_editor_visible",Ng="ht_editor_hidden",e1="textEditor",O8="text";class yu extends hh{static get EDITOR_TYPE(){return O8}constructor(e){super(e),ol(this,"eventManager",new _i(this)),ol(this,"autoResize",aF(this.hot.rootDocument)),ol(this,"TEXTAREA",void 0),ol(this,"textareaStyle",void 0),ol(this,"TEXTAREA_PARENT",void 0),ol(this,"textareaParentStyle",void 0),ol(this,"layerClass",void 0),this.eventManager=new _i(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Hd(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==zt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===zt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),$f(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),de(this.TEXTAREA,[["data-hot-input",""],Ir(-1)]),Y(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Y(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&le(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Ng),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){IL()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",le(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Ng)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ve(i,"handsontableEditor"))return n=!0,!1}),ve(this.TEXTAREA_PARENT,Ng)&&le(this.TEXTAREA_PARENT,Ng),n?(this.layerClass=I8,Y(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Y(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==zt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){N0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===zt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===zt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>oe(this.hot.getSelected()),group:e1},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;JH(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;JH(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(e1)}}const x8="base",A8="htTextEllipsis";function zf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Y(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(iA())):a&&c.push(iA()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(oA())):(u.push(s.invalidCellClassName),a&&c.push(oA()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(A8),le(e,u),Y(e,l),Wo(e,c),de(e,h)}zf.RENDERER_TYPE=x8;const H8="text";function Bs(t,e,n,r,i,o,s){zf.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ct(a),s.trimWhitespace&&(a=a.trim()),Fa(e,a)}Bs.RENDERER_TYPE=H8;const N8="text",lF={CELL_TYPE:N8,editor:yu,renderer:Bs};hi(lF);Se.editors={BaseEditor:hh};function Se(t,e){const n=new sF(t,e||{},mT);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new sF(t,e,mT)};Se.DefaultSettings=Z$();Se.hooks=re.getSingleton();Se.CellCoords=su;Se.CellRange=uh;Se.packageName="handsontable";Se.buildDate="23/09/2025 14:16:56";Se.version="16.1.1";Se.languages={dictionaryKeys:D4,getLanguageDictionary:U$,getLanguagesDictionaries:V4,registerLanguageDictionary:j$,getTranslatedPhrase:z$};function D8(t,e,n){return(e=$8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function k8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?t1(Object(n),!0).forEach(function(r){D8(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):t1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function L8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $8(t){var e=L8(t,"string");return typeof e=="symbol"?e:e+""}function Ld(t){"@babel/helpers - typeof";return Ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ld(t)}var $c=Symbol("unassigned"),F8="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Ap(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function uF(t){var e=Se.hooks.getRegistered(),n={};Object.assign(n,Se.DefaultSettings);for(var r in n)n[r]={default:$c};for(var i=0;i<e.length;i++)n[e[i]]={default:$c};return n.settings={default:$c},t==="HotTable"&&(n.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),n}function cF(t){var e={},n=t.settings;if(n!==$c)for(var r in n)Ap(n,r)&&n[r]!==$c&&(e[r]=n[r]);for(var i in t)Ap(t,i)&&i!=="settings"&&t[i]!==$c&&(e[i]=t[i]);return e}function n1(t,e){var n=cF(t),r=t.settings?t.settings:n,i=t.settings?n:null,o={};for(var s in r)Ap(r,s)&&r[s]!==void 0&&(!(e&&s!=="data")||!r1(e[s],r[s]))&&(o[s]=r[s]);for(var a in i)Ap(i,a)&&a!=="id"&&a!=="settings"&&i[a]!==void 0&&(!(e&&a!=="data")||!r1(e[a],i[a]))&&(o[a]=i[a]);return o}function r1(t,e){var n=function(i){var o=function(){var s=new WeakSet;return function(a,l){if(Ld(l)==="object"&&l!==null){if(s.has(l))return;s.add(l)}return l}}();return JSON.stringify(i,o)};return typeof t=="function"&&typeof e=="function"?t.toString()===e.toString():Ld(t)!==Ld(e)?!1:n(t)===n(e)}var V8="16.1.1",aM=kD({name:"HotTable",props:uF("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var n=n1(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||n===void 0||(n.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete n.data),Object.keys(n).length?this.hotInstance.updateSettings(n):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(F8),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=n1(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=YW(new Se.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var n=this.hotInstance.getSourceData(),r=[],i=[],o=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(n&&n.length!==o&&n.length<o)for(var l=n.length;l<o;l++)r.push(l);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&((u=n[0])===null||u===void 0?void 0:u.length)!==a&&n[0].length<a)for(var c=n[0].length;c<a;c++)i.push(c)}this.hotInstance.batch(function(){r.length>0?e.hotInstance.rowIndexMapper.removeIndexes(r):e.hotInstance.rowIndexMapper.insertIndexes(o-1,n.length-o),s&&n.length!==0&&(i.length>0?e.hotInstance.columnIndexMapper.removeIndexes(i):e.hotInstance.columnIndexMapper.insertIndexes(a-1,n[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:V8}),W8=["id"];function B8(t,e,n,r,i,o){return LD(),GW("div",{id:t.id},[qW(t.$slots,"default")],8,W8)}aM.render=B8;aM.__file="src/HotTable.vue";var j8=kD({name:"HotColumn",props:uF("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=cF(this.$props),n=k8({},e);e.renderer&&(n.renderer=e.renderer),e.editor&&(n.editor=e.editor),this.columnsCache.set(this,n)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});j8.__file="src/HotColumn.vue";const nfe={__name:"BaseHotTable",setup(t,{expose:e}){const n=KW(null);return e({hotInstance:n}),(r,i)=>(LD(),XW(QW(aM),ZW({ref_key:"innerHot",ref:n,licenseKey:"non-commercial-and-evaluation"},r.$attrs,{theme:"htThemeMain"}),null,16))}};function i1(t,e,n){return(e=U8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U8(t){var e=z8(t,"string");return typeof e=="symbol"?e:e+""}function z8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o1="handsontableEditor",Y8="handsontable";class lM extends yu{constructor(){super(...arguments),i1(this,"isFlippedVertically",!1),i1(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return Y8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),$f(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:o1,relativeToGroup:qa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ai(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedActive()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedActive()&&(this.isFlippedVertically?(l=s.getSelectedActive()[0],a=Math.max(0,l-1)):(l=s.getSelectedActive()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(s.getSelectedActive()){if(this.isFlippedVertically)a=s.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedActive()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(o1)}}function G8(t,e){hF(t,e),e.add(t)}function s1(t,e,n){hF(t,e),e.set(t,n)}function hF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jS(t,e,n){return(e=q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function US(t,e){return t.get(ma(t,e))}function ma(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const X8="autocomplete";var zS=new WeakMap,a1=new WeakMap,Xs=new WeakSet;class uM extends lM{constructor(){super(...arguments),G8(this,Xs),jS(this,"query",null),jS(this,"strippedChoices",[]),jS(this,"rawChoices",[]),s1(this,zS,this.hot.guid.slice(0,9)),s1(this,a1,Vf(()=>{this.focus()},100))}static get EDITOR_TYPE(){return X8}getValue(){const e=this.rawChoices.find(n=>{const r=this.stripValueIfNeeded(n);return(ma(Xs,this,Bh).call(this,r)?r.value:r)===this.TEXTAREA.value});return oe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Y(this.htContainer,"autocompleteEditor"),Y(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&de(this.TEXTAREA,[h2(),i2(),vL("listbox"),p2()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&de(this.TEXTAREA,[Ei("false"),w2(`${US(zS,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:a=>ma(Xs,this,Bh).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",US(a1,this)),this.htEditor.updateSettings({colWidths:e?[Gt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Bs(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:w,locale:y}=this.cellProperties,T=this.query;let b=Ct(d),M,R;b&&!w&&(M=m===!0?b.indexOf(T):b.toLocaleLowerCase(y).indexOf(T.toLocaleLowerCase(y)),M!==-1&&(R=b.substr(M,T.length),b=b.replace(R,`<strong>${R}</strong>`))),n&&de(l,[o2(),...r?[S2(i)]:[],...r?[b2(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=b},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{de(h,[x0()]),de(this.TEXTAREA,...v2(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(de(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ms()),de(this.htEditor.rootElement,[wL(),C2("polite"),y2("text"),["id",`${US(zS,this)}-listbox-${o}-${s}`]]),de(this.TEXTAREA,...Ei("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&de(this.TEXTAREA,[Ei("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=V0(this.TEXTAREA),r=VL(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=this.stripValueIfNeeded(this.getValue()),a=ma(Xs,this,Bh).call(this,s)?s.value:s;let l=null,u=e;i||(u=u.toSorted());const c=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let m=0;m<u.length;m++){const w=ma(Xs,this,Bh).call(this,u[m])?Bm(Ct(u[m].value)):Bm(Ct(u[m]));if((d?w:w.toLocaleLowerCase(h)).indexOf(f)!==-1&&(c.push(m),o===!1))break}o===!1?l=c[0]:(u=c.map(m=>u[m]),l=u.indexOf(f)>-1?u.indexOf(f):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Id([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),$f(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=WL(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),ma(Xs,this,l1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),ma(Xs,this,l1).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=i=>Ct(n?i:Bm(i));return e.every(i=>ma(Xs,this,Bh).call(this,i))?e.map(i=>({key:r(i.key),value:r(i.value)})):e.map(i=>r(i))}onBeforeKeyDown(e){if(YL(e.keyCode)||e.keyCode===pe.BACKSPACE||e.keyCode===pe.DELETE||e.keyCode===pe.INSERT){let n=10;if(e.keyCode===pe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function l1(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+en(this.hot.rootDocument)})}function Bh(t){return ye(t)&&oe(t.key)&&oe(t.value)}const Z8="checkbox";class dF extends hh{static get EDITOR_TYPE(){return Z8}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Pa=()=>window,yi=()=>window.document,pE=(t,e)=>window.setTimeout(t,e),Io=function(t,e,n,r){t.addEventListener(e,n,!!r)},ls=function(t,e,n,r){t.removeEventListener(e,n,!!r)},Q8=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ur=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},YS=function(t,e){Ur(t,e)||(t.className=t.className===""?e:t.className+" "+e)},GS=function(t,e){t.className=Q8((" "+t.className+" ").replace(" "+e+" "," "))},cM=function(t){return/Array/.test(Object.prototype.toString.call(t))},Kr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},J8=function(t){let e=t.getDay();return e===0||e===6},e7=function(t){return t%4===0&&t%100!==0||t%400===0},u1=function(t,e){return[31,e7(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Dg=function(t){Kr(t)&&t.setHours(0,0,0,0)},kg=function(t,e){return t.getTime()===e.getTime()},Hp=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Kr(e[r])?n&&(t[r]=new Date(e[r].getTime())):cM(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Hp({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},c1=function(t,e,n){let r=yi().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Hp(r,n),t.dispatchEvent(r)},h1=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},mo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},d1=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},t7=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},n7=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},r7=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():n7(o,i))+"</td>"},i7=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},o7=function(t){return"<tbody>"+t.join("")+"</tbody>"},s7=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+d1(t,e)+'">'+d1(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},a7=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,w=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",cM(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},l7=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+s7(t)+o7(e)+"</table>"};function wE(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Pa().event;let o=i.target||i.srcElement;if(o)if(Ur(o,"is-disabled")||(Ur(o,"pika-button")&&!Ur(o,"is-empty")&&!Ur(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&pE(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ur(o,"pika-prev")?e.prevMonth():Ur(o,"pika-next")&&e.nextMonth()),Ur(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Pa().event;let o=i.target||i.srcElement;o&&(Ur(o,"pika-select-month")?e.gotoMonth(o.value):Ur(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Pa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Kr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=yi().activeElement;do if(Ur(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=pE(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Pa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Ur(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Io(o,"change",e._onChange)));do if(Ur(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=yi().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Io(e.el,"mousedown",e._onMouseDown,!0),Io(e.el,"touchend",e._onMouseDown,!0),Io(e.el,"change",e._onChange),n.keyboardInput&&Io(yi(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?yi().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Io(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Kr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Io(n.trigger,"click",e._onInputClick),Io(n.trigger,"focus",e._onInputFocus),Io(n.trigger,"blur",e._onInputBlur)):this.show()}wE.prototype={config:function(t){this._o||(this._o=Hp({},mo,!0));let e=Hp(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Kr(e.minDate)||(e.minDate=!1),Kr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),cM(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||mo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Kr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Kr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",c1(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Kr(t))return;let n=this._o.minDate,r=this._o.maxDate;Kr(n)&&t<n?t=n:Kr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Dg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),c1(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Kr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=h1(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=h1({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Dg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=mo.minDate,this._o.minYear=mo.minYear,this._o.minMonth=mo.minMonth,this._o.startRange=mo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Dg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=mo.maxDate,this._o.maxYear=mo.maxYear,this._o.maxMonth=mo.maxMonth,this._o.endRange=mo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+a7(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&pE(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Pa().innerWidth||yi().documentElement.clientWidth,i=Pa().innerHeight||yi().documentElement.clientHeight,o=yi().body.scrollTop||yi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Pa().pageXOffset,a=l.bottom+Pa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",YS(this.el,u?"left-aligned":"right-aligned"),YS(this.el,c?"bottom-aligned":"top-aligned"),GS(this.el,u?"right-aligned":"left-aligned"),GS(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=u1(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Dg(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=u1(h,u),m=o+s,w=m;for(;w>7;)w-=7;m+=7-w;let y=!1;for(let T=0,b=0;T<m;T++){let M=new Date(t,e,1+(T-s)),R=Kr(this._d)?kg(M,this._d):!1,D=kg(M,i),I=r.events.indexOf(M.toDateString())!==-1,O=T<s||T>=o+s,U=1+(T-s),G=e,W=t,X=r.startRange&&kg(r.startRange,M),z=r.endRange&&kg(r.endRange,M),ae=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,ee=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&J8(M)||r.disableDayFn&&r.disableDayFn(M);O&&(T<s?(U=f+U,G=u,W=h):(U=U-o,G=c,W=d));let ce={day:U,month:G,year:W,hasEvent:I,isSelected:R,isToday:D,isDisabled:ee,isEmpty:O,isStartRange:X,isEndRange:z,isInRange:ae,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&R&&(y=!0),l.push(t7(ce)),++b===7&&(r.showWeekNumber&&l.unshift(r7(this,T-s,e,t,r.firstWeekOfYearMinDays)),a.push(i7(l,r.isRTL,r.pickWholeWeek,y)),l=[],b=0,y=!1)}return l7(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),GS(this.el,"is-hidden"),this._o.bound&&(Io(yi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&ls(yi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),YS(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),ls(this.el,"mousedown",this._onMouseDown,!0),ls(this.el,"touchend",this._onMouseDown,!0),ls(this.el,"change",this._onChange),t.keyboardInput&&ls(yi(),"keydown",this._onKeyChange),t.field&&(ls(t.field,"change",this._onInputChange),t.bound&&(ls(t.trigger,"click",this._onInputClick),ls(t.trigger,"focus",this._onInputFocus),ls(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function u7(t,e){c7(t,e),e.add(t)}function c7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f1(t,e,n){return(e=h7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h7(t){var e=d7(t,"string");return typeof e=="symbol"?e:e+""}function d7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fF="date",g1="dateEditor",f7="DD/MM/YYYY";var Lg=new WeakSet;class gF extends yu{constructor(){super(...arguments),u7(this,Lg),f1(this,"parentDestroyed",!1),f1(this,"$datePicker",null)}static get EDITOR_TYPE(){return fF}init(){if(typeof K!="function")throw new Error("You need to include moment.js to your project.");if(typeof wE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Y(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ve(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:g1})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(g1),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=qS(Lg,this,KS).call(this),r=this.hot.view.isMouseDown(),i=e?G0(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new wE(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(K),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Df(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:qS(Lg,this,KS).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=K(a).format(qS(Lg,this,KS).call(this))),this.setValue(a),i&&i(),eo()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==zt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Jt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Gt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function KS(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:f7}const g7="dropdown";class mF extends uM{static get EDITOR_TYPE(){return g7}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const m7="numeric";class pF extends yu{static get EDITOR_TYPE(){return m7}}function p7(t,e,n){return(e=w7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const C7="password";class wF extends yu{constructor(){super(...arguments),p7(this,"autoResize",aF(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return C7}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,zo(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Ir(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const XS="ht_editor_visible",m1="selectEditor",y7="select";class vF extends hh{static get EDITOR_TYPE(){return y7}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...vu()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),Y(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ve(this.selectWrapper,XS)&&le(this.selectWrapper,XS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),zo(this.select),He(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ya(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==zt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Y(this.selectWrapper,XS)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:m1};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(m1)}}const S7="time";class CF extends yu{static get EDITOR_TYPE(){return S7}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function b7(){Rr(hh),Rr(uM),Rr(dF),Rr(gF),Rr(mF),Rr(lM),Rr(pF),Rr(wF),Rr(vF),Rr(yu),Rr(CF)}const R7="html";function hM(t,e,n,r,i,o,s){zf.apply(this,[t,e,n,r,i,o,s]),Ya(e,o??"",!1)}hM.RENDERER_TYPE=R7;const E7="autocomplete";function fh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?hM:Bs,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...vu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),Y(e,"htAutocomplete"),!t.acArrowListener){const h=new _i(t);t.acArrowListener=function(d){ve(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}fh.RENDERER_TYPE=E7;const T7="dropdown";function dM(t,e,n,r,i,o,s){fh.apply(this,[t,e,n,r,i,o,s])}dM.RENDERER_TYPE=T7;const p1=new WeakMap,w1=new WeakMap,_7="htBadValue",qc="data-row",Kc="data-col",M7="checkboxRenderer",yF="checkbox";re.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===yF){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function fM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;zf.apply(this,[t,e,n,r,i,o,s]),P7(t);let u=I7(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),zo(e),o===s.checkedTemplate||Ct(o).toLocaleLowerCase(s.locale)===Ct(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ct(o).toLocaleLowerCase(s.locale)===Ct(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?Y(u,"noValue"):(u.style.display="none",Y(u,_7),h=!0),de(u,[[qc,n],[Kc,r]]),l&&de(u,[ti(u.checked?t.getTranslatedPhrase(Z_):t.getTranslatedPhrase(Q_)),SL(u.checked),s2()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const T=t.getDataAtRowProp(n,c.property);w=T!==null?T:""}const y=O7(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),p1.has(t)||(p1.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),T={group:M7,relativeToGroup:qa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const b=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&(b==null?void 0:b.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}}],T)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),T=[],b=new Map;let M=[],R=0;if(y){for(let D=0;D<y.length;D++){const{row:I,col:O}=y[D].getTopStartCorner(),{row:U,col:G}=y[D].getBottomEndCorner();for(let W=I;W<=U;W+=1)for(let X=O;X<=G;X+=1){const z=t.getCellMeta(W,X);if(z.hidden)continue;const ae={checkedTemplate:z.checkedTemplate,uncheckedTemplate:z.uncheckedTemplate};if(z.type!=="checkbox"){w===!0&&!z.readOnly&&(b.has(T.length)?b.set(T.length,[...b.get(T.length),[W,X,null]]):b.set(T.length,[[W,X,null]]));continue}if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const ee=t.getDataAtCell(W,X);w===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(ee)?M.push([W,X,z.uncheckedTemplate,ae]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(ee)&&M.push([W,X,z.checkedTemplate,ae]):M.push([W,X,z.uncheckedTemplate,ae]),R+=1}T.push(R),R=0}M.every(D=>{let[,,I]=D;return I===M[0][2]})?M=M.map(D=>{let[I,O,U]=D;return[I,O,U]}):M=M.map(D=>{let[I,O,,U]=D;return[I,O,U.checkedTemplate]}),M.length>0&&T.forEach((D,I)=>{let O=M.splice(0,D);b.size&&b.has(I)&&(O=[...O,...b.get(I)]),t.setDataAtCell(O)})}}function m(){const w=t.getSelectedRange();if(w){for(let y=0;y<w.length;y++){const T=w[y].getTopStartCorner(),b=w[y].getBottomEndCorner();for(let M=T.row;M<=b.row;M++)for(let R=T.col;R<=b.col;R++){if(t.getCellMeta(M,R).readOnly)continue;const I=t.getCell(M,R);if(Bo(I)&&I.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}fM.RENDERER_TYPE=yF;function P7(t){let e=w1.get(t);if(!e){const{rootElement:n}=t;e=new _i(t),e.addEventListener(n,"click",r=>A7(r,t)),e.addEventListener(n,"mouseup",r=>x7(r,t)),e.addEventListener(n,"change",r=>H7(r,t)),w1.set(t,e)}return e}function I7(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function O7(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function x7(t,e){const{target:n}=t;gM(n)&&(!n.hasAttribute(qc)||!n.hasAttribute(Kc)||setTimeout(e.listen,10))}function A7(t,e){const{target:n}=t;if(!gM(n)||!n.hasAttribute(qc)||!n.hasAttribute(Kc))return;const r=parseInt(n.getAttribute(qc),10),i=parseInt(n.getAttribute(Kc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function H7(t,e){const{target:n}=t;if(!gM(n)||!n.hasAttribute(qc)||!n.hasAttribute(Kc))return;const r=parseInt(n.getAttribute(qc),10),i=parseInt(n.getAttribute(Kc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function gM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const N7="handsontable";function mM(t,e,n,r,i,o,s){fh.apply(this,[t,e,n,r,i,o,s])}mM.RENDERER_TYPE=N7;var D7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function k7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ZS,v1;function L7(){return v1||(v1=1,ZS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ZS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var QS,C1;function SF(){if(C1)return QS;C1=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let w="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let I=0;I<t.length;I++){let O=t[I];if(w=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*O.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let T=parseFloat(l);if(isNaN(T))return;let b=h(T);if(b&&b!=="."&&(w=l.replace(new RegExp(`${e(b)}$`),""),w!==l))return n(w,u,c,h,d,f);let M={};Object.keys(f).forEach(I=>{M[f[I]]=I});let R=Object.keys(M).sort().reverse(),D=R.length;for(let I=0;I<D;I++){let O=R[I],U=M[O];if(w=l.replace(O,""),w!==l){let G;switch(U){case"thousand":G=Math.pow(10,3);break;case"million":G=Math.pow(10,6);break;case"billion":G=Math.pow(10,9);break;case"trillion":G=Math.pow(10,12);break}return n(w,u,c,h,d,f)*G}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=vM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),w=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,m,w);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return QS={unformat:a},QS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var JS,y1;function pM(){if(y1)return JS;y1=1;let t=SF();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,T){let b=d(y),M=m(T);return b&&M}function d(y){return t.unformat(y)!==void 0}function f(y,T,b,M=!1){let R=Object.keys(y).map(D=>{if(!T[D])return console.error(`${b} Invalid key: ${D}`),!1;let I=y[D],O=T[D];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(I,u,`[Validate ${D}]`,!0))return!1}else if(typeof I!==O.type)return console.error(`${b} ${D} type mismatched: "${O.type}" expected, "${typeof I}" provided`),!1;if(O.restrictions&&O.restrictions.length){let U=O.restrictions.length;for(let G=0;G<U;G++){let{restriction:W,message:X}=O.restrictions[G];if(!W(I,y))return console.error(`${b} ${D} invalid value: ${X}`),!1}}return O.restriction&&!O.restriction(I,y)?(console.error(`${b} ${D} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(I)===-1?(console.error(`${b} ${D} invalid value: must be among ${JSON.stringify(O.validValues)}, "${I}" provided`),!1):!(O.children&&!f(I,O.children,`[Validate ${D}]`))});return M||R.push(...Object.keys(T).map(D=>{let I=T[D];if(typeof I=="string"&&(I={type:I}),I.mandatory){let O=I.mandatory;if(typeof O=="function"&&(O=O(y)),O&&y[D]===void 0)return console.error(`${b} Missing mandatory key "${D}"`),!1}return!0})),R.reduce((D,I)=>D&&I,!0)}function m(y){return f(y,u,"[Validate format]")}function w(y){return f(y,c,"[Validate language]")}return JS={validate:h,validateFormat:m,validateInput:d,validateLanguage:w},JS}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function $7(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function F7(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function V7(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function W7(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function B7(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function j7(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function U7(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function z7(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function Y7(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function G7(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function q7(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function K7(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function X7(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function Z7(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function Q7(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function J7(t,e={}){return typeof t!="string"?t:(t=$7(t,e),t=F7(t,e),V7(t,e),j7(t,e),U7(t,e),X7(t,e),G7(t,e),q7(t,e),z7(t,e),K7(t,e),Y7(t,e),W7(t,e),B7(t,e),Z7(t,e),Q7(t,e),e)}var wM={parseFormat:J7};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var eb,S1;function vM(){if(S1)return eb;S1=1;const t=L7(),e=pM(),n=wM;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,eb=r,eb}function e5(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function t5(t,e){t.forEach(n=>{let r;try{r=e5(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var n5=t=>({loadLanguagesInNode:e=>t5(e,t)}),bF={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(I){var O,U,G,W=g.prototype={constructor:g,toString:null,valueOf:null},X=new g(1),z=20,ae=4,ee=-7,ce=21,Et=-1e7,$e=1e7,Ye=!1,St=1,ut=0,ct={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},kn="0123456789abcdefghijklmnopqrstuvwxyz",it=!0;function g(v,S){var _,x,E,H,$,A,L,B,V=this;if(!(V instanceof g))return new g(v,S);if(S==null){if(v&&v._isBigNumber===!0){V.s=v.s,!v.c||v.e>$e?V.c=V.e=null:v.e<Et?V.c=[V.e=0]:(V.e=v.e,V.c=v.c.slice());return}if((A=typeof v=="number")&&v*0==0){if(V.s=1/v<0?(v=-v,-1):1,v===~~v){for(H=0,$=v;$>=10;$/=10,H++);H>$e?V.c=V.e=null:(V.e=H,V.c=[v]);return}B=String(v)}else{if(!r.test(B=String(v)))return G(V,B,A);V.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}(H=B.indexOf("."))>-1&&(B=B.replace(".","")),($=B.search(/e/i))>0?(H<0&&(H=$),H+=+B.slice($+1),B=B.substring(0,$)):H<0&&(H=B.length)}else{if(b(S,2,kn.length,"Base"),S==10&&it)return V=new g(v),F(V,z+V.e+1,ae);if(B=String(v),A=typeof v=="number"){if(v*0!=0)return G(V,B,A,S);if(V.s=1/v<0?(B=B.slice(1),-1):1,g.DEBUG&&B.replace(/^0\.0*|\./,"").length>15)throw Error(a+v)}else V.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(_=kn.slice(0,S),H=$=0,L=B.length;$<L;$++)if(_.indexOf(x=B.charAt($))<0){if(x=="."){if($>H){H=L;continue}}else if(!E&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){E=!0,$=-1,H=0;continue}return G(V,String(v),A,S)}A=!1,B=U(B,S,10,V.s),(H=B.indexOf("."))>-1?B=B.replace(".",""):H=B.length}for($=0;B.charCodeAt($)===48;$++);for(L=B.length;B.charCodeAt(--L)===48;);if(B=B.slice($,++L)){if(L-=$,A&&g.DEBUG&&L>15&&(v>c||v!==o(v)))throw Error(a+V.s*v);if((H=H-$-1)>$e)V.c=V.e=null;else if(H<Et)V.c=[V.e=0];else{if(V.e=H,V.c=[],$=(H+1)%u,H<0&&($+=u),$<L){for($&&V.c.push(+B.slice(0,$)),L-=u;$<L;)V.c.push(+B.slice($,$+=u));$=u-(B=B.slice($)).length}else $-=L;for(;$--;B+="0");V.c.push(+B)}}else V.c=[V.e=0]}g.clone=m,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=function(v){var S,_;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(_=v[S],b(_,0,f,S),z=_),v.hasOwnProperty(S="ROUNDING_MODE")&&(_=v[S],b(_,0,8,S),ae=_),v.hasOwnProperty(S="EXPONENTIAL_AT")&&(_=v[S],_&&_.pop?(b(_[0],-1e9,0,S),b(_[1],0,f,S),ee=_[0],ce=_[1]):(b(_,-1e9,f,S),ee=-(ce=_<0?-_:_))),v.hasOwnProperty(S="RANGE"))if(_=v[S],_&&_.pop)b(_[0],-1e9,-1,S),b(_[1],1,f,S),Et=_[0],$e=_[1];else if(b(_,-1e9,f,S),_)Et=-($e=_<0?-_:_);else throw Error(s+S+" cannot be zero: "+_);if(v.hasOwnProperty(S="CRYPTO"))if(_=v[S],_===!!_)if(_)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ye=_;else throw Ye=!_,Error(s+"crypto unavailable");else Ye=_;else throw Error(s+S+" not true or false: "+_);if(v.hasOwnProperty(S="MODULO_MODE")&&(_=v[S],b(_,0,9,S),St=_),v.hasOwnProperty(S="POW_PRECISION")&&(_=v[S],b(_,0,f,S),ut=_),v.hasOwnProperty(S="FORMAT"))if(_=v[S],typeof _=="object")ct=_;else throw Error(s+S+" not an object: "+_);if(v.hasOwnProperty(S="ALPHABET"))if(_=v[S],typeof _=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(_))it=_.slice(0,10)=="0123456789",kn=_;else throw Error(s+S+" invalid: "+_)}else throw Error(s+"Object expected: "+v);return{DECIMAL_PLACES:z,ROUNDING_MODE:ae,EXPONENTIAL_AT:[ee,ce],RANGE:[Et,$e],CRYPTO:Ye,MODULO_MODE:St,POW_PRECISION:ut,FORMAT:ct,ALPHABET:kn}},g.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!g.DEBUG)return!0;var S,_,x=v.c,E=v.e,H=v.s;e:if({}.toString.call(x)=="[object Array]"){if((H===1||H===-1)&&E>=-1e9&&E<=f&&E===o(E)){if(x[0]===0){if(E===0&&x.length===1)return!0;break e}if(S=(E+1)%u,S<1&&(S+=u),String(x[0]).length==S){for(S=0;S<x.length;S++)if(_=x[S],_<0||_>=l||_!==o(_))break e;if(_!==0)return!0}}}else if(x===null&&E===null&&(H===null||H===1||H===-1))return!0;throw Error(s+"Invalid BigNumber: "+v)},g.maximum=g.max=function(){return C(arguments,-1)},g.minimum=g.min=function(){return C(arguments,1)},g.random=function(){var v=9007199254740992,S=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(_){var x,E,H,$,A,L=0,B=[],V=new g(X);if(_==null?_=z:b(_,0,f),$=i(_/u),Ye)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array($*=2));L<$;)A=x[L]*131072+(x[L+1]>>>11),A>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),x[L]=E[0],x[L+1]=E[1]):(B.push(A%1e14),L+=2);L=$/2}else if(crypto.randomBytes){for(x=crypto.randomBytes($*=7);L<$;)A=(x[L]&31)*281474976710656+x[L+1]*1099511627776+x[L+2]*4294967296+x[L+3]*16777216+(x[L+4]<<16)+(x[L+5]<<8)+x[L+6],A>=9e15?crypto.randomBytes(7).copy(x,L):(B.push(A%1e14),L+=7);L=$/7}else throw Ye=!1,Error(s+"crypto unavailable");if(!Ye)for(;L<$;)A=S(),A<9e15&&(B[L++]=A%1e14);for($=B[--L],_%=u,$&&_&&(A=h[u-_],B[L]=o($/A)*A);B[L]===0;B.pop(),L--);if(L<0)B=[H=0];else{for(H=-1;B[0]===0;B.splice(0,1),H-=u);for(L=1,A=B[0];A>=10;A/=10,L++);L<u&&(H-=u-L)}return V.e=H,V.c=B,V}}(),g.sum=function(){for(var v=1,S=arguments,_=new g(S[0]);v<S.length;)_=_.plus(S[v++]);return _},U=function(){var v="0123456789";function S(_,x,E,H){for(var $,A=[0],L,B=0,V=_.length;B<V;){for(L=A.length;L--;A[L]*=x);for(A[0]+=H.indexOf(_.charAt(B++)),$=0;$<A.length;$++)A[$]>E-1&&(A[$+1]==null&&(A[$+1]=0),A[$+1]+=A[$]/E|0,A[$]%=E)}return A.reverse()}return function(_,x,E,H,$){var A,L,B,V,q,J,se,be,je=_.indexOf("."),Xe=z,Re=ae;for(je>=0&&(V=ut,ut=0,_=_.replace(".",""),be=new g(x),J=be.pow(_.length-je),ut=V,be.c=S(D(y(J.c),J.e,"0"),10,E,v),be.e=be.c.length),se=S(_,x,E,$?(A=kn,v):(A=v,kn)),B=V=se.length;se[--V]==0;se.pop());if(!se[0])return A.charAt(0);if(je<0?--B:(J.c=se,J.e=B,J.s=H,J=O(J,be,Xe,Re,E),se=J.c,q=J.r,B=J.e),L=B+Xe+1,je=se[L],V=E/2,q=q||L<0||se[L+1]!=null,q=Re<4?(je!=null||q)&&(Re==0||Re==(J.s<0?3:2)):je>V||je==V&&(Re==4||q||Re==6&&se[L-1]&1||Re==(J.s<0?8:7)),L<1||!se[0])_=q?D(A.charAt(1),-Xe,A.charAt(0)):A.charAt(0);else{if(se.length=L,q)for(--E;++se[--L]>E;)se[L]=0,L||(++B,se=[1].concat(se));for(V=se.length;!se[--V];);for(je=0,_="";je<=V;_+=A.charAt(se[je++]));_=D(_,B,A.charAt(0))}return _}}(),O=function(){function v(x,E,H){var $,A,L,B,V=0,q=x.length,J=E%d,se=E/d|0;for(x=x.slice();q--;)L=x[q]%d,B=x[q]/d|0,$=se*L+B*J,A=J*L+$%d*d+V,V=(A/H|0)+($/d|0)+se*B,x[q]=A%H;return V&&(x=[V].concat(x)),x}function S(x,E,H,$){var A,L;if(H!=$)L=H>$?1:-1;else for(A=L=0;A<H;A++)if(x[A]!=E[A]){L=x[A]>E[A]?1:-1;break}return L}function _(x,E,H,$){for(var A=0;H--;)x[H]-=A,A=x[H]<E[H]?1:0,x[H]=A*$+x[H]-E[H];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,E,H,$,A){var L,B,V,q,J,se,be,je,Xe,Re,Te,qe,xn,Hr,Nr,Rn,Dr,bt=x.s==E.s?1:-1,Je=x.c,ot=E.c;if(!Je||!Je[0]||!ot||!ot[0])return new g(!x.s||!E.s||(Je?ot&&Je[0]==ot[0]:!ot)?NaN:Je&&Je[0]==0||!ot?bt*0:bt/0);for(je=new g(bt),Xe=je.c=[],B=x.e-E.e,bt=H+B+1,A||(A=l,B=w(x.e/u)-w(E.e/u),bt=bt/u|0),V=0;ot[V]==(Je[V]||0);V++);if(ot[V]>(Je[V]||0)&&B--,bt<0)Xe.push(1),q=!0;else{for(Hr=Je.length,Rn=ot.length,V=0,bt+=2,J=o(A/(ot[0]+1)),J>1&&(ot=v(ot,J,A),Je=v(Je,J,A),Rn=ot.length,Hr=Je.length),xn=Rn,Re=Je.slice(0,Rn),Te=Re.length;Te<Rn;Re[Te++]=0);Dr=ot.slice(),Dr=[0].concat(Dr),Nr=ot[0],ot[1]>=A/2&&Nr++;do{if(J=0,L=S(ot,Re,Rn,Te),L<0){if(qe=Re[0],Rn!=Te&&(qe=qe*A+(Re[1]||0)),J=o(qe/Nr),J>1)for(J>=A&&(J=A-1),se=v(ot,J,A),be=se.length,Te=Re.length;S(se,Re,be,Te)==1;)J--,_(se,Rn<be?Dr:ot,be,A),be=se.length,L=1;else J==0&&(L=J=1),se=ot.slice(),be=se.length;if(be<Te&&(se=[0].concat(se)),_(Re,se,Te,A),Te=Re.length,L==-1)for(;S(ot,Re,Rn,Te)<1;)J++,_(Re,Rn<Te?Dr:ot,Te,A),Te=Re.length}else L===0&&(J++,Re=[0]);Xe[V++]=J,Re[0]?Re[Te++]=Je[xn]||0:(Re=[Je[xn]],Te=1)}while((xn++<Hr||Re[0]!=null)&&bt--);q=Re[0]!=null,Xe[0]||Xe.splice(0,1)}if(A==l){for(V=1,bt=Xe[0];bt>=10;bt/=10,V++);F(je,H+(je.e=V+B*u-1)+1,$,q)}else je.e=B,je.r=+q;return je}}();function p(v,S,_,x){var E,H,$,A,L;if(_==null?_=ae:b(_,0,8),!v.c)return v.toString();if(E=v.c[0],$=v.e,S==null)L=y(v.c),L=x==1||x==2&&($<=ee||$>=ce)?R(L,$):D(L,$,"0");else if(v=F(new g(v),S,_),H=v.e,L=y(v.c),A=L.length,x==1||x==2&&(S<=H||H<=ee)){for(;A<S;L+="0",A++);L=R(L,H)}else if(S-=$,L=D(L,H,"0"),H+1>A){if(--S>0)for(L+=".";S--;L+="0");}else if(S+=H-A,S>0)for(H+1==A&&(L+=".");S--;L+="0");return v.s<0&&E?"-"+L:L}function C(v,S){for(var _,x,E=1,H=new g(v[0]);E<v.length;E++)x=new g(v[E]),(!x.s||(_=T(H,x))===S||_===0&&H.s===S)&&(H=x);return H}function k(v,S,_){for(var x=1,E=S.length;!S[--E];S.pop());for(E=S[0];E>=10;E/=10,x++);return(_=x+_*u-1)>$e?v.c=v.e=null:_<Et?v.c=[v.e=0]:(v.e=_,v.c=S),v}G=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,_=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(H,$,A,L){var B,V=A?$:$.replace(E,"");if(x.test(V))H.s=isNaN(V)?null:V<0?-1:1;else{if(!A&&(V=V.replace(v,function(q,J,se){return B=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!L||L==B?J:q}),L&&(B=L,V=V.replace(S,"$1").replace(_,"0.$1")),$!=V))return new g(V,B);if(g.DEBUG)throw Error(s+"Not a"+(L?" base "+L:"")+" number: "+$);H.s=null}H.c=H.e=null}}();function F(v,S,_,x){var E,H,$,A,L,B,V,q=v.c,J=h;if(q){e:{for(E=1,A=q[0];A>=10;A/=10,E++);if(H=S-E,H<0)H+=u,$=S,L=q[B=0],V=o(L/J[E-$-1]%10);else if(B=i((H+1)/u),B>=q.length)if(x){for(;q.length<=B;q.push(0));L=V=0,E=1,H%=u,$=H-u+1}else break e;else{for(L=A=q[B],E=1;A>=10;A/=10,E++);H%=u,$=H-u+E,V=$<0?0:o(L/J[E-$-1]%10)}if(x=x||S<0||q[B+1]!=null||($<0?L:L%J[E-$-1]),x=_<4?(V||x)&&(_==0||_==(v.s<0?3:2)):V>5||V==5&&(_==4||x||_==6&&(H>0?$>0?L/J[E-$]:0:q[B-1])%10&1||_==(v.s<0?8:7)),S<1||!q[0])return q.length=0,x?(S-=v.e+1,q[0]=J[(u-S%u)%u],v.e=-S||0):q[0]=v.e=0,v;if(H==0?(q.length=B,A=1,B--):(q.length=B+1,A=J[u-H],q[B]=$>0?o(L/J[E-$]%J[$])*A:0),x)for(;;)if(B==0){for(H=1,$=q[0];$>=10;$/=10,H++);for($=q[0]+=A,A=1;$>=10;$/=10,A++);H!=A&&(v.e++,q[0]==l&&(q[0]=1));break}else{if(q[B]+=A,q[B]!=l)break;q[B--]=0,A=1}for(H=q.length;q[--H]===0;q.pop());}v.e>$e?v.c=v.e=null:v.e<Et&&(v.c=[v.e=0])}return v}function j(v){var S,_=v.e;return _===null?v.toString():(S=y(v.c),S=_<=ee||_>=ce?R(S,_):D(S,_,"0"),v.s<0?"-"+S:S)}return W.absoluteValue=W.abs=function(){var v=new g(this);return v.s<0&&(v.s=1),v},W.comparedTo=function(v,S){return T(this,new g(v,S))},W.decimalPlaces=W.dp=function(v,S){var _,x,E,H=this;if(v!=null)return b(v,0,f),S==null?S=ae:b(S,0,8),F(new g(H),v+H.e+1,S);if(!(_=H.c))return null;if(x=((E=_.length-1)-w(this.e/u))*u,E=_[E])for(;E%10==0;E/=10,x--);return x<0&&(x=0),x},W.dividedBy=W.div=function(v,S){return O(this,new g(v,S),z,ae)},W.dividedToIntegerBy=W.idiv=function(v,S){return O(this,new g(v,S),0,1)},W.exponentiatedBy=W.pow=function(v,S){var _,x,E,H,$,A,L,B,V,q=this;if(v=new g(v),v.c&&!v.isInteger())throw Error(s+"Exponent not an integer: "+j(v));if(S!=null&&(S=new g(S)),A=v.e>14,!q.c||!q.c[0]||q.c[0]==1&&!q.e&&q.c.length==1||!v.c||!v.c[0])return V=new g(Math.pow(+j(q),A?v.s*(2-M(v)):+j(v))),S?V.mod(S):V;if(L=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new g(NaN);x=!L&&q.isInteger()&&S.isInteger(),x&&(q=q.mod(S))}else{if(v.e>9&&(q.e>0||q.e<-1||(q.e==0?q.c[0]>1||A&&q.c[1]>=24e7:q.c[0]<8e13||A&&q.c[0]<=9999975e7)))return H=q.s<0&&M(v)?-0:0,q.e>-1&&(H=1/H),new g(L?1/H:H);ut&&(H=i(ut/u+2))}for(A?(_=new g(.5),L&&(v.s=1),B=M(v)):(E=Math.abs(+j(v)),B=E%2),V=new g(X);;){if(B){if(V=V.times(q),!V.c)break;H?V.c.length>H&&(V.c.length=H):x&&(V=V.mod(S))}if(E){if(E=o(E/2),E===0)break;B=E%2}else if(v=v.times(_),F(v,v.e+1,1),v.e>14)B=M(v);else{if(E=+j(v),E===0)break;B=E%2}q=q.times(q),H?q.c&&q.c.length>H&&(q.c.length=H):x&&(q=q.mod(S))}return x?V:(L&&(V=X.div(V)),S?V.mod(S):H?F(V,ut,ae,$):V)},W.integerValue=function(v){var S=new g(this);return v==null?v=ae:b(v,0,8),F(S,S.e+1,v)},W.isEqualTo=W.eq=function(v,S){return T(this,new g(v,S))===0},W.isFinite=function(){return!!this.c},W.isGreaterThan=W.gt=function(v,S){return T(this,new g(v,S))>0},W.isGreaterThanOrEqualTo=W.gte=function(v,S){return(S=T(this,new g(v,S)))===1||S===0},W.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},W.isLessThan=W.lt=function(v,S){return T(this,new g(v,S))<0},W.isLessThanOrEqualTo=W.lte=function(v,S){return(S=T(this,new g(v,S)))===-1||S===0},W.isNaN=function(){return!this.s},W.isNegative=function(){return this.s<0},W.isPositive=function(){return this.s>0},W.isZero=function(){return!!this.c&&this.c[0]==0},W.minus=function(v,S){var _,x,E,H,$=this,A=$.s;if(v=new g(v,S),S=v.s,!A||!S)return new g(NaN);if(A!=S)return v.s=-S,$.plus(v);var L=$.e/u,B=v.e/u,V=$.c,q=v.c;if(!L||!B){if(!V||!q)return V?(v.s=-S,v):new g(q?$:NaN);if(!V[0]||!q[0])return q[0]?(v.s=-S,v):new g(V[0]?$:ae==3?-0:0)}if(L=w(L),B=w(B),V=V.slice(),A=L-B){for((H=A<0)?(A=-A,E=V):(B=L,E=q),E.reverse(),S=A;S--;E.push(0));E.reverse()}else for(x=(H=(A=V.length)<(S=q.length))?A:S,A=S=0;S<x;S++)if(V[S]!=q[S]){H=V[S]<q[S];break}if(H&&(E=V,V=q,q=E,v.s=-v.s),S=(x=q.length)-(_=V.length),S>0)for(;S--;V[_++]=0);for(S=l-1;x>A;){if(V[--x]<q[x]){for(_=x;_&&!V[--_];V[_]=S);--V[_],V[x]+=l}V[x]-=q[x]}for(;V[0]==0;V.splice(0,1),--B);return V[0]?k(v,V,B):(v.s=ae==3?-1:1,v.c=[v.e=0],v)},W.modulo=W.mod=function(v,S){var _,x,E=this;return v=new g(v,S),!E.c||!v.s||v.c&&!v.c[0]?new g(NaN):!v.c||E.c&&!E.c[0]?new g(E):(St==9?(x=v.s,v.s=1,_=O(E,v,0,3),v.s=x,_.s*=x):_=O(E,v,0,St),v=E.minus(_.times(v)),!v.c[0]&&St==1&&(v.s=E.s),v)},W.multipliedBy=W.times=function(v,S){var _,x,E,H,$,A,L,B,V,q,J,se,be,je,Xe,Re=this,Te=Re.c,qe=(v=new g(v,S)).c;if(!Te||!qe||!Te[0]||!qe[0])return!Re.s||!v.s||Te&&!Te[0]&&!qe||qe&&!qe[0]&&!Te?v.c=v.e=v.s=null:(v.s*=Re.s,!Te||!qe?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(x=w(Re.e/u)+w(v.e/u),v.s*=Re.s,L=Te.length,q=qe.length,L<q&&(be=Te,Te=qe,qe=be,E=L,L=q,q=E),E=L+q,be=[];E--;be.push(0));for(je=l,Xe=d,E=q;--E>=0;){for(_=0,J=qe[E]%Xe,se=qe[E]/Xe|0,$=L,H=E+$;H>E;)B=Te[--$]%Xe,V=Te[$]/Xe|0,A=se*B+V*J,B=J*B+A%Xe*Xe+be[H]+_,_=(B/je|0)+(A/Xe|0)+se*V,be[H--]=B%je;be[H]=_}return _?++x:be.splice(0,1),k(v,be,x)},W.negated=function(){var v=new g(this);return v.s=-v.s||null,v},W.plus=function(v,S){var _,x=this,E=x.s;if(v=new g(v,S),S=v.s,!E||!S)return new g(NaN);if(E!=S)return v.s=-S,x.minus(v);var H=x.e/u,$=v.e/u,A=x.c,L=v.c;if(!H||!$){if(!A||!L)return new g(E/0);if(!A[0]||!L[0])return L[0]?v:new g(A[0]?x:E*0)}if(H=w(H),$=w($),A=A.slice(),E=H-$){for(E>0?($=H,_=L):(E=-E,_=A),_.reverse();E--;_.push(0));_.reverse()}for(E=A.length,S=L.length,E-S<0&&(_=L,L=A,A=_,S=E),E=0;S;)E=(A[--S]=A[S]+L[S]+E)/l|0,A[S]=l===A[S]?0:A[S]%l;return E&&(A=[E].concat(A),++$),k(v,A,$)},W.precision=W.sd=function(v,S){var _,x,E,H=this;if(v!=null&&v!==!!v)return b(v,1,f),S==null?S=ae:b(S,0,8),F(new g(H),v,S);if(!(_=H.c))return null;if(E=_.length-1,x=E*u+1,E=_[E]){for(;E%10==0;E/=10,x--);for(E=_[0];E>=10;E/=10,x++);}return v&&H.e+1>x&&(x=H.e+1),x},W.shiftedBy=function(v){return b(v,-9007199254740991,c),this.times("1e"+v)},W.squareRoot=W.sqrt=function(){var v,S,_,x,E,H=this,$=H.c,A=H.s,L=H.e,B=z+4,V=new g("0.5");if(A!==1||!$||!$[0])return new g(!A||A<0&&(!$||$[0])?NaN:$?H:1/0);if(A=Math.sqrt(+j(H)),A==0||A==1/0?(S=y($),(S.length+L)%2==0&&(S+="0"),A=Math.sqrt(+S),L=w((L+1)/2)-(L<0||L%2),A==1/0?S="5e"+L:(S=A.toExponential(),S=S.slice(0,S.indexOf("e")+1)+L),_=new g(S)):_=new g(A+""),_.c[0]){for(L=_.e,A=L+B,A<3&&(A=0);;)if(E=_,_=V.times(E.plus(O(H,E,B,1))),y(E.c).slice(0,A)===(S=y(_.c)).slice(0,A))if(_.e<L&&--A,S=S.slice(A-3,A+1),S=="9999"||!x&&S=="4999"){if(!x&&(F(E,E.e+z+2,0),E.times(E).eq(H))){_=E;break}B+=4,A+=4,x=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(F(_,_.e+z+2,1),v=!_.times(_).eq(H));break}}return F(_,_.e+z+1,ae,v)},W.toExponential=function(v,S){return v!=null&&(b(v,0,f),v++),p(this,v,S,1)},W.toFixed=function(v,S){return v!=null&&(b(v,0,f),v=v+this.e+1),p(this,v,S)},W.toFormat=function(v,S,_){var x,E=this;if(_==null)v!=null&&S&&typeof S=="object"?(_=S,S=null):v&&typeof v=="object"?(_=v,v=S=null):_=ct;else if(typeof _!="object")throw Error(s+"Argument not an object: "+_);if(x=E.toFixed(v,S),E.c){var H,$=x.split("."),A=+_.groupSize,L=+_.secondaryGroupSize,B=_.groupSeparator||"",V=$[0],q=$[1],J=E.s<0,se=J?V.slice(1):V,be=se.length;if(L&&(H=A,A=L,L=H,be-=H),A>0&&be>0){for(H=be%A||A,V=se.substr(0,H);H<be;H+=A)V+=B+se.substr(H,A);L>0&&(V+=B+se.slice(H)),J&&(V="-"+V)}x=q?V+(_.decimalSeparator||"")+((L=+_.fractionGroupSize)?q.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):q):V}return(_.prefix||"")+x+(_.suffix||"")},W.toFraction=function(v){var S,_,x,E,H,$,A,L,B,V,q,J,se=this,be=se.c;if(v!=null&&(A=new g(v),!A.isInteger()&&(A.c||A.s!==1)||A.lt(X)))throw Error(s+"Argument "+(A.isInteger()?"out of range: ":"not an integer: ")+j(A));if(!be)return new g(se);for(S=new g(X),B=_=new g(X),x=L=new g(X),J=y(be),H=S.e=J.length-se.e-1,S.c[0]=h[($=H%u)<0?u+$:$],v=!v||A.comparedTo(S)>0?H>0?S:B:A,$=$e,$e=1/0,A=new g(J),L.c[0]=0;V=O(A,S,0,1),E=_.plus(V.times(x)),E.comparedTo(v)!=1;)_=x,x=E,B=L.plus(V.times(E=B)),L=E,S=A.minus(V.times(E=S)),A=E;return E=O(v.minus(_),x,0,1),L=L.plus(E.times(B)),_=_.plus(E.times(x)),L.s=B.s=se.s,H=H*2,q=O(B,x,H,ae).minus(se).abs().comparedTo(O(L,_,H,ae).minus(se).abs())<1?[B,x]:[L,_],$e=$,q},W.toNumber=function(){return+j(this)},W.toPrecision=function(v,S){return v!=null&&b(v,1,f),p(this,v,S,2)},W.toString=function(v){var S,_=this,x=_.s,E=_.e;return E===null?x?(S="Infinity",x<0&&(S="-"+S)):S="NaN":(v==null?S=E<=ee||E>=ce?R(y(_.c),E):D(y(_.c),E,"0"):v===10&&it?(_=F(new g(_),z+E+1,ae),S=D(y(_.c),_.e,"0")):(b(v,2,kn.length,"Base"),S=U(D(y(_.c),E,"0"),10,v,x,!0)),x<0&&_.c[0]&&(S="-"+S)),S},W.valueOf=W.toJSON=function(){return j(this)},W._isBigNumber=!0,I!=null&&g.set(I),g}function w(I){var O=I|0;return I>0||I===O?O:O-1}function y(I){for(var O,U,G=1,W=I.length,X=I[0]+"";G<W;){for(O=I[G++]+"",U=u-O.length;U--;O="0"+O);X+=O}for(W=X.length;X.charCodeAt(--W)===48;);return X.slice(0,W+1||1)}function T(I,O){var U,G,W=I.c,X=O.c,z=I.s,ae=O.s,ee=I.e,ce=O.e;if(!z||!ae)return null;if(U=W&&!W[0],G=X&&!X[0],U||G)return U?G?0:-ae:z;if(z!=ae)return z;if(U=z<0,G=ee==ce,!W||!X)return G?0:!W^U?1:-1;if(!G)return ee>ce^U?1:-1;for(ae=(ee=W.length)<(ce=X.length)?ee:ce,z=0;z<ae;z++)if(W[z]!=X[z])return W[z]>X[z]^U?1:-1;return ee==ce?0:ee>ce^U?1:-1}function b(I,O,U,G){if(I<O||I>U||I!==o(I))throw Error(s+(G||"Argument")+(typeof I=="number"?I<O||I>U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(I))}function M(I){var O=I.c.length-1;return w(I.e/u)==O&&I.c[O]%2!=0}function R(I,O){return(I.length>1?I.charAt(0)+"."+I.slice(1):I)+(O<0?"e":"e+")+O}function D(I,O,U){var G,W;if(O<0){for(W=U+".";++O;W+=U);I=W+I}else if(G=I.length,++O>G){for(W=U,O-=G;--O;W+=U);I+=W}else O<G&&(I=I.slice(0,O)+"."+I.slice(O));return I}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(D7)})(bF);var RF=bF.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const zi=vM(),r5=pM(),i5=wM,o5=RF,Hn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Yf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:EF,decimalSuffixes:Np}=zi.currentBytes(),CM={general:{scale:1024,suffixes:Np},binary:{scale:1024,suffixes:EF},decimal:{scale:1e3,suffixes:Np}};function s5(t,e={},n){if(typeof e=="string"&&(e=i5.parseFormat(e)),!r5.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=a5(t,e,n);return s=_5(s,i),s=M5(s,o),s}function a5(t,e,n){switch(e.output){case"currency":return e=fc(e,zi.currentCurrencyDefaultFormat()),m5(t,e,zi);case"percent":return e=fc(e,zi.currentPercentageDefaultFormat()),g5(t,e,zi,n);case"byte":return e=fc(e,zi.currentByteDefaultFormat()),h5(t,e,zi,n);case"time":return e=fc(e,zi.currentTimeDefaultFormat()),f5(t);case"ordinal":return e=fc(e,zi.currentOrdinalDefaultFormat()),d5(t,e,zi);case"number":default:return Gf({instance:t,providedFormat:e})}}function l5(t){let e=CM.decimal;return ev(t._value,e.suffixes,e.scale).suffix}function u5(t){let e=CM.binary;return ev(t._value,e.suffixes,e.scale).suffix}function c5(t){let e=CM.general;return ev(t._value,e.suffixes,e.scale).suffix}function ev(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function h5(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Yf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||Np,marker:"bd"},binary:{scale:1024,suffixes:s||EF,marker:"b"},decimal:{scale:1e3,suffixes:a||Np,marker:"d"}}[i],{value:c,suffix:h}=ev(t._value,u.suffixes,u.scale);return`${Gf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function d5(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Yf,e),o=Gf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function f5(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function g5(t,e,n,r){let i=e.prefixSymbol,o=Gf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Yf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function m5(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Yf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Gf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function p5({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Hn[e]?(a=r[e],t=t/Hn[e]):l>=Hn.trillion||n&&s(l/Hn.trillion)===1?(a=r.trillion,t=t/Hn.trillion):l<Hn.trillion&&l>=Hn.billion||n&&s(l/Hn.billion)===1?(a=r.billion,t=t/Hn.billion):l<Hn.billion&&l>=Hn.million||n&&s(l/Hn.million)===1?(a=r.million,t=t/Hn.million):(l<Hn.million&&l>=Hn.thousand||n&&s(l/Hn.thousand)===1)&&(a=r.thousand,t=t/Hn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function w5({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function $g(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function v5(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+$g(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=($g(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=$g(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${$g(e)}`),n}function C5(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?v5(t,e):new o5(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function y5(t,e,n,r,i,o){if(r===-1)return t;let s=C5(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function S5(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function b5(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function R5(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),b5(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function E5(t,e){return t+e}function T5(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function _5(t,e){return e+t}function M5(t,e){return t+e}function Gf({instance:t,providedFormat:e,state:n=zi,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Yf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,y=s.thousandSeparated,T=s.spaceSeparated,b=s.negative,M=s.forceSign,R=s.exponential,D=s.roundingFunction,I="";if(d){let U=p5({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:T,roundingFunction:D,totalLength:a});o=U.value,I+=U.abbreviation,a&&(f=U.mantissaPrecision)}if(R){let U=w5({value:o,characteristicPrecision:l});o=U.value,I=U.abbreviation+I}let O=y5(o.toString(),o,m,f,w,D);return O=S5(O,o,u,l),O=R5(O,o,y,n,r),(d||R)&&(O=E5(O,I)),(M||o<0)&&(O=T5(O,o,b)),O}function fc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var P5=t=>({format:(...e)=>s5(...e,t),getByteUnit:(...e)=>c5(...e,t),getBinaryByteUnit:(...e)=>u5(...e,t),getDecimalByteUnit:(...e)=>l5(...e,t),formatOrDefault:fc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ds=RF;function I5(t,e,n){let r=new Ds(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ds(i),t._value=r.plus(i).toNumber(),t}function TF(t,e,n){let r=new Ds(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ds(i),t._value=r.minus(i).toNumber(),t}function O5(t,e,n){let r=new Ds(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ds(i),t._value=r.times(i).toNumber(),t}function x5(t,e,n){let r=new Ds(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Ds(i),t._value=r.dividedBy(i).toNumber(),t}function A5(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function H5(t,e,n){let r=n(t._value);return TF(r,e,n),Math.abs(r._value)}var N5=t=>({add:(e,n)=>I5(e,n,t),subtract:(e,n)=>TF(e,n,t),multiply:(e,n)=>O5(e,n,t),divide:(e,n)=>x5(e,n,t),set:(e,n)=>A5(e,n,t),difference:(e,n)=>H5(e,n,t),BigNumber:Ds});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const D5="2.5.0",Qo=vM(),k5=pM(),L5=n5(qt),$5=SF();let sl=P5(qt),Ll=N5(qt);const F5=wM;class _F{constructor(e){this._value=e}clone(){return qt(this._value)}format(e={}){return sl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=F5.parseFormat(e)),e=sl.formatOrDefault(e,Qo.currentCurrencyDefaultFormat()),e.output="currency",sl.format(this,e)}formatTime(e={}){return e.output="time",sl.format(this,e)}binaryByteUnits(){return sl.getBinaryByteUnit(this)}decimalByteUnits(){return sl.getDecimalByteUnit(this)}byteUnits(){return sl.getByteUnit(this)}difference(e){return Ll.difference(this,e)}add(e){return Ll.add(this,e)}subtract(e){return Ll.subtract(this,e)}multiply(e){return Ll.multiply(this,e)}divide(e){return Ll.divide(this,e)}set(e){return Ll.set(this,MF(e))}value(){return this._value}valueOf(){return this._value}}function MF(t){let e=t;return qt.isNumbro(t)?e=t._value:typeof t=="string"?e=qt.unformat(t):isNaN(t)&&(e=NaN),e}function qt(t){return new _F(MF(t))}qt.version=D5;qt.isNumbro=function(t){return t instanceof _F};qt.language=Qo.currentLanguage;qt.registerLanguage=Qo.registerLanguage;qt.setLanguage=Qo.setLanguage;qt.languages=Qo.languages;qt.languageData=Qo.languageData;qt.zeroFormat=Qo.setZeroFormat;qt.defaultFormat=Qo.currentDefaults;qt.setDefaults=Qo.setDefaults;qt.defaultCurrencyFormat=Qo.currentCurrencyDefaultFormat;qt.validate=k5.validate;qt.loadLanguagesInNode=L5.loadLanguagesInNode;qt.unformat=$5.unformat;qt.BigNumber=Ll.BigNumber;var V5=qt,al=k7(V5);const W5="numeric";function PF(t,e){if(Yn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!al.languages()[r]){const o=r.replace("-",""),s=al.allLanguages?al.allLanguages[r]:al[o];s&&al.registerLanguage(s)}al.setLanguage(r),t=al(t).format(i||"0")}return t}function yM(t,e,n,r,i,o,s){let a=o;if(Yn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=PF(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Bs(t,e,n,r,i,a,s)}yM.RENDERER_TYPE=W5;const B5="password";function SM(t,e,n,r,i,o,s){Bs.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Ya(e,u)}SM.RENDERER_TYPE=B5;const j5="select";function bM(t,e,n,r,i,o,s){Bs.apply(this,[t,e,n,r,i,o,s])}bM.RENDERER_TYPE=j5;const U5="time";function RM(t,e,n,r,i,o,s){Bs.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}RM.RENDERER_TYPE=U5;function z5(){Yr(fh),Yr(zf),Yr(fM),Yr(dM),Yr(mM),Yr(hM),Yr(yM),Yr(SM),Yr(bM),Yr(Bs),Yr(RM)}const Y5="autocomplete";function tv(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,b1(n,e)):b1(n,e)(this.source):e(!0)}tv.VALIDATOR_TYPE=Y5;function b1(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(kf(n,r[o])){i=!0;break}e(i)}}function IF(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const G5=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:IF},Symbol.toStringTag,{value:"Module"})),q5="date";function EM(t,e){const n=e$(fF,this.instance);let r=t,i=!0;r==null&&(r="");let o=K(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=K(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=K5(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}EM.VALIDATOR_TYPE=q5;function K5(t,e){const n=K(IF(t)),r=K(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const X5="dropdown";function TM(t,e){tv.apply(this,[t,e])}TM.VALIDATOR_TYPE=X5;const Z5="numeric";function _M(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Yn(t))}_M.VALIDATOR_TYPE=Z5;const Q5=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],J5="time";function MM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=K(i,Q5,!0).isValid()?K(i):K(i,n);let a=s.isValid(),l=K(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}MM.VALIDATOR_TYPE=J5;function eZ(){Bl(tv),Bl(TM),Bl(EM),Bl(_M),Bl(MM)}function OF(t){return ye(t)&&t.value!==void 0?t.value:t}function xF(t,e,n){const r=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),i=o=>ye(o)&&oe(o.key)&&oe(o.value);return i(r)?i(t)?t:{key:t,value:t}:t}const tZ="autocomplete",nZ={CELL_TYPE:tZ,editor:uM,renderer:fh,validator:tv,valueGetter:OF,valueSetter:xF};function rZ(t,e,n){const{checkedTemplate:r,uncheckedTemplate:i}=this.getCellMeta(e,n),o=Ct(t),s=o===Ct(r),a=o===Ct(i);return s||a?s?r:i:t}const iZ="checkbox",oZ={CELL_TYPE:iZ,editor:dF,renderer:fM,valueSetter:rZ},sZ="date";function AF(t,e,n,r,i,o,s){fh.apply(this,[t,e,n,r,i,o,s])}AF.RENDERER_TYPE=sZ;const aZ="date",lZ={CELL_TYPE:aZ,editor:gF,renderer:AF,validator:EM};function uZ(t){return OF.call(this,t)}function cZ(t,e,n,r){return xF.call(this,t,e,n,r)}const hZ="dropdown",dZ={CELL_TYPE:hZ,editor:mF,renderer:dM,validator:TM,filter:!1,strict:!0,valueGetter:uZ,valueSetter:cZ},fZ="handsontable",gZ={CELL_TYPE:fZ,editor:lM,renderer:mM};function mZ(t){if(typeof t=="string"&&r$(t)){const e=i$(t);return Rd(e)?t:e}return t}const pZ="numeric",wZ={CELL_TYPE:pZ,editor:pF,renderer:yM,validator:_M,dataType:"number",valueSetter:mZ},vZ="password",CZ={CELL_TYPE:vZ,editor:wF,renderer:SM,copyable:!1},yZ="select",SZ={CELL_TYPE:yZ,editor:vF,renderer:bM},bZ="time",RZ={CELL_TYPE:bZ,editor:CF,renderer:RM,validator:MM};function EZ(){hi(nZ),hi(oZ),hi(lZ),hi(dZ),hi(gZ),hi(wZ),hi(CZ),hi(SZ),hi(lF),hi(RZ)}function TZ(t,e){HF(t,e),e.add(t)}function Du(t,e,n){return(e=_Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Z(t){var e=MZ(t,"string");return typeof e=="symbol"?e:e+""}function MZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function R1(t,e,n){HF(t,e),e.set(t,n)}function HF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fg(t,e,n){return t.set(PM(t,e),n),n}function jt(t,e){return t.get(PM(t,e))}function PM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const E1=new Map([["plugin",Uq],["cell-type",X$],["editor",JL],["renderer",a$],["validator",l$]]),NF=Symbol("mainSetting"),PZ="base",Vg=[];let ll=null;var Xt=new WeakMap,ul=new WeakMap,T1=new WeakSet;class Be{static get PLUGIN_KEY(){return PZ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){TZ(this,T1),R1(this,Xt,null),Du(this,"eventManager",new _i(this)),Du(this,"pluginName",null),Du(this,"pluginsInitializedCallbacks",[]),Du(this,"isPluginsReady",!1),Du(this,"enabled",!1),Du(this,"initialized",!1),R1(this,ul,{}),Xo(this,"hot",e,{writable:!1}),ll=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!E1.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);E1.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Vg.push(o)}}if(ll||(ll=Q0()),ll.indexOf(this.pluginName)>=0&&ll.splice(ll.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ll.length===0){if(Vg.length>0){const i=[`${Vg.join(`
`)}
`,"You have to import and register them manually."].join("");throw Vg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return ye(jt(Xt,this))?Ad(jt(Xt,this),n):jt(Xt,this);if((Array.isArray(jt(Xt,this))||ye(jt(Xt,this)))&&n[NF]===e){var r;return Array.isArray(jt(Xt,this))?jt(Xt,this):(r=jt(Xt,this)[e])!==null&&r!==void 0?r:n[e]}if(e.includes(".")){const i=vp(jt(Xt,this),e),o=vp(n,e);return ye(i)?Ad(i,o):i!==void 0?i:o}return ye(jt(Xt,this))?Ad(jt(Xt,this),n)[e]:n[e]}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){We(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Fg(Xt,this,e),jt(Xt,this)}return n&&typeof n=="object"&&typeof e=="object"?((jt(Xt,this)===null||typeof jt(Xt,this)!="object")&&Fg(Xt,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(r=>{if(!(r in e))return;const i=n[r];if((i?i(e[r]):!0)===!1){We(`${this.pluginName} Plugin: "${r}" option is not valid and it will be ignored.`);return}jt(Xt,this)[r]=e[r]}),jt(Xt,this)):(Fg(Xt,this,e),e)}addHook(e,n,r){jt(ul,this)[e]=jt(ul,this)[e]||[];const i=jt(ul,this)[e];this.hot.addHook(e,n,r),i.push(n),jt(ul,this)[e]=i}removeHooks(e){P(jt(ul,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=jt(ul,this);He(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=PM(T1,this,IZ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Fg(Xt,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),He(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function IZ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function cl(t,e,n){return(e=OZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OZ(t){var e=xZ(t,"string");return typeof e=="symbol"?e:e+""}function xZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let IM=class{constructor(e){cl(this,"hot",null),cl(this,"container",null),cl(this,"injected",!1),cl(this,"rows",[]),cl(this,"columns",[]),cl(this,"samples",null),cl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Y(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),P(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{P(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{P(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{P(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),P(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{P(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Y(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Y(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function jh(t,e,n){return(e=AZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:e+""}function HZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nv{static get SAMPLE_COUNT(){return 3}constructor(e){jh(this,"samples",null),jh(this,"dataFactory",null),jh(this,"customSampleCount",null),jh(this,"allowDuplicates",!1),jh(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:nv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a,this):this.dataFactory(a,r,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:ye(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Ct(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function NZ(t,e){DF(t,e),e.add(t)}function tb(t,e,n){DF(t,e),e.set(t,n)}function DF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uh(t,e,n){return(e=DZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DZ(t){var e=kZ(t,"string");return typeof e=="symbol"?e:e+""}function kZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ia(t,e){return t.get(_r(t,e))}function Dp(t,e,n){return t.set(_r(t,e),n),n}function _r(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutoColumnSizeSeed");const nb="autoColumnSize",LZ=10,$Z="autoColumnSize";var OM=new WeakMap,gc=new WeakMap,Xc=new WeakMap,Gr=new WeakSet;class $d extends Be{static get PLUGIN_KEY(){return nb}static get PLUGIN_PRIORITY(){return LZ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),NZ(this,Gr),Uh(this,"ghostTable",new IM(this.hot)),Uh(this,"samplesGenerator",new nv((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Uh(this,"inProgress",!1),Uh(this,"measuredColumns",0),Uh(this,"columnWidthsMap",new Ga),tb(this,OM,!1),tb(this,gc,[]),tb(this,Xc,[]),this.hot.columnIndexMapper.registerMap($Z,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>_r(Gr,this,_1).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[nb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _r(Gr,e,WZ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _r(Gr,e,BZ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _r(Gr,e,UZ).call(e,...i)}),this.addHook("beforeRender",()=>_r(Gr,this,VZ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>_r(Gr,this,jZ).call(this)),super.enablePlugin()}updatePlugin(){Dp(Xc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>_r(Gr,this,_1).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&_r(Gr,this,kF).call(this,s,o)}),this.ghostTable.columns.length&&(_r(Gr,this,LF).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){sf(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+$d.CALCULATION_STEP,i)},e,n),r=r+$d.CALCULATION_STEP+1,r<i?o=of(s):(sf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[nb];let n=$d.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return ye(e)&&(n=e.syncLimit,I0(n)?n=X0(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,zc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Ia(gc,this).length;return(s-1<o||Ia(gc,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Ia(gc,this).push(i):Ia(gc,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function FZ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||_r(Gr,this,kF).call(this,n,e))}),this.ghostTable.columns.length&&(_r(Gr,this,LF).call(this),this.ghostTable.clean())}function kF(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function LF(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function VZ(){this.calculateVisibleColumnsWidth(),this.inProgress||(_r(Gr,this,FZ).call(this,Ia(Xc,this)),Dp(Xc,this,[]))}function WZ(t,e){e||this.recalculateAllColumnsWidth()}function BZ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ia(Xc,this).push(...e)}function _1(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function jZ(){Dp(gc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Dp(OM,this,!0)}function UZ(t){if(!Ia(OM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ia(Xc,this).push(...e)}const ql={horizontal:"horizontal",vertical:"vertical"};function zZ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function YZ(t){const e={};return t===!0?(e.directions=Object.keys(ql),e.autoInsertRow=!0):ye(t)?(oe(t.autoInsertRow)?t.direction===ql.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,oe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(ql)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function GZ(t,e){qZ(t,e),e.add(t)}function qZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){return(e=KZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KZ(t){var e=XZ(t,"string");return typeof e=="symbol"?e:e+""}function XZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("modifyAutofillRange");re.getSingleton().register("beforeAutofill");re.getSingleton().register("afterAutofill");const M1="autofill",ZZ=20,QZ=["fillHandle"],JZ="insert_row_below",eQ=200;var hl=new WeakSet;class tQ extends Be{constructor(){super(...arguments),GZ(this,hl),ku(this,"addingStarted",!1),ku(this,"mouseDownOnCellCorner",!1),ku(this,"mouseDragOutside",!1),ku(this,"handleDraggedCells",0),ku(this,"directions",[]),ku(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return M1}static get PLUGIN_PRIORITY(){return ZZ}static get SETTING_KEYS(){return[M1,...QZ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Lu(hl,this,iQ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Lu(hl,this,rQ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Lu(hl,this,oQ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:r,col:i}=n.getTopStartCorner(),{row:o,col:s}=n.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:o,endCol:s}]),l=[],u=[],c=[];return P(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)u.indexOf(d)===-1&&u.push(d)}),P(l,h=>{const d=[];P(u,f=>{const m=e?this.hot.getSourceDataAtCell(h,f):null;e&&ye(m)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=zZ(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=this.getSelectionData(!0),w=o.clone(),y=this.hot._createCellRange(h,h,d),T=this.hot.runHooks("beforeAutofill",f,w,y,c);if(T===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=T;const M=T;if(["up","left"].indexOf(c)>-1&&!(M.length===1&&M[0].length===0))if(b=[],c==="up"){const R=d.row-h.row+1,D=R%M.length;for(let I=0;I<R;I++)b.push(M[(I+(M.length-D))%M.length])}else{const R=d.col-h.col+1,D=R%M[0].length;for(let I=0;I<M.length;I++){b.push([]);for(let O=0;O<R;O++)b[I].push(M[I][(O+(M[I].length-D))%M[I].length])}}if(m.some(R=>R.some(D=>ye(D)))){const R=Lu(hl,this,nQ).call(this,b,m,h,d,c);R.length&&(b=R)}this.hot.populateFromArray(h.row,h.col,b,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,y,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(ql.vertical)&&this.directions.includes(ql.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(ql.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(ql.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(JZ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},eQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ge(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Dn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Jt(this.hot.table),i=Dn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Gt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Lu(hl,this,sQ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Lu(hl,this,aQ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=YZ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function nQ(t,e,n,r){const i=[];for(let o=Math.min(n.row,r.row);o<=Math.max(n.row,r.row);o+=1){i.push([]);for(let s=Math.min(n.col,r.col);s<=Math.max(n.col,r.col);s+=1){const a=this.hot.getSourceDataAtCell(o,s),l=o-Math.min(n.row,r.row),u=s-Math.min(n.col,r.col),c=l%e.length,h=u%e[0].length;ye(a)?i[l][u]=e[c][h]:i[l][u]=t[c][h]}}return i}function rQ(){this.selectAdjacent()&&this.fillIn()}function iQ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function oQ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function sQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function aQ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function lQ(t,e){$F(t,e),e.add(t)}function P1(t,e,n){$F(t,e),e.set(t,n)}function $F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $u(t,e,n){return(e=uQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uQ(t){var e=cQ(t,"string");return typeof e=="symbol"?e:e+""}function cQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FF(t,e,n){return t.set(Xr(t,e),n),n}function kp(t,e){return t.get(Xr(t,e))}function Xr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rb="autoRowSize",hQ=40,dQ="autoRowSize",I1="htFirstDatasetColumnNotRendered";var df=new WeakMap,xM=new WeakMap,di=new WeakSet;class Fd extends Be{static get PLUGIN_KEY(){return rb}static get PLUGIN_PRIORITY(){return hQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lQ(this,di),$u(this,"headerHeight",null),$u(this,"ghostTable",new IM(this.hot)),$u(this,"samplesGenerator",new nv((n,r)=>{const i=this.hot.toPhysicalColumn(r);if(this.hot.columnIndexMapper.isHidden(i)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,r):n===-1&&(o=this.hot.getColHeader(r)),{value:o}})),$u(this,"inProgress",!1),$u(this,"measuredRows",0),$u(this,"rowHeightsMap",new Ga),P1(this,df,[]),P1(this,xM,!1),this.hot.rowIndexMapper.registerMap(dQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Xr(di,this,O1).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[rb];return e===!0||ye(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xr(di,e,pQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xr(di,e,wQ).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xr(di,e,CQ).call(e,...i)}),this.addHook("beforeViewRender",()=>Xr(di,this,gQ).call(this)),this.addHook("beforeRender",()=>Xr(di,this,mQ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>Xr(di,this,vQ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),Xr(di,this,VF).call(this,!1),this.addHook("beforeRowResize",(e,n,r)=>Xr(di,this,O1).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){sf(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+Fd.CALCULATION_STEP,i)},e,n),r=r+Fd.CALCULATION_STEP+1,r<i?o=of(s):(sf(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[rb];let n=Fd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return ye(e)&&(n=e.syncLimit,I0(n)?n=X0(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight();if(e<0){var r;return(r=this.headerHeight)!==null&&r!==void 0?r:n}const i=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(i))return n;const o=this.rowHeightsMap.getValueAtIndex(i);let s=n;return o!==null&&o>n&&(s=o),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fQ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function VF(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?le(this.hot.rootElement,I1):Y(this.hot.rootElement,I1)}function gQ(){Xr(di,this,VF).call(this)}function mQ(){this.calculateVisibleRowsHeight(),this.inProgress||(Xr(di,this,fQ).call(this,kp(df,this)),FF(df,this,[]))}function O1(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function pQ(t,e){e||this.recalculateAllRowsHeight()}function wQ(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);kp(df,this).push(...e)}function vQ(){this.recalculateAllRowsHeight(),FF(xM,this,!0)}function CQ(t){if(!kp(xM,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);kp(df,this).push(...e)}const{getListWithInsertedItems:yQ,getListWithRemovedItems:SQ}=O$("physicallyIndexed");class bQ extends Cu{constructor(){super(e=>e)}insert(e,n){const r=bT(this.indexedValues,n);this.indexedValues=yQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=SQ(this.indexedValues,e);this.indexedValues=ST(n,e),super.remove(e)}}const{getListWithInsertedItems:RQ,getListWithRemovedItems:EQ}=O$("physicallyIndexed");class TQ extends Cu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=RQ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=EQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function _Q(t,e){MQ(t,e),e.add(t)}function MQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PQ(t,e,n){return(e=IQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:e+""}function OQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xQ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const x1="bindRowsWithHeaders",AQ=210,HQ="loose",A1=new Map([["loose",bQ],["strict",TQ]]);var H1=new WeakSet;class NQ extends Be{constructor(){super(...arguments),_Q(this,H1),PQ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return x1}static get PLUGIN_PRIORITY(){return AQ}isEnabled(){return!!this.hot.getSettings()[x1]}enablePlugin(){var e;if(this.enabled)return;const n=(e=A1.get(this.getSetting()))!==null&&e!==void 0?e:A1.get(HQ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>xQ(H1,this,DQ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function DQ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function kQ(t,e){WF(t,e),e.add(t)}function LQ(t,e,n){WF(t,e),e.set(t,n)}function WF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N1(t,e,n){return(e=$Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Q(t){var e=FQ(t,"string");return typeof e=="symbol"?e:e+""}function FQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D1(t,e){return t.get(Ec(t,e))}function ib(t,e,n){return t.set(Ec(t,e),n),n}function Ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Xm="collapsibleColumns",VQ=290,WQ=["nestedHeaders"],Fc="collapsibleIndicator",k1=Xm,L1=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Fu=new WeakMap,zh=new WeakSet;class BQ extends Be{constructor(){super(...arguments),kQ(this,zh),N1(this,"nestedHeadersPlugin",null),N1(this,"headerStateManager",null),LQ(this,Fu,null)}static get PLUGIN_KEY(){return Xm}static get PLUGIN_PRIORITY(){return VQ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Xm,...WQ]}isEnabled(){return!!this.hot.getSettings()[Xm]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||We("You need to configure the Nested Headers plugin in order to use collapsible headers."),ib(Fu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ec(zh,this,zQ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ec(zh,e,YQ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ec(zh,e,jQ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ec(zh,this,UQ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ib(Fu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeActive().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:k1,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(k1)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Fc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Fc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Fc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!L1.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=La(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;P(r,f=>{var m;let{row:w,col:y}=f;const{collapsible:T,isCollapsed:b}=(m=this.headerStateManager.getHeaderSettings(w,y))!==null&&m!==void 0?m:{};if(!T||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&P(r,f=>{let{row:m,col:w}=f;const{colspanCompensation:y,affectedColumns:T,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,m,w);y>0&&(s.push(...T),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=cL([...a,...s]):n==="expand"&&(l=La(a,f=>!s.includes(f)));const u=L1.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(s,f=>{D1(Fu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,T=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;y!==null&&T!==null&&this.hot.selectCell(y,T)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return D1(Fu,this).getHiddenIndexes()}destroy(){ib(Fu,this,null),super.destroy()}}function jQ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Fc}`);if(Wo(e,[Ei("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Y(u,Fc),e.querySelector("div:first-child").appendChild(u)),le(u,["collapsed","expanded"]),s?(Y(u,"collapsed"),Fa(u,"+"),l&&de(e,...Ei(!1))):(Y(u,"expanded"),Fa(u,"-"),l&&de(e,...Ei(!0))),l&&de(u,...vu());else{var c;(c=u)===null||c===void 0||c.remove()}}function UQ(t,e){ve(t.target,Fc)&&(ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ai(t))}function zQ(){this.updatePlugin()}function YQ(t,e){e||this.updatePlugin()}function dl(t,e,n){return(e=GQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=qQ(t,"string");return typeof e=="symbol"?e:e+""}function qQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const KQ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],XQ=!1,ZQ=!0,QQ=!0;class JQ{constructor(e,n){dl(this,"hot",void 0),dl(this,"sortingStates",new Gw),dl(this,"sortEmptyCells",XQ),dl(this,"indicator",ZQ),dl(this,"headerAction",QQ),dl(this,"compareFunctionFactory",void 0),dl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){ye(e)&&He(e,(n,r)=>{KQ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ye(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(oe(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function BF(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?jo:Wt(i)?Wt(o)?jo:s&&t==="asc"?$t:Ft:Wt(o)?s&&t==="asc"?Ft:$t:isNaN(i)&&!isNaN(o)?t==="asc"?Ft:$t:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?$t:Ft:i>o?t==="asc"?Ft:$t:jo}}const jF="default";function eJ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return jo;if(a){if(Wt(r))return t==="asc"?$t:Ft;if(Wt(i))return t==="asc"?Ft:$t}return isNaN(o)?Ft:isNaN(s)?$t:o<s?t==="asc"?$t:Ft:o>s?t==="asc"?Ft:$t:jo}}const tJ="numeric";function nJ(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Ft;if(l===!1&&u)return $t}return d===!1&&f?t==="asc"?$t:Ft:d&&f===!1?t==="asc"?Ft:$t:d===!1&&f===!1?BF(t,e,n)(s,a):c===i&&h===r?t==="asc"?$t:Ft:c===r&&h===i?t==="asc"?Ft:$t:jo}}const rJ="checkbox";function iJ(t,e,n){return KF(t,e.dateFormat,n)}const oJ="date";function sJ(t,e,n){return KF(t,e.timeFormat,n)}const aJ="time",{register:qf,getItem:$1,hasItem:lJ}=Hi("sorting.compareFunctionFactory"),{register:UF,getItem:uJ}=Hi("sorting.mainSortComparator");function zF(t){return lJ(t)?$1(t):$1(jF)}qf(rJ,nJ);qf(oJ,iJ);qf(jF,BF);qf(tJ,eJ);qf(aJ,sJ);const jo=0,$t=-1,Ft=1;function cJ(t,e){const n=uJ(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Lp="asc",$p="desc",YF="colHeader";function hJ(t){if(ye(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Lp,$p].includes(n)}function dJ(t){if(t.some(n=>hJ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function F1(t){if(t!==$p)return t===Lp?$p:Lp}function GF(t){return t.querySelector(`.${YF}`)}function qF(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function AM(t,e,n){return t===-1&&e>=0&&Va(n)===!1}function KF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return jo;if(Wt(r))return Wt(i)?jo:o&&t==="asc"?$t:Ft;if(Wt(i))return o&&t==="asc"?Ft:$t;const s=K(r,e),a=K(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?$t:Ft:a.isBefore(s)?t==="asc"?Ft:$t:jo:$t:Ft}}function fJ(t,e){We(Qe`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const gJ="ascending",mJ="descending",XF="indicatorDisabled",ZF="columnSorting",QF="sortAction",JF=new Map([[Lp,gJ],[$p,mJ]]);function pJ(t,e,n,r){const i=[ZF];if(r&&i.push(QF),n===!1)return i.push(XF),i;const o=t.getSortOrderOfColumn(e);return oe(o)&&i.push(JF.get(o)),i}function wJ(){return Array.from(JF.values()).concat(QF,XF,ZF)}function vJ(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:zF(u.type))(l,u,d)(c,h)}(0)}}function CJ(t,e){yJ(t,e),e.add(t)}function yJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wg(t,e,n){return(e=SJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:e+""}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Fp="columnSorting",RJ=50,Vp="append",EJ="replace",V1=Fp;UF(Fp,vJ);re.getSingleton().register("beforeColumnSort");re.getSingleton().register("afterColumnSort");const Yh=new WeakMap;var $l=new WeakSet;class eV extends Be{constructor(){super(...arguments),CJ(this,$l),Wg(this,"columnStatesManager",null),Wg(this,"columnMetaCache",null),Wg(this,"pluginKey",Fp),Wg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Fp}static get PLUGIN_PRIORITY(){return RJ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Yh.has(this.hot)&&Yh.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),fJ(Yh.get(this.hot),this.pluginKey);return}this.enabled||(Yh.set(this.hot,this.pluginKey),this.columnStatesManager=new JQ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ga(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>mc($l,this,TJ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mc($l,e,MJ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>mc($l,this,vE).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mc($l,e,_J).call(e,...r)}),this.hot.view&&mc($l,this,vE).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=GF(r);qF(n,r)===!1||i===null||this.updateHeaderClasses(i)};Yh.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:qa,position:"before",group:V1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(V1)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new x$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return oe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return dJ(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ge(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return oe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ge(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(oe(n)){const i=F1(n);return oe(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:F1()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vp;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(_t(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Vp)return[...o.slice(0,r),...o.slice(r+1),s];if(n===EJ)return[...o.slice(0,r),s,...o.slice(r+1)]}return oe(s)?o.concat(s):o}getPluginColumnConfig(e){if(ye(e)){const n=e[this.pluginKey];if(ye(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Ze(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Ge(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ge(n,u=>u[0]);cJ(n,this.pluginKey,Ge(e,u=>u.sortOrder),Ge(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ge(n,u=>u[0]),a=new Map(Ge(o,(u,c)=>[u,s[c]])),l=Ge(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(ye(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||ye(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(le(e,wJ()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Y(e,pJ(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),oe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ve(e.target,YF)}onAfterOnCellMouseDown(e,n){if(AM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function vE(){const t=this.getAllSavedSortSettings();if(ye(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function TJ(t,e){const n=GF(e);if(qF(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);de(e,...m2(s?`${s}ending`:"none"))}}function _J(t){t===!0&&this.hot.view&&mc($l,this,vE).call(this)}function MJ(t,e,n,r){AM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ob(t){return t==null||isNaN(t)}function PJ(t,e){if(typeof t!="number")return t;const n=r=>r.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const r=Math.round(t).toString().length;return n(t.toFixed(8-r))}return t;default:return t}}function fl(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:e+""}function OJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xJ{constructor(e,n){fl(this,"plugin",void 0),fl(this,"hot",void 0),fl(this,"endpoints",[]),fl(this,"settings",void 0),fl(this,"settingsType","array"),fl(this,"currentEndpoint",null),fl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;P(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?P(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):P(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){P(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];P(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),P(i,o=>{let s=[];P(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],P(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),P(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.result=PJ(e.result,e.roundFloat),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){We("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function AJ(t,e){HJ(t,e),e.add(t)}function HJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NJ(t,e,n){return(e=DJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=kJ(t,"string");return typeof e=="symbol"?e:e+""}function kJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sb="columnSummary",LJ=220;var gl=new WeakSet;class $J extends Be{constructor(){super(...arguments),AJ(this,gl),NJ(this,"endpoints",null)}static get PLUGIN_KEY(){return sb}static get PLUGIN_PRIORITY(){return LJ}isEnabled(){return!!this.hot.getSettings()[sb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[sb],this.endpoints=new xJ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,FJ).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,WJ).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,VJ).call(e,...r)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,BJ).call(e,...r)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,jJ).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vu(gl,e,UJ).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return He(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=ob(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return He(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=ob(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=ob(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return He(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Qe`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function FJ(){this.endpoints.initEndpoints()}function VJ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function WJ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function BJ(t,e){e||this.endpoints.refreshAllEndpoints()}function jJ(t,e){e||this.endpoints.refreshAllEndpoints()}function UJ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function zJ(t,e){tV(t,e),e.add(t)}function ab(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(t,e){return t.get(HM(t,e))}function CE(t,e,n){return t.set(HM(t,e),n),n}function HM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wp=new WeakMap,Bg=new WeakMap,jg=new WeakMap,W1=new WeakSet;class nV{constructor(){zJ(this,W1),ab(this,Wp,!0),ab(this,Bg,null),ab(this,jg,new ResizeObserver(e=>HM(W1,this,YJ).call(this,e)))}setObservedElement(e){CE(Bg,this,e)}unobserve(){pc(jg,this).unobserve(pc(Bg,this))}observe(){CE(Wp,this,!0),pc(jg,this).observe(pc(Bg,this))}destroy(){pc(jg,this).disconnect()}}function YJ(t){if(pc(Wp,this)||!Array.isArray(t)||!t.length){CE(Wp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}rt(nV,bn);function Zs(t,e,n){GJ(t,e),e.set(t,n)}function GJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gt(t,e){return t.get(rV(t,e))}function po(t,e,n){return t.set(rV(t,e),n),n}function rV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wu=new WeakMap,lb=new WeakMap,ub=new WeakMap,us=new WeakMap,Qs=new WeakMap,Js=new WeakMap,Ug=new WeakMap,Bu=new WeakMap;class Kl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;Zs(this,Wu,void 0),Zs(this,lb,void 0),Zs(this,ub,!1),Zs(this,us,null),Zs(this,Qs,void 0),Zs(this,Js,void 0),Zs(this,Ug,!0),Zs(this,Bu,new nV),po(Wu,this,e),po(lb,this,r),po(ub,this,n),po(Qs,this,this.createEditor()),po(Js,this,gt(Qs,this).style),gt(Bu,this).setObservedElement(this.getInputElement()),gt(Bu,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){gt(Js,this).left=`${e}px`,gt(Js,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Gt(this.getInputElement()),height:Jt(this.getInputElement())}}observeSize(){gt(Bu,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){gt(Js,this).display="block",po(Ug,this,!1)}hide(){gt(Bu,this).unobserve(),gt(Ug,this)||(gt(Js,this).display="none"),po(Ug,this,!0)}isVisible(){return gt(Js,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return gt(Wu,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=gt(Wu,this).createElement("div"),n=gt(Wu,this).createElement("textarea");return e.style.display="none",po(us,this,gt(Wu,this).createElement("div")),gt(us,this).setAttribute("dir",gt(ub,this)?"rtl":"ltr"),Y(gt(us,this),Kl.CLASS_EDITOR_CONTAINER),gt(lb,this).appendChild(gt(us,this)),Y(e,Kl.CLASS_EDITOR),Y(n,Kl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),gt(us,this).appendChild(e),e}getInputElement(){return gt(Qs,this).querySelector(`.${Kl.CLASS_INPUT}`)}getEditorElement(){return gt(Qs,this)}destroy(){const e=gt(us,this)?gt(us,this).parentNode:null;gt(Qs,this).parentNode.removeChild(gt(Qs,this)),po(Qs,this,null),po(Js,this,null),gt(Bu,this).destroy(),e&&e.removeChild(gt(us,this))}}rt(Kl,bn);function cb(t,e,n){return(e=qJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=KJ(t,"string");return typeof e=="symbol"?e:e+""}function KJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XJ=250,ZJ=250;class iV{constructor(e){cb(this,"wasLastActionShow",!0),cb(this,"showDebounced",null),cb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},ZJ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:XJ;this.showDebounced=Vf(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}rt(iV,bn);function QJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function JJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function ml(t,e){const n={};return P(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function pa(t,e,n,r,i){P(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&eee(s,a,e,n,r,i)})})}function eee(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=QJ(s.className,r):a=JJ(s.className,r)),o(t,e,"className",a)}function oV(t){return`<span class="selected">â</span>${t}`}function Zm(t,e){let n=!1;return Array.isArray(t)&&P(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function rv(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Le="---------";function tee(){return{name:Le}}const pi="alignment";function nee(){return{key:pi,name(){return this.getTranslatedPhrase(GT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${pi}:left`,name(){return this.getTranslatedPhrase(qT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pi}:center`,name(){return this.getTranslatedPhrase(KT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pi}:right`,name(){return this.getTranslatedPhrase(XT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pi}:justify`,name(){return this.getTranslatedPhrase(ZT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Le},{key:`${pi}:top`,name(){return this.getTranslatedPhrase(QT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pi}:middle`,name(){return this.getTranslatedPhrase(JT)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pi}:bottom`,name(){return this.getTranslatedPhrase(e_)},callback(){const t=this.getSelectedRange(),e=ml(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),pa(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const iv="clear_column";function ree(){return{key:iv,name(){return this.getTranslatedPhrase(HT)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Kf="col_left";function iee(){return{key:Kf,name(){return this.getTranslatedPhrase(MT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Xf="col_right";function oee(){return{key:Xf,name(){return this.getTranslatedPhrase(PT)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Zf="make_read_only";function see(){return{key:Zf,checkable:!0,ariaChecked(){return Zm(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(_p)},name(){let t=this.getTranslatedPhrase(_p);return Zm(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=oV(t)),t},callback(){const t=this.getSelectedRange(),e=Zm(t,(n,r)=>this.getCellMeta(n,r).readOnly);P(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const ov="redo";function aee(){return{key:ov,name(){return this.getTranslatedPhrase(AT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Qf="remove_col";function lee(){return{key:Qf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(OT,e)},callback(){this.alter("remove_col",g6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const sv="remove_row";function uee(){return{key:sv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(IT,e)},callback(){this.alter("remove_row",m6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const av="row_above";function cee(){return{key:av,name(){return this.getTranslatedPhrase(TT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const lv="row_below";function hee(){return{key:lv,name(){return this.getTranslatedPhrase(_T)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const ff="no_items";function dee(){return{key:ff,name(){return this.getTranslatedPhrase(ET)},disabled:!0,isCommand:!1}}const uv="undo";function fee(){return{key:uv,name(){return this.getTranslatedPhrase(xT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const gee=[av,lv,Kf,Xf,iv,sv,Qf,uv,ov,Zf,pi,Le,ff],mee={[Le]:tee,[ff]:dee,[av]:cee,[lv]:hee,[Kf]:iee,[Xf]:oee,[iv]:ree,[sv]:uee,[Qf]:lee,[uv]:fee,[ov]:aee,[Zf]:see,[pi]:nee};function sV(){const t={};return He(mee,(e,n)=>{t[n]=e()}),t}function pee(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(UT):this.getTranslatedPhrase(jT)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function wee(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(zT)},callback(){this.getSelectedRangeActive().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function vee(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(YT);return Zm(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Qm))?oV(e):e},callback(){this.getSelectedRangeActive().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Qm);t.updateCommentMeta(n,r,{[Qm]:!i})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Cee(t,e){aV(t,e),e.add(t)}function pl(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yee(t,e,n){return(e=See(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=bee(t,"string");return typeof e=="symbol"?e:e+""}function bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $o(t,e,n){return t.set(vn(t,e),n),n}function xe(t,e){return t.get(vn(t,e))}function vn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bp="comments",Ree=60,ys="comment",Td="value",lV="style",Qm="readOnly",Gh=Bp,yE=`plugin:${Bp}`;var pt=new WeakMap,Ao=new WeakMap,cv=new WeakMap,Jm=new WeakMap,jp=new WeakMap,SE=new WeakMap,Up=new WeakMap,Pn=new WeakSet;class Eee extends Be{constructor(){super(...arguments),Cee(this,Pn),yee(this,"range",{}),pl(this,pt,null),pl(this,Ao,null),pl(this,cv,!1),pl(this,Jm,!1),pl(this,jp,!1),pl(this,SE,null),pl(this,Up,"")}static get PLUGIN_KEY(){return Bp}static get PLUGIN_PRIORITY(){return Ree}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Bp]}enablePlugin(){var e=this;this.enabled||(xe(pt,this)||($o(pt,this,new Kl(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),xe(pt,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Pn,e,Aee).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),xe(Ao,this)||$o(Ao,this,new iV(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>vn(Pn,this,Iee).call(this,n,a)),this.addHook("afterScroll",()=>vn(Pn,this,Hee).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>vn(Pn,this,B1).call(this,n)),this.addHook("beforeCompositionStart",n=>vn(Pn,this,B1).call(this,n)),xe(Ao,this).addLocalHook("hide",()=>this.hide()),xe(Ao,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){xe(Ao,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(yE);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeActive();$o(Jm,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(yE),this.hot._registerTimeout(()=>{$o(Jm,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isCell()},group:Gh}),r.addShortcut({keys:[["Escape"]],callback:()=>{xe(pt,this).setValue(xe(Up,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>xe(pt,this).isVisible()&&xe(pt,this).isFocused(),group:Gh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>xe(pt,this).isVisible()&&xe(pt,this).isFocused(),group:Gh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{$o(jp,this,!0),xe(pt,this).setValue(xe(pt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Gh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>vn(Pn,this,Mee).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>vn(Pn,this,Tee).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>vn(Pn,this,Pee).call(this)),this.eventManager.addEventListener(n,"focus",()=>vn(Pn,this,xee).call(this)),this.eventManager.addEventListener(n,"blur",()=>vn(Pn,this,Oee).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>vn(Pn,this,_ee).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=$a(e.target,"TD","TBODY");return!!(n&&ve(n,"htCommentCell")&&$a(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=xe(pt,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const{row:i,col:o}=vn(Pn,this,wc).call(this);this.updateCommentMeta(i,o,{[Td]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:r}=vn(Pn,this,wc).call(this);this.hot.setCellMeta(n,r,ys),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const{row:e,col:n}=vn(Pn,this,wc).call(this);return this.getCommentMeta(e,n,Td)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Td)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:r}=vn(Pn,this,wc).call(this);if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(n,r);return xe(Ao,this).cancelHiding(),xe(pt,this).setValue((e=i[ys]?i[ys][Td]:null)!==null&&e!==void 0?e:""),xe(pt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){xe(pt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!xe(pt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=vn(Pn,this,wc).call(this);let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;xe(pt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,lV);w?xe(pt,this).setSize(w.width,w.height):xe(pt,this).resetSize();const y=c?0:f.getColumnWidth(a),T=l&&!u?Jt(m):0,{left:b,top:M,width:R,height:D}=m.getBoundingClientRect(),{width:I,height:O}=xe(pt,this).getSize(),{innerWidth:U,innerHeight:G}=this.hot.rootWindow,W=this.hot.rootDocument.documentElement,X=en(this.hot.rootDocument),z=W0(this.hot.rootWindow)?X:0,ae=B0(this.hot.rootWindow)?X:0;let ee=b+h.scrollX+y,ce=M+h.scrollY+T;this.hot.isRtl()&&(ee-=I+y),this.hot.isLtr()&&b+R+I>U-z?ee=b+h.scrollX-I-1:this.hot.isRtl()&&ee<-(W.scrollWidth-W.clientWidth)&&(ee=b+h.scrollX+y+1),M+O>G-ae&&(ce-=O-D+1),xe(pt,this).setPosition(ee,ce),xe(pt,this).setReadOnlyState(this.getCommentMeta(i,o,Qm)),xe(pt,this).observeSize()}focusEditor(){xe(pt,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[ys];let o;i?(o=Xn(i),Df(o,r)):o=r,this.hot.setCellMeta(e,n,ys,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[ys])return i[ys][r]}addToContextMenu(e){e.items.push({name:Le},pee(this),wee(this),vee(this))}getEditorInputElement(){return xe(pt,this).getInputElement()}destroy(){var e,n;(e=xe(pt,this))===null||e===void 0||e.destroy(),(n=xe(Ao,this))===null||n===void 0||n.destroy(),super.destroy()}}function Tee(t){if(!(!this.hot.view||!this.hot.view._wt)&&!xe(cv,this)&&!this.targetIsCommentTextArea(t)){const e=$a(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function _ee(t){t.stopPropagation()}function Mee(t){const{rootDocument:e}=this.hot;if(!(xe(cv,this)||xe(pt,this).isFocused()||ve(t.target,"wtBorder")||xe(SE,this)===t.target||!xe(pt,this)))if($o(SE,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));xe(Ao,this).show(n)}else Ha(t.target,e)&&!this.targetIsCommentTextArea(t)&&xe(Ao,this).hide()}function Pee(){$o(cv,this,!1)}function Iee(t,e){e[ys]&&e[ys][Td]&&Y(t,e.commentedCellClassName)}function Oee(){if(xe(jp,this)){$o(jp,this,!1);return}$o(Up,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function xee(){$o(Up,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(yE)}function Aee(t,e){const{row:n,col:r}=vn(Pn,this,wc).call(this);this.updateCommentMeta(n,r,{[lV]:{width:t,height:e}})}function B1(t){xe(pt,this).isFocused()&&Ai(t)}function Hee(){xe(Jm,this)||this.hide()}function wc(){return this.range instanceof uh?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function hb(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:e+""}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uV{constructor(e){hb(this,"hot",void 0),hb(this,"commands",{}),hb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=kee(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Vt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function kee(t,e){let n;return P(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function db(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;db(this,"hot",void 0),db(this,"predefinedItems",sV()),db(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,He(e,(r,i)=>{let o="";r.name===Le?(n[Le]=r,o=Le):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Fee(e,this.defaultOrderPattern,this.predefinedItems)}}function Fee(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ye(i)?He(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),ye(o)?tn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):P(i,(o,s)=>{let a=n[o];!a&&gee.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),ye(o)&&tn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ea(t,e,n){return(e=Vee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vee(t){var e=Wee(t,"string");return typeof e=="symbol"?e:e+""}function Wee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bee{constructor(e,n){ea(this,"top",void 0),ea(this,"topRelative",void 0),ea(this,"left",void 0),ea(this,"leftRelative",void 0),ea(this,"scrollTop",void 0),ea(this,"scrollLeft",void 0),ea(this,"cellHeight",void 0),ea(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function qh(t,e,n){jee(t,e),e.set(t,n)}function jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(hV(t,e))}function zg(t,e,n){return t.set(hV(t,e),n),n}function hV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var er=new WeakMap,pr=new WeakMap,wr=new WeakMap,fb=new WeakMap,ju=new WeakMap;class Uee{constructor(e){qh(this,er,void 0),qh(this,pr,void 0),qh(this,wr,void 0),qh(this,fb,!1),qh(this,ju,{above:0,below:0,left:0,right:0}),zg(fb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Me(ju,this)[e]=n,this}setElement(e){return zg(er,this,e),this}setParentElement(e){return zg(pr,this,e),this}updatePosition(e){zg(wr,this,new Bee(e,Me(er,this).ownerDocument.defaultView)),Me(fb,this)?(Me(wr,this).fitsBelow(Me(er,this))?this.setPositionBelowCursor():Me(wr,this).fitsAbove(Me(er,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Me(er,this).dir==="rtl"?Me(wr,this).fitsOnLeft(Me(er,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Me(wr,this).fitsOnRight(Me(er,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Me(ju,this).above+Me(wr,this).top-Me(er,this).offsetHeight;if(Me(pr,this)){const r=Me(pr,this).ownerDocument.defaultView.getComputedStyle(Me(pr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(wr,this).top+Me(wr,this).cellHeight-Me(er,this).scrollHeight+i+o}Me(er,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Me(ju,this).below+Me(wr,this).top+1;if(Me(pr,this)){const r=Me(pr,this).ownerDocument.defaultView.getComputedStyle(Me(pr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Me(wr,this).top-i-o}Me(er,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Me(wr,this).left;if(Me(pr,this)){const n=Me(pr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(pr,this).querySelector(".htCore")).borderRightWidth,10);e+=Me(wr,this).cellWidth+r}else e+=Me(ju,this).right;Me(er,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Me(ju,this).left+Me(wr,this).left-Me(er,this).offsetWidth;if(Me(pr,this)){const n=Me(pr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Me(pr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Me(er,this).style.left=`${e}px`}}function NM(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ke(e,-1,w()-1);function a(T,b){const M=w()-1;return T<0&&(T=M),T>M&&(T=0),o.has(T)?-1:(o.add(T),r(T,!1)===!1&&(T=a(b===1?++T:--T,b)),T)}function l(T){T>-1&&T<w()&&r(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<w()&&(s=T)}function c(){return s}function h(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function m(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:w,clear:y}}function zee(t){return Ge(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function bE(t){return Vt(t,"submenu")}function RE(t){return new RegExp(Le,"i").test(t.name)}function ep(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function j1(t){return Vt(t,"disableSelection")}function Yee(t){return ve(t,"htSeparator")}function Gee(t){return ve(t,"htSubmenu")}function qee(t){return ve(t,"htDisabled")}function Kee(t){return ve(t,"htSelectionDisabled")}function Xee(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function dV(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Zee(t,e){let n=t.slice(0);return n.reverse(),n=dV(n,e),n.reverse(),n}function Qee(t){const e=[];return P(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Jee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Le,n=t.slice(0);return n=dV(n,e),n=Zee(n,e),n=Qee(n),n}function ete(t){return t.checkable===!0}function tte(t){return NM({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Yee(r)||qee(r)||Kee(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function nte(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedActive();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedActive();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const fV="menu",U1=fV;function rte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(nte(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:fV})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${U1}:${u}`:U1}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function ite(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(zo(n),Y(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!ep(a,t)&&!j1(a)&&!RE(a);de(n,[...ete(a)?[r2(),ti(c),SL(h)]:[n2(),ti(u)],...d?[Ir(-1)]:[],...ep(a,t)?[Cd()]:[],...bE(a)?[Ei(!1)]:[]])}n.className="",n.appendChild(l),RE(a)?Y(n,"htSeparator"):typeof a.renderer=="function"?(Y(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ya(l,u),ep(a,t)?Y(n,"htDisabled"):j1(a)?Y(n,"htSelectionDisabled"):bE(a)&&Y(n,"htSubmenu")}}function gb(t,e,n){ote(t,e),e.set(t,n)}function ote(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wo(t,e,n){return(e=ste(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ste(t){var e=ate(t,"string");return typeof e=="symbol"?e:e+""}function ate(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mb(t,e,n){return t.set(gV(t,e),n),n}function ta(t,e){return t.get(gV(t,e))}function gV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const z1=215;var Uu=new WeakMap,Yg=new WeakMap,Gg=new WeakMap;class gh{get tableBorderWidth(){return ta(Gg,this)===void 0&&this.hotMenu&&mb(Gg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ta(Gg,this)}constructor(e,n){var r=this;wo(this,"hot",void 0),wo(this,"options",void 0),wo(this,"eventManager",new _i(this)),wo(this,"container",void 0),wo(this,"positioner",void 0),wo(this,"hotMenu",null),wo(this,"hotSubMenus",{}),wo(this,"parentMenu",void 0),wo(this,"menuItems",null),wo(this,"origOutsideClickDeselects",null),gb(this,Uu,void 0),gb(this,Yg,void 0),gb(this,Gg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:z1,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Uee(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(le(this.options.container,/ht-theme-.*/g),Y(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=iu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ta(Uu,this)}getKeyboardShortcutsCtrl(){return ta(Yg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Vf(a=>this.openSubMenu(a),300),n=this.options.minWidth||z1;let r=!1,i=La(this.menuItems,a=>(a.key===ff&&(r=!0),Xee(a,this.hot)));if(i.length<1&&!r)i.push(sV()[ff]);else if(i.length===0)return;i=Jee(i,Le);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return oe(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:ite(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ta(Uu,this).setCurrentPage(l.row):ta(Uu,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Cp()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Cp()||!Va(a))&&o&&this.hasSelectedItem()&&(eo()||D0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),mb(Uu,this,tte(this.hotMenu)),mb(Yg,this,rte(this)),ta(Yg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ta(Uu,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);de(r,[Ei(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Gee(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new gh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&de(n,[Ei(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&de(i,[Ei(!1)])}}closeAllSubMenus(){P(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?zee(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||RE(e)||ep(e,this.hot)||bE(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=gn(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?Jt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Le?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Ze(r)&&(r=r.call(this.hot),r===null||_t(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Y(i,`htMenu handsontable ${this.options.className}`),r&&Y(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&de(this.hotMenu.rootElement,[t2(),Ir(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ha(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ha(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&Ha(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}rt(gh,bn);function lte(t,e){ute(t,e),e.add(t)}function ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pb(t,e,n){return(e=cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cte(t){var e=hte(t,"string");return typeof e=="symbol"?e:e+""}function hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _d="contextMenu",dte=70,Y1=_d;re.getSingleton().register("afterContextMenuDefaultOptions");re.getSingleton().register("beforeContextMenuShow");re.getSingleton().register("afterContextMenuShow");re.getSingleton().register("afterContextMenuHide");re.getSingleton().register("afterContextMenuExecute");var Kh=new WeakSet;class hv extends Be{constructor(){super(...arguments),lte(this,Kh),pb(this,"commandExecutor",new uV(this.hot)),pb(this,"itemsFactory",null),pb(this,"menu",null)}static get PLUGIN_KEY(){return _d}static get PLUGIN_PRIORITY(){return dte}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[av,lv,Le,Kf,Xf,Le,sv,Qf,Le,uv,ov,Le,Zf,Le,pi]}isEnabled(){return!!this.hot.getSettings()[_d]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[_d];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new gh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>qg(Kh,this,gte).call(this)),this.menu.addLocalHook("afterOpen",()=>qg(Kh,this,mte).call(this)),this.menu.addLocalHook("afterClose",()=>qg(Kh,this,pte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>qg(Kh,this,fte).call(this,r)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=rv(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:Y1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Y1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),He(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new cV(this.hot,hv.DEFAULT_ITEMS);const e=this.hot.getSettings()[_d],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function fte(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=rv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function gte(){this.hot.runHooks("beforeContextMenuShow",this)}function mte(){this.hot.runHooks("afterContextMenuShow",this)}function pte(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}hv.SEPARATOR={name:Le};function wte(t){return{key:"copy",name(){return this.getTranslatedPhrase(NT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function vte(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Cte(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function yte(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Ste(t){return{key:"cut",name(){return this.getTranslatedPhrase($T)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class bte{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Rte{constructor(){this.clipboardData=new bte}preventDefault(){}composedPath(){return[]}}function Ete(t,e){mV(t,e),e.add(t)}function zu(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e){return t.get(Tc(t,e))}function Yu(t,e,n){return t.set(Tc(t,e),n),n}function Tc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var na=new WeakMap,wb=new WeakMap,Xh=new WeakMap,EE=new WeakMap,TE=new WeakMap,Zh=new WeakMap,Qh=new WeakSet;class Tte{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Ete(this,Qh),zu(this,na,void 0),zu(this,wb,void 0),zu(this,Xh,void 0),zu(this,EE,void 0),zu(this,TE,void 0),zu(this,Zh,void 0),Yu(wb,this,n),Yu(Xh,this,r),Yu(EE,this,i),Yu(TE,this,o),Yu(Zh,this,s)}setSelectedRange(e){Yu(na,this,e)}getCellsRange(){if(rr(wb,this).call(this)===0||rr(Xh,this).call(this)===0)return null;const{row:e,col:n}=rr(na,this).getTopStartCorner(),{row:r,col:i}=rr(na,this).getBottomEndCorner(),o=Tc(Qh,this,_te).call(this,e,r),s=Tc(Qh,this,vb).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(rr(Xh,this).call(this)===0||rr(Zh,this).call(this)===0)return null;const{col:e}=rr(na,this).getTopStartCorner(),{col:n}=rr(na,this).getBottomEndCorner(),r=Tc(Qh,this,vb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(rr(Xh,this).call(this)===0||rr(Zh,this).call(this)===0)return null;const{col:e}=rr(na,this).getTopStartCorner(),{col:n}=rr(na,this).getBottomEndCorner(),r=Tc(Qh,this,vb).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-rr(Zh,this).call(this),startCol:e,endRow:-1,endCol:r}}}function vb(t,e){return Math.min(e,Math.max(t+rr(TE,this).call(this)-1,t))}function _te(t,e){return Math.min(e,Math.max(t+rr(EE,this).call(this)-1,t))}function pV(t){const e=[],n=[];return P(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Mte(t,e){wV(t,e),e.add(t)}function ra(t,e,n){wV(t,e),e.set(t,n)}function wV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jh(t,e,n){return(e=Pte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pte(t){var e=Ite(t,"string");return typeof e=="symbol"?e:e+""}function Ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e){return t.get(Un(t,e))}function ji(t,e,n){return t.set(Un(t,e),n),n}function Un(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterCopyLimit");re.getSingleton().register("modifyCopyableRange");re.getSingleton().register("beforeCut");re.getSingleton().register("afterCut");re.getSingleton().register("beforePaste");re.getSingleton().register("afterPaste");re.getSingleton().register("beforeCopy");re.getSingleton().register("afterCopy");const Cb="copyPaste",Ote=80,xte=["fragmentSelection"],vV="application/ht-source-data-json-html",G1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _E=new WeakMap,ME=new WeakMap,PE=new WeakMap,Gu=new WeakMap,Kg=new WeakMap,Xg=new WeakMap,qu=new WeakMap,zp=new WeakMap,ir=new WeakSet;class Ate extends Be{constructor(){super(...arguments),Mte(this,ir),Jh(this,"columnsLimit",1/0),Jh(this,"rowsLimit",1/0),Jh(this,"pasteMode","overwrite"),Jh(this,"uiContainer",this.hot.rootDocument.body),ra(this,_E,!1),ra(this,ME,!1),ra(this,PE,!1),ra(this,Gu,"cells-only"),ra(this,Kg,!1),ra(this,Xg,!1),ra(this,qu,new Tte({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),ra(this,zp,!1),Jh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Cb}static get SETTING_KEYS(){return[Cb,...xte]}static get PLUGIN_PRIORITY(){return Ote}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Cb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),ji(_E,this,this.getSetting("copyColumnHeaders")),ji(ME,this,this.getSetting("copyColumnGroupHeaders")),ji(PE,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Un(ir,this,Dte).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Un(ir,r,kte).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Un(ir,this,Lte).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Lf()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Un(ir,r,$te).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Un(ir,r,Fte).call(r,...o)}),this.addHook("afterSelection",()=>Un(ir,this,Vte).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ji(Gu,this,e),ji(Kg,this,!0),Un(ir,this,q1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ji(Xg,this,!0),Un(ir,this,q1).call(this,"cut")}getRangedCopyableData(e){return Ip(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=[],{rows:i,columns:o}=pV(e);return P(i,s=>{const a=[];P(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=n?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);n&&ye(u)&&(u=JSON.stringify(u)),a.push(u)}}),r.push(a)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new Rte;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Tr(qu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Tr(Gu,this)==="column-headers-only"?n.set("headers",Tr(qu,this).getMostBottomColumnHeadersRange()):(Tr(Gu,this)==="with-column-headers"?n.set("headers",Tr(qu,this).getMostBottomColumnHeadersRange()):Tr(Gu,this)==="with-column-group-headers"&&n.set("headers",Tr(qu,this).getAllColumnHeadersRange()),n.set("cells",Tr(qu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner();let h=a,d=l,f=a,m=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:y,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,y===!0)continue;f=T,d=l;const b=[],M=s.length%i;for(;b.length<o||d<=c;){var w;const{skipColumnOnPaste:R,visualCol:D}=this.hot.getCellMeta(T,d),I=this.hot.getSourceDataAtCell(T,d),O=b.length%o;if(d=D+1,R===!0)continue;m=D;const U=n==null||(w=n[M])===null||w===void 0?void 0:w[O];let G=e[M][O];if(n&&gL(U)){const W=JSON.parse(U);(ye(I)||I===null)&&(G=W)}b.push(G)}s.push(b)}return ji(zp,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,m]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Tr(Kg,this)||this.isEditorOpened()||Bo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Hd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(Kg,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Un(ir,this,Hte).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Un(ir,this,K1).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),ji(Gu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Tr(Xg,this)||this.isEditorOpened()||Bo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Hd(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),ji(Xg,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Un(ir,this,K1).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Bo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Hd(n,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(vV);h&&(s=nE(h,this.hot.rootDocument).data);const d=Hw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=nE(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=y6(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function q1(t){if(Lf()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&jL(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Hte(t){const{rows:e}=pV(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Nte(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&U0(r)}}}function CV(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&z0(r)}}}function K1(t,e,n){const r=Ip(e);if(t&&t.clipboardData){const i=tE(e),o=tE(n);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[G1,i].join("")),t.clipboardData.setData(vV,[G1,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r)}function Dte(t){t.items.push({name:"---------"},wte(this)),Tr(_E,this)&&t.items.push(yte(this)),Tr(ME,this)&&t.items.push(Cte(this)),Tr(PE,this)&&t.items.push(vte(this)),t.items.push(Ste(this))}function kte(t,e,n,r,i){Tr(zp,this)&&(i.value=!0),ji(zp,this,!1)}function Lte(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function $te(){Un(ir,this,CV).call(this)}function Fte(){Un(ir,this,Nte).call(this)}function Vte(){Un(ir,this,CV).call(this)}function yV(t,e){return`border_row${t}col${e}`}function Md(){return{width:1,color:"#000"}}function Ps(){return{hide:!0}}function Wte(){return{width:1,color:"#000",cornerVisible:!1}}function yb(t){if(oe(t.start)||oe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(oe(t.end)||oe(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function ed(t){return oe(t.start)&&(t.left=t.start),oe(t.end)&&(t.right=t.end),t}function Sb(t,e){return{id:yV(t,e),border:Wte(),row:t,col:e,top:Ps(),bottom:Ps(),start:Ps(),end:Ps()}}function Bte(t,e){return Vt(e,"border")&&e.border&&(t.border=e.border),Vt(e,"top")&&oe(e.top)&&(e.top?(ye(e.top)||(e.top=Md()),t.top=e.top):(e.top=Ps(),t.top=e.top)),Vt(e,"bottom")&&oe(e.bottom)&&(e.bottom?(ye(e.bottom)||(e.bottom=Md()),t.bottom=e.bottom):(e.bottom=Ps(),t.bottom=e.bottom)),Vt(e,"start")&&oe(e.start)&&(e.start?(ye(e.start)||(e.start=Md()),t.start=e.start):(e.start=Ps(),t.start=e.start)),Vt(e,"end")&&oe(e.end)&&(e.end?(ye(e.end)||(e.end=Md()),t.end=e.end):(e.end=Ps(),t.end=e.end)),t}function ks(t,e){let n=!1;return P(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Vt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function dv(t){return`<span class="selected">â</span>${t}`}function jte(t){return t.some(e=>oe(e.left)||oe(e.right))}function Ute(t){return t.some(e=>oe(e.start)||oe(e.end))}const zte=new Map([["left","start"],["right","end"]]);function Yte(t){var e;return(e=zte.get(t))!==null&&e!==void 0?e:t}function Gte(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(i_);return ks(this,"bottom")&&(e=dv(e)),e},callback(e,n){const r=ks(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function qte(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(o_);return ks(this,e)&&(n=dv(n)),n},callback(n,r){const i=ks(this,e);t.prepareBorder(r,e,i)}}}function Kte(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(s_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ks(this)}}}function Xte(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(r_);return ks(this,e)&&(n=dv(n)),n},callback(n,r){const i=ks(this,e);t.prepareBorder(r,e,i)}}}function Zte(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(n_);return ks(this,"top")&&(e=dv(e)),e},callback(e,n){const r=ks(this,"top");t.prepareBorder(n,"top",r)}}}function Qte(t,e){Jte(t,e),e.add(t)}function Jte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ene(t,e,n){return(e=tne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tne(t){var e=nne(t,"string");return typeof e=="symbol"?e:e+""}function nne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tp="customBorders",rne=90;var bb=new WeakSet;class ine extends Be{constructor(){super(...arguments),Qte(this,bb),ene(this,"savedBorders",[])}static get PLUGIN_KEY(){return tp}static get PLUGIN_PRIORITY(){return rne}isEnabled(){return!!this.hot.getSettings()[tp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>X1(bb,this,one).call(this,e)),this.addHook("init",()=>X1(bb,this,sne).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=yb(n));const o=Yc(e),s=cf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});P(e,a=>{s(a).forAll((l,u)=>{P(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,Yte(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Yc(e),r=cf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return P(e,o=>{r(o).forAll((s,a)=>{P(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(ed(l))})})}),i}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Sb(e,n);r&&(a=Bte(a,r),P(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",ed(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Sb(o,s);let l=0;o===e.from.row&&Vt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Vt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Vt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Vt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",ed(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=yV(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Sb(e,n):o=yb(o),i?(o[r]=Ps(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ed(o)))):(o[r]=Md(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ed(o)))}prepareBorder(e,n,r){P(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){P(e,n=>{const r=yb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return gn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ge(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ge(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):P(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return P(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);P(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[tp];if(Array.isArray(e)){const n=Xn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=jte(e),r=Ute(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function one(t){this.hot.getSettings()[tp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(t_)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Zte(this),Xte(this),Gte(this),qte(this),Kte(this)]}})}function sne(){this.changeBorderSettings()}function ane(t,e){lne(t,e),e.add(t)}function lne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rb(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Q1="dragToScroll",hne=100;var Eb=new WeakSet;class dne extends Be{constructor(){super(...arguments),ane(this,Eb),Rb(this,"boundaries",null),Rb(this,"callback",null),Rb(this,"listening",!1)}static get PLUGIN_KEY(){return Q1}static get PLUGIN_PRIORITY(){return hne}isEnabled(){return!!this.hot.getSettings()[Q1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Z1(Eb,this,J1).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Z1(Eb,this,J1).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=iu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function J1(t){if(Va(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function fne(t,e){SV(t,e),e.add(t)}function gne(t,e,n){SV(t,e),e.set(t,n)}function SV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tb(t,e,n){return(e=mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:e+""}function pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wne(t,e){return t.get(wi(t,e))}function bV(t,e,n){return t.set(wi(t,e),n),n}function wi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("afterDropdownMenuDefaultOptions");re.getSingleton().register("beforeDropdownMenuShow");re.getSingleton().register("afterDropdownMenuShow");re.getSingleton().register("afterDropdownMenuHide");re.getSingleton().register("afterDropdownMenuExecute");const np="dropdownMenu",vne=230,gf="changeType",_b=np;var fv=new WeakMap,Yi=new WeakSet;class gv extends Be{static get PLUGIN_KEY(){return np}static get PLUGIN_PRIORITY(){return vne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Kf,Xf,Le,Qf,Le,iv,Le,Zf,Le,pi]}constructor(e){super(e),fne(this,Yi),Tb(this,"commandExecutor",new uV(this.hot)),Tb(this,"itemsFactory",null),Tb(this,"menu",null),gne(this,fv,!1),this.hot.addHook("afterGetColHeader",(n,r)=>wi(Yi,this,yne).call(this,n,r))}isEnabled(){return this.hot.getSettings()[np]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new cV(this.hot,gv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return wi(Yi,e,_ne).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return wi(Yi,e,Tne).call(e,...o)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[np],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new gh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>wi(Yi,this,Sne).call(this)),this.menu.addLocalHook("afterOpen",()=>wi(Yi,this,bne).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>wi(Yi,this,Rne).call(this,o)),this.menu.addLocalHook("afterClose",()=>wi(Yi,this,Ene).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),P(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeActive();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeActive(),o=rv(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${gf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:_b},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:_b}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_b)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>wi(Yi,this,Cne).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),He(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function RV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Cne(t){if(ve(t.target,gf)){const e=rv(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),bV(fv,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function yne(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${gf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=gf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(de(s,[vu(),ti(" ")]),de(e,[vL("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Sne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function bne(){this.hot.runHooks("afterDropdownMenuShow",this),wi(Yi,this,RV).call(this,this.menu)}function Rne(t){wi(Yi,this,RV).call(this,t)}function Ene(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Tne(t){return wne(fv,this)?null:t}function _ne(t){ve(t.target,gf)&&bV(fv,this,!0)}gv.SEPARATOR={name:Le};function eN(t,e,n){return(e=Mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mne(t){var e=Pne(t,"string");return typeof e=="symbol"?e:e+""}function Pne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ine{constructor(e){eN(this,"hot",void 0),eN(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function tN(t,e,n){return(e=One(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function One(t){var e=xne(t,"string");return typeof e=="symbol"?e:e+""}function xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){tN(this,"dataProvider",void 0),tN(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=io(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=tn(io(DM.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=Aw(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Ane(t,e){Hne(t,e),e.add(t)}function Hne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const EV="\r",Nne='"',Dne=`
`,kne="=",Lne="+",$ne="-",Fne="@",Vne="	";var Mb=new WeakSet;class Wne extends DM{constructor(){super(...arguments),Ane(this,Mb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Ge(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),P(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=Ct(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=nN(Mb,this,jne).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=nN(Mb,this,Bne).call(this,i)),(n||i.indexOf(EV)>=0||i.indexOf(Nne)>=0||i.indexOf(Dne)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Bne(t){return t.startsWith(kne)||t.startsWith(Lne)||t.startsWith($ne)||t.startsWith(Fne)||t.startsWith(Vne)||t.startsWith(EV)?`'${t}`:t}function jne(t,e){return e.test(t)?`'${t}`:t}const Une="csv",IE={[Une]:Wne};function zne(t,e,n){return typeof IE[t]=="function"?new IE[t](e,n):null}const Yne="exportFile",Gne=240;class qne extends Be{static get PLUGIN_KEY(){return Yne}static get PLUGIN_PRIORITY(){return Gne}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!IE[e])throw new Error(`Export format type "${e}" is not supported.`);return zne(e,new Ine(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ku(t,e,n){return(e=Kne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kne(t){var e=Xne(t,"string");return typeof e=="symbol"?e:e+""}function Xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jf{constructor(e,n){let{id:r,stateless:i=!0}=n;Ku(this,"hot",void 0),Ku(this,"id",void 0),Ku(this,"elements",[]),Ku(this,"hidden",!1),Ku(this,"stateId",""),Ku(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Gw)}getElements(){return this.elements}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}rt(Jf,bn);const mf={};function Wa(t,e){if(!mf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=mf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Xl(t){if(!mf[t])throw Error(`Filter condition "${t}" does not exist.`);return mf[t].descriptor}function on(t,e,n){n.key=t,mf[t]={condition:e,descriptor:n}}const On="none";function Zne(){return!0}on(On,Zne,{name:qw,inputsCount:0,showOperators:!1});const Vd="empty";function Qne(t){return Wt(t.value)}on(Vd,Qne,{name:f_,inputsCount:0,showOperators:!0});const rp="not_empty";function Jne(t,e){return!Wa(Vd,e)(t)}on(rp,Jne,{name:g_,inputsCount:0,showOperators:!0});const Wd="eq";function ere(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale)===Ct(n)}on(Wd,ere,{name:m_,inputsCount:1,showOperators:!0});const ip="neq";function tre(t,e){return!Wa(Wd,e)(t)}on(ip,tre,{name:p_,inputsCount:1,showOperators:!0});const TV="gt";function nre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}on(TV,nre,{name:S_,inputsCount:1,showOperators:!0});const _V="gte";function rre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}on(_V,rre,{name:b_,inputsCount:1,showOperators:!0});const MV="lt";function ire(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}on(MV,ire,{name:R_,inputsCount:1,showOperators:!0});const PV="lte";function ore(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}on(PV,ore,{name:E_,inputsCount:1,showOperators:!0});const kM="date_after";function sre(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}on(kM,sre,{name:M_,inputsCount:1,showOperators:!0});const LM="date_before";function are(t,e){let[n]=e;const r=K(t.value,t.meta.dateFormat),i=K(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}on(LM,are,{name:P_,inputsCount:1,showOperators:!0});const Yp="between";function lre(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Wa(LM,[o]),a=Wa(kM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}on(Yp,lre,{name:T_,inputsCount:2,showOperators:!0});const IV="not_between";function ure(t,e){return!Wa(Yp,e)(t)}on(IV,ure,{name:__,inputsCount:2,showOperators:!0});const OV="begins_with";function cre(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ct(n))}on(OV,cre,{name:w_,inputsCount:1,showOperators:!0});const xV="ends_with";function hre(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ct(n))}on(xV,hre,{name:v_,inputsCount:1,showOperators:!0});const $M="contains";function dre(t,e){let[n]=e;return Ct(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ct(n))>=0}on($M,dre,{name:C_,inputsCount:1,showOperators:!0});const AV="not_contains";function fre(t,e){return!Wa($M,e)(t)}on(AV,fre,{name:y_,inputsCount:1,showOperators:!0});const HV="date_tomorrow";function gre(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(-1,"days").startOf("day"),"d"):!1}on(HV,gre,{name:O_,inputsCount:0});const NV="date_today";function mre(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().startOf("day"),"d"):!1}on(NV,mre,{name:I_,inputsCount:0});const DV="date_yesterday";function pre(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(1,"days").startOf("day"),"d"):!1}on(DV,pre,{name:x_,inputsCount:0});EL();function wre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function eg(t){const e=new Set(t);return function(n){return e.has(n)}}function FM(t){return t??""}function OE(t){return Array.from(new Set(t)).map(e=>FM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function rN(t,e,n,r){const i=[],o=t===e;let s;return o||(s=eg(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:wre(a,n)};r&&r(u),i.push(u)}),i}const Zl="by_value";function vre(t,e){let[n]=e;return n(t.value)}on(Zl,vre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[eg(e)]},showOperators:!1});const pf={};function Cre(t){if(!pf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=pf[t].func;return function(n,r){return e(n,r)}}function yre(t){return pf[t].name}function VM(t,e,n){pf[t]={name:e,func:n}}const Da="conjunction",Sre=N_;function bre(t,e){return t.every(n=>n.func(e))}VM(Da,Sre,bre);const Gp="disjunction",Rre=Kw;function Ere(t,e){return t.some(n=>n.func(e))}VM(Gp,Rre,Ere);const WM="disjunctionWithExtraCondition",Tre=Kw;function _re(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}VM(WM,Tre,_re);const Mre="numeric",kV="text",Pre="date",iN={[Mre]:[On,Le,Vd,rp,Le,Wd,ip,Le,TV,_V,MV,PV,Yp,IV],[kV]:[On,Le,Vd,rp,Le,Wd,ip,Le,OV,xV,Le,$M,AV],[Pre]:[On,Le,Vd,rp,Le,Wd,ip,Le,LM,kM,Yp,Le,HV,NV,DV]};function Ire(t){const e=[];let n=t;return iN[n]||(n=kV),P(iN[n],r=>{let i;r===Le?i={name:Le}:i=io(Xl(r)),e.push(i)}),e}function td(t,e,n){return(e=Ore(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ore(t){var e=xre(t,"string");return typeof e=="symbol"?e:e+""}function xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Pb="built",Ib="building",oN=["click","input","keydown","keypress","keyup","focus","blur","change"];let to=class LV{static get DEFAULTS(){return io({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){td(this,"hot",void 0),td(this,"eventManager",new _i(this)),td(this,"options",void 0),td(this,"_element",void 0),td(this,"buildState",void 0),this.hot=e,this.options=tn(LV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Ib?this._element:this.buildState===Pb?(this.update(),this._element):(this.buildState=Ib,this.build(),this.buildState=Pb,this._element)}isBuilt(){return this.buildState===Pb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(hr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Ib),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Y(this._element,this.options.className),this.options.children.length)P(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),He(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),P(oN,r=>e(n,r))}else P(oN,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};rt(to,bn);function Are(t,e){$V(t,e),e.add(t)}function Hre(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zg(t,e){return t.get(BM(t,e))}function Nre(t,e,n){return t.set(BM(t,e),n),n}function BM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xu=new WeakMap,sN=new WeakSet;class ka extends to{static get DEFAULTS(){return io({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(ka.DEFAULTS,n)),Are(this,sN),Hre(this,Xu,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>BM(sN,this,Dre).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Nre(Xu,this,this._element.firstChild),Y(this._element,"htUIInput"),Y(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Zg(Xu,this).type=this.options.type,Zg(Xu,this).placeholder=this.translateIfPossible(this.options.placeholder),Zg(Xu,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Zg(Xu,this).focus()}}function Dre(t){this.options.value=t.target.value}function kre(t,e){FV(t,e),e.add(t)}function nd(t,e,n){FV(t,e),e.set(t,n)}function FV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zu(t,e,n){return t.set(Bd(t,e),n),n}function Nt(t,e){return t.get(Bd(t,e))}function Bd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mn=new WeakMap,Qg=new WeakMap,Jg=new WeakMap,Ob=new WeakMap,em=new WeakMap,tm=new WeakSet;class wf extends to{static get DEFAULTS(){return io({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(wf.DEFAULTS,n)),kre(this,tm),nd(this,mn,null),nd(this,Qg,[]),nd(this,Jg,void 0),nd(this,Ob,void 0),nd(this,em,void 0),this.registerHooks()}getMenu(){return Nt(mn,this)}registerHooks(){this.addLocalHook("click",()=>Bd(tm,this,Fre).call(this))}setItems(e){Zu(Qg,this,this.translateNames(e)),Nt(mn,this)&&Nt(mn,this).setMenuItems(Nt(Qg,this))}translateNames(e){return P(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Zu(mn,this,new gh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Nt(mn,this).setMenuItems(Nt(Qg,this));const e=new to(this.hot,{className:"htUISelectCaption"}),n=new to(this.hot,{className:"htUISelectDropdown"});Zu(Jg,this,e),Zu(Ob,this,e.element),Zu(em,this,n),this.hot.getSettings().ariaTags&&(de(n.element,[vu()]),de(this._element,[wL()])),P([e,n],r=>this._element.appendChild(r.element)),Nt(mn,this).addLocalHook("select",r=>Bd(tm,this,Lre).call(this,r)),Nt(mn,this).addLocalHook("afterClose",()=>Bd(tm,this,$re).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Nt(mn,this).hot.getTranslatedPhrase(qw),Nt(Ob,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Nt(mn,this)&&(Nt(mn,this).open(),Nt(mn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Nt(mn,this).getNavigator().toFirstItem(),Nt(mn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Nt(mn,this)&&Nt(mn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Nt(mn,this)&&(Nt(mn,this).destroy(),Zu(mn,this,null)),Nt(Jg,this)&&Nt(Jg,this).destroy(),Nt(em,this)&&Nt(em,this).destroy(),super.destroy()}}function Lre(t){t.name!==Le&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function $re(){this.runLocalHooks("afterClose")}function Fre(){this.openOptions()}function Vre(t,e){Wre(t,e),e.add(t)}function Wre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aN(t,e,n){return(e=Bre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=jre(t,"string");return typeof e=="symbol"?e:e+""}function jre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xb=new WeakSet;class xE extends Jf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Vre(this,xb),aN(this,"name",""),aN(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new wf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ka(this.hot,{placeholder:V_})),this.elements.push(new ka(this.hot,{placeholder:W_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>lN(xb,this,Ure).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),P(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>lN(xb,this,zre).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=io(e.command);n.name.startsWith(Bt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),P(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Xl(On),n=[];return P(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Xl(e?e.name:On);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof wf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ka)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Y(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Xl(On)];if(e!==null){const{visualIndex:r}=e;n=Ire(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Ure(t){P(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function zre(t){lh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function uN(t,e,n){Yre(t,e),e.set(t,n)}function Yre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rd(t,e){return t.get(VV(t,e))}function cN(t,e,n){return t.set(VV(t,e),n),n}function VV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qu=new WeakMap,Ab=new WeakMap;class qp extends to{static get DEFAULTS(){return io({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(qp.DEFAULTS,n)),uN(this,Qu,void 0),uN(this,Ab,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),cN(Ab,this,e),cN(Qu,this,this._element.firstChild),rd(Qu,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(rd(Ab,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?rd(Qu,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(rd(Qu,this).checked=e)}focus(){this.isBuilt()&&rd(Qu,this).focus()}}function Gre(t,e){qre(t,e),e.add(t)}function qre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kre(t,e,n){return(e=Xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:e+""}function Zre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hN=0;var dN=new WeakSet;class Jre extends Jf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Gre(this,dN),Kre(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuOperators"),P(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Da,Gp];P(e,n=>{const r=new qp(this.hot,{name:"operator",label:{htmlFor:n,textContent:yre(n)},value:n,checked:n===e[hN],id:n});r.addLocalHook("change",i=>Qre(dN,this,eie).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Qe`Radio button with index ${e} doesn't exist.`);P(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof qp&&n.isChecked());return e?e.getValue():Da}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Da,n=arguments.length>1?arguments[1]:void 0,r=e;r===WM&&(r=Gp),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(hN)}}function eie(t){this.setState(t.target.value)}function tie(t,e,n){nie(t,e),e.set(t,n)}function nie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hb(t,e){return t.get(WV(t,e))}function rie(t,e,n){return t.set(WV(t,e),n),n}function WV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var id=new WeakMap;class vf extends to{static get DEFAULTS(){return io({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(vf.DEFAULTS,n)),tie(this,id,void 0)}build(){super.build(),rie(id,this,this._element.firstChild)}update(){this.isBuilt()&&(Hb(id,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Hb(id,this).focus()}activate(){Hb(id,this).click()}}function iie(t,e){BV(t,e),e.add(t)}function Ju(t,e,n){BV(t,e),e.set(t,n)}function BV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(_c(t,e))}function Fi(t,e,n){return t.set(_c(t,e),n),n}function _c(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fN="multipleSelect.itemBox";var Gi=new WeakMap,Zt=new WeakMap,Nb=new WeakMap,cs=new WeakMap,ia=new WeakMap,oa=new WeakMap,od=new WeakSet;class Cf extends to{static get DEFAULTS(){return io({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(Cf.DEFAULTS,n)),iie(this,od),Ju(this,Gi,[]),Ju(this,Zt,void 0),Ju(this,Nb,void 0),Ju(this,cs,void 0),Ju(this,ia,void 0),Ju(this,oa,void 0),Fi(cs,this,new ka(this.hot,{placeholder:F_,className:"htUIMultipleSelectSearch"})),Fi(ia,this,new vf(this.hot,{textContent:D_,className:"htUISelectAll"})),Fi(oa,this,new vf(this.hot,{textContent:k_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Pe(Zt,this)}registerHooks(){Pe(cs,this).addLocalHook("keydown",e=>_c(od,this,sie).call(this,e)),Pe(cs,this).addLocalHook("input",e=>_c(od,this,oie).call(this,e)),Pe(ia,this).addLocalHook("click",e=>_c(od,this,aie).call(this,e)),Pe(oa,this).addLocalHook("click",e=>_c(od,this,lie).call(this,e))}setItems(e){var n;Fi(Gi,this,e),(n=Pe(Zt,this))===null||n===void 0||n.loadData(Pe(Gi,this))}setLocale(e){Fi(Nb,this,e)}getLocale(){return Pe(Nb,this)}getItems(){return[...Pe(Gi,this)]}getValue(){return cie(Pe(Gi,this))}getSearchInputElement(){return Pe(cs,this)}getSelectAllElement(){return Pe(ia,this)}getClearAllElement(){return Pe(oa,this)}isSelectedAllValues(){return Pe(Gi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[Pe(ia,this),Pe(oa,this)]});this._element.appendChild(Pe(cs,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Pe(Zt,this))===null||s===void 0||s.destroy(),Y(o,"htUIMultipleSelectHot"),Fi(Zt,this,new this.hot.constructor(o,{data:Pe(Gi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Pe(Zt,this).listen()},modifyColWidth:u=>{const c=Pe(Zt,this).container.scrollWidth-en(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Pe(Zt,this).init();const l=Pe(Zt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:fN}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Pe(Zt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:fN})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Pe(Zt,this).listen()}reset(){Pe(cs,this).reset(),Pe(ia,this).reset(),Pe(oa,this).reset()}update(){this.isBuilt()&&(Pe(Zt,this).loadData(uie(Pe(Gi,this),this.options.value)),super.update())}destroy(){var e;(e=Pe(Zt,this))===null||e===void 0||e.destroy(),Pe(cs,this).destroy(),Pe(oa,this).destroy(),Pe(ia,this).destroy(),Fi(cs,this,null),Fi(oa,this,null),Fi(ia,this,null),Fi(Zt,this,null),Fi(Gi,this,null),super.destroy()}}function oie(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Pe(Gi,this)]:n=Pe(Gi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Pe(Zt,this).loadData(n)}function sie(t){this.runLocalHooks("keydown",t,this),Y0(lh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ai(t),Pe(Zt,this).listen(),Pe(Zt,this).selectCell(0,0))}function aie(t){const e=[];t.preventDefault(),Pe(Zt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(pT(n,r)[0])}),Pe(Zt,this).setSourceDataAtCell(e)}function lie(t){const e=[];t.preventDefault(),Pe(Zt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(pT(n,r)[0])}),Pe(Zt,this).setSourceDataAtCell(e)}function uie(t,e){const n=eg(e);return t.map(r=>(r.checked=n(r.value),r))}function cie(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function hie(t,e){die(t,e),e.add(t)}function die(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fie(t,e,n){return(e=gie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gie(t){var e=mie(t,"string");return typeof e=="symbol"?e:e+""}function mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sd=new WeakSet;class pie extends Jf{constructor(e,n){super(e,{id:n.id,stateless:!1}),hie(this,sd),fie(this,"name",""),this.name=n.name,this.elements.push(new Cf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>nm(sd,this,wie).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>nm(sd,this,vie).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Zl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?On:Zl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=La(i,h=>h.name===Zl),u={},c=this.hot.getTranslatedPhrase(Mp);if(l){const h=s(r,a),d=Ge(h,b=>b.value),f=new Map(h.map(b=>[b.value,this.hot.getCellMeta(b.meta.visualRow,b.meta.visualCol)])),m=OE(d);o&&(l.args[0]=o);const w=[],y=rN(m,l.args[0],c,b=>{b.checked&&w.push(b.value),nm(sd,this,gN).call(this,b,f)}),T=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,T).locale,u.args=[w],u.command=Xl(Zl),u.itemsSnapshot=y}else u.args=[],u.command=Xl(On);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Cf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Mp),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=OE(r),s=rN(o,o,e,l=>{nm(sd,this,gN).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ge(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:FM(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function wie(t){lh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ai(t))}function gN(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function vie(t,e){switch(e.type){case"numeric":return PF(t,e);default:return t}}var jV;function Cie(t,e){yie(t,e),e.add(t)}function yie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sie(t,e,n){return(e=bie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:e+""}function Rie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mN=new WeakSet;class yf extends Jf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Cie(this,mN),Sie(this,"name",""),this.name=n.name,this.elements.push(new ka(this.hot,{type:"button",value:L_,className:"htUIButton htUIButtonOK",identifier:yf.BUTTON_OK})),this.elements.push(new ka(this.hot,{type:"button",value:$_,className:"htUIButton htUIButtonCancel",identifier:yf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(n,r)=>Eie(mN,this,Tie).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuActionBar"),P(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}jV=yf;function Tie(t,e){e.options.identifier===jV.BUTTON_OK?this.accept():this.cancel()}function Db(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Mie(t,"string");return typeof e=="symbol"?e:e+""}function Mie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pN="ConditionCollection.filteringStates";class jM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Db(this,"hot",void 0),Db(this,"isMapRegistrable",void 0),Db(this,"filteringStates",new Gw),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(pN,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Da;return e.length?Cre(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Da,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(Qe`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(_t(pf[r]))throw new Error(Qe`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Wa(a,s)}]},i):u.push({name:a,args:s,func:Wa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(pN),this.filteringStates=null,this.clearLocalHooks()}}rt(jM,bn);function wN(t,e,n){return(e=Pie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pie(t){var e=Iie(t,"string");return typeof e=="symbol"?e:e+""}function Iie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];wN(this,"conditionCollection",void 0),wN(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return P(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Oie(t,e){xie(t,e),e.add(t)}function xie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wl(t,e,n){return(e=Aie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:e+""}function Hie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rm=new WeakSet;class zV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Oie(this,rm),wl(this,"hot",void 0),wl(this,"conditionCollection",void 0),wl(this,"columnDataFactory",void 0),wl(this,"changes",[]),wl(this,"grouping",!1),wl(this,"latestEditedColumnPosition",-1),wl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>kb(rm,this,Nie).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>kb(rm,this,Die).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>kb(rm,this,kie).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=zL(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new jM(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const w=r.columnDataFactory(h);let y;f.isEmpty()?y=w:y=new UV(f,b=>r.columnDataFactory(b)).filter(),y=Ge(y,b=>b.meta.visualRow);const T=eg(y);return f.destroy(),La(w,b=>T(b.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),He(this,(e,n)=>{this[n]=null})}}function Nie(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Die(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function kie(){P(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}rt(zV,bn);function Lie(t){return NM({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Cf)return r;if(i.element&&!ou(i.element))return!1;i.focus()}})}const ad="filters";function $ie(t,e){let n=-1,r;const i=Lie(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(ad),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof to&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(ad),callback:()=>{h.isSubMenu()&&h.close(),d.listen(ad)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const w=e[i.getCurrentPage()];w instanceof wf&&(w.openOptions(),m.preventDefault()),w instanceof vf&&(w.activate(),m.preventDefault()),w instanceof to||m.preventDefault()}}],ad)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(ad)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Fie(t,e){YV(t,e),e.add(t)}function Lb(t,e,n){YV(t,e),e.set(t,n)}function YV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ld(t,e,n){return(e=Vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function op(t,e,n){return t.set(Sr(t,e),n),n}function vi(t,e){return t.get(Sr(t,e))}function Sr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const AE="filters",Bie=250,vN=AE;var ms=new WeakMap,HE=new WeakMap,Ul=new WeakMap,Fr=new WeakSet;class jie extends Be{static get PLUGIN_KEY(){return AE}static get PLUGIN_PRIORITY(){return Bie}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Fie(this,Fr),ld(this,"dropdownMenuPlugin",null),ld(this,"conditionCollection",null),ld(this,"conditionUpdateObserver",null),ld(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ld(this,"filtersRowsMap",null),Lb(this,ms,void 0),Lb(this,HE,new WeakSet),Lb(this,Ul,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Sr(Fr,n,Xie).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[AE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Uf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>Sr(Fr,this,CN).call(this,"accept")),a.addLocalHook("cancel",()=>Sr(Fr,this,CN).call(this,"cancel")),a.addLocalHook("change",l=>Sr(Fr,this,Kie).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(A_)}:`,s=()=>`${this.hot.getTranslatedPhrase(H_)}:`;if(!this.components.get("filter_by_condition")){const a=new xE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>Sr(Fr,this,yN).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Jre(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new xE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>Sr(Fr,this,yN).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new pie(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new yf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new jM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new zV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Sr(Fr,this,Zie).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Sr(Fr,e,qie).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Sr(Fr,this,Gie).call(this)),this.addHook("afterDropdownMenuShow",()=>Sr(Fr,this,zie).call(this)),this.addHook("afterDropdownMenuHide",()=>Sr(Fr,this,Yie).call(this)),this.addHook("afterChange",a=>Sr(Fr,this,Uie).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!vi(ms,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=vi(ms,this).getMenu(),c=u.getNavigator(),h=vi(ms,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];op(ms,this,$ie(this.dropdownMenuPlugin.menu,a));const l=u=>{vi(ms,this).listen(),u.preventDefault(),lh(u.keyCode,"TAB")&&(u.shiftKey?vi(ms,this).toPreviousItem():vi(ms,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:vN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vN)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Da;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,vi(Ul,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ge(n.filter(),u=>u.meta.visualRow);const l=eg(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),P(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),op(Ul,this,this.exportConditions())}else s!==!1&&!r?(op(Ul,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(vi(Ul,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:FM(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=OE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Gp&&n.command.key!==On&&r.command.key!==On&&i.command.key!==On?o=WM:i.command.key!==On&&(n.command.key===On||r.command.key===On)&&(o=Da),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new UV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return P(i,s=>{P(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Uie(t){t&&P(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function zie(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Yie(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Gie(){const t=this.dropdownMenuPlugin.menu;vi(HE,this).has(t)||vi(ms,this).setMenu(t),vi(HE,this).add(t)}function qie(t){t.items.push({name:Le}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function CN(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==On&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==On&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==On&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Kie(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===xE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function yN(){this.setListeningDropdownMenu()}function Xie(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Y(e,"htFiltersActive"):le(e,"htFiltersActive")}function Zie(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&op(Ul,this,vi(Ul,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Zl),s=n.filter(a=>a.name!==Zl);if(o.length>=2||s.length>=3)We(Qe`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const GV="internal-use-in-handsontable",NE={licenseKey:GV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function qV(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Gn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function KV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Qie(t){var e;const n=t[Gn],r=KV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qV(t);return{...NE,...r,...i}}function Jie(t){var e;const n=t[Gn],r=KV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qV(t);return{...r,...i}}function eoe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function mv(){const t="engine_relationship",e=Hi(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function UM(){const t="shared_engine_usage",e=Hi(Gn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function toe(t){const e=t.getSettings(),n=e[Gn],r=n==null?void 0:n.engine;if(n===!0||_t(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return noe((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&_t(r.hyperformula)){const o=mv(),s=UM().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:GV}),(r.getConfig().leapYear1900!==NE.leapYear1900||kf(r.getConfig().nullDate,NE.nullDate)===!1)&&We(Qe`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function noe(t,e,n){const r=e[Gn],i=Qie(e),o=mv(),s=UM();roe(t,r.functions),ioe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),ooe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function SN(t){var e;const n=mv(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function bN(t,e){if(t){const n=mv(),r=n.get(t),i=UM(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function roe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){We(s.message)}})}function ioe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){We(r.message)}}}function ooe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){We(a.message)}}),t.resumeEvaluation())}function soe(t,e){return(_t(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const XV="DD/MM/YYYY";function aoe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function loe(t){return aoe(t)?t.substr(1):t}function uoe(t){return typeof t=="string"&&t.startsWith("=")}function zM(t,e){return typeof t=="string"&&e==="date"}function ZV(t,e){return K(t,e,!0).isValid()}function QV(t,e){return K(t,e,!0).format(XV)}function coe(t,e){return K(t,XV,!0).format(e)}function JV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return K(r).format(e)}function hoe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function doe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function foe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function YM(t,e,n){const r=doe(t,hoe(t,e,n));return foe(r)}function vl(t,e,n){goe(t,e),e.set(t,n)}function goe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(t,e){return t.get(eW(t,e))}function sa(t,e,n){return t.set(eW(t,e),n),n}function eW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ud=new WeakMap,aa=new WeakMap,Vr=new WeakMap,im=new WeakMap,$b=new WeakMap,Fb=new WeakMap,om=new WeakMap;class RN{constructor(e,n,r){vl(this,ud,void 0),vl(this,aa,void 0),vl(this,Vr,void 0),vl(this,im,[]),vl(this,$b,[]),vl(this,Fb,void 0),vl(this,om,[]),sa(ud,this,e),sa(aa,this,n),sa(Vr,this,r)}setRemovedHfIndexes(e){return sa(om,this,e.map(n=>{const r=Tt(aa,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Tt(om,this)}getRemovedHfIndexes(){return Tt(om,this)}getHfIndexFromVisualIndex(e){const n=Tt(aa,this).getIndexesSequence(),r=Tt(aa,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Kn(Tt(ud,this))}s`;Tt(Vr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Tt(Vr,this).getEngine()[r](Tt(Vr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(sa($b,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),sa(Fb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Tt(Vr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=YM(Tt($b,this),Tt(Fb,this),Tt(aa,this).getNumberOfIndexes());Tt(Vr,this).getSheetId()===null?Tt(Vr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Kn(Tt(ud,this))}Order`;return n=>{if(Tt(Vr,this).isPerformingUndoRedo())return;const r=Tt(aa,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Tt(im,this).map(l=>r.indexOf(l)),o=Tt(Vr,this).getEngine().getSheetDimensions(Tt(Vr,this).getSheetId());let s;Tt(ud,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Tt(Vr,this).getEngine()[e](Tt(Vr,this).getSheetId(),i)}sa(im,this,r)}}init(){sa(im,this,Tt(aa,this).getIndexesSequence())}}function Cl(t,e,n){moe(t,e),e.set(t,n)}function moe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e){return t.get(tW(t,e))}function yl(t,e,n){return t.set(tW(t,e),n),n}function tW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sm=new WeakMap,am=new WeakMap,Vb=new WeakMap,Wb=new WeakMap,Bb=new WeakMap,jb=new WeakMap,Ub=new WeakMap;class poe{constructor(e,n,r){Cl(this,sm,void 0),Cl(this,am,void 0),Cl(this,Vb,void 0),Cl(this,Wb,!1),Cl(this,Bb,!1),Cl(this,jb,null),Cl(this,Ub,null),yl(sm,this,new RN("row",e,this)),yl(am,this,new RN("column",n,this)),yl(Vb,this,r)}getForAxis(e){return e==="row"?hs(sm,this):hs(am,this)}setPerformUndo(e){yl(Wb,this,e)}setPerformRedo(e){yl(Bb,this,e)}isPerformingUndoRedo(){return hs(Wb,this)||hs(Bb,this)}getSheetId(){return hs(Ub,this)}getEngine(){return hs(jb,this)}getPostponeAction(){return hs(Vb,this)}setupSyncEndpoint(e,n){yl(jb,this,e),yl(Ub,this,n),hs(sm,this).init(),hs(am,this).init()}}function woe(t,e){nW(t,e),e.add(t)}function Sl(t,e,n){return(e=voe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function voe(t){var e=Coe(t,"string");return typeof e=="symbol"?e:e+""}function Coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zb(t,e,n){nW(t,e),e.set(t,n)}function nW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){return t.set(Oe(t,e),n),n}function ru(t,e){return t.get(Oe(t,e))}function Oe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Gn="formulas",yoe=["maxRows","maxColumns","language"],Soe=260;re.getSingleton().register("afterNamedExpressionAdded");re.getSingleton().register("afterNamedExpressionRemoved");re.getSingleton().register("afterSheetAdded");re.getSingleton().register("afterSheetRemoved");re.getSingleton().register("afterSheetRenamed");re.getSingleton().register("afterFormulasValuesUpdate");const mh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ls=new WeakMap,pv=new WeakMap,cd=new WeakMap,Ne=new WeakSet;class boe extends Be{constructor(){var e;super(...arguments),e=this,woe(this,Ne),zb(this,Ls,!1),zb(this,pv,!1),zb(this,cd,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,$oe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,Foe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,Voe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,Woe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,Boe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Oe(Ne,e,joe).call(e,...r)}]]),Sl(this,"staticRegister",Hi("formulas")),Sl(this,"engine",null),Sl(this,"sheetId",null),Sl(this,"sheetName",null),Sl(this,"indexSyncer",null),Sl(this,"rowAxisSyncer",null),Sl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Gn}static get PLUGIN_PRIORITY(){return Soe}static get SETTING_KEYS(){return[Gn,...yoe]}isEnabled(){return!!this.hot.getSettings()[Gn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=toe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){We("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,Oe(Ne,this,Sf).call(this));r!==!1&&Oe(Ne,this,jd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,EN).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,TN).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,EN).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,TN).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,_oe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Moe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Roe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Poe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,_N).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,_N).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Ioe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Ooe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Hoe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Noe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,xoe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Aoe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Doe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,koe).call(n,...i)}),this.indexSyncer=new poe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Toe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Loe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oe(Ne,n,Eoe).call(n,...i)}),ru(cd,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){ru(cd,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),bN(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Jie(this.hot.getSettings());eoe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Gn];if(oe(r)&&oe(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Gn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,Oe(Ne,this,Sf).call(this));Oe(Ne,this,jd).call(this,o)}}super.updatePlugin(e)}destroy(){ru(cd,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ba(cd,this,null),bN(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(oe(n)&&!P$(n))return We("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return We("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return We(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){q0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}Oe(Ne,this,jd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Kn(Gn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),SN(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return oe(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(oe(l)===!1||oe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=SN(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){We(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return zM(r,o.type)&&(ZV(r,o.dateFormat)?r=QV(r,o.dateFormat):uoe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function jd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function rW(t,e,n){if(ye(n)&&n!==null){const r=this.hot.toVisualRow(t),i=this.hot.toVisualColumn(e),o=this.hot.getCellMeta(r,i).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function Sf(t,e,n,r){return this.hot.getSourceDataArray(t,e,n,r).map((i,o)=>i.map((s,a)=>Oe(Ne,this,rW).call(this,o,a,s)))}function Roe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Yn(s)&&(s=JV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Eoe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:w}=h.start,{row:y,col:T}=h.end,b=y-m+1,M=T-w+1;for(let R=0;R<f.length;R+=1)for(let D=0;D<f[R].length;D+=1){const I=f[R][D],O=m+R%b,U=w+D%M,G=this.hot.getCellMeta(O,U);zM(I,G.type)&&(I.startsWith("'")?f[R][D]=I.slice(1):this.isFormulaCellType(O,U,this.sheetId)===!1&&(f[R][D]=coe(I,G.dateFormat)))}return f}function EN(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Kn(Gn))||Ba(pv,this,_t(this.hot.getSettings().data))}function Toe(){if(ru(pv,this)){this.switchSheet(this.sheetName);return}const t=Oe(Ne,this,Sf).call(this);t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;zM(i,s.type)&&(ZV(i,a)?t[r][o]=QV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ba(Ls,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ba(Ls,this,!1)}function TN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Kn(Gn)))return;const r=soe(this.engine,this.hot.getSettings()[Gn].sheetName);if(Oe(Ne,this,jd).call(this,r),n!=="updateSettings")if(ru(pv,this))this.switchSheet(this.sheetName);else{const i=Oe(Ne,this,Sf).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ba(Ls,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ba(Ls,this,!1)}}}function _oe(t,e,n,r){if(r!=="get"||ru(Ls,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=loe(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Yn(s)&&(s=JV(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Moe(t,e,n,r){if(r!=="get"||ru(Ls,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function _N(t,e){if(mh(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};l=Oe(Ne,this,rW).call(this,c,h,l),c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Poe(t,e){if(mh(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Yn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){We(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Ioe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Ooe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function xoe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Aoe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Hoe(t,e,n){if(mh(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Noe(t,e,n){if(mh(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Doe(t,e,n,r){if(mh(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function koe(t,e,n,r){if(mh(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Loe(t,e,n){var r;Ba(Ls,this,!0);const i=Oe(Ne,this,Sf).call(this,n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ba(Ls,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function $oe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Foe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Voe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Woe(t){this.hot.runHooks("afterSheetAdded",t)}function Boe(t,e){Oe(Ne,this,jd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function joe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Uoe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(u_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function zoe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(c_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Yoe(t,e){iW(t,e),e.add(t)}function Goe(t,e,n){iW(t,e),e.set(t,n)}function iW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bl(t,e){return t.get(va(t,e))}function MN(t,e,n){return t.set(va(t,e),n),n}function va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideColumns");re.getSingleton().register("afterHideColumns");re.getSingleton().register("beforeUnhideColumns");re.getSingleton().register("afterUnhideColumns");const PN="hiddenColumns",qoe=310;var vo=new WeakMap,Rl=new WeakSet;class Koe extends Be{constructor(){super(...arguments),Yoe(this,Rl),Goe(this,vo,null)}static get PLUGIN_KEY(){return PN}static get PLUGIN_PRIORITY(){return qoe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PN]}enablePlugin(){var e=this;this.enabled||(MN(vo,this,new Yw),bl(vo,this).addLocalHook("init",()=>va(Rl,this,tse).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,bl(vo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Rl,e,ese).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>va(Rl,this,Zoe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>va(Rl,this,Xoe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return va(Rl,e,Joe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>va(Rl,this,Qoe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=bl(vo,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));P(l,u=>{o[u]=!1}),i=gn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&bl(vo,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{bl(vo,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ge(bl(vo,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return bl(vo,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){MN(vo,this,null),super.destroy()}}function Xoe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Zoe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Qoe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Joe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Y(e,n)}function ese(t){t.items.push({name:Le},Uoe(this),zoe(this))}function tse(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function nse(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(h_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function rse(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(d_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeActive(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function ise(t,e){oW(t,e),e.add(t)}function ose(t,e,n){oW(t,e),e.set(t,n)}function oW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function El(t,e){return t.get(Ca(t,e))}function IN(t,e,n){return t.set(Ca(t,e),n),n}function Ca(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeHideRows");re.getSingleton().register("afterHideRows");re.getSingleton().register("beforeUnhideRows");re.getSingleton().register("afterUnhideRows");const ON="hiddenRows",sse=320;var Co=new WeakMap,Tl=new WeakSet;class ase extends Be{constructor(){super(...arguments),ise(this,Tl),ose(this,Co,null)}static get PLUGIN_KEY(){return ON}static get PLUGIN_PRIORITY(){return sse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[ON]}enablePlugin(){var e=this;this.enabled||(IN(Co,this,new Yw),El(Co,this).addLocalHook("init",()=>Ca(Tl,this,fse).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,El(Co,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Tl,e,dse).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Ca(Tl,this,use).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Ca(Tl,this,lse).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ca(Tl,e,hse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Ca(Tl,this,cse).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=El(Co,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));P(l,u=>{o[u]=!1}),i=gn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&El(Co,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{El(Co,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ge(El(Co,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return El(Co,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){IN(Co,this,null),super.destroy()}}function lse(t,e){return this.isHidden(e)?0:t}function use(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function cse(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function hse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Y(e,n)}function dse(t){t.items.push({name:Le},nse(this),rse(this))}function fse(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function gse(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(FT)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function mse(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(VT)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function pse(t,e){sW(t,e),e.add(t)}function wse(t,e,n){sW(t,e),e.set(t,n)}function sW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DE(t,e){return t.get(Kp(t,e))}function Yb(t,e,n){return t.set(Kp(t,e),n),n}function Kp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnFreeze");re.getSingleton().register("afterColumnFreeze");re.getSingleton().register("beforeColumnUnfreeze");re.getSingleton().register("afterColumnUnfreeze");const xN="manualColumnFreeze",vse=110;var Fl=new WeakMap,Gb=new WeakSet;class Cse extends Be{constructor(){super(...arguments),pse(this,Gb),wse(this,Fl,!1)}static get PLUGIN_KEY(){return xN}static get PLUGIN_PRIORITY(){return vse}isEnabled(){return!!this.hot.getSettings()[xN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Kp(Gb,this,yse).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Kp(Gb,this,Sse).call(this,e,n)),super.enablePlugin())}disablePlugin(){Yb(Fl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;DE(Fl,this)||Yb(Fl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;DE(Fl,this)||Yb(Fl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function yse(t){t.items.push({name:"---------"},gse(this),mse(this))}function Sse(t,e){if(DE(Fl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function lm(t,e,n){return(e=bse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bse(t){var e=Rse(t,"string");return typeof e=="symbol"?e:e+""}function Rse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qb=0,AN=1,HN=2,ec="px";let aW=class{constructor(e){lm(this,"hot",void 0),lm(this,"_element",null),lm(this,"state",qb),lm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=HN}build(){this.state===qb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=AN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=qb}isAppended(){return this.state===HN}isBuilt(){return this.state>=AN}setPosition(e,n){Yn(e)&&(this._element.style.top=e+ec),Yn(n)&&(this._element.style[this.inlineProperty]=n+ec)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Yn(e)&&(this._element.style.width=e+ec),Yn(n)&&(this._element.style.height=n+ec)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Yn(e)&&(this._element.style.marginTop=e+ec),Yn(n)&&(this._element.style[`margin${Kn(this.inlineProperty)}`]=n+ec)}getOffset(){const e=this._element.style,n=`margin${Kn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const Ese="ht__manualColumnMove--backlight";let Tse=class extends aW{build(){super.build(),Y(this._element,Ese)}};const _se="ht__manualColumnMove--guideline";let Mse=class extends aW{build(){super.build(),Y(this._element,_se)}};function Pse(t,e){lW(t,e),e.add(t)}function Vi(t,e,n){lW(t,e),e.set(t,n)}function lW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e,n){return t.set(ya(t,e),n),n}function he(t,e){return t.get(ya(t,e))}function ya(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeColumnMove");re.getSingleton().register("afterColumnMove");const Kb="manualColumnMove",Ise=120,NN="ht__manualColumnMove",Xp="show-ui",kE="on-moving--columns",LE="after-selection--columns";var ar=new WeakMap,Ra=new WeakMap,Is=new WeakMap,sp=new WeakMap,Oa=new WeakMap,sr=new WeakMap,um=new WeakMap,fi=new WeakMap,vc=new WeakMap,Zp=new WeakMap,Ud=new WeakMap,_l=new WeakSet;class Ose extends Be{constructor(){super(...arguments),Pse(this,_l),Vi(this,ar,new Tse(this.hot)),Vi(this,Ra,new Mse(this.hot)),Vi(this,Is,[]),Vi(this,sp,0),Vi(this,Oa,!1),Vi(this,sr,{}),Vi(this,um,void 0),Vi(this,fi,void 0),Vi(this,vc,void 0),Vi(this,Zp,void 0),Vi(this,Ud,void 0)}static get PLUGIN_KEY(){return Kb}static get PLUGIN_PRIORITY(){return Ise}isEnabled(){return!!this.hot.getSettings()[Kb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(_l,e,xse).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(_l,e,Hse).call(e,...r)}),this.addHook("afterScrollVertically",()=>ya(_l,this,Dse).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ya(_l,e,kse).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,NN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){le(this.hot.rootElement,NN),this.unregisterEvents(),he(ar,this).destroy(),he(Ra,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(um,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Mr(um,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Mr(um,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=gn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Kb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(fi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(fi,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(ar,this).getOffset().start,u=he(ar,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,w=Gt(this.hot.rootElement),y=m.innerWidth-he(vc,this)-w;h=m.innerWidth-he(sr,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(sr,this).eventPageX-(he(vc,this)-(r.scrollX===void 0?i:0));if(he(Zp,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(fi,this))&&(o+=i),o+=c,he(fi,this)<0)he(Ud,this)>0?he(sr,this).col=0:he(sr,this).col=e>0?e-1:e;else if(he(sr,this).TD.offsetWidth/2+o<=h){const m=he(fi,this)>=he(sp,this)?he(sp,this)-1:he(fi,this);he(sr,this).col=m+1,o+=he(sr,this).TD.offsetWidth}else he(sr,this).col=he(fi,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(fi,this)<he(Ud,this)&&(f-=he(vc,this)<=r.scrollX?he(vc,this):0),he(ar,this).setPosition(null,d),he(Ra,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ya(_l,this,Ase).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ya(_l,this,Nse).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(ar,this).build(),he(Ra,this).build()}destroy(){he(ar,this).destroy(),he(Ra,this).destroy(),super.destroy()}}function xse(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeActive(),a=ve(t.target,"sortAction");if(!s||!o||he(Oa,this)||t.button!==0||a){Mr(Oa,this,!1),he(Is,this).length=0,le(this.hot.rootElement,[kE,Xp]);return}const l=he(Ra,this).isBuilt()&&!he(Ra,this).isAppended(),u=he(ar,this).isBuilt()&&!he(ar,this).isAppended();l&&u&&(he(Ra,this).appendTo(i.hider),he(ar,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,Mr(Oa,this,!0);const m=n.firstChild?KL(t,n.firstChild).x:t.offsetX;he(sr,this).eventPageX=t.pageX,Mr(fi,this,e.col),he(sr,this).TD=n,he(sr,this).col=e.col,Mr(Is,this,this.prepareColumnsToMoving(d,f)),Mr(Zp,this,!!this.hot.getSettings().rowHeaders),Mr(sp,this,this.hot.countCols()),Mr(Ud,this,this.hot.getSettings().fixedColumnsStart),Mr(vc,this,Dn(this.hot.rootElement).left);const w=he(Zp,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,T=e.col<he(Ud,this),b=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),R=this.getColumnsWidth(d,e.col-1)+M,D=this.getColumnsWidth(w,d-1)+(T?b:0)+R;he(ar,this).setPosition(y,D),he(ar,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(ar,this).setOffset(null,-R),Y(this.hot.rootElement,kE)}else le(this.hot.rootElement,LE),Mr(Oa,this,!1),he(Is,this).length=0}function Ase(t){he(Oa,this)&&(he(sr,this).eventPageX=t.pageX,this.refreshPositions())}function Hse(t,e,n,r){!this.hot.getSelectedRangeActive()||!he(Oa,this)||(he(Is,this).indexOf(e.col)>-1?le(this.hot.rootElement,Xp):Y(this.hot.rootElement,Xp),r.row=!0,r.column=!0,r.cell=!0,Mr(fi,this,e.col),he(sr,this).TD=n)}function Nse(){const t=he(sr,this).col,e=he(Is,this).length;if(Mr(fi,this,void 0),Mr(Oa,this,!1),le(this.hot.rootElement,[kE,Xp,LE]),this.hot.selection.isSelectedByColumnHeader()&&Y(this.hot.rootElement,LE),e<1||t===void 0)return;const n=he(Is,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Is,this),t);if(he(Is,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Dse(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(ar,this).setPosition(r),he(ar,this).setSize(null,t.hider.offsetHeight-r)}function kse(){this.moveBySettingsOrLoad()}function Lse(t,e){uW(t,e),e.add(t)}function $n(t,e,n){uW(t,e),e.set(t,n)}function uW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e,n){return t.set(qi(t,e),n),n}function ne(t,e){return t.get(qi(t,e))}function qi(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qp="manualColumnResize",$se=130,DN="manualColumnWidths";var Ss=new WeakMap,cm=new WeakMap,Zr=new WeakMap,Jp=new WeakMap,Fo=new WeakMap,Fse=new WeakMap,Vc=new WeakMap,hm=new WeakMap,yr=new WeakMap,ps=new WeakMap,cu=new WeakMap,ew=new WeakMap,Mc=new WeakMap,zd=new WeakMap,Jr=new WeakMap,Yd=new WeakMap,yo=new WeakSet;class Vse extends Be{static get PLUGIN_KEY(){return Qp}static get PLUGIN_PRIORITY(){return $se}constructor(e){super(e),Lse(this,yo),$n(this,Ss,null),$n(this,cm,null),$n(this,Zr,[]),$n(this,Jp,null),$n(this,Fo,null),$n(this,Fse,null),$n(this,Vc,null),$n(this,hm,null),$n(this,yr,this.hot.rootDocument.createElement("DIV")),$n(this,ps,this.hot.rootDocument.createElement("DIV")),$n(this,cu,null),$n(this,ew,!1),$n(this,Mc,0),$n(this,zd,null),$n(this,Jr,void 0),$n(this,Yd,void 0),Y(ne(yr,this),"manualColumnResizer"),Y(ne(ps,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Qp]}enablePlugin(){var e=this;this.enabled||(Yt(Jr,this,new Ga),ne(Jr,this).addLocalHook("init",()=>qi(yo,this,Wse).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ne(Jr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(yo,e,Gse).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(yo,e,qse).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qi(yo,e,Kse).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yt(Yd,this,ne(Jr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",DN,ne(Jr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",DN,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ne(Jr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ne(Jr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||ne(Mc,this)>1)return;Yt(Ss,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ne(Ss,this)),i=r.col;if(i<0)return;const o=Jt(ne(Ss,this)),s=ne(Ss,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ne(Ss,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ne(Ss,this),r.row,r.col)),Yt(cm,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Yt(Zr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,m=>{ne(Zr,this).includes(m)||ne(Zr,this).push(m)})})}ne(Zr,this).includes(ne(cm,this))||Yt(Zr,this,[ne(cm,this)]),Yt(hm,this,l.start-6),Yt(Vc,this,parseInt(s.width,10)),ne(yr,this).style.top=`${l.top}px`,ne(yr,this).style[this.inlineDir]=`${ne(hm,this)+ne(Vc,this)}px`,ne(yr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ne(yr,this))}refreshHandlePosition(){ne(yr,this).style[this.inlineDir]=`${ne(hm,this)+ne(Jp,this)}px`}setupGuidePosition(){const e=parseInt(Jt(ne(yr,this)),10),n=parseInt(ne(yr,this).style.top,10)+e,r=this.hot.view.getTableHeight();Y(ne(yr,this),"active"),Y(ne(ps,this),"active"),ne(ps,this).style.top=`${n}px`,this.refreshGuidePosition(),ne(ps,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ne(ps,this))}refreshGuidePosition(){ne(ps,this).style[this.inlineDir]=ne(yr,this).style[this.inlineDir]}hideHandleAndGuide(){le(ne(yr,this),"active"),le(ne(ps,this),"active")}checkIfColumnHeader(e){const n=$a(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ne(Fo,this),r,!0);o!==void 0&&Yt(Fo,this,o),this.setManualSize(r,ne(Fo,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ne(Fo,this),r,!0),i&&e()};ne(Mc,this)>=2&&(ne(Zr,this).length>1?(P(ne(Zr,this),i=>{n(i)}),e()):P(ne(Zr,this),i=>{n(i,!0)})),Yt(Mc,this,0),Yt(zd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>qi(yo,this,Bse).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>qi(yo,this,jse).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>qi(yo,this,Use).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>qi(yo,this,zse).call(this)),this.eventManager.addEventListener(ne(yr,this),"contextmenu",()=>qi(yo,this,Yse).call(this))}destroy(){super.destroy()}}function Wse(){const t=this.hot.getSettings()[Qp],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ne(Jr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ne(Jr,this).setValueAtIndex(r,n)})},!0),Yt(Yd,this,t)):t===!0&&Array.isArray(ne(Yd,this))&&this.hot.batchExecution(()=>{ne(Yd,this).forEach((n,r)=>{ne(Jr,this).setValueAtIndex(r,n)})},!0)}function Bse(t){if(!j0(t.target)&&ne(ew,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ne(cu,this)||this.setupHandlePosition(e))}}function jse(t){t.target.parentNode===this.hot.rootElement&&ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ne(Ss,this)),this.setupGuidePosition(),Yt(cu,this,!0),ne(zd,this)===null&&(Yt(zd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ne(zd,this))),Yt(Mc,this,ne(Mc,this)+1),this.startX=t.pageX,Yt(Fo,this,ne(Vc,this)))}function Use(t){if(ne(cu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Yt(Jp,this,ne(Vc,this)+e),P(ne(Zr,this),n=>{Yt(Fo,this,this.setManualSize(n,ne(Jp,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function zse(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ne(Fo,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ne(Fo,this),n,!1)};ne(cu,this)&&(this.hideHandleAndGuide(),Yt(cu,this,!1),ne(Fo,this)!==ne(Vc,this)&&(ne(Zr,this).length>1?(P(ne(Zr,this),r=>{e(r)}),t()):P(ne(Zr,this),r=>{e(r,!0)})),this.setupHandlePosition(ne(Ss,this)))}function Yse(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ne(yr,this)),this.hot.rootElement.removeChild(ne(ps,this)),Yt(cu,this,!1),Yt(ew,this,!0),this.hot._registerImmediate(()=>{Yt(ew,this,!1)})}function Gse(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ne(Jr,this).getValueAtIndex(r);this.hot.getSettings()[Qp]&&i&&(n=i)}return n}function qse(t,e){const n=ne(Jr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Kse(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Xb(t,e,n){return(e=Xse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:e+""}function Zse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zb=0,kN=1,LN=2,tc="px";let cW=class{constructor(e){Xb(this,"hot",void 0),Xb(this,"_element",null),Xb(this,"state",Zb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=LN}build(){this.state===Zb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=kN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Zb}isAppended(){return this.state===LN}isBuilt(){return this.state>=kN}setPosition(e,n){e!==void 0&&(this._element.style.top=e+tc),n!==void 0&&(this._element.style.left=n+tc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+tc),n&&(this._element.style.height=n+tc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+tc),n&&(this._element.style.marginLeft=n+tc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Qse="ht__manualRowMove--backlight";class Jse extends cW{build(){super.build(),Y(this._element,Qse)}}const eae="ht__manualRowMove--guideline";class tae extends cW{build(){super.build(),Y(this._element,eae)}}function nae(t,e){hW(t,e),e.add(t)}function nc(t,e,n){hW(t,e),e.set(t,n)}function hW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ql(t,e,n){return t.set(Sa(t,e),n),n}function Ee(t,e){return t.get(Sa(t,e))}function Sa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeRowMove");re.getSingleton().register("afterRowMove");const Qb="manualRowMove",rae=140,$N="ht__manualRowMove",tw="show-ui",$E="on-moving--rows",FE="after-selection--rows";var lr=new WeakMap,Ea=new WeakMap,Os=new WeakMap,xa=new WeakMap,Pr=new WeakMap,dm=new WeakMap,Ml=new WeakSet;class iae extends Be{constructor(){super(...arguments),nae(this,Ml),nc(this,lr,new Jse(this.hot)),nc(this,Ea,new tae(this.hot)),nc(this,Os,[]),nc(this,xa,void 0),nc(this,Pr,{}),nc(this,dm,void 0)}static get PLUGIN_KEY(){return Qb}static get PLUGIN_PRIORITY(){return rae}isEnabled(){return!!this.hot.getSettings()[Qb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Ml,e,oae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Ml,e,aae).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Sa(Ml,this,uae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sa(Ml,e,cae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,$N),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){le(this.hot.rootElement,$N),this.unregisterEvents(),Ee(lr,this).destroy(),Ee(Ea,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ee(dm,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Ql(dm,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Ql(dm,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=gn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Qb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ee(Pr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ee(Pr,this).TD,a=this.hot.rootElement,l=Dn(a),u=Uc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ee(Pr,this).eventPageY-d+c,m=o.hider.offsetHeight,w=o.TBODY.offsetTop,y=Ee(lr,this).getOffset().top,T=Ee(lr,this).getSize().height,b=s.offsetHeight/2,M=s.offsetHeight;let R=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const D=f>=R+b;this.isFixedRowTop(e.row)&&(R+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ee(Pr,this).row=n>0?n-1:n:D?(Ee(Pr,this).row=e.row+1,R+=e.row===0?M-1:M):Ee(Pr,this).row=e.row;let I=f,O=R;f+T+y>=m?I=m-T-y:f+y<w&&(I=w+Math.abs(y)),R>=m-1&&(O=m-1),Ee(lr,this).setPosition(I),Ee(Ea,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Sa(Ml,this,sae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Sa(Ml,this,lae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ee(lr,this).build(),Ee(Ea,this).build()}destroy(){Ee(lr,this).destroy(),Ee(Ea,this).destroy(),super.destroy()}}function oae(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!s||Ee(xa,this)||t.button!==0){Ql(xa,this,!1),Ee(Os,this).length=0,le(this.hot.rootElement,[$E,tw]);return}const l=Ee(Ea,this).isBuilt()&&!Ee(Ea,this).isAppended(),u=Ee(lr,this).isBuilt()&&!Ee(lr,this).isAppended();l&&u&&(Ee(Ea,this).appendTo(i.hider),Ee(lr,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Ql(xa,this,!0),Ee(Pr,this).eventPageY=t.pageY,Ee(Pr,this).coords=e,Ee(Pr,this).TD=n,Ql(Os,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ee(lr,this).setPosition(null,m),Ee(lr,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),Ee(lr,this).setOffset(-w,null),Y(this.hot.rootElement,$E),this.refreshPositions()}else le(this.hot.rootElement,FE),Ql(xa,this,!1),Ee(Os,this).length=0}function sae(t){Ee(xa,this)&&(Ee(Pr,this).eventPageY=t.pageY,this.refreshPositions())}function aae(t,e,n,r){!this.hot.getSelectedRangeActive()||!Ee(xa,this)||(Ee(Os,this).indexOf(e.row)>-1?le(this.hot.rootElement,tw):Y(this.hot.rootElement,tw),r.row=!0,r.column=!0,r.cell=!0,Ee(Pr,this).coords=e,Ee(Pr,this).TD=n)}function lae(){const t=Ee(Pr,this).row,e=Ee(Os,this).length;if(Ql(xa,this,!1),le(this.hot.rootElement,[$E,tw,FE]),this.hot.selection.isSelectedByRowHeader()&&Y(this.hot.rootElement,FE),e<1||t===void 0)return;const n=Ee(Os,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ee(Os,this),t);if(Ee(Os,this).length=0,i===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function uae(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ee(lr,this).setPosition(null,r),Ee(lr,this).setSize(t.hider.offsetWidth-r)}function cae(){this.moveBySettingsOrLoad()}function hae(t,e){dW(t,e),e.add(t)}function Fn(t,e,n){dW(t,e),e.set(t,n)}function dW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e,n){return t.set(bs(t,e),n),n}function te(t,e){return t.get(bs(t,e))}function bs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nw="manualRowResize",dae=30,FN="manualRowHeights";var Ho=new WeakMap,fm=new WeakMap,Qr=new WeakMap,Gd=new WeakMap,Ta=new WeakMap,GM=new WeakMap,Wc=new WeakMap,gm=new WeakMap,nr=new WeakMap,Oo=new WeakMap,hu=new WeakMap,rw=new WeakMap,Pc=new WeakMap,qd=new WeakMap,Zi=new WeakMap,Kd=new WeakMap,la=new WeakSet;class fae extends Be{static get PLUGIN_KEY(){return nw}static get PLUGIN_PRIORITY(){return dae}constructor(e){super(e),hae(this,la),Fn(this,Ho,null),Fn(this,fm,null),Fn(this,Qr,[]),Fn(this,Gd,null),Fn(this,Ta,null),Fn(this,GM,null),Fn(this,Wc,null),Fn(this,gm,null),Fn(this,nr,this.hot.rootDocument.createElement("DIV")),Fn(this,Oo,this.hot.rootDocument.createElement("DIV")),Fn(this,hu,!1),Fn(this,rw,!1),Fn(this,Pc,0),Fn(this,qd,null),Fn(this,Zi,void 0),Fn(this,Kd,void 0),Y(te(nr,this),"manualRowResizer"),Y(te(Oo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[nw]}enablePlugin(){this.enabled||(Lt(Zi,this,new Ga),te(Zi,this).addLocalHook("init",()=>bs(la,this,yae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,te(Zi,this)),this.addHook("modifyRowHeight",(e,n)=>bs(la,this,Cae).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Lt(Kd,this,te(Zi,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",FN,te(Zi,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",FN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return te(Zi,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return te(Gd,this)}setupHandlePosition(e){if(te(Pc,this)>1)return;Lt(Ho,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(te(Ho,this)),o=i.row;if(o<0)return;const s=Gt(te(Ho,this)),a=te(Ho,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(te(Ho,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(te(Ho,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(te(Ho,this),i.row,i.col)),Lt(fm,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Lt(Qr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();P(d,f=>{const m=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;fe(m,w,y=>{te(Qr,this).includes(y)||te(Qr,this).push(y)})})}te(Qr,this).includes(te(fm,this))||Lt(Qr,this,[te(fm,this)]),Lt(gm,this,c.top-6),Lt(Wc,this,parseInt(a.height,10)),te(nr,this).style.top=`${te(gm,this)+te(Wc,this)}px`,te(nr,this).style[this.inlineDir]=`${c.start}px`,te(nr,this).style.width=`${s}px`,this.hot.rootElement.appendChild(te(nr,this))}refreshHandlePosition(){te(nr,this).style.top=`${te(gm,this)+te(Gd,this)}px`}setupGuidePosition(){const e=parseInt(Gt(te(nr,this)),10),n=parseInt(te(nr,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();Y(te(nr,this),"active"),Y(te(Oo,this),"active"),te(Oo,this).style.top=te(nr,this).style.top,te(Oo,this).style[this.inlineDir]=`${n}px`,te(Oo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(te(Oo,this))}refreshGuidePosition(){te(Oo,this).style.top=te(nr,this).style.top}hideHandleAndGuide(){le(te(nr,this),"active"),le(te(Oo,this),"active")}checkIfRowHeader(e){const n=$a(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&te(Ta,this)<n?n:te(Ta,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Lt(Ta,this,o),this.setManualSize(r,te(Ta,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};te(Pc,this)>=2&&(te(Qr,this).length>1?(P(te(Qr,this),i=>{n(i)}),e()):P(te(Qr,this),i=>{n(i,!0)})),Lt(Pc,this,0),Lt(qd,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>bs(la,this,gae).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>bs(la,this,mae).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>bs(la,this,pae).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>bs(la,this,wae).call(this)),this.eventManager.addEventListener(te(nr,this),"contextmenu",()=>bs(la,this,vae).call(this))}destroy(){super.destroy()}}function gae(t){if(!j0(t.target)&&te(rw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(te(hu,this)||this.setupHandlePosition(e))}}function mae(t){ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(te(Ho,this)),this.setupGuidePosition(),Lt(hu,this,!0),te(qd,this)===null&&(Lt(qd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(te(qd,this))),Lt(Pc,this,te(Pc,this)+1),Lt(GM,this,t.pageY),Lt(Ta,this,te(Wc,this)))}function pae(t){te(hu,this)&&(Lt(Gd,this,te(Wc,this)+(t.pageY-te(GM,this))),P(te(Qr,this),e=>{Lt(Ta,this,this.setManualSize(e,te(Gd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function wae(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};te(hu,this)&&(this.hideHandleAndGuide(),Lt(hu,this,!1),te(Ta,this)!==te(Wc,this)&&(te(Qr,this).length>1?(P(te(Qr,this),r=>{e(r)}),t()):P(te(Qr,this),r=>{e(r,!0)})),this.setupHandlePosition(te(Ho,this)))}function vae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(te(nr,this)),this.hot.rootElement.removeChild(te(Oo,this)),Lt(hu,this,!1),Lt(rw,this,!0),this.hot._registerImmediate(()=>{Lt(rw,this,!1)})}function Cae(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),o=te(Zi,this).getValueAtIndex(i);if(this.hot.getSettings()[nw]&&o){var r;(r=this.hot.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.isEnabled()?n=Math.max(o,n??0):n=o}}return n}function yae(){const t=this.hot.getSettings()[nw],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{te(Zi,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{te(Zi,this).setValueAtIndex(r,n)}),Lt(Kd,this,t)):t===!0&&Array.isArray(te(Kd,this))&&te(Kd,this).forEach((n,r)=>{te(Zi,this).setValueAtIndex(r,n)})},!0)}var VN={},WN;function Sae(){if(WN)return VN;WN=1;var t=Ww();return t("flatMap"),VN}Sae();var BN={},jN={},Jb,UN;function bae(){if(UN)return Jb;UN=1;var t=hn(),e=fn(),n=Go(),r=e0();return Jb=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},Jb}var zN;function Rae(){if(zN)return jN;zN=1;var t=yt(),e=hn(),n=xr(),r=fn(),i=Go(),o=bae(),s=r0(),a=Ar(),l=ja(),u=i0(),c=za(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,m=s(function(){for(var w=this.iterator,y=this.mapper,T,b;;){if(b=this.inner)try{if(T=r(e(b.next,b.iterator)),!T.done)return T.value;this.inner=null}catch(M){a(w,"throw",M)}if(T=r(e(this.next,w)),this.done=!!T.done)return;try{this.inner=o(y(T.value,this.counter++),!1)}catch(M){a(w,"throw",M)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(y){r(this);try{n(y)}catch(T){a(this,"throw",T)}return d?e(d,this,y):new m(i(this),{mapper:y,inner:null})}}),jN}var YN;function Eae(){return YN||(YN=1,Rae()),BN}Eae();function Tae(t,e,n){_ae(t,e),e.set(t,n)}function _ae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e,n){return(e=Mae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mae(t){var e=Pae(t,"string");return typeof e=="symbol"?e:e+""}function Pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GN(t,e){return t.get(fW(t,e))}function mm(t,e,n){return t.set(fW(t,e),n),n}function fW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Il=new WeakMap;class No{constructor(e,n,r,i,o,s){Pl(this,"row",void 0),Pl(this,"col",void 0),Pl(this,"rowspan",void 0),Pl(this,"colspan",void 0),Pl(this,"removed",!1),Pl(this,"cellCoordsFactory",void 0),Pl(this,"cellRangeFactory",void 0),Tae(this,Il,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return Qe`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return Qe`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return Qe`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return Qe`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),mm(Il,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,mm(Il,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return mm(Il,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return GN(Il,this)||mm(Il,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),GN(Il,this)}}function Iae(t,e){Oae(t,e),e.add(t)}function Oae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pm(t,e,n){return(e=xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=Aae(t,"string");return typeof e=="symbol"?e:e+""}function Aae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ol(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ua=new WeakSet;class iw{constructor(e){Iae(this,ua),pm(this,"plugin",void 0),pm(this,"mergedCells",[]),pm(this,"mergedCellsMatrix",new Map),pm(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return Qe`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){We(iw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new No(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ol(ua,this,qN).call(this,a),a):(u&&We(iw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Ol(ua,this,Hae).call(this,r),r):!1}clear(){P(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=ke(u,i,i+s-1),d=ke(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Ol(ua,this,wm).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Ol(ua,this,wm).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Ol(ua,this,wm).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Ol(ua,this,wm).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ol(ua,this,qN).call(this,s)})}}function wm(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function qN(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Hae(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function eR(t,e,n){return(e=Nae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nae(t){var e=Dae(t,"string");return typeof e=="symbol"?e:e+""}function Dae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kae{constructor(e){eR(this,"plugin",void 0),eR(this,"mergedCellsCollection",void 0),eR(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const y=w.row+w.rowspan-a-m;o[2]+y>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?y:0}else if(r==="right"){const y=w.col+w.colspan-l-m;o[3]+y>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?y:0}else if(r==="up"){const y=u-m-w.row+1;o[0]+y<0?o[0]+=m:o[0]-=m?y:0}else if(r==="left"){const y=c-m-w.col+1;o[1]+y<0?o[1]+=m:o[1]-=m?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,w=d-m;let y=null,T=null,b=null;switch(r){case"up":y="includesVertically",b=c-w+1;break;case"left":y="includesHorizontally",b=c-w+1;break;case"down":y="includesVertically",b=h+w-1;break;case"right":y="includesHorizontally",b=h+w-1;break}return P(i,M=>{M[y](b)&&M.isFarther(T,r)&&(T=M)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return P(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(m=>{let{colspan:w}=m;return w===h.getWidth()}):!f.every(m=>{let{rowspan:w}=m;return w===h.getHeight()})}}function tR(t,e,n){return(e=Lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lae(t){var e=$ae(t,"string");return typeof e=="symbol"?e:e+""}function $ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fae{constructor(e){tR(this,"plugin",void 0),tR(this,"hot",void 0),tR(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Vae(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(BT)}return this.getTranslatedPhrase(WT)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedActive();return e?No.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Xd(t,e,n){return(e=Wae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wae(t){var e=Bae(t,"string");return typeof e=="symbol"?e:e+""}function Bae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KN{constructor(e){Xd(this,"data",void 0),Xd(this,"next",null),Xd(this,"prev",null),this.data=e}}class vm{constructor(){Xd(this,"first",null),Xd(this,"last",null)}push(e){const n=new KN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new KN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function jae(t,e){gW(t,e),e.add(t)}function xl(t,e,n){gW(t,e),e.set(t,n)}function gW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(t,e){return t.get(ow(t,e))}function Wr(t,e,n){return t.set(ow(t,e),n),n}function ow(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var So=new WeakMap,bo=new WeakMap,Ro=new WeakMap,Eo=new WeakMap,VE=new WeakMap,Cm=new WeakMap,ym=new WeakMap,nR=new WeakSet;class Uae{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;jae(this,nR),xl(this,So,new vm),xl(this,bo,new vm),xl(this,Ro,null),xl(this,Eo,null),xl(this,VE,null),xl(this,Cm,null),xl(this,ym,null),Wr(VE,this,n),Wr(Cm,this,r),Wr(ym,this,i)}getCurrentVerticalNode(){return st(Eo,this).data}getFirstVerticalNode(){return st(bo,this).first.data}getNextVerticalNode(){return st(Eo,this).next.data}getPrevVerticalNode(){return st(Eo,this).prev.data}getCurrentHorizontalNode(){return st(Ro,this).data}getFirstHorizontalNode(){return st(So,this).first.data}getNextHorizontalNode(){return st(Ro,this).next.data}getPrevHorizontalNode(){return st(Ro,this).prev.data}setPrevNodeAsActive(){Wr(Eo,this,st(Eo,this).prev),Wr(Ro,this,st(Ro,this).prev)}setNextNodeAsActive(){Wr(Eo,this,st(Eo,this).next),Wr(Ro,this,st(Ro,this).next)}buildFocusOrder(e){Wr(So,this,new vm),e.forEach((n,r)=>{const i=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.row;a<=s.row;a++)if(!st(Cm,this).isHidden(a))for(let l=o.col;l<=s.col;l++){if(st(ym,this).isHidden(l))continue;const u=ow(nR,this,XN).call(this,{selectedRange:n,selectionLayer:r,listOrder:st(So,this),mergeCellsVisitor:i,row:a,column:l});u&&Wr(Ro,this,u)}}),st(So,this).first&&(st(So,this).first.prev=st(So,this).last,st(So,this).last.next=st(So,this).first),Wr(bo,this,new vm),e.forEach((n,r)=>{const i=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.col;a<=s.col;a++)if(!st(ym,this).isHidden(a))for(let l=o.row;l<=s.row;l++){if(st(Cm,this).isHidden(l))continue;const u=ow(nR,this,XN).call(this,{selectedRange:n,selectionLayer:r,listOrder:st(bo,this),mergeCellsVisitor:i,row:l,column:a});u&&Wr(Eo,this,u)}}),st(bo,this).first&&(st(bo,this).first.prev=st(bo,this).last,st(bo,this).last.next=st(bo,this).first)}setActiveNode(e,n,r){return st(So,this).inorder(i=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=i.data;if(o===r&&e>=s&&e<=a&&n>=l&&n<=u)return Wr(Ro,this,i),!0}),st(bo,this).inorder(i=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=i.data;if(o===r&&e>=s&&e<=a&&n>=l&&n<=u)return Wr(Eo,this,i),!0}),this}}function XN(t){let{selectedRange:e,selectionLayer:n,listOrder:r,mergeCellsVisitor:i,row:o,column:s}=t;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),c=st(VE,this).call(this,o,s);if(c&&i.has(c))return null;const h={selectionLayer:n,colStart:s,colEnd:s,rowStart:o,rowEnd:o};if(c){if(i.add(c),c.row<a.row||c.row+c.rowspan-1>l.row||c.col<a.col||c.col+c.colspan-1>l.col)return null;h.colStart=c.col,h.colEnd=c.col+c.colspan-1,h.rowStart=c.row,h.rowEnd=c.row+c.rowspan-1}const d=r.push(h);return o===u.row&&s===u.col||c&&u.row>=c.row&&u.row<=c.row+c.rowspan-1&&u.col>=c.col&&u.col<=c.col+c.colspan-1?d:null}function mW(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function zae(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!ye(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[w,y]=t.translateMergedCellToRenderable(h,m,d,f),T=t.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const W=e._getRowHeightFromSettings(l);if(W!==void 0){const z=e.stylesHandler.areCellsBorderBox()?0:1;i.set(l,W-z)}else if(Lf()){const X=mW(e,h,m);i.set(l,X/m)}}const b=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),R=w-b+1,D=y-M+1;let I=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(T){const W=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(W)||(I=Math.max(I,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(W)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const U=Math.min(m,R),G=Math.min(f,D);I===l&&O===u?(a.setAttribute("rowspan",U),a.setAttribute("colspan",G)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Yae(t,e){pW(t,e),e.add(t)}function Sm(t,e,n){pW(t,e),e.set(t,n)}function pW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rR(t,e,n){return(e=Gae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gae(t){var e=qae(t,"string");return typeof e=="symbol"?e:e+""}function qae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bf(t,e,n){return t.set(ht(t,e),n),n}function vt(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}re.getSingleton().register("beforeMergeCells");re.getSingleton().register("afterMergeCells");re.getSingleton().register("beforeUnmergeCells");re.getSingleton().register("afterUnmergeCells");const WE="mergeCells",Kae=150,ZN=WE;var bi=new WeakMap,Ri=new WeakMap,Vo=new WeakMap,QN=new WeakMap,mt=new WeakSet;class Xae extends Be{constructor(){super(...arguments),Yae(this,mt),rR(this,"mergedCellsCollection",null),rR(this,"autofillCalculations",null),rR(this,"selectionCalculations",null),Sm(this,bi,null),Sm(this,Ri,{row:0,col:0}),Sm(this,Vo,new Uae({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Sm(this,QN,zae(this))}static get PLUGIN_KEY(){return WE}static get PLUGIN_PRIORITY(){return Kae}static get DEFAULT_SETTINGS(){return{[NF]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[WE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new iw(this),this.autofillCalculations=new kae(this),this.selectionCalculations=new Fae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,Zae).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,Jae).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ele).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,tle).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,nle).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,eD).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,eD).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ile).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ole).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,sle).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,JN).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,JN).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,Qae).call(e,...r)}),this.addHook("afterRenderer",function(){return vt(QN,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,rle).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ale).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,lle).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ule).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,cle).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,hle).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,dle).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,fle).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,gle).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,mle).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,ple).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,wle).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,vle).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,Cle).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ht(mt,e,yle).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!H0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=lf(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=lf(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?No.containsNegativeValues(e)?(We(No.NEGATIVE_VALUES_WARNING(e)),!1):No.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(We(No.IS_OUT_OF_BOUNDS_WARNING(e)),!1):No.isSingleCell(e)?(We(No.IS_SINGLE_CELL(e)),!1):No.containsZeroSpan(e)?(We(No.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),P(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeActive();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:ZN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZN)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(ye(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(ye(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(ye(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(ye(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Zae(){this.generateFromSettings(),this.hot.render()}function Qae(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Jae(t){vt(Ri,this).row=t.row,vt(Ri,this).col=t.col}function ele(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;vt(bi,this)&&(i.getRenderableFromVisualIndex(vt(bi,this).row)!==null&&(n.row=vt(bi,this).row),r.getRenderableFromVisualIndex(vt(bi,this).col)!==null&&(n.col=vt(bi,this).col),bf(bi,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function tle(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function nle(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){bf(bi,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);bf(bi,this,e.clone()),n&&e.assign(n)}function JN(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[ke(m,u,h),ke(w,c,d),ke(this.hot.getLastRenderedVisibleRow(),u,h),ke(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function rle(t){t.items.push({name:"---------"},Vae(this))}function eD(){bf(bi,this,null)}function ile(){if(vt(bi,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=vt(bi,this).clone().normalize();vt(Vo,this).setActiveNode(r.row,r.col),vt(Ri,this).row>0||vt(Ri,this).col>0?vt(Vo,this).setPrevNodeAsActive():(n==="E-W"&&vt(Ri,this).col<0||e==="S-N"&&vt(Ri,this).row<0)&&vt(Vo,this).setNextNodeAsActive()}function ole(t,e){const{columnIndexMapper:n,rowIndexMapper:r}=this.hot;let i=this.hot.getActiveSelectionLayerIndex(),o=null,s=null;if(vt(Ri,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=vt(Vo,this).getPrevHorizontalNode();s=n.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1),i=u}else if(vt(Ri,this).col>0){const{rowStart:a,colStart:l,selectionLayer:u}=vt(Vo,this).getNextHorizontalNode();s=n.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1),i=u}else if(vt(Ri,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=vt(Vo,this).getPrevVerticalNode();s=n.getNearestNotHiddenIndex(l,-1),o=r.getNearestNotHiddenIndex(a,-1),i=u}else if(vt(Ri,this).row>0){const{rowStart:a,colStart:l,selectionLayer:u}=vt(Vo,this).getNextVerticalNode();s=n.getNearestNotHiddenIndex(l,1),o=r.getNearestNotHiddenIndex(a,1),i=u}if(o!==null||s!==null){this.hot.selection.setActiveSelectionLayerIndex(i);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(o,s),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(l),c.clear(),c.add(l).commit()}vt(Vo,this).setActiveNode(t,e,i),bf(Ri,this,{row:0,col:0})}function sle(){vt(Vo,this).buildFocusOrder(this.hot.getSelectedRange())}function ale(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function lle(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function ule(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function cle(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function hle(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function dle(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function fle(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function gle(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function mle(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function ple(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),r=this.mergedCellsCollection.getWithinRange(n);P(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function wle(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function vle(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Cle(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function yle(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,mW(this.hot,e,m))}),t}function Sle(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:zF(u.type))(l,u,d)(c,h);if(m===jo){const w=a+1;if(typeof e[w]<"u")return s(w)}return m}(0)}}const wW="sort";function ble(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${wW}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Rle(t){const e=t.className.split(" "),n=new RegExp(`^${wW}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Ele(t,e,n){return(e=Tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tle(t){var e=_le(t,"string");return typeof e=="symbol"?e:e+""}function _le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sw="multiColumnSorting",Mle=170,tD=sw;UF(sw,Sle);class Ple extends eV{constructor(){super(...arguments),Ele(this,"pluginKey",sw)}static get PLUGIN_KEY(){return sw}static get PLUGIN_PRIORITY(){return Mle}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Vp)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:qa,position:"before",group:tD})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tD)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),le(e,Rle(e)),this.enabled!==!1&&Y(e,ble(...r))}onAfterOnCellMouseDown(e,n){AM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Vp))):this.sort(this.getColumnNextConfig(n.col)))}}function nD(t,e,n){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ile(t){var e=Ole(t,"string");return typeof e=="symbol"?e:e+""}function Ole(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xle="multipleSelectionHandles",Ale=160;class Hle extends Be{constructor(){super(...arguments),nD(this,"dragged",[]),nD(this,"lastSetCell",null)}static get PLUGIN_KEY(){return xle}static get PLUGIN_PRIORITY(){return Ale}isEnabled(){return eo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function BE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function vW(){return{label:"",isPlaceholder:!0}}function Nle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;P(t,i=>{const o=[];let s=0;n.push(o),P(i,a=>{const l=BE();if(ye(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Ct(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Ct(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(vW());return!u})});const r=Math.max(...Ge(n,i=>i.length));return P(n,i=>{if(i.length<r){const o=Ge(new Array(r-i.length),()=>BE());i.splice(i.length,0,...o)}}),n}function iR(t,e,n){Dle(t,e),e.set(t,n)}function Dle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e){return t.get(CW(t,e))}function hd(t,e,n){return t.set(CW(t,e),n),n}function CW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rD=["label","collapsible"];var ds=new WeakMap,Al=new WeakMap,oR=new WeakMap;class kle{constructor(){iR(this,ds,[]),iR(this,Al,0),iR(this,oR,1/0)}setColumnsLimit(e){hd(oR,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];hd(ds,this,Nle(e,Wi(oR,this))),hd(Al,this,Wi(ds,this).length)}getData(){return Wi(ds,this)}mergeWith(e){P(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&tn(s,o,rD)})}map(e){P(Wi(ds,this),n=>{P(n,r=>{const i=e({...r});ye(i)&&tn(r,i,rD)})})}getHeaderSettings(e,n){var r;if(e>=Wi(Al,this)||e<0)return null;const i=Wi(ds,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Wi(Al,this)||e<0)return i;const o=Wi(ds,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Wi(Al,this)}getColumnsCount(){return Wi(Al,this)>0?Wi(ds,this)[0].length:0}clear(){hd(ds,this,[]),hd(Al,this,0)}}function sR(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=$le(t,"string");return typeof e=="symbol"?e:e+""}function $le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yW="DF-pre-order";function SW(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=SW.call(this.childs[r],t,e)}return n}const Fle="DF-post-order";function bW(t,e){for(let n=0;n<this.childs.length;n++)if(bW.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const RW="BF";function Vle(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Wle=RW,iD=new Map([[yW,SW],[Fle,bW],[RW,Vle]]);class aw{constructor(e){sR(this,"data",{}),sR(this,"parent",null),sR(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new aw({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wle;if(!iD.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);iD.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function aR(t,e,n){Ble(t,e),e.set(t,n)}function Ble(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tr(t,e){return t.get(EW(t,e))}function jle(t,e,n){return t.set(EW(t,e),n),n}function EW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rc=new WeakMap,Hl=new WeakMap,ic=new WeakMap;class Ule{constructor(e){aR(this,rc,new Map),aR(this,Hl,new Map),aR(this,ic,null),jle(ic,this,e)}getRoots(){return Array.from(tr(rc,this).values())}getRootByColumn(e){let n;return tr(Hl,this).has(e)&&(n=tr(rc,this).get(tr(Hl,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-tr(Hl,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;tr(Hl,this).clear(),P(tr(rc,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)tr(Hl,this).set(i,e);e+=r})}buildTree(){this.clear();const e=tr(ic,this).getColumnsCount();let n=0;for(;n<e;){const r=tr(ic,this).getHeaderSettings(0,n),i=new aw;tr(rc,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=tr(ic,this).getHeadersSettings(r,n,i);r+=1,P(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new aw(a),e.addChild(l)),r<tr(ic,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){tr(rc,this).clear(),tr(Hl,this).clear()}}function TW(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function lw(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function uw(t){return lw(t,"origColspan")===t.data.origColspan}function qM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uw(t))return qM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)P(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,TW(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):uw(a)&&(l.isCollapsed=lw(a,"isCollapsed"))}),{rollbackModification:()=>KM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function KM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(uw(t))return KM(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)P(o,l=>{TW(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=lw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):uw(l)&&(u.isCollapsed=lw(l,"isCollapsed"))}),{rollbackModification:()=>qM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function zle(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qe`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Yle(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qe`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const oD=new Map([["collapse",KM],["expand",qM],["hide-column",zle],["show-column",Yle]]);function Gle(t,e,n){if(!oD.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return oD.get(t)(e,n)}function bm(t){const e=[];return P(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Kle(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(vW());else{const f=qle(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function qle(t){const{crossHiddenColumns:e,...n}=BE(t);return n}function Kle(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function lR(t,e,n){Xle(t,e),e.set(t,n)}function Xle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return t.set(_W(t,e),n),n}function Dt(t,e){return t.get(_W(t,e))}function _W(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var To=new WeakMap,vr=new WeakMap,Nl=new WeakMap;class Zle{constructor(){lR(this,To,new kle),lR(this,vr,new Ule(Dt(To,this))),lR(this,Nl,[[]])}setState(e){Dt(To,this).setData(e);let n=!1;try{Dt(vr,this).buildTree()}catch{Dt(vr,this).clear(),Dt(To,this).clear(),n=!0}return dd(Nl,this,bm(Dt(vr,this).getRoots())),n}setColumnsLimit(e){Dt(To,this).setColumnsLimit(e)}mergeStateWith(e){const n=Ge(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(To,this).mergeWith(n),Dt(vr,this).buildTree(),dd(Nl,this,bm(Dt(vr,this).getRoots()))}mapState(e){Dt(To,this).map(e),Dt(vr,this).buildTree(),dd(Nl,this,bm(Dt(vr,this).getRoots()))}mapNodes(e){return gn(Dt(vr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(vr,this).getNode(n,r);let o;return i&&(o=Gle(e,i,r),dd(Nl,this,bm(Dt(vr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(Nl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(vr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Dt(vr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},yW)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(To,this).getLayersCount()}getColumnsCount(){return Dt(To,this).getColumnsCount()}clear(){dd(Nl,this,[]),Dt(To,this).clear(),Dt(vr,this).clear()}}function fd(t,e,n){return(e=Qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qle(t){var e=Jle(t,"string");return typeof e=="symbol"?e:e+""}function Jle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eue{constructor(e,n){fd(this,"hot",void 0),fd(this,"nestedHeaderSettingsGetter",void 0),fd(this,"layersCount",0),fd(this,"container",void 0),fd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),Ya(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function tue(t,e){MW(t,e),e.add(t)}function sD(t,e,n){return(e=nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nue(t){var e=rue(t,"string");return typeof e=="symbol"?e:e+""}function rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oc(t,e,n){MW(t,e),e.set(t,n)}function MW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(t,e,n){return t.set(pn(t,e),n),n}function Ie(t,e){return t.get(pn(t,e))}function pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aD="nestedHeaders",iue=280;var ft=new WeakMap,ca=new WeakMap,Zd=new WeakMap,wv=new WeakMap,cw=new WeakMap,Dl=new WeakMap,_n=new WeakSet;class oue extends Be{constructor(){super(...arguments),tue(this,_n),oc(this,ft,new Zle),oc(this,ca,null),oc(this,Zd,null),oc(this,wv,!1),oc(this,cw,null),sD(this,"ghostTable",new eue(this.hot,(e,n)=>this.getHeaderSettings(e,n))),sD(this,"detectedOverlappedHeaders",!1),oc(this,Dl,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:r}=n;if(r.isHeader()&&r.col>=0){const o=Ie(ft,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=o,s.visualCellRange.from.col=o,s.visualCellRange.to.col=o,s.commit()}})}static get PLUGIN_KEY(){return aD}static get PLUGIN_PRIORITY(){return iue}isEnabled(){return!!this.hot.getSettings()[aD]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&We(Qe`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>pn(_n,this,Sue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,bue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,uue).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,cue).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,hue).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,due).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,fue).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,gue).call(e,...i)}),this.addHook("afterSelection",()=>Ie(Dl,this).call(this)),this.addHook("afterSelectionFocusSet",()=>Ie(Dl,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,sue).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>pn(_n,this,pue).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,vue).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,Cue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,aue).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,lue).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,mue).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,wue).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pn(_n,e,yue).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",Ie(Dl,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ie(Dl,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ie(ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ie(ft,this).setState(e)),this.detectedOverlappedHeaders&&We(Qe`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Ie(ft,this).triggerColumnModification(i,r)}),!Ie(ca,this)&&this.enabled&&xs(ca,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Ie(ft,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ie(Dl,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",Ie(Dl,this)),this.clearColspans(),Ie(ft,this).clear(),Ie(ca,this).unsubscribe(),xs(ca,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ie(ft,this)}getLayersCount(){return Ie(ft,this).getLayersCount()}getHeaderSettings(e,n){return Ie(ft,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),le(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),le(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),le(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),le(o,"hiddenHeader"),le(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ie(ft,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)Y(o,"hiddenHeader");else if(c>1){var m,w,y;const{wtOverlays:T}=l._wt,b=(m=T.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),M=(w=T.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((y=T.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&Y(o,"hiddenHeaderText");const D=b||M?Math.min(c,r-i):c;D>1&&o.setAttribute("colspan",D)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const T=o.querySelector("div.relative");T&&f&&f.length>0&&(le(T,this.hot.getColumnMeta(u).headerClassName),Y(T,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Ie(ft,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){xs(ft,this,null),Ie(ca,this)!==null&&(Ie(ca,this).unsubscribe(),xs(ca,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ie(ft,this).getHeaderTreeNodeData(e.row,e.col)}}function sue(t,e){var n;const r=this.hot.getSelectedRangeActive();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=Ie(cw,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(xs(cw,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ie(ft,this).findLeftMostColumnIndex(a,l),m=Ie(ft,this).findRightMostColumnIndex(a,l),w=m-f+1;if(f<c&&m>h)return f;if(s){let y=null;return f>=c&&m>h?w>d?(e.value="start",y=f):(e.value="end",y=m):f<c&&m<=h&&(w>d?(e.value="end",y=m):(e.value="start",y=f)),y}return f<=c?f:m}function aue(t,e,n){const r=Ie(ft,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ie(ft,this).getHeaderSettings(e,t);if(o===sT){if(!a)return r.columnIndex}else if(o===y$&&(l>s-i||!a))return null;return t}function lue(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const m=c+f,w=d-a;if(w===0)continue;((i=Ie(ft,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][w]="")}}}function uue(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function cue(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;xs(Zd,this,e.clone()),xs(wv,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Vw(t)||Va(t)&&l||qL(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function hue(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ke(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function due(){xs(wv,this,!1)}function fue(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ie(wv,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Ie(ft,this).getHeaderTreeNodeData(Ie(Zd,this).row,Ie(Zd,this).col);if(e.setHighlight(Ie(Zd,this)),o>e.getWidth()||i<n||i+o-1>r){const s=Ie(ft,this).findTopMostEntireHeaderLevel(ke(n,i,i+o-1),ke(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function gue(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Ie(ft,this).findLeftMostColumnIndex(n.row,n.col),o=Ie(ft,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function mue(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});xs(cw,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function pue(t){if(Ie(ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ie(ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function wue(t){const e=Ie(ft,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Ie(ft,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Yn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Ie(ft,this).getHeaderTreeNodeData(0,n).columnIndex:n}function vue(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Cue(t,e,n){var r;const{label:i}=(r=Ie(ft,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function yue(t,e){if(t<0)return this.hot.getCell(t,Ie(ft,this).findLeftMostColumnIndex(t,e),!0)}function Sue(){this.updatePlugin()}function bue(t,e){e||this.updatePlugin()}function gd(t,e,n){return(e=Rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rue(t){var e=Eue(t,"string");return typeof e=="symbol"?e:e+""}function Eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tue{constructor(e,n){gd(this,"hot",void 0),gd(this,"data",null),gd(this,"plugin",void 0),gd(this,"parentReference",new WeakMap),gd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&P(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&P(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return He(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];P(r,o=>{i.push(this.getDataObject(o))}),P(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function lD(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Mue(t,"string");return typeof e=="symbol"?e:e+""}function Mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XM{constructor(e,n){lD(this,"hot",void 0),lD(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Do extends XM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getDataObject(r);if(!i)return;const o=this.dataManager.getRowLevel(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(P(l,c=>{c&&s.removeChild(c)}),Y(n,Do.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,o-1,()=>{const d=c.createElement("SPAN");Y(d,Do.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(i)){const c=this.hot.rootDocument.createElement("DIV");u&&de(c,[vu()]),Y(n,Do.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Y(c,`${Do.CSS_CLASSES.button} ${Do.CSS_CLASSES.expandButton}`),u&&de(n,[Ei(!1)])):(Y(c,`${Do.CSS_CLASSES.button} ${Do.CSS_CLASSES.collapseButton}`),u&&de(n,[Ei(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class Pue extends XM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&P(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&P(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&P(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ve(e.target,Do.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ai(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function Iue(t,e,n){Oue(t,e),e.set(t,n)}function Oue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xue(t,e,n){return(e=Aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aue(t){var e=Hue(t,"string");return typeof e=="symbol"?e:e+""}function Hue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nue(t,e){return t.get(Due(t,e))}function Due(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uD=new WeakMap;class kue extends XM{constructor(){super(...arguments),xue(this,"dataManager",this.plugin.dataManager),Iue(this,uD,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(a_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedActive();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(l_)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const r=this.hot.getSelectedActive(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return P(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=Nue(uD,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Rm(t,e,n){return(e=Lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lue(t){var e=$ue(t,"string");return typeof e=="symbol"?e:e+""}function $ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fue{constructor(e){Rm(this,"plugin",void 0),Rm(this,"hot",void 0),Rm(this,"dataManager",void 0),Rm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return _t(i)&&(We(Qe`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Vue(t,e){PW(t,e),e.add(t)}function cD(t,e,n){PW(t,e),e.set(t,n)}function PW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uR(t,e,n){return(e=Wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wue(t){var e=Bue(t,"string");return typeof e=="symbol"?e:e+""}function Bue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ap(t,e){return t.get(wn(t,e))}function hw(t,e,n){return t.set(wn(t,e),n),n}function wn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dw="nestedRows",jue=300,hD=dw,Uue="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var vv=new WeakMap,sc=new WeakMap,Mn=new WeakSet;class zue extends Be{constructor(){super(...arguments),Vue(this,Mn),uR(this,"dataManager",null),uR(this,"headersUI",null),uR(this,"collapsedRowsMap",null),cD(this,vv,!1),cD(this,sc,!1)}static get PLUGIN_KEY(){return dw}static get PLUGIN_PRIORITY(){return jue}isEnabled(){return!!this.hot.getSettings()[dw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Uf),this.dataManager=new Tue(this,this.hot),this.collapsingUI=new Pue(this,this.hot),this.headersUI=new Do(this,this.hot),this.contextMenuUI=new kue(this,this.hot),this.rowMoveController=new Fue(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,oce).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,sce).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,que).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Kue).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Xue).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Gue).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Jue).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Que).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,ece).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,tce).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,nce).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,rce).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Zue).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,ice).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wn(Mn,e,Yue).call(e,...r)}),this.addHook("beforeLoadData",n=>wn(Mn,this,dD).call(this,n)),this.addHook("beforeUpdateData",n=>wn(Mn,this,dD).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:hD,relativeToGroup:qa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hD)}disableCoreAPIModifiers(){hw(sc,this,!0)}enableCoreAPIModifiers(){hw(sc,this,!1)}onModifyRowData(e){if(!ap(sc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ap(sc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return ap(sc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Yue(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Gue(t,e,n){this.collapsingUI.toggleState(t,e,n)}function que(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),hw(vv,this,!0),this.dataManager.getData().slice()}function Kue(t){return this.contextMenuUI.appendOptions(t)}function Xue(t,e){this.headersUI.appendLevelIndicators(t,e)}function Zue(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Que(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{hw(vv,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Jue(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function ece(){this.collapsingUI.collapsedRowsStash.stash()}function tce(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function nce(){this.collapsingUI.collapsedRowsStash.stash()}function rce(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ice(){this.dataManager.rewriteCache()}function oce(){this.headersUI.updateRowHeaderWidth()}function sce(t,e){ap(vv,this)&&(e.skipRender=!0)}function dD(t){if(!I$(t)){q0(Uue),this.hot.getSettings()[dw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function ace(t,e){IW(t,e),e.add(t)}function ha(t,e,n){IW(t,e),e.set(t,n)}function IW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ve(t,e){return t.get(Qd(t,e))}function _o(t,e,n){return t.set(Qd(t,e),n),n}function Qd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lce=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var Ic=new WeakMap,Vl=new WeakMap,cR=new WeakMap,Vn=new WeakMap,ac=new WeakMap,ci=new WeakMap,hR=new WeakMap,dR=new WeakMap,Em=new WeakSet;class OW{constructor(e){let{rootElement:n,uiContainer:r,isRtl:i,themeName:o,phraseTranslator:s,shouldHaveBorder:a,a11yAnnouncer:l}=e;ace(this,Em),ha(this,Ic,void 0),ha(this,Vl,void 0),ha(this,cR,!1),ha(this,Vn,void 0),ha(this,ac,void 0),ha(this,ci,void 0),ha(this,hR,void 0),ha(this,dR,void 0),_o(Ic,this,n),_o(Vl,this,r),_o(cR,this,i),_o(ac,this,o),_o(ci,this,s),_o(hR,this,a),_o(dR,this,l),this.install()}install(){var e;if((e=Ve(Vn,this))!==null&&e!==void 0&&e.container)return;const n=hL`${lce}`,{container:r,first:i,prev:o,next:s,last:a,pageSizeSelect:l}=n.refs;_o(Vn,this,n.refs),r.setAttribute("dir",Ve(cR,this)?"rtl":"ltr");const u=h=>h.currentTarget.disabled,c=(h,d,f)=>{d.addEventListener(h,m=>{u(m)||f()})};c("click",i,()=>this.runLocalHooks("firstPageClick")),c("focus",i,()=>this.runLocalHooks("focus",i)),c("click",o,()=>this.runLocalHooks("prevPageClick")),c("focus",o,()=>this.runLocalHooks("focus",o)),c("click",s,()=>this.runLocalHooks("nextPageClick")),c("focus",s,()=>this.runLocalHooks("focus",s)),c("click",a,()=>this.runLocalHooks("lastPageClick")),c("focus",a,()=>this.runLocalHooks("focus",a)),c("focus",l,()=>this.runLocalHooks("focus",l)),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Ve(Vl,this)?(Ve(Vl,this).appendChild(n.fragment),Y(r,[Ve(ac,this),"handsontable"])):Ve(Ic,this).after(n.fragment)}getContainer(){return Ve(Vn,this).container}getFocusableElements(){const{first:e,prev:n,next:r,last:i,pageSizeSelect:o}=Ve(Vn,this);return[o,e,n,r,i].filter(s=>!s.disabled)}updateWidth(e){return Ve(Vn,this).container.style.width=`${e}px`,this}updateTheme(e){if(_o(ac,this,e),Ve(Vl,this)){const{container:n}=Ve(Vn,this);le(n,/ht-theme-.*/g),Ve(ac,this)&&Y(n,Ve(ac,this))}return this}getHeight(){return Ve(Vn,this).container.offsetHeight}refreshBorderState(){const{container:e}=Ve(Vn,this);return Ve(Vl,this)||Ve(hR,this).call(this)?Y(e,"ht-pagination--bordered"):le(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:r,firstVisibleRowIndex:i,lastVisibleRowIndex:o,totalRenderedRows:s,pageSizeList:a,pageSize:l,autoPageSize:u}=e;const{first:c,prev:h,next:d,last:f,pageCounterSection:m,pageNavSection:w,pageNavLabel:y,pageSizeSelect:T,pageSizeLabel:b}=Ve(Vn,this),M=Ve(ci,this).call(this,U_,{start:i+1,end:o+1,total:s}),R=Ve(ci,this).call(this,z_,{currentPage:n,totalPages:r}),D=Ve(ci,this).call(this,Pp);m.textContent=M,y.textContent=R,T.textContent="",b.textContent=`${D}:`,de(w,[ti(Ve(ci,this).call(this,B_))]),de(T,[ti(Ve(ci,this).call(this,Pp)),Ir(-1)]),Ve(dR,this).call(this,R),this.refreshBorderState(),a.forEach(U=>{const G=U==="auto"?Ve(ci,this).call(this,j_):U,W=new Option(G,U);(u&&U==="auto"||!u&&U===l)&&(W.selected=!0),T.add(W)});const I=n===1,O=n===r;if(w.style.display!=="none"){const U=Ve(Ic,this).ownerDocument.activeElement;I?(Y(c,"ht-page-navigation-section__button--disabled"),Y(h,"ht-page-navigation-section__button--disabled"),c.disabled=!0,h.disabled=!0):(le(c,"ht-page-navigation-section__button--disabled"),le(h,"ht-page-navigation-section__button--disabled"),c.disabled=!1,h.disabled=!1),O?(Y(d,"ht-page-navigation-section__button--disabled"),Y(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(le(d,"ht-page-navigation-section__button--disabled"),le(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[c,h,d,f].includes(U)&&(h.disabled?d.focus():d.disabled&&h.focus())}return de(c,[ti(Ve(ci,this).call(this,Y_)),Cd(I),Ir(-1)]),de(h,[ti(Ve(ci,this).call(this,G_)),Cd(I),Ir(-1)]),de(d,[ti(Ve(ci,this).call(this,q_)),Cd(O),Ir(-1)]),de(f,[ti(Ve(ci,this).call(this,K_)),Cd(O),Ir(-1)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:r}=Ve(Vn,this);return n.style.display=e?"":"none",r.disabled=!e,Qd(Em,this,fR).call(this),this}setCounterSectionVisibility(e){return Ve(Vn,this).pageCounterSection.style.display=e?"":"none",Qd(Em,this,fR).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:r,prev:i,next:o,last:s}=Ve(Vn,this);return n.style.display=e?"":"none",r.disabled=!e,i.disabled=!e,o.disabled=!e,s.disabled=!e,Qd(Em,this,fR).call(this),this}destroy(){var e;(e=Ve(Vn,this))===null||e===void 0||e.container.remove(),_o(Vn,this,null)}}function fR(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:r}=Ve(Vn,this),i=e.style.display!=="none"||n.style.display!=="none"||r.style.display!=="none";Ve(Vl,this)||(i?Y(Ve(Ic,this).querySelector(".ht-wrapper"),"htPagination"):le(Ve(Ic,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=i?"":"none"}rt(OW,bn);const uce=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function cce(t){return uce.some(e=>{const n=!!t[e];return n&&We(Qe`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function gR(t,e,n){return(e=hce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hce(t){var e=dce(t,"string");return typeof e=="symbol"?e:e+""}function dce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fce{constructor(){gR(this,"pageSize",1),gR(this,"totalItems",0),gR(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:r}=e;this.pageSize=Math.max(n,1),this.totalItems=r,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,r=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:r,pageSize:this.pageSize}}}function gce(t,e,n){return(e=mce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mce(t){var e=pce(t,"string");return typeof e=="symbol"?e:e+""}function pce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wce{constructor(){gce(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:r}=e;const i=n(),o=r(),s=[];let a=0,l=1,u=0;for(let c=0;c<i.length;c++){const h=i[c];u>0&&l+h>=o&&(s.push({startIndex:a,endIndex:c-1,pageSize:u}),a=c,l=1,u=0),l+=h,u+=1}s.push({startIndex:a,endIndex:Math.max(0,i.length-1),pageSize:u}),this.pages=s}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const fD=new Map([["fixed",fce],["auto",wce]]);function gD(t){if(!fD.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=fD.get(t);return new e}function vce(t){let{focusableElements:e}=t;return NM({initialPage:0,size:()=>e().length,onItemSelect:r=>{e()[r].focus()}})}function Cce(t,e){xW(t,e),e.add(t)}function Mo(t,e,n){xW(t,e),e.set(t,n)}function xW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(et(t,e))}function Cn(t,e,n){return t.set(et(t,e),n),n}function et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Oc="pagination",yce=900,AW=Oc,Zc=`plugin:${Oc}`,mD=Qe`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var Jd=new WeakMap,zn=new WeakMap,Ki=new WeakMap,xt=new WeakMap,Ci=new WeakMap,fw=new WeakMap,lp=new WeakMap,ni=new WeakMap,Qi=new WeakMap,lt=new WeakSet,mR=new WeakMap;class Sce extends Be{constructor(){super(...arguments),Cce(this,lt),Mo(this,Jd,null),Mo(this,zn,1),Mo(this,Ki,10),Mo(this,xt,null),Mo(this,Ci,null),Mo(this,fw,!1),Mo(this,lp,!1),Mo(this,ni,null),Mo(this,Qi,null),Mo(this,mR,()=>{var e;!ie(fw,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&et(lt,this,Jl).call(this)})}static get PLUGIN_KEY(){return Oc}static get PLUGIN_PRIORITY(){return yce}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[Oc]}enablePlugin(){var e,n=this;if(cce(this.hot.getSettings())){this.hot.getSettings()[Oc]=!1;return}if(this.enabled)return;const r=this.hot.getSettings()[Oc];(r==null?void 0:r.initialPage)!==void 0&&Cn(zn,this,this.getSetting("initialPage")),(r==null?void 0:r.pageSize)!==void 0&&Cn(Ki,this,this.getSetting("pageSize")),Cn(Jd,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),ie(Ki,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&We(mD),Cn(Ci,this,gD(ie(Ki,this)==="auto"?"auto":"fixed")),ie(xt,this)||(Cn(xt,this,new OW({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>et(lt,this,Tce).call(this),a11yAnnouncer:i=>_8(i)})),et(lt,this,pD).call(this),ie(xt,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",i=>this.setPageSize(i)).addLocalHook("focus",i=>{ie(ni,this).setCurrentPage(ie(xt,this).getFocusableElements().indexOf(i)),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(Zc),this.hot.listen(),ie(Qi,this).deactivate()})),ie(ni,this)||Cn(ni,this,vce({focusableElements:()=>ie(xt,this).getFocusableElements()})),ie(Qi,this)||Cn(Qi,this,oM(this.hot,ie(xt,this).getContainer(),{onFocus:i=>{this.hot.getShortcutManager().setActiveContextName(Zc),this.hot.listen(),i==="from_above"?ie(ni,this).toFirstItem():ie(ni,this).toLastItem(),ie(Qi,this).deactivate()}})),et(lt,this,bce).call(this),et(lt,this,Rce).call(this),this.addHook("init",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Hce).call(n,...o)},-1),this.addHook("beforeSelectAll",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,wD).call(n,...o)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,wD).call(n,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,_ce).call(n,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Mce).call(n,...o)}),this.addHook("beforePaste",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Pce).call(n,...o)}),this.addHook("afterViewRender",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Oce).call(n,...o)}),this.addHook("afterRender",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,xce).call(n,...o)}),this.addHook("afterScrollVertically",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Nce).call(n,...o)}),this.addHook("afterLanguageChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Dce).call(n,...o)}),this.addHook("modifyRowHeight",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Ice).call(n,...o)}),this.addHook("beforeHeightChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Ace).call(n,...o)}),this.addHook("afterSetTheme",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,kce).call(n,...o)}),this.addHook("afterDialogShow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,Lce).call(n,...o)}),this.addHook("beforeDialogHide",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return et(lt,n,$ce).call(n,...o)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",ie(mR,this)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),et(lt,this,Jl).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",ie(mR,this)).unregisterMap(this.pluginName),ie(xt,this).destroy(),Cn(xt,this,null),et(lt,this,Ece).call(this),super.disablePlugin()}getPaginationData(){const e=ie(Ci,this).getTotalPages();let n=-1,r=-1;const{pageSize:i,startIndex:o}=ie(Ci,this).getState(ie(zn,this)),s=this.hot.countRows();let a=0;for(let l=o;a<i&&!(l>=s);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(n===-1&&(n=l),r=l,a+=1);return{currentPage:ie(zn,this),totalPages:e,pageSize:i,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:ie(Ki,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:r}}setPage(e){const n=ie(zn,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&(Cn(zn,this,e),et(lt,this,Jl).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,ie(zn,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const r=ie(Ki,this);this.hot.runHooks("beforePageSizeChange",r,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&We(mD),Cn(Ci,this,gD(e==="auto"?"auto":"fixed")),Cn(Ki,this,e),et(lt,this,Jl).call(this),this.hot.runHooks("afterPageSizeChange",r,ie(Ki,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),et(lt,this,pD).call(this)}nextPage(){this.setPage(ie(zn,this)+1)}prevPage(){this.setPage(ie(zn,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(ie(Ci,this).getTotalPages())}hasPreviousPage(){return ie(zn,this)>1}hasNextPage(){return ie(zn,this)<ie(Ci,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){ie(xt,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){ie(xt,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){ie(xt,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){ie(xt,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){ie(xt,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){ie(xt,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;Cn(Jd,this,null),Cn(Ci,this,null),(e=ie(xt,this))===null||e===void 0||e.destroy(),Cn(xt,this,null),super.destroy()}}function bce(){this.eventManager.addEventListener(this.hot.rootDocument,"mouseup",t=>{!ie(xt,this).getContainer().contains(t.target)&&this.hot.getShortcutManager().getActiveContextName()===Zc&&(ie(Qi,this).activate(),ie(ni,this).clear(),this.hot.getShortcutManager().setActiveContextName("grid"))})}function Rce(){var t;const e=this.hot.getShortcutManager();((t=e.getContext(Zc))!==null&&t!==void 0?t:e.addContext(Zc,"global")).addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{let i=ie(ni,this).getCurrentPage();if(r.shiftKey){ie(ni,this).toPreviousItem();const o=ie(ni,this).getCurrentPage();if(o>=i){et(lt,this,vD).call(this);return}i=o}else{ie(ni,this).toNextItem();const o=ie(ni,this).getCurrentPage();if(o<=i){et(lt,this,vD).call(this);return}i=o}r.preventDefault()},group:AW})}function Ece(){this.hot.getShortcutManager().getContext(Zc).removeShortcutsByGroup(AW)}function pD(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function Jl(){Cn(fw,this,!0),ie(Jd,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;ie(Ci,this).calculate({pageSize:ie(Ki,this),totalItems:e,viewportSizeProvider:()=>{const{view:o}=this.hot;if(o.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?o._wt.wtTable.getColumnHeaderHeight():0,c=ie(xt,this).getHeight();return o.getWorkspaceHeight()-c-u-l}const s=o.hasHorizontalScroll()?en():0;return o.getViewportHeight()-s},itemsSizeProvider:()=>{const o=n.getDefaultRowHeight();return this.hot.rowIndexMapper.getRenderableIndexes().map(a=>{var l;return(l=this.hot.getRowHeight(this.hot.toVisualRow(a)))!==null&&l!==void 0?l:o})}});const r=ie(Ci,this).getTotalPages();if(Cn(zn,this,ke(ie(zn,this),1,r)),t.length>0){const{startIndex:o,pageSize:s}=ie(Ci,this).getState(ie(zn,this));t.splice(o,s)}t.length>0?this.hot.batchExecution(()=>{t.forEach(o=>ie(Jd,this).setValueAtIndex(o,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),Cn(fw,this,!1);const i=this.getPaginationData();ie(xt,this).updateState({...i,totalRenderedRows:e}),(this.getSetting("showPageSize")||this.getSetting("showNavigation"))&&i.totalPages>1?ie(Qi,this).activate():ie(Qi,this).deactivate()}function Tce(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function wD(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();(ie(zn,this)>1||t.row>=0)&&(t.row=n),e.row=r}function _ce(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function Mce(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=ke(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function Pce(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:r}=this.getPaginationData();if(n===-1||r===-1)return!1;e.forEach(i=>{let{startRow:o}=i;if(t.length===0)return;const s=Math.min(t.length-(r-o+1),t.length);t.splice(0,s)})}function Ice(t,e){if(t===void 0||!ie(Ci,this).getState(ie(zn,this)))return;const{firstVisibleRowIndex:n}=this.getPaginationData();return e!==0&&e===n&&(t+=1),t}function Oce(){if(ie(Ki,this)!=="auto"||ie(lp,this)){Cn(lp,this,!1);return}et(lt,this,Jl).call(this),Cn(lp,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function xce(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();ie(xt,this).updateWidth(e).refreshBorderState()}function Ace(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${ie(xt,this).getHeight()}px)`}function Hce(){ie(Ki,this)!=="auto"&&et(lt,this,Jl).call(this)}function Nce(){ie(xt,this).refreshBorderState()}function Dce(){et(lt,this,Jl).call(this)}function kce(t){ie(xt,this).updateTheme(t)}function vD(){ie(Qi,this).activate(),ie(ni,this).clear(),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName("grid")}function Lce(){ie(Qi,this).deactivate()}function $ce(){ie(Qi,this).activate()}function pR(t,e,n){return(e=Fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fce(t){var e=Vce(t,"string");return typeof e=="symbol"?e:e+""}function Vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;pR(this,"rootWindow",void 0),pR(this,"prefix",void 0),pR(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Bce(t,e,n){return(e=jce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jce(t){var e=Uce(t,"string");return typeof e=="symbol"?e:e+""}function Uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}re.getSingleton().register("persistentStateSave");re.getSingleton().register("persistentStateLoad");re.getSingleton().register("persistentStateReset");const CD="persistentState",zce=0,yD=new WeakSet;class Yce extends Be{constructor(){super(...arguments),Bce(this,"storage",void 0)}static get PLUGIN_KEY(){return CD}static get PLUGIN_PRIORITY(){return zce}isEnabled(){return!!this.hot.getSettings()[CD]}enablePlugin(){this.enabled||(yD.has(this.hot)||(yD.add(this.hot),XL("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new Wce(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Gce(t,e){qce(t,e),e.add(t)}function qce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wR(t,e,n){return(e=Kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kce(t){var e=Xce(t,"string");return typeof e=="symbol"?e:e+""}function Xce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SD(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vR="search",Zce=190,Qce="htSearchResult",Jce=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},ehe=function(t,e,n){return _t(t)||t===null||!t.toLocaleLowerCase||t.length===0||_t(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var CR=new WeakSet;class the extends Be{constructor(){super(...arguments),Gce(this,CR),wR(this,"callback",Jce),wR(this,"queryMethod",ehe),wR(this,"searchResultClass",Qce)}static get PLUGIN_KEY(){return vR}static get PLUGIN_PRIORITY(){return Zce}isEnabled(){return this.hot.getSettings()[vR]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[vR];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return SD(CR,e,bD).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return SD(CR,e,bD).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ye(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function bD(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Tm(t,e,n){return(e=nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nhe(t){var e=rhe(t,"string");return typeof e=="symbol"?e:e+""}function rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HW{constructor(e){Tm(this,"viewportWidth",void 0),Tm(this,"overwriteColumnWidthFn",void 0),Tm(this,"baseWidths",new Map),Tm(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class ihe extends HW{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=zc?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),o.push(d),s-=m)}),s<=zc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,w=m;o.includes(f)||(w=Math.round(m*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function RD(t,e,n){ohe(t,e),e.set(t,n)}function ohe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yR(t,e){return t.get(NW(t,e))}function _m(t,e,n){return t.set(NW(t,e),n),n}function NW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mm=new WeakMap,md=new WeakMap;class she extends HW{constructor(){super(...arguments),RD(this,Mm,0),RD(this,md,-1)}prepare(e){super.prepare(e),_m(Mm,this,0),_m(md,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),_m(md,this,e),_m(Mm,this,n)}calculate(){if(yR(md,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+yR(Mm,this),0);this.stretchedWidths.set(yR(md,this),n)}}function ahe(t,e){DW(t,e),e.add(t)}function Pm(t,e,n){DW(t,e),e.set(t,n)}function DW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(xc(t,e))}function SR(t,e,n){return t.set(xc(t,e),n),n}function xc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const lhe="stretchColumns";var In=new WeakMap,lc=new WeakMap,bR=new WeakMap,Im=new WeakMap,pd=new WeakSet;class uhe{constructor(e){ahe(this,pd),Pm(this,In,void 0),Pm(this,lc,void 0),Pm(this,bR,new Map([["all",new ihe(xc(pd,this,ED).bind(this))],["last",new she(xc(pd,this,ED).bind(this))]])),Pm(this,Im,"none"),SR(In,this,e),SR(lc,this,At(In,this).columnIndexMapper.createAndRegisterIndexMap(lhe,"physicalIndexToValue"))}useStrategy(e){SR(Im,this,At(bR,this).has(e)?e:"none")}refreshStretching(){if(At(Im,this)==="none"){At(lc,this).clear();return}At(In,this).batchExecution(()=>{At(lc,this).clear();const e=At(bR,this).get(At(Im,this));let r=At(In,this).view.getViewportWidth();xc(pd,this,che).call(this)&&(r-=en(At(In,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<At(In,this).countCols();i++)At(In,this).columnIndexMapper.isHidden(At(In,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,xc(pd,this,hhe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;At(lc,this).setValueAtIndex(At(In,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return At(lc,this).getValueAtIndex(At(In,this).toPhysicalColumn(e))}}function che(){const{view:t,stylesHandler:e}=At(In,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=At(In,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(!At(In,this).rowIndexMapper.isHidden(At(In,this).toPhysicalRow(l))&&(o+=((a=At(In,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n)){s=!0;break}}return s}function hhe(t){var e;return(e=At(In,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:zc}function ED(t,e){return At(In,this).runHooks("beforeStretchingColumnWidth",t,e)}function dhe(t,e){kW(t,e),e.add(t)}function RR(t,e,n){kW(t,e),e.set(t,n)}function kW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ER(t,e,n){return t.set(gw(t,e),n),n}function ws(t,e){return t.get(gw(t,e))}function gw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fhe="stretchColumns",ghe=155;var Cc=new WeakMap,Om=new WeakMap,wd=new WeakMap,TR=new WeakSet;class mhe extends Be{constructor(){super(...arguments),dhe(this,TR),RR(this,Cc,new uhe(this.hot)),RR(this,Om,null),RR(this,wd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;ws(Om,this)!==null&&ws(Om,this)!==i.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),ER(Om,this,i.width)})})}))}static get PLUGIN_KEY(){return fhe}static get PLUGIN_PRIORITY(){return ghe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(ws(Cc,this).useStrategy(this.hot.getSettings().stretchH),ws(wd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gw(TR,e,whe).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gw(TR,e,phe).call(e,...r)},10),super.enablePlugin())}updatePlugin(){ws(Cc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),ws(wd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return ws(Cc,this).getStretchedWidth(e)}destroy(){ws(wd,this).disconnect(),ER(wd,this,null),ER(Cc,this,null),super.destroy()}}function phe(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function whe(t){t&&ws(Cc,this).refreshStretching()}function vhe(t,e){Che(t,e),e.add(t)}function Che(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xm(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=She(t,"string");return typeof e=="symbol"?e:e+""}function She(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _R(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bhe="touchScroll",Rhe=200;var Am=new WeakSet;class Ehe extends Be{constructor(){super(...arguments),vhe(this,Am),xm(this,"scrollbars",[]),xm(this,"clones",[]),xm(this,"lockedCollection",!1),xm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return bhe}static get PLUGIN_PRIORITY(){return Rhe}static get SETTING_KEYS(){return!0}isEnabled(){return A0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_R(Am,this,The).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_R(Am,this,_he).call(this)),this.addHook("afterMomentumScroll",()=>_R(Am,this,Mhe).call(this))}}function The(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function _he(){this.freezeOverlays=!0,P(this.clones,t=>{Y(t,"hide-tween")})}function Mhe(){this.freezeOverlays=!1,P(this.clones,t=>{le(t,"hide-tween"),Y(t,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,t=>{le(t,"show-tween")})},400),P(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Phe(t,e){Ihe(t,e),e.add(t)}function Ihe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ohe(t,e,n){return(e=xhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xhe(t){var e=Ahe(t,"string");return typeof e=="symbol"?e:e+""}function Ahe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hhe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const up="trimRows",Nhe=330;var TD=new WeakSet;class Dhe extends Be{constructor(){super(...arguments),Phe(this,TD),Ohe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return up}static get PLUGIN_PRIORITY(){return Nhe}isEnabled(){return!!this.hot.getSettings()[up]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Uf),this.trimmedRowsMap.addLocalHook("init",()=>Hhe(TD,this,khe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[up];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(P(e,l=>{o[l]=!1}),i=gn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function khe(){const t=this.hot.getSettings()[up];Array.isArray(t)&&this.hot.batchExecution(()=>{P(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Lhe(t,e,n){return(e=$he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $he(t){var e=Fhe(t,"string");return typeof e=="symbol"?e:e+""}function Fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ni{constructor(e){Lhe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Hm(t,e,n){return(e=Vhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vhe(t){var e=Whe(t,"string");return typeof e=="symbol"?e:e+""}function Whe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZM extends Ni{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Hm(this,"stateBefore",void 0),Hm(this,"range",void 0),Hm(this,"type",void 0),Hm(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new ZM({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){P(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){pa(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function _D(t,e,n){return(e=Bhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bhe(t){var e=jhe(t,"string");return typeof e=="symbol"?e:e+""}function jhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QM extends Ni{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),_D(this,"columns",void 0),_D(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new QM({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),YM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function MD(t,e,n){return(e=Uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JM extends Ni{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),MD(this,"previousSortState",void 0),MD(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new JM({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function PD(t,e,n){return(e=Yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yhe(t){var e=Ghe(t,"string");return typeof e=="symbol"?e:e+""}function Ghe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eP extends Ni{constructor(e){let{index:n,amount:r}=e;super("insert_col"),PD(this,"index",void 0),PD(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new eP({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function ID(t,e,n){return(e=qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qhe(t){var e=Khe(t,"string");return typeof e=="symbol"?e:e+""}function Khe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tP extends Ni{constructor(e){let{index:n,amount:r}=e;super("insert_row"),ID(this,"index",void 0),ID(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new tP({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Nm(t,e,n){return(e=Xhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xhe(t){var e=Zhe(t,"string");return typeof e=="symbol"?e:e+""}function Zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nP extends Ni{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Nm(this,"changes",void 0),Nm(this,"selected",void 0),Nm(this,"countCols",void 0),Nm(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new nP({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=Xn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){const r=Xn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(r,null,null,"UndoRedo.redo")}}function OD(t,e,n){return(e=Qhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=Jhe(t,"string");return typeof e=="symbol"?e:e+""}function Jhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rP extends Ni{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),OD(this,"conditionsStack",void 0),OD(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new rP({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function ede(t,e,n){return(e=tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tde(t){var e=nde(t,"string");return typeof e=="symbol"?e:e+""}function nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iP extends Ni{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),ede(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new iP({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function LW(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function fs(t,e,n){return(e=rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rde(t){var e=ide(t,"string");return typeof e=="symbol"?e:e+""}function ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oP extends Ni{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),fs(this,"index",void 0),fs(this,"indexes",void 0),fs(this,"data",void 0),fs(this,"amount",void 0),fs(this,"headers",void 0),fs(this,"columnPositions",void 0),fs(this,"rowPositions",void 0),fs(this,"fixedColumnsStart",void 0),fs(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,m=>{const w=[],y=l[m];fe(u,c,T=>{w.push(y[e.toPhysicalColumn(T)])}),h.push(w)}),fe(i-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new oP({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:LW(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Ge(this.data[c],o));const l=Ge(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),P(e.getSourceDataArray(),(c,h)=>{P(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&P(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function uc(t,e,n){return(e=ode(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ode(t){var e=sde(t,"string");return typeof e=="symbol"?e:e+""}function sde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sP extends Ni{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),uc(this,"index",void 0),uc(this,"data",void 0),uc(this,"fixedRowsBottom",void 0),uc(this,"fixedRowsTop",void 0),uc(this,"rowIndexesSequence",void 0),uc(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=Xn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new sP({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:LW(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function xD(t,e,n){return(e=ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ade(t){var e=lde(t,"string");return typeof e=="symbol"?e:e+""}function lde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aP extends Ni{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),xD(this,"rows",void 0),xD(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new aP({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),YM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function ude(t,e,n){return(e=cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cde(t){var e=hde(t,"string");return typeof e=="symbol"?e:e+""}function hde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lP extends Ni{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),ude(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new lP({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function dde(t,e){[ZM,QM,JM,eP,tP,nP,rP,iP,oP,sP,aP,lP].forEach(n=>n.startRegisteringEvents(t,e))}function fde(t,e){gde(t,e),e.add(t)}function gde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MR(t,e,n){return(e=mde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mde(t){var e=pde(t,"string");return typeof e=="symbol"?e:e+""}function pde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PR(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const AD="undoRedo",wde="undoRedo",vde=1e3;re.getSingleton().register("beforeUndo");re.getSingleton().register("afterUndo");re.getSingleton().register("beforeRedo");re.getSingleton().register("afterRedo");const HD=new Set;var Dm=new WeakSet;class Cde extends Be{static get PLUGIN_KEY(){return wde}static get PLUGIN_PRIORITY(){return vde}static get SETTING_KEYS(){return!0}constructor(e){super(e),fde(this,Dm),MR(this,"doneActions",[]),MR(this,"undoneActions",[]),MR(this,"ignoreNewActions",!1),dde(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return PR(Dm,e,yde).call(e,...r)}),this.registerShortcuts(),PR(Dm,this,Sde).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),PR(Dm,this,bde).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:AD};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AD)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=Xn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function yde(t,e){e==="loadData"&&this.clear()}function Sde(){const t=e=>{HD.has(e)||(We(Qe`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),HD.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function bde(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function IR(t,e,n){Rde(t,e),e.set(t,n)}function Rde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(t,e){return t.get($W(t,e))}function km(t,e,n){return t.set($W(t,e),n),n}function $W(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gi="ht-dialog",Ede=`
<div data-ref="dialogElement" class="${gi}">
  <div data-ref="contentWrapperElement" class="${gi}__content-wrapper">
    <div data-ref="contentElement" class="${gi}__content"></div>
  </div>
</div>
`;var OR=new WeakMap,Cr=new WeakMap,xR=new WeakMap;class FW{constructor(e){let{rootElement:n,isRtl:r}=e;IR(this,OR,void 0),IR(this,Cr,void 0),IR(this,xR,!1),km(OR,this,n),km(xR,this,r),this.install()}install(){var e;if((e=Br(Cr,this))!==null&&e!==void 0&&e.dialogElement)return;const n=hL`${Ede}`;km(Cr,this,n.refs);const{dialogElement:r}=Br(Cr,this);r.addEventListener("click",()=>this.runLocalHooks("clickDialogElement")),de(r,[R2(),Ir(-1),["dir",Br(xR,this)?"rtl":"ltr"]]),Br(OR,this).after(n.fragment)}getDialogElement(){return Br(Cr,this).dialogElement}isInsideDialog(e){return Br(Cr,this).dialogElement.contains(e)}updateDialog(e){let{isVisible:n,content:r,customClassName:i,background:o,contentBackground:s,animation:a,a11y:l}=e;const{dialogElement:u,contentElement:c}=Br(Cr,this),h=i?` ${i}`:"",d=o?` ${gi}--background-${o}`:"",f=a?` ${gi}--animation`:"",m=n?` ${gi}--show`:"";u.className=`${gi}${h}${d}${f}${m}`,de(u,[l.role==="alertdialog"?l2():a2()]),l.ariaLabel&&!l.ariaLabelledby?de(u,[l.ariaLabel?ti(l.ariaLabel):void 0]):Wo(u,"aria-label"),l.ariaLabelledby?de(u,[d2(l.ariaLabelledby)]):Wo(u,"aria-labelledby"),l.ariaDescribedby?de(u,[f2(l.ariaDescribedby)]):Wo(u,"aria-describedby");const w=s?` ${gi}__content--background`:"";return c.className=`${gi}__content${w}`,c.innerHTML="",typeof r=="string"?Ya(c,r):(r instanceof HTMLElement||r instanceof DocumentFragment)&&c.appendChild(r),this}showDialog(e){const{dialogElement:n}=Br(Cr,this);return n.style.display="block",e&&n.offsetHeight,Y(n,`${gi}--show`),this}hideDialog(e){const{dialogElement:n}=Br(Cr,this);return le(n,`${gi}--show`),e?n.addEventListener("transitionend",()=>{ve(n,`${gi}--show`)||(n.style.display="none")},{once:!0}):n.style.display="none",this}focusDialog(){Br(Cr,this).dialogElement.focus()}updateWidth(e){return Br(Cr,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return Br(Cr,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=Br(Cr,this))===null||e===void 0||e.dialogElement.remove(),km(Cr,this,null)}}rt(FW,bn);function Tde(t,e){VW(t,e),e.add(t)}function Lm(t,e,n){VW(t,e),e.set(t,n)}function VW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Po(t,e,n){return t.set(Rs(t,e),n),n}function yn(t,e){return t.get(Rs(t,e))}function Rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mw="dialog",_de=360,jE=mw,Qc=`plugin:${mw}`;var or=new WeakMap,yc=new WeakMap,Bc=new WeakMap,cc=new WeakMap,da=new WeakSet;class Mde extends Be{constructor(){super(...arguments),Tde(this,da),Lm(this,or,null),Lm(this,yc,!1),Lm(this,Bc,null),Lm(this,cc,null)}static get PLUGIN_KEY(){return mw}static get PLUGIN_PRIORITY(){return _de}static get DEFAULT_SETTINGS(){return{content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>ye(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[mw]}enablePlugin(){this.enabled||(yn(or,this)||(Po(or,this,new FW({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),yn(or,this).addLocalHook("clickDialogElement",()=>Rs(da,this,xde).call(this)),Po(Bc,this,oM(this.hot,yn(or,this).getDialogElement(),{onFocus:e=>{this.hot.getShortcutManager().setActiveContextName(Qc),this.hot.listen(),this.hot.runHooks("afterDialogFocus",`tab_${e}`)}}))),Rs(da,this,Pde).call(this),this.addHook("modifyFocusOnTabNavigation",e=>Rs(da,this,Ode).call(this,e),1),this.addHook("afterViewRender",()=>Rs(da,this,Nde).call(this)),this.addHook("afterListen",()=>Rs(da,this,Ade).call(this)),this.addHook("afterUnlisten",()=>Rs(da,this,Hde).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),Rs(da,this,Ide).call(this),super.disablePlugin()}isVisible(){return yn(yc,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.enabled)return;if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),yn(or,this).showDialog(this.getSetting("animation")),Po(yc,this,!0),Po(cc,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow");const{activeElement:n}=this.hot.rootDocument;(this.hot.rootWrapperElement.contains(n)||this.hot.rootPortalElement.contains(n))&&(this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(Qc),this.hot.listen(),yn(or,this).focusDialog(),this.hot.runHooks("afterDialogFocus","show"))}hide(){this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),yn(or,this).hideDialog(this.getSetting("animation")),this.hot.getShortcutManager().setActiveContextName("grid"),Po(yc,this,!1),yn(cc,this)?(this.hot.selection.importSelection(yn(cc,this)),this.hot.view.render(),Po(cc,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){this.enabled&&(this.updatePluginSettings(e),yn(or,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")}))}focus(){yn(or,this).focusDialog()}destroy(){var e;(e=yn(or,this))===null||e===void 0||e.destroyDialog(),Po(or,this,null),Po(yc,this,!1),Po(Bc,this,null),Po(cc,this,null),super.destroy()}}function Pde(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(Qc))!==null&&t!==void 0?t:e.addContext(Qc);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>yn(yc,this)&&this.getSetting("closable"),group:jE}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:r=>{this.hot._registerTimeout(()=>{const{activeElement:i}=this.hot.rootDocument;if(!yn(or,this).isInsideDialog(i)){this.hot.unlisten();return}r.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")},0)},group:jE})}function Ide(){this.hot.getShortcutManager().getContext(Qc).removeShortcutsByGroup(jE)}function Ode(t){if(this.isVisible())return yn(Bc,this).focus(t),!1}function xde(){this.isVisible()&&!this.hot.isListening()&&(this.hot.getShortcutManager().setActiveContextName(Qc),this.hot.runHooks("afterDialogFocus","click")),this.hot.listen()}function Ade(){yn(Bc,this).deactivate()}function Hde(){yn(Bc,this).activate()}function Nde(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,r=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();yn(or,this).updateWidth(r);const i=e.querySelector(".hot-display-license-info");if(i){const o=i.offsetHeight,s=parseFloat(n.getComputedStyle(i).marginTop);yn(or,this).updateHeight(o+s)}}function Dde(t){let{id:e,icon:n,title:r,description:i}=t;return`
    <div class="${zl}__content">
      <i class="${zl}__icon">${n}</i>
      <div class="${zl}__text">
        <h2 id="${e}-${eu}-title" class="${zl}__title">${r}</h2>
        ${i?`<p id="${e}-${eu}-description" class="${zl}__description">${i}</p>`:""}
      </div>
    </div>
  `}function kde(t,e){WW(t,e),e.add(t)}function Lde(t,e,n){WW(t,e),e.set(t,n)}function WW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ND(t,e,n){return t.set(uP(t,e),n),n}function zr(t,e){return t.get(uP(t,e))}function uP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eu="loading",$de=350,zl=`ht-${eu}`;var Wn=new WeakMap,DD=new WeakSet;class Fde extends Be{constructor(){super(...arguments),kde(this,DD),Lde(this,Wn,null)}static get PLUGIN_KEY(){return eu}static get PLUGIN_PRIORITY(){return $de}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${zl}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[eu]}enablePlugin(){if(!this.enabled){if(zr(Wn,this)===null){var e;ND(Wn,this,this.hot.getPlugin("dialog")),(e=zr(Wn,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>uP(DD,this,Vde).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=zr(Wn,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!zr(Wn,this)||!((e=zr(Wn,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),zr(Wn,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!zr(Wn,this)||!((e=zr(Wn,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(zr(Wn,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,r;if(!this.isEnabled()||!zr(Wn,this)||!((n=zr(Wn,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const i=this.hot.guid,o=this.getSetting("icon"),s=(r=this.getSetting("title"))!==null&&r!==void 0?r:this.hot.getTranslatedPhrase(J_),a=this.getSetting("description"),l=Dde({id:i,icon:o,title:s,description:a});zr(Wn,this).update({content:l,customClassName:zl,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${i}-${eu}-title`,ariaDescribedby:a?`${i}-${eu}-description`:void 0}})}destroy(){ND(Wn,this,null),super.destroy()}}function Vde(){zr(Wn,this).focus()}function Wde(){Fe($d),Fe(tQ),Fe(Fd),Fe(NQ),Fe(BQ),Fe(eV),Fe($J),Fe(Eee),Fe(hv),Fe(Ate),Fe(ine),Fe(dne),Fe(gv),Fe(qne),Fe(jie),Fe(boe),Fe(Koe),Fe(ase),Fe(Cse),Fe(Ose),Fe(Vse),Fe(iae),Fe(fae),Fe(Xae),Fe(Ple),Fe(Hle),Fe(oue),Fe(zue),Fe(Sce),Fe(Yce),Fe(the),Fe(mhe),Fe(Ehe),Fe(Dhe),Fe(Cde),Fe(Mde),Fe(Fde)}function Bde(){b7(),z5(),eZ(),EZ(),Wde()}function jde(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var AR,HR,NR,DR,kR;Bde();jde(Se);Se.__GhostTable=IM;Se._getListenersCounter=mq;Se._getRegisteredMapsCounter=w4;Se.EventManager=_i;const Ude=[jG,O2,n4,G5,M2,j2,GG,Nq,_2,KG,Y2,Hq],zde=[F2,G2];Se.helper={};Se.dom={};P(Ude,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});P(zde,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(AR=Se.cellTypes)!==null&&AR!==void 0?AR:{};P(_6(),t=>{Se.cellTypes[t]=iM(t)});Se.cellTypes.registerCellType=hi;Se.cellTypes.getCellType=iM;Se.editors=(HR=Se.editors)!==null&&HR!==void 0?HR:{};P(uq(),t=>{Se.editors[`${Kn(t)}Editor`]=Rp(t)});Se.editors.registerEditor=Rr;Se.editors.getEditor=Rp;Se.renderers=(NR=Se.renderers)!==null&&NR!==void 0?NR:{};P(Kq(),t=>{const e=Ep(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${Kn(t)}Renderer`]=e});Se.renderers.registerRenderer=Yr;Se.renderers.getRenderer=Ep;Se.validators=(DR=Se.validators)!==null&&DR!==void 0?DR:{};P(Qq(),t=>{Se.validators[`${Kn(t)}Validator`]=J0(t)});Se.validators.registerValidator=Bl;Se.validators.getValidator=J0;Se.plugins=(kR=Se.plugins)!==null&&kR!==void 0?kR:{};P(Q0(),t=>{Se.plugins[t]=Wf(t)});Se.plugins[`${Kn(Be.PLUGIN_KEY)}Plugin`]=Be;Se.plugins.registerPlugin=Fe;Se.plugins.getPlugin=Wf;export{Se as H,nfe as _};
