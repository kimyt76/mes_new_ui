import{b as se,s as E,a as B}from"./index-Z2YNGKhZ.js";import{s as ie}from"./index-D49h5Cbk.js";import{K as R,A as c,U as z,M as de,Z as re,W as Q,J as G,H as Y,e as W,o as K,p as e,h as a,l as n,a2 as p,G as J,a0 as x,a7 as ue,F as O,P as me,t as F,y as q}from"./index-BCdxernO.js";import{s as C}from"./index-WWuz9eST.js";import{s as Z}from"./index-DhHuXiFi.js";import{a as pe,b as ce,s as X}from"./index-CKfU0QJd.js";import{s as ee}from"./index-Dsa_8OmY.js";import{s as fe}from"./index-BE87lW_G.js";import{A as P}from"./apiCommon-DQdCmI3G.js";import{d as L,i as te,j as ye}from"./common-Ctgf_4Dl.js";import{e as ve}from"./exportToExcel-BIsrPQTg.js";import{s as be}from"./index-CEOpAmiF.js";import{_ as ge}from"./CustomerPop-BkXt7x33.js";import{I as Ve}from"./ItemListMultiPop-BS5GtrW8.js";import{_ as we}from"./StorageListPop-DUQWZ2vL.js";import{C as Ce}from"./ContractListPop-DP1BRr28.js";import{U as xe}from"./UserListPop-40qvmJxy.js";import{s as S}from"./index-BGn1OEmN.js";import"./index-CLRf2YcQ.js";import"./apiBase-DJzL_JWR.js";import"./apiItem-B0JHHkd5.js";import"./apiOrders-LBbh7QBG.js";import"./apiSystem-BBpYMteA.js";const _e={class:"grid mb-1"},he={class:"col-3 flex align-items-center gap-2"},Ne={class:"col-3"},Ue={class:"col-3"},Se={class:"grid mb-1"},Pe={class:"col-3"},De={class:"col-3"},$e={class:"col-3"},Te={class:"col-3"},ke={class:"w-full flex gap-2 ml-2 mt-4"},Ie={class:"flex items-center gap-2"},je={class:"w-full mt-2"},Le={class:"w-full flex gap-2 justify-end"},He={__name:"PurchaseTranPPop",emits:["selected","close"],setup(le,{emit:D}){const _=c(!1),H=z(),{userId:h,memberNm:$}=de(),r=D,T=c([]),k=c([]),v=c([]),I=c(!1),w=re(null),s=Q({orderDate:"",seq:1,itemTypeCd:"",srcStorageName:"",srcStorageCd:"",managerName:$,managerId:h,deliveryDate:"",customerName:"",customerCd:"",customerManager:"",userId:h}),f=()=>{},o=d=>{Array.isArray(d)&&M(d)},M=d=>{const t=d.map((m,u)=>({itemCd:m.itemCd,itemName:m.itemName,spec:m.spec,inPrice:m.inPrice}));v.value,v.value.length>0?v.value.push(...t):v.value=[...t]},j=()=>{_.value=!0},g=d=>{let t="창고 목록";d==="C"?(w.value=ge,t="거래처 목록"):d==="U"?(w.value=xe,t="사용자 목록"):d==="S"?(t="창고 목록",w.value=we):d==="T"&&(t="주문서 목록",w.value=Ce),H.open(w.value,{props:{header:t,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},onClose:m=>{m.data&&(d==="C"?(s.customerCd=m.data.customerCd,s.customerName=m.data.customerName):d==="U"?(s.managerId=m.data.userId,s.managerName=m.data.memberNm):d==="S"&&(s.srcStorageCd=m.data.storageCd,s.srcStorageName=m.data.storageName))}})};G(()=>s.orderDate,async(d,t)=>{te(t)||t!==d&&(s.seq=await P.getNextSeq("tb_mat_order","order_date",d))}),G(()=>s.vatYn,async d=>{s.vatType==="VRN"?v.value.map(t=>{t.vatPrice=0}):v.value.map(t=>{t.vatPrice=ye(t.supplyPrice)})});const V=()=>{};return Y(async()=>{T.value=await P.getCodeList("item_type_cd"),k.value=await P.getCodeList("vat_type"),s.orderDate=L(),s.deliveryDate=L()}),(d,t)=>{const m=ee,u=Z,N=ce,i=pe,A=X,oe=be,U=J,b=E,ae=B,ne=ue;return K(),W(O,null,[e(oe,{style:{width:"90rem",height:"8rem"}},{content:n(()=>[a("div",_e,[a("div",he,[e(u,{variant:"on"},{default:n(()=>[e(m,{modelValue:s.orderDate,"onUpdate:modelValue":t[0]||(t[0]=l=>s.orderDate=l),fluid:"",style:{width:"120px"}},null,8,["modelValue"]),t[16]||(t[16]=a("label",null,"구매일",-1))]),_:1}),t[18]||(t[18]=a("span",{class:"center-dash"},"-",-1)),e(u,{variant:"on"},{default:n(()=>[e(p(S),{modelValue:s.seq,"onUpdate:modelValue":t[1]||(t[1]=l=>s.seq=l),inputStyle:{width:"50px","text-align":"center"}},null,8,["modelValue"]),t[17]||(t[17]=a("label",null,"연번",-1))]),_:1})]),a("div",Ne,[e(u,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(C),{modelValue:s.srcStorageName,"onUpdate:modelValue":t[2]||(t[2]=l=>s.srcStorageName=l),class:"w-full"},null,8,["modelValue"]),e(N,{class:"pi pi-search",onClick:t[3]||(t[3]=l=>g("S"))})]),_:1}),t[19]||(t[19]=a("label",null,"입고창고",-1))]),_:1})]),a("div",Ue,[e(u,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(C),{modelValue:s.managerName,"onUpdate:modelValue":t[4]||(t[4]=l=>s.managerName=l),class:"w-full"},null,8,["modelValue"]),e(N,{class:"pi pi-search",onClick:t[5]||(t[5]=l=>g("U"))})]),_:1}),t[20]||(t[20]=a("label",null,"담당자",-1))]),_:1})])]),a("div",Se,[a("div",Pe,[e(u,{variant:"on"},{default:n(()=>[e(m,{modelValue:s.deliveryDate,"onUpdate:modelValue":t[6]||(t[6]=l=>s.deliveryDate=l),"show-icon":"",fluid:""},null,8,["modelValue"]),t[21]||(t[21]=a("label",null,"납기일",-1))]),_:1})]),a("div",De,[e(u,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(C),{modelValue:s.customerName,"onUpdate:modelValue":t[7]||(t[7]=l=>s.customerName=l),class:"w-full"},null,8,["modelValue"]),e(N,{class:"pi pi-search",onClick:t[8]||(t[8]=l=>g("C"))})]),_:1}),t[22]||(t[22]=a("label",null,"거래처",-1))]),_:1})]),a("div",$e,[e(u,{variant:"on"},{default:n(()=>[e(p(C),{modelValue:s.customerManager,"onUpdate:modelValue":t[9]||(t[9]=l=>s.customerManager=l),class:"w-full"},null,8,["modelValue"]),t[23]||(t[23]=a("label",null,"거래처담당자",-1))]),_:1})]),a("div",Te,[e(u,{variant:"on"},{default:n(()=>[e(A,{modelValue:s.vatYn,"onUpdate:modelValue":t[10]||(t[10]=l=>s.vatYn=l),options:k.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[24]||(t[24]=a("label",null,"부가세율적용",-1))]),_:1})])])]),_:1}),a("div",ke,[a("div",Ie,[e(p(se),{modelValue:I.value,"onUpdate:modelValue":t[11]||(t[11]=l=>I.value=l),name:"전체",value:"A"},null,8,["modelValue"]),t[25]||(t[25]=a("label",{for:"ingredient1"},"전체 ",-1))]),a("div",null,[e(U,{label:"주문서",onClick:t[12]||(t[12]=l=>g("T"))}),e(U,{label:"품목+",onClick:j})]),a("div",null,[e(U,{label:"품목-",onClick:V})])]),a("div",je,[e(ae,{value:v.value,selectionMode:"single",class:"my-table","show-gridlines":""},{default:n(()=>[e(b,{selectionMode:"multiple",headerStyle:"width: 3rem"}),e(b,{field:"itemCd",header:"품목코드",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(b,{field:"itemName",header:"품목명",style:x([{width:"300px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}}),e(b,{field:"spec",header:"규격",style:x([{width:"100px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(C),{modelValue:l.data.spec,"onUpdate:modelValue":y=>l.data.spec=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"orderQty",header:"수량",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(S),{modelValue:l.data.orderQty,"onUpdate:modelValue":y=>l.data.orderQty=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"inPrice",header:"단가",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(S),{modelValue:l.data.inPrice,"onUpdate:modelValue":y=>l.data.inPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"supplyPrice",header:"공급가액",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(S),{modelValue:l.data.supplyPrice,"onUpdate:modelValue":y=>l.data.supplyPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"vatPrice",header:"부가세",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(S),{modelValue:l.data.vatPrice,"onUpdate:modelValue":y=>l.data.vatPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"etc",header:"비고",style:x([{width:"200px"},{"text-align":"right"}]),pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(C),{modelValue:l.data.etc,"onUpdate:modelValue":y=>l.data.etc=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"]),a("div",Le,[e(U,{label:"저장",severity:"secondary",onClick:f}),e(U,{label:"닫기",onClick:t[13]||(t[13]=l=>r("close"))})]),e(ne,{visible:_.value,"onUpdate:visible":t[15]||(t[15]=l=>_.value=l),header:"품목 조회",modal:"true",draggable:!1,resizable:!1,style:{width:"20rem",maxWidth:"30rem"},contentStyle:{height:"38rem",overflow:"hidden"}},{default:n(()=>[e(Ve,{onSeleted:o,onClose:t[14]||(t[14]=l=>r("close"))})]),_:1},8,["visible"])])],64)}}},Me=R(He,[["__scopeId","data-v-265f664a"]]),Fe={class:"flex flex-wrap items-center gap-2 w-full"},Ae={class:"flex items-center justify-end gap-2 mb-2"},Ge=["onClick"],qe={__name:"PurchaseTranPList",setup(le){const D=c(null),_=z(),H=c([]),h=c([]);c([]);const $=c([]),r=Q({strDate:L(),toDate:L(),areaCd:null,itemTypeCd:null,itemName:"",itemCd:"",customerName:"",testState:null,passState:null}),T=f=>{let o="구매 등록";te(f)||(o="구매 상세"),_.open(Me,{props:{header:o,modal:!0,draggable:!1,resizable:!1,style:{width:"92rem",maxWidth:"120rem"},contentStyle:{height:"38rem",overflow:"hidden"}},data:f,onClose:()=>{}})},k=()=>{},v=()=>{};Y(async()=>{$.value=await P.getCodeList("AREA"),h.value=await P.getCodeList("ITEM_TYPE_CD")});const I=c({icon:"pi pi-home"}),w=c([{label:"구매관리"},{label:"구매(구매)"},{label:"구매(구매)목록"}]),s=()=>{var o;const f=((o=D.value)==null?void 0:o.columns)??[];f.length&&ve(H.value,"구매 리스트",f)};return(f,o)=>{const M=fe,j=ee,g=X,V=Z,d=C,t=J,m=ie,u=E,N=B;return K(),W(O,null,[e(M,{home:I.value,model:w.value},null,8,["home","model"]),a("form",{onSubmit:me(k,["prevent"]),class:"space-y-4"},[e(m,{class:"flex flex-wrap mt-2 mb-2 gap-1 w-full"},{start:n(()=>[a("div",Fe,[e(j,{modelValue:r.strDate,"onUpdate:modelValue":o[0]||(o[0]=i=>r.strDate=i),showIcon:"",fluid:"",iconDisplay:"input",inputId:"icondisplay",style:{width:"130px"}},null,8,["modelValue"]),e(j,{modelValue:r.toDate,"onUpdate:modelValue":o[1]||(o[1]=i=>r.toDate=i),showIcon:"",fluid:"",iconDisplay:"input",inputId:"icondisplay",style:{width:"130px"}},null,8,["modelValue"]),e(V,{variant:"on"},{default:n(()=>[e(g,{modelValue:r.areaCd,"onUpdate:modelValue":o[2]||(o[2]=i=>r.areaCd=i),options:$.value,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),o[9]||(o[9]=a("label",{for:"on_label1"},"구역(공장)",-1))]),_:1}),e(V,{variant:"on"},{default:n(()=>[e(g,{modelValue:r.itemTypeCd,"onUpdate:modelValue":o[3]||(o[3]=i=>r.itemTypeCd=i),options:h.value,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),o[10]||(o[10]=a("label",{for:"on_label1"},"품목구분",-1))]),_:1}),e(V,{variant:"on"},{default:n(()=>[e(g,{modelValue:r.passState,"onUpdate:modelValue":o[4]||(o[4]=i=>r.passState=i),options:f.passStates,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),o[11]||(o[11]=a("label",{for:"on_label1"},"진행상태",-1))]),_:1}),e(V,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:r.itemName,"onUpdate:modelValue":o[5]||(o[5]=i=>r.itemName=i),style:{width:"180px"}},null,8,["modelValue"]),o[12]||(o[12]=a("label",{for:"on_label1"},"품목명",-1))]),_:1}),e(V,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:r.itemCd,"onUpdate:modelValue":o[6]||(o[6]=i=>r.itemCd=i),style:{width:"180px"}},null,8,["modelValue"]),o[13]||(o[13]=a("label",{for:"on_label1"},"품목코드",-1))]),_:1}),e(V,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:r.customerName,"onUpdate:modelValue":o[7]||(o[7]=i=>r.customerName=i),style:{width:"180px"}},null,8,["modelValue"]),o[14]||(o[14]=a("label",{for:"on_label1"},"거래처명",-1))]),_:1}),e(t,{label:"검색",icon:"pi pi-search",type:"submit",class:"bg-blue-500 text-white hover:bg-blue-600"})])]),_:1})],32),a("div",Ae,[e(t,{label:"신규",icon:"pi pi-plus",severity:"secondary",onClick:T}),e(t,{label:"인쇄",icon:"pi pi-file-excel",onClick:v}),e(t,{label:"엑셀",icon:"pi pi-file-excel",severity:"success",onClick:s})]),a("div",null,[e(N,{ref_key:"dt",ref:D,selection:f.selectedProducts,"onUpdate:selection":o[8]||(o[8]=i=>f.selectedProducts=i),paginator:"",rows:20,rowsPerPageOptions:[20,30,40],scrollHeight:"700px",scrollable:"",showGridlines:"",tableStyle:"min-width: 100rem; table-layout: fixed;",selectionMode:"single",class:"my-table"},{default:n(()=>[e(u,{selectionMode:"multiple",headerStyle:"width: 3rem",style:{"text-align":"center"}}),e(u,{field:"tranDateSeq",header:"일자-No",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(u,{field:"customerName",header:"거래처명",style:{width:"190px"},pt:{columnHeaderContent:"justify-center"}}),e(u,{field:"itemName",header:"품목명",frozen:"",style:x([{width:"350px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:n(i=>[a("div",{onClick:A=>T(i.data.itemCd),class:"clickable-cell"},F(i.data.itemName),9,Ge)]),_:1}),e(u,{field:"sumQty",header:"수량합계",pt:{columnHeaderContent:"justify-center"},style:x([{width:"80px"},{"text-align":"right"}])},{body:n(i=>[q(F(Number(i.data.qty).sumQty()),1)]),_:1}),e(u,{field:"sumPrice",header:"금액합계",pt:{columnHeaderContent:"justify-center"},style:x([{width:"80px"},{"text-align":"right"}])},{body:n(i=>[q(F(Number(i.data.sumPrice).toLocaleString()),1)]),_:1}),e(u,{field:"testNo",header:"입고창고",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(u,{field:"unit",header:"발주구분",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(u,{field:"manaserName",header:"담당자",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["selection"])])],64)}}},mt=R(qe,[["__scopeId","data-v-b5c09e16"]]);export{mt as default};
