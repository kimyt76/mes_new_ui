import{_ as ce,r as m,B as me,p as pe,y as ve,u as fe,a as ye,k as we,m as ge,A as be,c as O,f as _e,g as t,d as c,w as o,F as T,o as x,i as R,n as F,H as ke,h as he,t as Ce,b as xe,z as Ve}from"./index-DjI8e8VZ.js";import{H as p,_ as q}from"./index-CbWiV_Pe.js";import{d as Ne,e as Ie,p as De,f as Se}from"./common-DeQ1G7iv.js";import{_ as E}from"./ItemListSinglePop-C88KYWuD.js";import{C as Oe}from"./CustomerListPop-JvGKSwu5.js";import{_ as Te}from"./UserListPop-BghcWnxN.js";import"./_commonjsHelpers-CZnAS8i4.js";import"./format-DWu4U6B8.js";import"./apiItem-slwuKuQH.js";import"./apiBase-CRBLZO_5.js";const Re=["id"],Ee={__name:"WorkOrderDetail",setup(Ue){const Q=m({weigh:null,manufacture:null,coating:null,filling:null,packing:null}),P=me(()=>["MES","ìƒì‚°ê´€ë¦¬",!!A.params.id?"ì‘ì—…ì§€ì‹œìƒì„¸":"ì‘ì—…ì§€ì‹œë“±ë¡"]);let b=m(null),V=m("");const _=m(""),U=m(!1),g=m(!1),k=ve(null),{vError:W,vSuccess:Ae,vWarning:N}=fe(),{userId:Y}=ye(),A=pe();A.params.id;const H=m([]),C=l=>{switch(V.value=l,l){case"C":k.value=Oe;break;case"U":k.value=Te;break;case"I":k.value=E;break;default:k.value=E;break}g.value=!0},z=l=>{switch(V.value){case"C":s.customerName=l.customerName,s.customerCd=l.customerCd;break;case"U":s.managerName=l.memberNm,s.managerId=l.userId;break;case"I":s.itemCd=l.itemCd,s.itemName=l.itemName;break;case"L":d[r.value]||(d[r.value]=[]),d[r.value][b.value]||(d[r.value][b.value]={});const e=d.value[r.value];e[b.value].itemCd=l.itemCd,e[b.value].itemName=l.itemName,e!=null&&e.hotInstance&&e.hotInstance.render();break}V.value="",g.value=!1},I=m(!1),s=we({workOrderDate:"",seq:0,areaCd:"",customerName:"",customerCd:"",itemName:"",itemCd:"",deliveryQty:0,userId:Y}),K=m(null),v=m([]),j=[{data:"selected",type:p.cellTypes.checkbox,width:80,className:"htCenter"},{data:"makeNo",type:p.cellTypes.text,width:200,className:"htCenter"},{data:"lotNo",type:p.cellTypes.text,width:350},{data:"lotNO2",type:p.cellTypes.text,width:350,className:"htRight"}],r=m("weigh"),L=[{label:"ì¹­ëŸ‰",code:"weigh"},{label:"ì œì¡°",code:"manufacture"},{label:"ì½”íŒ…",code:"coating"},{label:"ì¶©ì „",code:"filling"},{label:"í¬ì¥",code:"packing"}],G=["#5C6BC0","#42A5F5","#66BB6A","#FFA726","#EF5350"],d=m({weigh:[],manufacture:[],coating:[],filling:[],packing:[]}),J=()=>{try{const l={workOrderInfo:s,weigh:d.weigh,manufacture:d.manufacture,coating:d.coating,filling:d.filling,packing:d.packing}}catch{W("ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},X=({row:l,rowData:e})=>{b.value=l,r.value==="weigh"||r.value==="manufacture"?_.value="M3":r.value==="coating"?_.value="M5":r.value==="filling"?_.value="M6":r.value==="packing"&&(_.value="M0"),C("L")};p.cellTypes.text,p.cellTypes.text,p.cellTypes.text;const M=[{data:"select",title:"ì„ íƒ",renderer:$,width:30,readOnly:!0},{data:"itemCd",title:"í’ˆëª©ì½”ë“œ",type:p.cellTypes.text,width:100,readOnly:!0},{data:"itemName",title:"í’ˆëª©ëª…",type:p.cellTypes.text,width:300,readOnly:!0},{data:"workOrderDate",title:"ì§€ì‹œì¼ì",type:p.cellTypes.date,dateFormat:"YYYY-MM-DD",datePickerConfig:{firstDay:1,showWeekNumber:!1,i18n:{previousMonth:"ì´ì „ ë‹¬",nextMonth:"ë‹¤ìŒ ë‹¬",months:["1ì›”","2ì›”","3ì›”","4ì›”","5ì›”","6ì›”","7ì›”","8ì›”","9ì›”","10ì›”","11ì›”","12ì›”"],weekdays:["ì¼ìš”ì¼","ì›”ìš”ì¼","í™”ìš”ì¼","ìˆ˜ìš”ì¼","ëª©ìš”ì¼","ê¸ˆìš”ì¼","í† ìš”ì¼"],weekdaysShort:["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "]}},width:80},{data:"workQty",title:"ì§€ì‹œëŸ‰",type:"numeric",numericFormat:{pattern:"0,0"},validator:"numeric",allowInvalid:!0,width:150},{data:"workStatus",title:"ì‘ì—…ìƒíƒœ",type:"text",width:90,readonly:!0}];function $(l,e,n,u,f,i,h){const y=l.getSourceDataAtRow(n);return e.innerHTML='<button class="icon-btn">ğŸ”</button>',e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.height="100%",e.querySelector(".icon-btn").style.background="none",e.querySelector(".icon-btn").style.border="none",e.querySelector(".icon-btn").style.cursor="pointer",e.querySelector(".icon-btn").onclick=()=>{X({row:n,rowData:y})},e}p.renderers.registerRenderer("iconRenderer",$);const Z=()=>{const l={selected:!1,makeNo:"",lotNo:"",lotNo2:""};v.value.push({...l});const e={itemCd:"",itemName:"",workOrderDate:null,workQty:0,workStatus:""};Object.keys(d.value).forEach(n=>{d.value[n].push({...e})})},ee=()=>{const l=v.value.map((n,u)=>n.selected?u:-1).filter(n=>n!==-1);if(l.length===0){N("ë³µì‚¬í•  ë°°ì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}const e=l.map(n=>({...n,selected:!1,id:null}));v.value.push(...e),e.forEach((n,u)=>{Object.keys(d.value).forEach(f=>{const i=l[u],h=d.value[f][i];d.value[f].push(h?{...h}:{itemCd:"",itemName:"",workOrderDate:null,workQty:0,workStatus:""})})})},te=()=>{if(v.value.filter(e=>e.selected).length===0){N("ì·¨ì†Œí•  ë°°ì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}},ae=()=>{const l=v.value.filter(e=>e.selected);if(l.length===0){N("ì‚­ì œí•  ë°°ì¹˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.");return}l.forEach(e=>{const n=v.value.indexOf(e);n>-1&&v.value.splice(n,1),Object.keys(d.value).forEach(u=>{d.value[u].length>n&&d.value[u].splice(n,1)})})},le=()=>{v.value.forEach(l=>l.selected=I.value)},oe=l=>{const e=d.value[l];!e||!e.length||e.forEach(n=>{Object.keys(n).forEach(u=>{u==="selected"&&n[u]==="icon"||(u==="workOrderDate"?n[u]=null:typeof n[u]=="number"?n[u]=0:n[u]="")})})};return ge(async()=>{H.value=await be.getCodeList("area"),s.workOrderDate=Ne()}),(l,e)=>{const n=c("v-breadcrumbs"),u=c("v-date-input"),f=c("v-text-field"),i=c("v-col"),h=c("v-select"),y=c("v-row"),D=c("v-card-text"),ne=c("v-checkbox"),w=c("v-btn"),se=c("v-tab"),de=c("v-tabs"),re=c("v-tabs-window-item"),ue=c("v-tabs-window"),ie=c("v-card"),B=c("v-dialog");return x(),O(T,null,[_e("div",{id:l.$attrs.id},null,8,Re),t(n,{items:P.value,class:"custom-breadcrumbs"},null,8,["items"]),t(ie,null,{default:o(()=>[t(D,null,{default:o(()=>[t(y,{dense:""},{default:o(()=>[t(i,{class:"d-flex"},{default:o(()=>[t(u,{modelValue:s.workOrderDate,"onUpdate:modelValue":e[0]||(e[0]=a=>s.workOrderDate=a),label:"ì‘ì—…ì§€ì‹œì¼ì","display-format":R(Ie),density:"compact",variant:"underlined","prepend-icon":"","append-inner-icon":"mdi-calendar"},null,8,["modelValue","display-format"]),t(f,{modelValue:s.seq,"onUpdate:modelValue":e[1]||(e[1]=a=>s.seq=a),label:"ìˆœë²ˆ",density:"compact",variant:"underlined",style:{width:"30px","text-align":"right"},class:"ml-3"},null,8,["modelValue"])]),_:1}),t(i,null,{default:o(()=>[t(h,{modelValue:s.areaCd,"onUpdate:modelValue":e[2]||(e[2]=a=>s.areaCd=a),label:"êµ¬ì—­(ê³µì¥)",items:H.value,density:"compact","item-title":"codeNm","item-value":"code",variant:"underlined"},null,8,["modelValue","items"])]),_:1}),t(i,null,{default:o(()=>[t(f,{"model-value":R(Se)(s.deliveryQty),label:"ë‚©í’ˆëŸ‰",type:"number",density:"compact",variant:"underlined","control-variant":"stacked","onUpdate:modelValue":e[3]||(e[3]=a=>s.deliveryQty=R(De)(a))},null,8,["model-value"])]),_:1}),t(i,null,{default:o(()=>[t(f,{modelValue:s.managerName,"onUpdate:modelValue":e[4]||(e[4]=a=>s.managerName=a),label:"ë‹´ë‹¹ìëª…",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[5]||(e[5]=a=>C("U"))},null,8,["modelValue"])]),_:1})]),_:1}),t(y,{dense:""},{default:o(()=>[t(i,null,{default:o(()=>[t(f,{modelValue:s.customerName,"onUpdate:modelValue":e[6]||(e[6]=a=>s.customerName=a),label:"ê±°ë˜ì²˜ëª…",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[7]||(e[7]=a=>C("C"))},null,8,["modelValue"])]),_:1}),t(i,null,{default:o(()=>[t(f,{modelValue:s.itemName,"onUpdate:modelValue":e[8]||(e[8]=a=>s.itemName=a),label:"í’ˆëª©ëª…",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[9]||(e[9]=a=>C("I"))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(D,null,{default:o(()=>[t(y,{dense:""},{default:o(()=>[t(i,{class:"d-flex ga-2 justify-start mt-5"},{default:o(()=>[t(ne,{modelValue:I.value,"onUpdate:modelValue":e[10]||(e[10]=a=>I.value=a),density:"compact","hide-details":"",onChange:le},null,8,["modelValue"]),t(w,{text:"ë°°ì¹˜+",density:"compact",onClick:Z}),t(w,{text:"ë°°ì¹˜-",density:"compact",onClick:ae}),t(w,{text:"ë°°ì¹˜ë³µì‚¬",density:"compact",onClick:ee}),t(w,{text:"ë°°ì¹˜ì·¨ì†Œ",density:"compact",onClick:te})]),_:1})]),_:1}),t(y,{dense:""},{default:o(()=>[t(i,null,{default:o(()=>[t(q,{ref_key:"hotTable",ref:K,data:v.value,colHeaders:["ì„ íƒ","ì œì¡°ë²ˆí˜¸","1ì°¨í¬ì¥ Lot","2ì°¨í¬ì¥ Lot"],columns:j,stretchH:"none",height:200},null,8,["data"])]),_:1})]),_:1}),t(y,{dense:""},{default:o(()=>[t(i,null,{default:o(()=>[t(de,{modelValue:r.value,"onUpdate:modelValue":e[11]||(e[11]=a=>r.value=a),"align-tabs":"title",density:"compact"},{default:o(()=>[(x(),O(T,null,F(L,(a,S)=>t(se,{key:a.code,text:a.code,value:a.code,style:ke({backgroundColor:r.value===a.code?G[S]:"#E0E0E0",color:r.value===a.code?"white":"black",fontWeight:r.value===a.code?"bold":"normal",borderRadius:"8px",transition:"all 0.2s ease",margin:"0 4px"})},{default:o(()=>[he(Ce(a.label),1)]),_:2},1032,["text","value","style"])),64))]),_:1},8,["modelValue"]),t(ue,{modelValue:r.value,"onUpdate:modelValue":e[12]||(e[12]=a=>r.value=a),class:"mt-3"},{default:o(()=>[(x(),O(T,null,F(L,a=>t(re,{key:a.code,value:a.code,transition:!1,"reverse-transition":!1},{default:o(()=>[t(q,{ref_for:!0,ref_key:"hotTables",ref:Q,data:d.value[a.code],colHeaders:M.map(S=>S.title),columns:M,stretchH:"all",height:200},null,8,["data","colHeaders"])]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(y,{class:"justify-end mb-3 mr-2",dense:""},{default:o(()=>[t(i,{cols:"auto"},{default:o(()=>[t(w,{text:"ì €ì¥",onClick:J})]),_:1}),t(i,{cols:"auto"},{default:o(()=>[t(w,{text:"clear",onClick:e[13]||(e[13]=a=>oe(r.value))})]),_:1}),t(i,{cols:"auto"},{default:o(()=>[t(w,{text:"ìˆ˜ì •"})]),_:1}),t(i,{cols:"auto"},{default:o(()=>[t(w,{text:"ì‚­ì œ"})]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{modelValue:g.value,"onUpdate:modelValue":e[15]||(e[15]=a=>g.value=a),width:"800px",height:"800px",persistent:""},{default:o(()=>[(x(),xe(Ve(k.value),{id:l.id,type:_.value,onSelected:z,onCloseDialog:e[14]||(e[14]=a=>g.value=!1)},null,40,["id","type"]))]),_:1},8,["modelValue"]),t(B,{modelValue:U.value,"onUpdate:modelValue":e[17]||(e[17]=a=>U.value=a),width:"800px",height:"800px",persistent:""},{default:o(()=>[t(E,{onSelected:l.selectItemInfo,onCloseDialog:e[16]||(e[16]=a=>g.value=!1)},null,8,["onSelected"])]),_:1},8,["modelValue"])],64)}}},Ye=ce(Ee,[["__scopeId","data-v-c4fac6c8"]]);export{Ye as default};
