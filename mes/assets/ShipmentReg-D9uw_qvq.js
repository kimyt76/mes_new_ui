import{_ as ee,u as te,r as v,a as le,v as ae,m as oe,C as ne,n as se,c as k,f as u,g as t,d as m,w as o,i as T,F as B,e as de,o as S,j as ie,t as F,E as N,G as U,x as ue,y as me,b as re,z as pe}from"./index-BNL3Tgw5.js";import{_ as A}from"./DateSinglePicker-8DAkXH4C.js";import{_ as ce}from"./MultiFileUpload--c0CfwPP.js";import{I as ve}from"./ItemListSinglePop-B9yN6Coo.js";import{_ as fe}from"./CustomerListPop-C12lnYGL.js";import{_ as _e}from"./UserListPop-DEkQwN6k.js";import{_ as ge}from"./StorageListPop-DItQtyxf.js";import{A as R}from"./apiOrders-Whxuw2Cj.js";import{_ as ye}from"./SaleListPop-COeEt8O-.js";import{A as Ve}from"./apiCommon-LY9rUrf-.js";import"./format-CBpsKyOP.js";import"./filedownLoad-DSISiZ_u.js";import"./apiItem-CL-1bRvd.js";import"./apiBase-CSC4uJMW.js";const xe=["id"],we={class:"d-flex ga-4 justify-end"},he={class:"d-flex ga-4 justify-end"},Se=["onUpdate:modelValue","onDblclick"],Ne=["onUpdate:modelValue"],Ue=["onUpdate:modelValue","onBlur"],be=["onUpdate:modelValue"],Ce={class:"summary-row"},Ie={style:{width:"110px",height:"30px","text-align":"right","font-weight":"bold"}},ke={class:"d-flex ga-4 justify-end"},De={__name:"ShipmentReg",setup($e){const{vError:E,vSuccess:O}=te(),D=de();let r=v(""),P=v("");const{userId:z}=le(),V=v(!1),g=v(!1);let x=v("");const y=ae(null),b=v(null),$=v([]),C=v([]),i=v([]),l=oe({shipmentDate:"",seq:"",customerName:"",customerCd:"",releaseUserId:"",releaseUserName:"",descStorageCd:"",descStorageName:"",deliveryTelno:"",deliveryManagerName:"",dueDate:"",releaseTime:"",releaseType:"",accountStatement:"",address:"",attachFileId:"",saleIds:"",userId:z}),J=ne(()=>i.value.reduce((n,e)=>n+Number(e.qty||0),0)),G=[{title:"품목코드 ",key:"itemCd",align:"center",width:100},{title:"품목명",key:"itemName",align:"center",width:250},{title:"수량",key:"qty",align:"center",width:110},{title:"lot No.",key:"lotNo",align:"center",width:150}],w=n=>{switch(x.value=n,n){case"C":y.value=fe,r.value="800px",r.value="900px";break;case"U":y.value=_e,r.value="800px",r.value="900px";break;case"S":y.value=ge,r.value="800px",r.value="900px";break;default:x.value="I",b.value=n,y.value=ve,r.value="1100px",r.value="800px";break}g.value=!0},H=(n,e)=>{switch(x.value){case"C":l.customerName=e,l.customerCd=n;break;case"U":l.releaseUserName=e,l.releaseUserId=n;break;case"S":l.descStorageName=e,l.descStorageCd=n;break;case"I":if(b.value!==null){const _=i.value[b.value];_.itemCd=n,_.itemName=e}break}x.value="",g.value=!1},Q=async n=>{$.value=n,l.customerCd=n[0].customerCd,l.customerName=n[0].customerName,l.releaseUserId=n[0].managerId,l.releaseUserName=n[0].managerName,l.descStorageCd=n[0].descStorageCd,l.descStorageName=n[0].descStorageName,l.tradingMethod=n[0].tradingMethod,l.saleIds=$.value.map(e=>e.saleId).join(","),i.value=await R.getSalesItemList(l.saleIds),console.log("itemList",i.value)},W=async()=>{const n=new FormData;try{const e={...l};n.append("shipmentInfo",JSON.stringify(e)),n.append("itemList",JSON.stringify(i.value)),C.value.forEach(h=>{h.file instanceof File&&n.append("attachFile",h.file)});const _=await R.saveShipmentInfo(n);O(_),D.push({name:"ShipmentList"})}catch(e){E(e.message)}},K=()=>{V.value=!0};se(async()=>{l.seq=await Ve.getNextSeq("tb_shipment_mst","shipment_date",l.shipmentDate)});const X=()=>{D.push({name:"ShipmentList"})};return(n,e)=>{const _=m("v-breadcrumbs"),h=m("v-card-item"),p=m("v-text-field"),s=m("v-col"),f=m("v-row"),M=m("v-textarea"),q=m("v-card-text"),I=m("v-btn"),Y=m("v-data-table-virtual"),Z=m("v-form"),j=m("v-card"),L=m("v-dialog");return S(),k(B,null,[u("div",{id:n.$attrs.id},null,8,xe),t(_,{items:["MES","수주관리","출하지시서 신규"],class:"custom-breadcrumbs"}),t(j,null,{default:o(()=>[t(h,{title:"출하지시서 입력"}),t(Z,{ref:"vform",onSubmit:ie(W,["prevent"])},{default:o(()=>[t(q,null,{default:o(()=>[t(f,null,{default:o(()=>[t(s,{class:"d-flex flex-row align-center",style:{gap:"0px"}},{default:o(()=>[t(A,{modelValue:l.shipmentDate,"onUpdate:modelValue":e[0]||(e[0]=a=>l.shipmentDate=a),title:"주문일자",density:"compact",style:{width:"100px"}},null,8,["modelValue"]),t(p,{modelValue:l.seq,"onUpdate:modelValue":e[1]||(e[1]=a=>l.seq=a),label:"순번",density:"compact",style:{width:"50px","max-width":"70px","min-width":"0"},readonly:""},null,8,["modelValue"])]),_:1}),t(s),t(s,null,{default:o(()=>[u("div",we,[t(A,{modelValue:l.dueDate,"onUpdate:modelValue":e[2]||(e[2]=a=>l.dueDate=a),title:"출하예정일",density:"compact"},null,8,["modelValue"])])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.tradingMethod,"onUpdate:modelValue":e[3]||(e[3]=a=>l.tradingMethod=a),label:"거래방법",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"6"},{default:o(()=>[t(p,{modelValue:l.customerName,"onUpdate:modelValue":e[4]||(e[4]=a=>l.customerName=a),label:"거래처",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[5]||(e[5]=a=>w("C"))},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.releaseUserName,"onUpdate:modelValue":e[6]||(e[6]=a=>l.releaseUserName=a),label:"출고요청자",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[7]||(e[7]=a=>w("U"))},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.descStorageName,"onUpdate:modelValue":e[8]||(e[8]=a=>l.descStorageName=a),label:"출하창고",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[9]||(e[9]=a=>w("S"))},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,null,{default:o(()=>[t(p,{modelValue:l.deliveryTelno,"onUpdate:modelValue":e[10]||(e[10]=a=>l.deliveryTelno=a),label:"납품지연락처",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.deliveryManagerName,"onUpdate:modelValue":e[11]||(e[11]=a=>l.deliveryManagerName=a),label:"납품지담당자",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.releaseType,"onUpdate:modelValue":e[12]||(e[12]=a=>l.releaseType=a),label:"출고구분",density:"compact"},null,8,["modelValue"])]),_:1}),t(s,null,{default:o(()=>[t(p,{modelValue:l.accountStatement,"onUpdate:modelValue":e[13]||(e[13]=a=>l.accountStatement=a),label:"거래명세서",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"6"},{default:o(()=>[t(M,{modelValue:l.address,"onUpdate:modelValue":e[14]||(e[14]=a=>l.address=a),label:"납품지 주소",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),t(s,{cols:"6"},{default:o(()=>[t(M,{modelValue:l.etc,"onUpdate:modelValue":e[15]||(e[15]=a=>l.etc=a),label:"특이사항",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{dense:""},{default:o(()=>[t(s,{cols:"12"},{default:o(()=>[t(ce,{modelValue:C.value,"onUpdate:modelValue":e[16]||(e[16]=a=>C.value=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(f,null,{default:o(()=>[t(s,null,{default:o(()=>[u("div",he,[t(I,{text:"판매",density:"compact",onClick:K})])]),_:1})]),_:1}),t(f,null,{default:o(()=>[t(s,{cols:"12"},{default:o(()=>[t(Y,{headers:G,items:i.value,"item-value":"id"},{headers:o(({columns:a})=>[u("tr",null,[(S(!0),k(B,null,ue(a,d=>(S(),k("th",{key:d.key,class:"custom-header",style:me([{height:"30px"},{width:d.width+"px"}])},F(d.title),5))),128))])]),"item.itemCd":o(({item:a,index:d})=>[N(u("input",{"onUpdate:modelValue":c=>i.value[d].itemCd=c,style:{"text-align":"center",width:"100px","min-width":"100px","max-width":"100px"},class:"custom-input",onDblclick:c=>w(d)},null,40,Se),[[U,i.value[d].itemCd]])]),"item.itemName":o(({item:a,index:d})=>[N(u("input",{"onUpdate:modelValue":c=>i.value[d].itemName=c,style:{"text-align":"left",width:"250px","min-width":"250px","max-width":"250px"},class:"custom-input",readonly:""},null,8,Ne),[[U,i.value[d].itemName]])]),"item.qty":o(({item:a,index:d})=>[N(u("input",{"onUpdate:modelValue":c=>i.value[d].qty=c,type:"number",style:{"text-align":"right",width:"110px","min-width":"110px","max-width":"110px"},class:"custom-line",onBlur:c=>n.onBlur(d)},null,40,Ue),[[U,i.value[d].qty]])]),"item.lotNo":o(({item:a,index:d})=>[N(u("input",{"onUpdate:modelValue":c=>i.value[d].lotNo=c,style:{"text-align":"right",width:"110px","min-width":"110px","max-width":"110px"},class:"custom-line"},null,8,be),[[U,i.value[d].lotNo]])]),"body.append":o(()=>[u("tr",Ce,[e[21]||(e[21]=u("td",{style:{width:"100px",height:"30px"}},null,-1)),e[22]||(e[22]=u("td",{style:{width:"250px",height:"30px"}},null,-1)),u("td",Ie,F(J.value.toLocaleString()),1),e[23]||(e[23]=u("td",null,null,-1))])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),t(f,{class:"mt-2 mb-2"},{default:o(()=>[t(s,null,{default:o(()=>[u("div",ke,[t(I,{text:"저장",class:"gt-2",color:"brown-lighten-4",type:"submit"}),t(I,{text:"목록",class:"mr-3",onClick:X})])]),_:1})]),_:1})]),_:1},512)]),_:1}),t(L,{modelValue:g.value,"onUpdate:modelValue":e[18]||(e[18]=a=>g.value=a),width:T(r),height:T(P),persistent:""},{default:o(()=>[(S(),re(pe(y.value),{id:n.id,onSelected:H,onCloseDialog:e[17]||(e[17]=a=>g.value=!1)},null,40,["id"]))]),_:1},8,["modelValue","width","height"]),t(L,{modelValue:V.value,"onUpdate:modelValue":e[20]||(e[20]=a=>V.value=a),width:"1200px",height:"800px",persistent:""},{default:o(()=>[t(ye,{onSelected:Q,onCloseSaleDialog:e[19]||(e[19]=a=>V.value=!1)})]),_:1},8,["modelValue"])],64)}}},He=ee(De,[["__scopeId","data-v-9e4f5e8d"]]);export{He as default};
