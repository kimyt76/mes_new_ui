import{_ as te,u as ae,a as le,p as oe,r as _,B as ne,k as de,m as se,A as re,c as C,f as ie,g as t,d as c,w as n,F as N,o as V,i as O,n as H,H as ce,h as ue,t as me}from"./index-WOYElqRf.js";import{H as u,_ as S}from"./index-CxEtZ2a1.js";import{d as pe,e as fe,p as ve,f as ye}from"./common-DT3ZdnD0.js";import"./_commonjsHelpers-CZnAS8i4.js";import"./format-DWu4U6B8.js";const _e=["id"],we={__name:"WorkOrderDetail",setup(be){const{vError:A,vSuccess:ge,vWarning:h}=ae(),{userId:U}=le(),D=oe();D.params.id;const E=_([]),M=ne(()=>["MES","생산관리",!!D.params.id?"작업지시상세":"작업지시등록"]),k=_(!1),r=de({workOrderDate:"",seq:0,areaCd:"",customerName:"",customerCd:"",itemName:"",itemCd:"",deliveryQty:0,userId:U}),L=_(null),m=_([]),B=[{data:"selected",type:u.cellTypes.checkbox,width:80,className:"htCenter"},{data:"makeNo",type:u.cellTypes.text,width:200,className:"htCenter"},{data:"lotNo",type:u.cellTypes.text,width:350},{data:"lotNO2",type:u.cellTypes.text,width:350,className:"htRight"}],p=_("weigh"),T=[{label:"칭량",code:"weigh"},{label:"제조",code:"manufacture"},{label:"코팅",code:"coating"},{label:"충전",code:"filling"},{label:"포장",code:"packing"}],F=["#5C6BC0","#42A5F5","#66BB6A","#FFA726","#EF5350"],i=_({weigh:[],manufacture:[],coating:[],filling:[],packing:[]}),j=_({}),P=()=>{try{const l={workOrderInfo:r,weigh:i.weigh,manufacture:i.manufacture,coating:i.coating,filling:i.filling,packing:i.packing};console.log("params",l)}catch{A("저장에 실패했습니다.")}},$=l=>{alert(`팝업 호출: ${l.itemName||"새 항목"}`)};u.cellTypes.text,u.cellTypes.text,u.cellTypes.text;const I=[{data:"select",title:"선택",renderer:R,width:30,readOnly:!0},{data:"itemCd",title:"품목코드",type:u.cellTypes.text,width:100,readOnly:!0},{data:"itemName",title:"품목명",type:u.cellTypes.text,width:300,readOnly:!0},{data:"workOrderDate",title:"지시일자",type:u.cellTypes.date,dateFormat:"YYYY-MM-DD",datePickerConfig:{firstDay:1,showWeekNumber:!1,i18n:{previousMonth:"이전 달",nextMonth:"다음 달",months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],weekdaysShort:["일","월","화","수","목","금","토"]}},width:80},{data:"workQty",title:"지시량",type:"numeric",numericFormat:{pattern:"0,0"},validator:"numeric",allowInvalid:!0,width:150},{data:"workStatus",title:"작업상태",type:"text",width:90,readonly:!0}];function R(l,e,o,d,f,s,w){var b;const v=l.getSourceDataAtRow(o);return e.innerHTML=`
    <span class="v-icon notranslate mdi mdi-magnify"
        style="heigth:20px; cursor:pointer; font-size:16px; line-height:1; vertical-align:middle;">
    </span>
  `,(b=e.querySelector(".mdi-magnify"))==null||b.addEventListener("click",()=>{var g;(g=l.rootElement.__vueParentComponent)==null||g.emit("icon-click",v)}),e}u.renderers.registerRenderer("iconRenderer",R);const Q=()=>{const l={selected:!1,makeNo:"",lotNo:"",lotNo2:""};m.value.push({...l});const e={itemCd:"",itemName:"",workOrderDate:null,workQty:0,workStatus:""};Object.keys(i.value).forEach(o=>{i.value[o].push({...e})})},W=()=>{const l=m.value.filter(o=>o.selected);if(l.length===0){h("복사할 배치를 선택하세요.");return}const e=l.map(o=>({...o,selected:!1,id:null}));m.value.push(...e),e.forEach(()=>{const o={selected:!1,makeNo:"",lotNo:"",lotNo2:""};Object.keys(i.value).forEach(d=>{i.value[d].push({...o})})})},q=()=>{if(m.value.filter(e=>e.selected).length===0){h("취소할 배치를 선택하세요.");return}},Y=()=>{const l=m.value.filter(e=>e.selected);if(l.length===0){h("삭제할 배치를 선택하세요.");return}l.forEach(e=>{const o=m.value.indexOf(e);o>-1&&m.value.splice(o,1),Object.keys(i.value).forEach(d=>{i.value[d].length>o&&i.value[d].splice(o,1)})})},z=()=>{m.value.forEach(l=>l.selected=k.value)},K=l=>{const e=i.value[l];!e||!e.length||e.forEach(o=>{Object.keys(o).forEach(d=>{d==="selected"&&o[d]==="icon"||(d==="workOrderDate"?o[d]=null:typeof o[d]=="number"?o[d]=0:o[d]="")})})};return se(async()=>{E.value=await re.getCodeList("area"),r.workOrderDate=pe(),Object.keys(i.value).forEach(l=>{var o,d;const e=(d=(o=j.value[l])==null?void 0:o.hotInstance)==null?void 0:d.hotInstance;e&&e.addHook("afterOnCellMouseDown",(f,s)=>{if(f.detail===2){const w=e.getCellMeta(s.row,s.col);w.data==="itemCd"&&onCellDblClick(l,{row:s.row,prop:w.data})}})})}),(l,e)=>{const o=c("v-breadcrumbs"),d=c("v-date-input"),f=c("v-text-field"),s=c("v-col"),w=c("v-select"),v=c("v-row"),b=c("v-card-text"),g=c("v-checkbox"),y=c("v-btn"),G=c("v-tab"),J=c("v-tabs"),X=c("v-tabs-window-item"),Z=c("v-tabs-window"),ee=c("v-card");return V(),C(N,null,[ie("div",{id:l.$attrs.id},null,8,_e),t(o,{items:M.value,class:"custom-breadcrumbs"},null,8,["items"]),t(ee,null,{default:n(()=>[t(b,null,{default:n(()=>[t(v,{dense:""},{default:n(()=>[t(s,{class:"d-flex"},{default:n(()=>[t(d,{modelValue:r.workOrderDate,"onUpdate:modelValue":e[0]||(e[0]=a=>r.workOrderDate=a),label:"작업지시일자","display-format":O(fe),density:"compact",variant:"underlined","prepend-icon":"","append-inner-icon":"mdi-calendar"},null,8,["modelValue","display-format"]),t(f,{modelValue:r.seq,"onUpdate:modelValue":e[1]||(e[1]=a=>r.seq=a),label:"순번",density:"compact",variant:"underlined",style:{width:"30px","text-align":"right"},class:"ml-3"},null,8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(w,{modelValue:r.areaCd,"onUpdate:modelValue":e[2]||(e[2]=a=>r.areaCd=a),label:"구역(공장)",items:E.value,density:"compact","item-title":"codeNm","item-value":"code",variant:"underlined"},null,8,["modelValue","items"])]),_:1}),t(s,null,{default:n(()=>[t(f,{"model-value":O(ye)(r.deliveryQty),label:"납품량",type:"number",density:"compact",variant:"underlined","control-variant":"stacked","onUpdate:modelValue":e[3]||(e[3]=a=>r.deliveryQty=O(ve)(a))},null,8,["model-value"])]),_:1}),t(s,null,{default:n(()=>[t(f,{modelValue:r.managerName,"onUpdate:modelValue":e[4]||(e[4]=a=>r.managerName=a),label:"담당자명",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[5]||(e[5]=a=>l.callPop("U"))},null,8,["modelValue"])]),_:1})]),_:1}),t(v,{dense:""},{default:n(()=>[t(s,null,{default:n(()=>[t(f,{modelValue:r.customerName,"onUpdate:modelValue":e[6]||(e[6]=a=>r.customerName=a),label:"거래처명",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[7]||(e[7]=a=>l.callPop("C"))},null,8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(f,{modelValue:r.itemName,"onUpdate:modelValue":e[8]||(e[8]=a=>r.itemName=a),label:"품목명",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":e[9]||(e[9]=a=>l.callPop("I"))},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(b,null,{default:n(()=>[t(v,{dense:""},{default:n(()=>[t(s,{class:"d-flex ga-2 justify-start mt-5"},{default:n(()=>[t(g,{modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=a=>k.value=a),density:"compact","hide-details":"",onChange:z},null,8,["modelValue"]),t(y,{text:"배치+",density:"compact",onClick:Q}),t(y,{text:"배치-",density:"compact",onClick:Y}),t(y,{text:"배치복사",density:"compact",onClick:W}),t(y,{text:"배치취소",density:"compact",onClick:q})]),_:1})]),_:1}),t(v,{dense:""},{default:n(()=>[t(s,null,{default:n(()=>[t(S,{ref_key:"hotTable",ref:L,data:m.value,colHeaders:["선택","제조번호","1차포장 Lot","2차포장 Lot"],columns:B,stretchH:"none",height:200},null,8,["data"])]),_:1})]),_:1}),t(v,{dense:""},{default:n(()=>[t(s,null,{default:n(()=>[t(J,{modelValue:p.value,"onUpdate:modelValue":e[11]||(e[11]=a=>p.value=a),"align-tabs":"title",density:"compact"},{default:n(()=>[(V(),C(N,null,H(T,(a,x)=>t(G,{key:a.code,text:a.code,value:a.code,style:ce({backgroundColor:p.value===a.code?F[x]:"#E0E0E0",color:p.value===a.code?"white":"black",fontWeight:p.value===a.code?"bold":"normal",borderRadius:"8px",transition:"all 0.2s ease",margin:"0 4px"})},{default:n(()=>[ue(me(a.label),1)]),_:2},1032,["text","value","style"])),64))]),_:1},8,["modelValue"]),t(Z,{modelValue:p.value,"onUpdate:modelValue":e[12]||(e[12]=a=>p.value=a),class:"mt-3"},{default:n(()=>[(V(),C(N,null,H(T,a=>t(X,{key:a.code,value:a.code,transition:!1,"reverse-transition":!1},{default:n(()=>[t(S,{ref_for:!0,ref:"hotTables",data:i.value[a.code],colHeaders:I.map(x=>x.title),columns:I,stretchH:"all",height:200,onIconClick:$},null,8,["data","colHeaders"])]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(v,{class:"justify-end mb-3 mr-2",dense:""},{default:n(()=>[t(s,{cols:"auto"},{default:n(()=>[t(y,{text:"저장",onClick:P})]),_:1}),t(s,{cols:"auto"},{default:n(()=>[t(y,{text:"clear",onClick:e[13]||(e[13]=a=>K(p.value))})]),_:1}),t(s,{cols:"auto"},{default:n(()=>[t(y,{text:"수정"})]),_:1}),t(s,{cols:"auto"},{default:n(()=>[t(y,{text:"삭제"})]),_:1})]),_:1})]),_:1})]),_:1})],64)}}},Ve=te(we,[["__scopeId","data-v-6b18d97b"]]);export{Ve as default};
