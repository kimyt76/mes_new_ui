import{_ as W,r,a as K,u as q,k as H,m as J,A as M,d as s,b as O,o as k,w as o,g as e,s as Q,c as D,F as Y,j as X,f as j,t as z,n as Z}from"./index-DbwVXjcr.js";import{A as S}from"./apiBase--1t-TlkM.js";import{e as h}from"./exportToExcel-Kkbtezxo.js";import{_ as ee}from"./UserListPop-C1yrHg2z.js";import{l as te}from"./lodash-DR4aaNSv.js";import"./_commonjsHelpers-CZnAS8i4.js";const le={__name:"CustomerDetailPop",props:{title:{type:String},id:{type:String},mode:{type:String}},emits:["saved","close-dialog"],setup(F,{emit:E}){const y=r(!1),{userId:f,memberNm:b}=K(),{vError:x,vInfo:w,vWarning:N}=q(),_=E,v=F,g=r([]),i=r([]),C=r([]),t=H({customerType:"",customerCd:"",customerName:"",memberCd:"",memberName:"",businessItem:"",businessType:"",president:"",tel:"",fax:"",presidentTel:"",email:"",customerManager:"",customerManagerTel:"",zipCode:"",address:"",tradingMethod:"",customerGrp1:"",customerGrp2:"",searchText:"",memo:"",userId:f}),T=async()=>{try{const d={...t},l=await S.saveCustomerInfo(d);_("saved",l),_("close-dialog")}catch(d){x(d.message)}};J(async()=>{if(g.value=await M.getCodeList("CUSTOMER_TYPE"),i.value=await M.getCodeList("CUSTOMER_GRP1"),C.value=await M.getCodeList("CUSTOMER_GRP2"),v.mode==="U"){const d=await S.getCustomerInfo(v.id);Object.assign(t,d)}else t.memberName=b,t.memberCd=f});const I=d=>{t.memberCd=d.userId,t.memberName=d.memberNm},G=async()=>{await S.getCheckCustomerCd(t.customerCd)==="N"?w("사용할 수 있는 번호입니다."):(N("사용할 수 없는 번호입니다."),t.customerCd="")},c=()=>{y.value=!0};return(d,l)=>{const L=s("v-card-item"),V=s("v-select"),n=s("v-col"),u=s("v-text-field"),U=s("v-btn"),p=s("v-row"),P=s("v-form"),$=s("v-card-text"),A=s("v-spacer"),B=s("v-card-actions"),R=s("v-dialog"),m=s("v-card");return k(),O(m,null,{default:o(()=>[e(L,{title:v.title},null,8,["title"]),e($,null,{default:o(()=>[e(P,{ref:"vform"},{default:o(()=>[e(p,{class:"mt-3"},{default:o(()=>[e(n,null,{default:o(()=>[e(V,{modelValue:t.customerType,"onUpdate:modelValue":l[0]||(l[0]=a=>t.customerType=a),label:"거래처구분",items:g.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.customerCd,"onUpdate:modelValue":l[1]||(l[1]=a=>t.customerCd=a),label:"사업자번호",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[v.mode==="N"?(k(),O(U,{key:0,text:"중복확인",onClick:G})):Q("",!0)]),_:1}),e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:t.customerName,"onUpdate:modelValue":l[2]||(l[2]=a=>t.customerName=a),label:"상호명",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,null,{default:o(()=>[e(u,{modelValue:t.memberName,"onUpdate:modelValue":l[3]||(l[3]=a=>t.memberName=a),label:"담당자",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":c},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.businessType,"onUpdate:modelValue":l[4]||(l[4]=a=>t.businessType=a),label:"업태",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.businessItem,"onUpdate:modelValue":l[5]||(l[5]=a=>t.businessItem=a),label:"종목",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.president,"onUpdate:modelValue":l[6]||(l[6]=a=>t.president=a),label:"대표자명",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,null,{default:o(()=>[e(u,{modelValue:t.tel,"onUpdate:modelValue":l[7]||(l[7]=a=>t.tel=a),label:"전화",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.fax,"onUpdate:modelValue":l[8]||(l[8]=a=>t.fax=a),label:"팩스",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.presidentTel,"onUpdate:modelValue":l[9]||(l[9]=a=>t.presidentTel=a),label:"휴대폰",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(u,{modelValue:t.email,"onUpdate:modelValue":l[10]||(l[10]=a=>t.email=a),label:"이메일",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:t.customerManager,"onUpdate:modelValue":l[11]||(l[11]=a=>t.customerManager=a),label:"거래처담당자",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:t.customerManagerTel,"onUpdate:modelValue":l[12]||(l[12]=a=>t.customerManagerTel=a),label:"담당자핸드폰",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,null,{default:o(()=>[e(V,{modelValue:t.customerGrp1,"onUpdate:modelValue":l[13]||(l[13]=a=>t.customerGrp1=a),label:"그룹유형1",items:i.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1}),e(n,null,{default:o(()=>[e(V,{modelValue:t.customerGrp2,"onUpdate:modelValue":l[14]||(l[14]=a=>t.customerGrp2=a),label:"그룹유형2",items:C.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact"},null,8,["modelValue","items"])]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:t.zipCode,"onUpdate:modelValue":l[15]||(l[15]=a=>t.zipCode=a),label:"우편번호",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:t.tradingMethod,"onUpdate:modelValue":l[16]||(l[16]=a=>t.tradingMethod=a),label:"거래방법",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:t.address,"onUpdate:modelValue":l[17]||(l[17]=a=>t.address=a),label:"주소",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:t.searchText,"onUpdate:modelValue":l[18]||(l[18]=a=>t.searchText=a),label:"검색창내용",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:t.memo,"onUpdate:modelValue":l[19]||(l[19]=a=>t.memo=a),label:"비고",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(B,null,{default:o(()=>[e(A),e(U,{color:"indigo-darken-4",text:"저장",variant:"tonal",depressed:"",onClick:T}),e(U,{text:"닫기",variant:"tonal",onClick:l[20]||(l[20]=a=>_("close-dialog"))})]),_:1}),e(R,{modelValue:y.value,"onUpdate:modelValue":l[22]||(l[22]=a=>y.value=a),height:"800",width:"900px",persistent:""},{default:o(()=>[e(ee,{onSelected:I,onCloseDialog:l[21]||(l[21]=a=>y.value=!1)})]),_:1},8,["modelValue"])]),_:1})}}},ae=W(le,[["__scopeId","data-v-1a737e10"]]),oe=["onClick"],ne={__name:"CustomerList",setup(F){const{vError:E,vSuccess:y}=q(),f=r(!1),b=r(!1),x=r([]),w=r([]),N=r(""),_=r(""),v=r(""),g=r(""),i=H({customerType:"",customerCd:"",customerName:"",customerManager:""}),C=r([{title:"구분",key:"customerTypeName",align:"center",width:"60px"},{title:"거래처명",key:"customerName",align:"left",width:"280px"},{title:"주소",key:"address",align:"left",width:"250px"},{title:"대표자명",key:"president",align:"center",width:"70px"},{title:"사업자번호",key:"businessNo",align:"center",width:"120px"},{title:"전화번호",key:"tel",align:"center",width:"120px"},{title:"거래처담당자",key:"customerManager",align:"center",width:"90px"},{title:"이메일",key:"email",align:"center",width:"90px"},{title:"핸드폰번호",key:"customerManagerTel",align:"center",width:"120px"},{title:"담당자명",key:"memberName",align:"center",width:"70px"}]);J(async()=>{w.value=await M.getCodeList("CUSTOMER_TYPE"),t()});const t=async()=>{b.value=!0;try{const c={...i};x.value=await S.getCustomerList(c)}catch(c){E("조회 실패 : "+c.message)}finally{b.value=!1}},T=c=>{te.isEmpty(c)?(g.value="거래처 신규",_.value="N",v.value=""):(g.value="거래처 상세",_.value="U",v.value=c.customerCd),f.value=!0},I=c=>{y(c),t()},G=()=>{h(C,x.value,"거래처_목록")};return(c,d)=>{const l=s("v-breadcrumbs"),L=s("v-select"),V=s("v-text-field"),n=s("v-btn"),u=s("v-col"),U=s("v-form"),p=s("v-row"),P=s("v-card-text"),$=s("v-card"),A=s("v-spacer"),B=s("v-data-table"),R=s("v-dialog");return k(),D(Y,null,[e(l,{items:["MES","기본관리","거래처관리"],class:"custom-breadcrumbs"}),e($,{class:"pa-1",style:{height:"60px"}},{default:o(()=>[e(P,null,{default:o(()=>[e(p,null,{default:o(()=>[e(U,{ref_key:"srhForm",ref:N,onSubmit:X(t,["prevent"])},{default:o(()=>[e(u,{class:"d-flex ga-4"},{default:o(()=>[e(L,{modelValue:i.customerType,"onUpdate:modelValue":d[0]||(d[0]=m=>i.customerType=m),label:"거래처구분",items:w.value,"item-title":"codeNm","item-value":"code",variant:"underlined",density:"compact",style:{width:"130px"}},null,8,["modelValue","items"]),e(V,{modelValue:i.customerName,"onUpdate:modelValue":d[1]||(d[1]=m=>i.customerName=m),density:"compact",label:"거래처명",placeholder:"거래처명 입력해주세요",variant:"underlined",style:{width:"180px"}},null,8,["modelValue"]),e(V,{modelValue:i.customerCd,"onUpdate:modelValue":d[2]||(d[2]=m=>i.customerCd=m),density:"compact",label:"거래처코드",placeholder:"거래처코드를 입력해주세요",variant:"underlined",style:{width:"150px"}},null,8,["modelValue"]),e(V,{modelValue:i.customerManager,"onUpdate:modelValue":d[3]||(d[3]=m=>i.customerManager=m),density:"compact",label:"거래처담당자",placeholder:"거래처담당자를 입력해주세요",variant:"underlined",style:{width:"120px"}},null,8,["modelValue"]),e(n,{color:"#EFEBE9",type:"submit",text:"조회"}),e(n,{class:"mr-2",text:"초기화",onClick:d[4]||(d[4]=m=>N.value.reset())})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}),e(A),e(p,null,{default:o(()=>[e(u,{class:"d-flex justify-end align-center mr-2",style:{gap:"10px","margin-top":"10px"}},{default:o(()=>[e(n,{color:"brown-lighten-4",text:"신규",onClick:T}),e(n,{class:"excel-btn",text:"엑셀","prepend-icon":"mdi-microsoft-excel",onClick:G})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(u,{class:"pa-0"},{default:o(()=>[e(B,{headers:C.value,items:x.value,loading:b.value,"items-per-page":15,density:"compact","fixed-header":"",height:"650px","return-object":""},{headers:o(({columns:m})=>[j("tr",null,[(k(!0),D(Y,null,Z(m,a=>(k(),D("th",{key:a.key,class:"custom-header pa-1"},z(a.title),1))),128))])]),"item.customerName":o(({item:m,index:a})=>[j("div",{style:{cursor:"pointer","text-decoration":"underline"},onClick:de=>T(m,a)},z(m.customerName),9,oe)]),_:1},8,["headers","items","loading"])]),_:1})]),_:1}),e(R,{modelValue:f.value,"onUpdate:modelValue":d[6]||(d[6]=m=>f.value=m),"max-width":"900px","max-height":"800px",persistent:""},{default:o(()=>[e(ae,{id:v.value,mode:_.value,title:g.value,onSaved:I,onCloseDialog:d[5]||(d[5]=m=>f.value=!1)},null,8,["id","mode","title"])]),_:1},8,["modelValue"])],64)}}},pe=W(ne,[["__scopeId","data-v-38239eaa"]]);export{pe as default};
