import{_ as H,a as J,u as K,p as Q,r as w,x as W,k as X,m as Y,c as Z,f as y,g as e,d,w as a,F as j,e as ee,o as x,j as te,i as V,h as ne,B as I,C as k,b as ae,y as le}from"./index-DbwVXjcr.js";import{A as b}from"./apiLab-DS60JKzK.js";import{i as oe,p as ie,f as se}from"./common-BCog4hmn.js";import{_ as de}from"./IngredientListPop-CVFOAoIz.js";import{C as re}from"./CustomerListPop-CqvL_Sl6.js";import{_ as me}from"./ItemListSinglePop-DNLS70X5.js";import"./format-CBpsKyOP.js";import"./apiBase--1t-TlkM.js";import"./apiItem-BapmxV41.js";const ue=["id"],ce=["onUpdate:modelValue"],pe=["onUpdate:modelValue"],ve={__name:"NewMaterialDetail",setup(fe){const{userId:M}=J(),{vError:h,vSuccess:U,vInfo:_e}=K(),P=Q(),L=ee(),N=P.params.id,p=w(!1),v=w(""),f=W(null),s=w([]),o=X({newMaterialCd:"",itemCd:"",itemName:"",materialName:"",inPrice:"",customerCd:"",customerName:"",mtrName:"",userId:M}),$=[{title:"성분코드",key:"ingredientCode",align:"center",width:"90px"},{title:"국문성분명",key:"krIngredientName",align:"start",width:"230px"},{title:"영어성분명",key:"enIngredientName",align:"start",width:"230px"},{title:"국내함량",key:"inContent",align:"center",width:"100px"},{title:"수출용함량",key:"outContent",align:"center",width:"100px"},{title:"CAS No",key:"casNo",align:"center",width:"90px"},{title:"function",key:"functionNm",align:"center",width:"90px"},{title:"한도 국가",key:"limitCountry",align:"center",width:"90px"},{title:"금지 국가",key:"banCountry",align:"center",width:"90px"},{title:"-",key:"actions",align:"center",width:"10px"}],A=async()=>{try{const n={newMaterialInfo:o,materialMappingList:s.value},t=await b.saveNewMaterialInfo(n);o.newMaterialCd=t.data.newMaterialCd,U("저장되었습니다.")}catch{h("저장에 실패했습니다.")}},_=n=>{v.value=n,n==="I"?f.value=de:n==="C"?f.value=re:n==="P"&&(f.value=me),p.value=!0},S=n=>{v.value==="C"?(o.customerCd=n.customerCd,o.customerName=n.customerName):v.value==="P"?(o.itemCd=n.itemCd,o.itemName=n.itemName):v.value==="I"&&B(n)},B=n=>{if(!Array.isArray(n))return;let t=s.value.length;const m=n.map((i,r)=>({id:t++,ingredientCode:i.ingredientCode,krIngredientName:i.krIngredientName,enIngredientName:i.enIngredientName,inContent:"",outContent:"",casNo:i.casNo,functionNm:i.functionNm,limitCountry:i.limitCountry,banCountry:i.banCountry}));s.value.length>0?s.value.push(...m):s.value=[...m]},D=n=>{const t=s.value.findIndex(m=>m.ingredientCode===n);s.value.splice(t,1)};Y(async()=>{if(!oe(N)){const n=await b.getNewMaterialInfo(N);Object.assign(o,n.newMaterialInfo),s.value=n.materialMappingList}});const E=()=>{L.push({name:"NewMaterialList"})};return(n,t)=>{const m=d("v-breadcrumbs"),i=d("v-text-field"),r=d("v-col"),c=d("v-row"),R=d("v-card-subtitle"),C=d("v-btn"),F=d("v-icon"),T=d("v-data-table-virtual"),z=d("v-form"),O=d("v-card-text"),q=d("v-card"),G=d("v-dialog");return x(),Z(j,null,[y("div",{id:n.$attrs.id},null,8,ue),e(m,{items:["MES","연구관리","신 원료상세"]}),e(q,null,{default:a(()=>[e(O,null,{default:a(()=>[e(z,{onSubmit:te(A,["prevent"])},{default:a(()=>[e(c,null,{default:a(()=>[e(r,null,{default:a(()=>[e(i,{modelValue:o.newMaterialCd,"onUpdate:modelValue":t[0]||(t[0]=l=>o.newMaterialCd=l),label:"임시코드",variant:"underlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(i,{modelValue:o.materialName,"onUpdate:modelValue":t[1]||(t[1]=l=>o.materialName=l),label:"원료명",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(i,{"model-value":V(se)(o.inPrice),label:"입고단가",variant:"underlined",density:"compact","onUpdate:modelValue":t[2]||(t[2]=l=>o.inPrice=V(ie)(l))},null,8,["model-value"])]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(r,null,{default:a(()=>[e(i,{modelValue:o.mtrName,"onUpdate:modelValue":t[3]||(t[3]=l=>o.mtrName=l),label:"제조원",variant:"underlined",density:"compact"},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(i,{modelValue:o.customerName,"onUpdate:modelValue":t[4]||(t[4]=l=>o.customerName=l),label:"거래처",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":t[5]||(t[5]=l=>_("C"))},null,8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(i,{modelValue:o.itemCd,"onUpdate:modelValue":t[6]||(t[6]=l=>o.itemCd=l),label:"품목코드",variant:"underlined",density:"compact","append-inner-icon":"mdi-magnify","onClick:appendInner":t[7]||(t[7]=l=>_("P"))},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{class:"mt-4"},{default:a(()=>[e(r,{class:"mt-3"},{default:a(()=>[e(R,null,{default:a(()=>t[11]||(t[11]=[ne(" - 성분코드 ")])),_:1})]),_:1}),e(r,{class:"d-flex justify-end"},{default:a(()=>[e(C,{color:"brown-lighten-4",class:"mt-3",text:"추가+",density:"compact",onClick:t[8]||(t[8]=l=>_("I"))})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(T,{headers:$,items:s.value,class:"custom-table"},{"item.inContent":a(({item:l,index:u})=>[I(y("input",{"onUpdate:modelValue":g=>s.value[u].inContent=g,style:{"text-align":"right",width:"90%",height:"30px"},density:"compact",class:"custom-line"},null,8,ce),[[k,s.value[u].inContent]])]),"item.outContent":a(({item:l,index:u})=>[I(y("input",{"onUpdate:modelValue":g=>s.value[u].outContent=g,style:{"text-align":"right",width:"90%",height:"30px"},class:"custom-line"},null,8,pe),[[k,s.value[u].outContent]])]),"item.actions":a(({item:l})=>[e(F,{color:"medium-emphasis",icon:"mdi-delete",size:"small",onClick:u=>D(l.ingredientCode)},null,8,["onClick"])]),_:1},8,["items"])]),_:1}),e(c,null,{default:a(()=>[e(r,{class:"d-flex justify-end mt-3 ga-3"},{default:a(()=>[e(C,{text:"저장",color:"brown-lighten-4",type:"submit"}),e(C,{text:"목록",onClick:E})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(G,{modelValue:p.value,"onUpdate:modelValue":t[10]||(t[10]=l=>p.value=l),width:"800px",height:"800px",persistent:""},{default:a(()=>[(x(),ae(le(f.value),{id:n.id,onSelected:S,onCloseDialog:t[9]||(t[9]=l=>p.value=!1)},null,40,["id"]))]),_:1},8,["modelValue"])],64)}}},be=H(ve,[["__scopeId","data-v-4dd96297"]]);export{be as default};
