import{b as se,s as q,a as E}from"./index-Z2YNGKhZ.js";import{s as ie}from"./index-D49h5Cbk.js";import{K as B,A as c,U as z,V as de,M as re,Z as ue,W as Q,J as G,H as Y,e as K,o as W,p as e,h as o,l as n,a2 as p,G as J,a0 as _,a7 as me,F as O,P as pe,t as F,y as R}from"./index-BCdxernO.js";import{s as w}from"./index-WWuz9eST.js";import{s as Z}from"./index-DhHuXiFi.js";import{a as ce,b as fe,s as X}from"./index-CKfU0QJd.js";import{s as ee}from"./index-Dsa_8OmY.js";import{s as ye}from"./index-BE87lW_G.js";import{A as P}from"./apiCommon-DQdCmI3G.js";import{d as I,i as te,j as ve}from"./common-Ctgf_4Dl.js";import{e as be}from"./exportToExcel-BIsrPQTg.js";import{s as ge}from"./index-CEOpAmiF.js";import{_ as Ve}from"./CustomerPop-BkXt7x33.js";import{I as we}from"./ItemListMultiPop-BS5GtrW8.js";import{_ as xe}from"./StorageListPop-DUQWZ2vL.js";import{U as Ce}from"./UserListPop-40qvmJxy.js";import{s as D}from"./index-BGn1OEmN.js";import"./index-CLRf2YcQ.js";import"./apiBase-DJzL_JWR.js";import"./apiItem-B0JHHkd5.js";import"./apiSystem-BBpYMteA.js";const _e={class:"grid mb-1"},he={class:"col-3 flex align-items-center gap-2"},Ne={class:"col-3"},Ue={class:"col-3"},Se={class:"grid mb-1"},De={class:"col-3"},Pe={class:"col-3"},$e={class:"col-3"},ke={class:"col-3"},Te={class:"w-full flex gap-2 ml-2 mt-4"},Ie={class:"flex items-center gap-2"},je={class:"w-full mt-2"},He={class:"w-full flex gap-2 justify-end"},Le={__name:"PurchaseTranMPop",setup(le){const V=c(!1),j=z(),H=de("dialogRef"),{userId:h,memberNm:$}=re(),u=c([]),N=c([]),v=c([]),k=c(!1),x=ue(null),s=Q({orderDate:"",seq:1,itemTypeCd:"",srcStorageName:"",srcStorageCd:"",managerName:$,managerId:h,deliveryDate:"",customerName:"",customerCd:"",customerManager:"",userId:h}),L=()=>{},f=d=>{Array.isArray(d)&&a(d)},a=d=>{const t=d.map((m,r)=>({itemCd:m.itemCd,itemName:m.itemName,spec:m.spec,inPrice:m.inPrice}));v.value,v.value.length>0?v.value.push(...t):v.value=[...t]},M=()=>{V.value=!0},C=d=>{let t="창고 목록";d==="C"?(x.value=Ve,t="거래처 목록"):d==="U"?(x.value=Ce,t="사용자 목록"):d==="S"&&(x.value=xe),j.open(x.value,{props:{header:t,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},onClose:m=>{m.data&&(d==="C"?(s.customerCd=m.data.customerCd,s.customerName=m.data.customerName):d==="U"?(s.managerId=m.data.userId,s.managerName=m.data.memberNm):d==="S"&&(s.srcStorageCd=m.data.storageCd,s.srcStorageName=m.data.storageName))}})};G(()=>s.orderDate,async(d,t)=>{te(t)||t!==d&&(s.seq=await P.getNextSeq("tb_mat_order","order_date",d))}),G(()=>s.vatYn,async d=>{s.vatType==="VRN"?v.value.map(t=>{t.vatPrice=0}):v.value.map(t=>{t.vatPrice=ve(t.supplyPrice)})});const U=()=>{};Y(async()=>{u.value=await P.getCodeList("item_type_cd"),N.value=await P.getCodeList("vat_type"),s.orderDate=I(),s.deliveryDate=I()});const g=()=>{H.value.close()};return(d,t)=>{const m=ee,r=Z,S=fe,i=ce,A=X,ae=ge,T=J,b=q,oe=E,ne=me;return W(),K(O,null,[e(ae,{style:{width:"90rem",height:"8rem"}},{content:n(()=>[o("div",_e,[o("div",he,[e(r,{variant:"on"},{default:n(()=>[e(m,{modelValue:s.orderDate,"onUpdate:modelValue":t[0]||(t[0]=l=>s.orderDate=l),fluid:"",style:{width:"120px"}},null,8,["modelValue"]),t[14]||(t[14]=o("label",null,"구매일",-1))]),_:1}),t[16]||(t[16]=o("span",{class:"center-dash"},"-",-1)),e(r,{variant:"on"},{default:n(()=>[e(p(D),{modelValue:s.seq,"onUpdate:modelValue":t[1]||(t[1]=l=>s.seq=l),inputStyle:{width:"50px","text-align":"center"}},null,8,["modelValue"]),t[15]||(t[15]=o("label",null,"연번",-1))]),_:1})]),o("div",Ne,[e(r,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(w),{modelValue:s.srcStorageName,"onUpdate:modelValue":t[2]||(t[2]=l=>s.srcStorageName=l),class:"w-full"},null,8,["modelValue"]),e(S,{class:"pi pi-search",onClick:t[3]||(t[3]=l=>C("S"))})]),_:1}),t[17]||(t[17]=o("label",null,"입고창고",-1))]),_:1})]),o("div",Ue,[e(r,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(w),{modelValue:s.managerName,"onUpdate:modelValue":t[4]||(t[4]=l=>s.managerName=l),class:"w-full"},null,8,["modelValue"]),e(S,{class:"pi pi-search",onClick:t[5]||(t[5]=l=>C("U"))})]),_:1}),t[18]||(t[18]=o("label",null,"담당자",-1))]),_:1})])]),o("div",Se,[o("div",De,[e(r,{variant:"on"},{default:n(()=>[e(m,{modelValue:s.deliveryDate,"onUpdate:modelValue":t[6]||(t[6]=l=>s.deliveryDate=l),"show-icon":"",fluid:""},null,8,["modelValue"]),t[19]||(t[19]=o("label",null,"납기일",-1))]),_:1})]),o("div",Pe,[e(r,{variant:"on"},{default:n(()=>[e(i,{iconPosition:"left"},{default:n(()=>[e(p(w),{modelValue:s.customerName,"onUpdate:modelValue":t[7]||(t[7]=l=>s.customerName=l),class:"w-full"},null,8,["modelValue"]),e(S,{class:"pi pi-search",onClick:t[8]||(t[8]=l=>C("C"))})]),_:1}),t[20]||(t[20]=o("label",null,"거래처",-1))]),_:1})]),o("div",$e,[e(r,{variant:"on"},{default:n(()=>[e(p(w),{modelValue:s.customerManager,"onUpdate:modelValue":t[9]||(t[9]=l=>s.customerManager=l),class:"w-full"},null,8,["modelValue"]),t[21]||(t[21]=o("label",null,"거래처담당자",-1))]),_:1})]),o("div",ke,[e(r,{variant:"on"},{default:n(()=>[e(A,{modelValue:s.vatYn,"onUpdate:modelValue":t[10]||(t[10]=l=>s.vatYn=l),options:N.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[22]||(t[22]=o("label",null,"부가세율적용",-1))]),_:1})])])]),_:1}),o("div",Te,[o("div",Ie,[e(p(se),{modelValue:k.value,"onUpdate:modelValue":t[11]||(t[11]=l=>k.value=l),name:"전체",value:"A"},null,8,["modelValue"]),t[23]||(t[23]=o("label",{for:"ingredient1"},"전체 ",-1))]),o("div",null,[e(T,{label:"품목+",onClick:M})]),o("div",null,[e(T,{label:"품목-",onClick:U})])]),o("div",je,[e(oe,{value:v.value,selectionMode:"single",class:"my-table","show-gridlines":""},{default:n(()=>[e(b,{selectionMode:"multiple",headerStyle:"width: 3rem"}),e(b,{field:"itemCd",header:"품목코드",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(b,{field:"itemName",header:"품목명",style:_([{width:"300px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}}),e(b,{field:"spec",header:"규격",style:_([{width:"100px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(w),{modelValue:l.data.spec,"onUpdate:modelValue":y=>l.data.spec=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"orderQty",header:"수량",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(D),{modelValue:l.data.orderQty,"onUpdate:modelValue":y=>l.data.orderQty=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"inPrice",header:"단가",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(D),{modelValue:l.data.inPrice,"onUpdate:modelValue":y=>l.data.inPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"supplyPrice",header:"공급가액",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(D),{modelValue:l.data.supplyPrice,"onUpdate:modelValue":y=>l.data.supplyPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"vatPrice",header:"부가세",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(D),{modelValue:l.data.vatPrice,"onUpdate:modelValue":y=>l.data.vatPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(b,{field:"etc",header:"비고",style:_([{width:"200px"},{"text-align":"right"}]),pt:{columnHeaderContent:"justify-center"}},{body:n(l=>[e(p(w),{modelValue:l.data.etc,"onUpdate:modelValue":y=>l.data.etc=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value"]),o("div",He,[e(T,{label:"저장",severity:"secondary",onClick:L}),e(T,{label:"닫기",onClick:g})]),e(ne,{visible:V.value,"onUpdate:visible":t[13]||(t[13]=l=>V.value=l),header:"품목 조회",modal:"",draggable:!1,resizable:!1},{default:n(()=>[e(we,{onSeleted:f,onClose:t[12]||(t[12]=l=>V.value=!1)})]),_:1},8,["visible"])])],64)}}},Me=B(Le,[["__scopeId","data-v-d3fdba4b"]]),Fe={class:"flex flex-wrap items-center gap-2 w-full"},Ae={class:"flex items-center justify-end gap-2 mb-2"},Ge=["onClick"],Re={__name:"PurchaseTranMList",setup(le){const V=c(null),j=z(),H=c([]),h=c([]);c([]);const $=c([]),u=Q({strDate:I(),toDate:I(),areaCd:null,itemTypeCd:null,itemName:"",itemCd:"",customerName:"",testState:null,passState:null}),N=f=>{let a="구매 등록";te(f)||(a="구매 상세"),j.open(Me,{props:{header:a,modal:!0,draggable:!1,resizable:!1,style:{width:"92rem",maxWidth:"120rem"},contentStyle:{height:"38rem",overflow:"hidden"}},data:f,onClose:()=>{}})},v=()=>{},k=()=>{};Y(async()=>{$.value=await P.getCodeList("AREA"),h.value=await P.getCodeList("ITEM_TYPE_CD")});const x=c({icon:"pi pi-home"}),s=c([{label:"구매관리"},{label:"구매(생산)"},{label:"구매(생산)목록"}]),L=()=>{var a;const f=((a=V.value)==null?void 0:a.columns)??[];f.length&&be(H.value,"구매 리스트",f)};return(f,a)=>{const M=ye,C=ee,U=X,g=Z,d=w,t=J,m=ie,r=q,S=E;return W(),K(O,null,[e(M,{home:x.value,model:s.value},null,8,["home","model"]),o("form",{onSubmit:pe(v,["prevent"]),class:"space-y-4"},[e(m,{class:"flex flex-wrap mt-2 mb-2 gap-1 w-full"},{start:n(()=>[o("div",Fe,[e(C,{modelValue:u.strDate,"onUpdate:modelValue":a[0]||(a[0]=i=>u.strDate=i),showIcon:"",fluid:"",iconDisplay:"input",inputId:"icondisplay",style:{width:"130px"}},null,8,["modelValue"]),e(C,{modelValue:u.toDate,"onUpdate:modelValue":a[1]||(a[1]=i=>u.toDate=i),showIcon:"",fluid:"",iconDisplay:"input",inputId:"icondisplay",style:{width:"130px"}},null,8,["modelValue"]),e(g,{variant:"on"},{default:n(()=>[e(U,{modelValue:u.areaCd,"onUpdate:modelValue":a[2]||(a[2]=i=>u.areaCd=i),options:$.value,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),a[9]||(a[9]=o("label",{for:"on_label1"},"구역(공장)",-1))]),_:1}),e(g,{variant:"on"},{default:n(()=>[e(U,{modelValue:u.itemTypeCd,"onUpdate:modelValue":a[3]||(a[3]=i=>u.itemTypeCd=i),options:h.value,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),a[10]||(a[10]=o("label",{for:"on_label1"},"품목구분",-1))]),_:1}),e(g,{variant:"on"},{default:n(()=>[e(U,{modelValue:u.passState,"onUpdate:modelValue":a[4]||(a[4]=i=>u.passState=i),options:f.passStates,optionLabel:"codeNm",optionValue:"code",style:{width:"150px"}},null,8,["modelValue","options"]),a[11]||(a[11]=o("label",{for:"on_label1"},"진행상태",-1))]),_:1}),e(g,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:u.itemName,"onUpdate:modelValue":a[5]||(a[5]=i=>u.itemName=i),style:{width:"180px"}},null,8,["modelValue"]),a[12]||(a[12]=o("label",{for:"on_label1"},"품목명",-1))]),_:1}),e(g,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:u.itemCd,"onUpdate:modelValue":a[6]||(a[6]=i=>u.itemCd=i),style:{width:"180px"}},null,8,["modelValue"]),a[13]||(a[13]=o("label",{for:"on_label1"},"품목코드",-1))]),_:1}),e(g,{variant:"on"},{default:n(()=>[e(d,{id:"on_label1",modelValue:u.customerName,"onUpdate:modelValue":a[7]||(a[7]=i=>u.customerName=i),style:{width:"180px"}},null,8,["modelValue"]),a[14]||(a[14]=o("label",{for:"on_label1"},"거래처명",-1))]),_:1}),e(t,{label:"검색",icon:"pi pi-search",type:"submit",class:"bg-blue-500 text-white hover:bg-blue-600"})])]),_:1})],32),o("div",Ae,[e(t,{label:"신규",icon:"pi pi-plus",severity:"secondary",onClick:N}),e(t,{label:"인쇄",icon:"pi pi-file-excel",onClick:k}),e(t,{label:"엑셀",icon:"pi pi-file-excel",severity:"success",onClick:L})]),o("div",null,[e(S,{ref_key:"dt",ref:V,selection:f.selectedProducts,"onUpdate:selection":a[8]||(a[8]=i=>f.selectedProducts=i),paginator:"",rows:20,rowsPerPageOptions:[20,30,40],scrollHeight:"700px",scrollable:"",showGridlines:"",tableStyle:"min-width: 100rem; table-layout: fixed;",selectionMode:"single",class:"my-table"},{default:n(()=>[e(r,{selectionMode:"multiple",headerStyle:"width: 3rem",style:{"text-align":"center"}}),e(r,{field:"tranDateSeq",header:"일자-No",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(r,{field:"customerName",header:"거래처명",style:{width:"190px"},pt:{columnHeaderContent:"justify-center"}}),e(r,{field:"itemName",header:"품목명",frozen:"",style:_([{width:"350px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:n(i=>[o("div",{onClick:A=>N(i.data.itemCd),class:"clickable-cell"},F(i.data.itemName),9,Ge)]),_:1}),e(r,{field:"sumQty",header:"수량합계",pt:{columnHeaderContent:"justify-center"},style:_([{width:"80px"},{"text-align":"right"}])},{body:n(i=>[R(F(Number(i.data.qty).sumQty()),1)]),_:1}),e(r,{field:"sumPrice",header:"금액합계",pt:{columnHeaderContent:"justify-center"},style:_([{width:"80px"},{"text-align":"right"}])},{body:n(i=>[R(F(Number(i.data.sumPrice).toLocaleString()),1)]),_:1}),e(r,{field:"testNo",header:"입고창고",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(r,{field:"unit",header:"발주구분",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(r,{field:"manaserName",header:"담당자",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["selection"])])],64)}}},rt=B(Re,[["__scopeId","data-v-7702943a"]]);export{rt as default};
