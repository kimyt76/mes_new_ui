import{b as re,s as z,a as B}from"./index-Z2YNGKhZ.js";import{s as ue}from"./index-D49h5Cbk.js";import{K,U as J,A as c,V as me,M as pe,Z as ce,W,J as E,H as Z,e as X,o as ee,p as e,h as a,l as i,a2 as v,G as te,a0 as C,a7 as fe,F as le,P as ye,t as I,y as A}from"./index-BCdxernO.js";import{s as x}from"./index-WWuz9eST.js";import{s as oe,a as ve,b as be}from"./index-CKfU0QJd.js";import{s as ae}from"./index-DhHuXiFi.js";import{s as ne}from"./index-Dsa_8OmY.js";import{s as ge}from"./index-BE87lW_G.js";import{A as _}from"./apiCommon-DQdCmI3G.js";import{d as Q,i as G,j as q,m as Ce}from"./common-Ctgf_4Dl.js";import{e as Ve}from"./exportToExcel-BIsrPQTg.js";import{s as we}from"./index-CEOpAmiF.js";import{C as xe}from"./CustomerListPop-CR8s3FNg.js";import{I as _e}from"./ItemListMultiPop-BS5GtrW8.js";import{_ as Ne}from"./StorageListPop-DUQWZ2vL.js";import{C as he}from"./ContractListPop-DP1BRr28.js";import{U as De}from"./UserListPop-40qvmJxy.js";import{s as U}from"./index-BGn1OEmN.js";import"./apiBase-DJzL_JWR.js";import"./apiItem-B0JHHkd5.js";import"./apiOrders-LBbh7QBG.js";import"./apiSystem-BBpYMteA.js";const Pe={class:"grid mb-1"},Ue={class:"col-3 flex align-items-center gap-2"},Se={class:"col-3"},je={class:"col-3"},$e={class:"col-3"},ke={class:"grid mb-1"},He={class:"col-3"},Le={class:"col-3"},Ie={class:"col-3"},Te={class:"col-3"},Ye={class:"w-full flex gap-2 ml-2 mt-4"},Me={class:"flex items-center gap-2"},Fe={class:"w-full mt-2"},Re=["onClick"],Ae={class:"w-full flex gap-2 justify-end mt-2"},Qe={__name:"PurchaseOrderMPop",emits:["selected","close"],setup(ie,{emit:O}){const S=J(),V=c(!1),j=me("dialogRef"),{userId:$,memberNm:T}=pe(),r=c([]),N=c([]),b=c([]),h=c(!1),w=ce(null),s=W({orderDate:"",seq:1,itemTypeCd:"",srcStorageName:"",srcStorageCd:"",managerName:T,managerId:$,deliveryDate:"",customerName:"",customerCd:"",customerManager:"",userId:$}),Y=async()=>{b.value},M=n=>{Array.isArray(n)&&F(n)},F=n=>{console.log("rows",n);const t=n.map((u,p)=>({itemCd:u.itemCd,itemName:u.itemName,spec:u.spec,inPrice:u.inPrice,supplyPrice:u.supplyPrice,vatPrice:u.vatPrice,etc:u.etc}));b.value,b.value.length>0?b.value.push(...t):b.value=[...t]},R=()=>{V.value=!0},f=n=>{let t="창고 목록";n==="C"?(w.value=xe,t="거래처 목록"):n==="U"?(w.value=De,t="사용자 목록"):n==="S"?w.value=Ne:n==="O"&&(w.value=he,t="주문서 목록"),S.open(w.value,{props:{header:t,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},onClose:u=>{u.data&&(n==="C"?(s.customerCd=u.data.customerCd,s.customerName=u.data.customerName):n==="U"?(s.managerId=u.data.userId,s.managerName=u.data.memberNm):n==="S"&&(s.srcStorageCd=u.data.storageCd,s.srcStorageName=u.data.storageName))}})};E(()=>s.orderDate,async(n,t)=>{G(t)||t!==n&&(s.seq=await _.getNextSeq("tb_mat_order","order_date",n))});const l=n=>{const t=Number(n.orderQty)||0,u=Number(n.inPrice)||0;n.supplyPrice=t*u,!G(s.vatYn)&&s.vatYn==="VRY"?n.vatPrice=q(n.supplyPrice):n.vatPrice=0};E(()=>s.vatYn,async n=>{s.vatType==="VRN"?b.value.map(t=>{t.vatPrice=0}):b.value.map(t=>{t.vatPrice=q(t.supplyPrice)})});const k=n=>{b.value.splice(n,1)};Z(async()=>{r.value=await _.getCodeList("item_type_cd"),N.value=await _.getCodeList("vat_type"),s.orderDate=Q(),s.deliveryDate=Q()});const H=()=>{j.value.close()};return(n,t)=>{const u=ne,p=ae,L=oe,m=be,D=ve,d=we,P=te,g=z,se=B,de=fe;return ee(),X(le,null,[e(d,{style:{width:"90rem",height:"8rem"}},{content:i(()=>[a("div",Pe,[a("div",Ue,[e(p,{variant:"on"},{default:i(()=>[e(u,{modelValue:s.orderDate,"onUpdate:modelValue":t[0]||(t[0]=o=>s.orderDate=o),fluid:"",style:{width:"120px"}},null,8,["modelValue"]),t[16]||(t[16]=a("label",null,"발주일",-1))]),_:1}),t[18]||(t[18]=a("span",{class:"center-dash"},"-",-1)),e(p,{variant:"on"},{default:i(()=>[e(v(U),{modelValue:s.seq,"onUpdate:modelValue":t[1]||(t[1]=o=>s.seq=o),inputStyle:{width:"50px","text-align":"center"}},null,8,["modelValue"]),t[17]||(t[17]=a("label",null,"연번",-1))]),_:1})]),a("div",Se,[e(p,{variant:"on"},{default:i(()=>[e(L,{modelValue:s.itemTypeCd,"onUpdate:modelValue":t[2]||(t[2]=o=>s.itemTypeCd=o),options:r.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[19]||(t[19]=a("label",null,"품목구분",-1))]),_:1})]),a("div",je,[e(p,{variant:"on"},{default:i(()=>[e(D,{iconPosition:"left"},{default:i(()=>[e(v(x),{modelValue:s.srcStorageName,"onUpdate:modelValue":t[3]||(t[3]=o=>s.srcStorageName=o),class:"w-full"},null,8,["modelValue"]),e(m,{class:"pi pi-search",onClick:t[4]||(t[4]=o=>f("S"))})]),_:1}),t[20]||(t[20]=a("label",null,"입고창고",-1))]),_:1})]),a("div",$e,[e(p,{variant:"on"},{default:i(()=>[e(D,{iconPosition:"left"},{default:i(()=>[e(v(x),{modelValue:s.managerName,"onUpdate:modelValue":t[5]||(t[5]=o=>s.managerName=o),class:"w-full"},null,8,["modelValue"]),e(m,{class:"pi pi-search",onClick:t[6]||(t[6]=o=>f("U"))})]),_:1}),t[21]||(t[21]=a("label",null,"담당자",-1))]),_:1})])]),a("div",ke,[a("div",He,[e(p,{variant:"on"},{default:i(()=>[e(u,{modelValue:s.deliveryDate,"onUpdate:modelValue":t[7]||(t[7]=o=>s.deliveryDate=o),"show-icon":"",fluid:""},null,8,["modelValue"]),t[22]||(t[22]=a("label",null,"납기일",-1))]),_:1})]),a("div",Le,[e(p,{variant:"on"},{default:i(()=>[e(D,{iconPosition:"left"},{default:i(()=>[e(v(x),{modelValue:s.customerName,"onUpdate:modelValue":t[8]||(t[8]=o=>s.customerName=o),class:"w-full"},null,8,["modelValue"]),e(m,{class:"pi pi-search",onClick:t[9]||(t[9]=o=>f("C"))})]),_:1}),t[23]||(t[23]=a("label",null,"거래처",-1))]),_:1})]),a("div",Ie,[e(p,{variant:"on"},{default:i(()=>[e(v(x),{modelValue:s.customerManager,"onUpdate:modelValue":t[10]||(t[10]=o=>s.customerManager=o),class:"w-full"},null,8,["modelValue"]),t[24]||(t[24]=a("label",null,"거래처담당자",-1))]),_:1})]),a("div",Te,[e(p,{variant:"on"},{default:i(()=>[e(L,{modelValue:s.vatYn,"onUpdate:modelValue":t[11]||(t[11]=o=>s.vatYn=o),options:N.value,optionLabel:"codeNm",optionValue:"code",class:"w-full"},null,8,["modelValue","options"]),t[25]||(t[25]=a("label",null,"부가세율적용",-1))]),_:1})])])]),_:1}),a("div",Ye,[a("div",Me,[e(v(re),{modelValue:h.value,"onUpdate:modelValue":t[12]||(t[12]=o=>h.value=o),name:"전체",value:"A"},null,8,["modelValue"]),t[26]||(t[26]=a("label",{for:"ingredient1"},"전체 ",-1))]),a("div",null,[e(P,{label:"주문서",onClick:t[13]||(t[13]=o=>f("O"))})]),a("div",null,[e(P,{label:"품목+",onClick:R})])]),a("div",Fe,[e(se,{value:b.value,selectionMode:"single",class:"my-table","show-gridlines":""},{default:i(()=>[e(g,{selectionMode:"multiple",headerStyle:"width: 3rem"}),e(g,{field:"itemCd",header:"품목코드",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(g,{field:"itemName",header:"품목명",style:C([{width:"350px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}}),e(g,{field:"spec",header:"규격",style:C([{width:"110px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(x),{modelValue:o.data.spec,"onUpdate:modelValue":y=>o.data.spec=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"orderQty",header:"수량",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(U),{modelValue:o.data.orderQty,"onUpdate:modelValue":[y=>o.data.orderQty=y,()=>l(o.data)],class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"inPrice",header:"단가",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(U),{modelValue:o.data.inPrice,"onUpdate:modelValue":[y=>o.data.inPrice=y,()=>l(o.data)],class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"supplyPrice",header:"공급가액",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(U),{modelValue:o.data.supplyPrice,"onUpdate:modelValue":y=>o.data.supplyPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"120px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"vatPrice",header:"부가세",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(U),{modelValue:o.data.vatPrice,"onUpdate:modelValue":y=>o.data.vatPrice=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0,inputStyle:{width:"100px","text-align":"right"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"etc",header:"비고",style:C([{width:"200px"},{"text-align":"right"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[e(v(x),{modelValue:o.data.etc,"onUpdate:modelValue":y=>o.data.etc=y,class:"w-full",min:0,maxFractionDigits:0,useGrouping:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{field:"actions",header:"-",style:C([{width:"20px"},{"text-align":"center"}]),pt:{columnHeaderContent:"justify-center"}},{body:i(o=>[a("i",{class:"pi pi-trash cursor-pointer",onClick:y=>k(o.index)},null,8,Re)]),_:1})]),_:1},8,["value"])]),a("div",Ae,[e(P,{label:"저장",class:"btn-save",onClick:Y}),e(P,{label:"닫기",onClick:H})]),e(de,{visible:V.value,"onUpdate:visible":t[15]||(t[15]=o=>V.value=o),header:"품목 조회",modal:"",draggable:!1,resizable:!1},{default:i(()=>[e(_e,{onSelected:M,onClose:t[14]||(t[14]=o=>V.value=!1)})]),_:1},8,["visible"])],64)}}},Ge=K(Qe,[["__scopeId","data-v-213ca24e"]]),Oe={class:"flex flex-wrap items-center gap-2 w-full"},Ee={class:"flex items-center justify-end gap-2 mb-2"},qe=["onClick"],ze={__name:"PurchaseOrderMList",setup(ie){c(!1);const O=J(),S=c(null),V=c([]),j=c([]),$=c([{codeNm:"미입고",code:"N"},{codeNm:"입고",code:"Y"}]),T=c([{codeNm:"진행중",code:"N"},{codeNm:"종결",code:"Y"}]),r=W({strDate:"",toDate:"",itemTypeCd:"",itemCd:"",itemName:"",customerName:"",customerCd:"",regYn:"",endYn:"",selectedCity:""}),N=c();c([]);const b=c([]),h=f=>{let l="발주서 등록";G(f)||(l="발주서 상세"),O.open(Ge,{props:{header:l,modal:!0,maximizable:!1,draggable:!0,style:{overflow:"hidden"},pt:{root:{style:{overflow:"hidden"}},content:{style:{overflow:"hidden"}}}},data:f,onClose:k=>{}})},w=async()=>{const f={...r};list.value=await _.getCodeList(f)},s=()=>{},Y=()=>{};Z(async()=>{V.value=await _.getCodeList("AREA"),j.value=await _.getCodeList("ITEM_TYPE_CD"),r.toDate=Q(),r.strDate=Ce(r.toDate)});const M=c({icon:"pi pi-home"}),F=c([{label:"발주관리"},{label:"발주목록(생산)"},{label:"발주목록(생산)목록"}]),R=()=>{var l;const f=((l=S.value)==null?void 0:l.columns)??[];if(!f.length){console.warn("No Columns Found");return}Ve(b.value,"발주 리스트",f)};return(f,l)=>{const k=ge,H=ne,n=ae,t=oe,u=x,p=te,L=ue,m=z,D=B;return ee(),X(le,null,[e(k,{home:M.value,model:F.value},null,8,["home","model"]),a("form",{onSubmit:ye(w,["prevent"]),class:"space-y-4"},[e(L,{class:"flex flex-wrap mt-2 mb-2 gap-1 w-full"},{start:i(()=>[a("div",Oe,[e(n,{variant:"on"},{default:i(()=>[e(H,{modelValue:r.strDate,"onUpdate:modelValue":l[0]||(l[0]=d=>r.strDate=d),inputId:"on_label",showIcon:"",iconDisplay:"input"},null,8,["modelValue"]),l[11]||(l[11]=a("label",{for:"on_label"},"시작",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(H,{modelValue:r.toDate,"onUpdate:modelValue":l[1]||(l[1]=d=>r.toDate=d),inputId:"on_label",showIcon:"",iconDisplay:"input"},null,8,["modelValue"]),l[12]||(l[12]=a("label",{for:"on_label"},"종료",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(t,{modelValue:r.areaCd,"onUpdate:modelValue":l[2]||(l[2]=d=>r.areaCd=d),options:V.value,optionLabel:"codeNm",optionValue:"code",style:{width:"120px"}},null,8,["modelValue","options"]),l[13]||(l[13]=a("label",{for:"on_label"},"구역(공장)",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(t,{modelValue:r.itemTypeCd,"onUpdate:modelValue":l[3]||(l[3]=d=>r.itemTypeCd=d),options:j.value,optionLabel:"codeNm",optionValue:"code",style:{width:"120px"}},null,8,["modelValue","options"]),l[14]||(l[14]=a("label",{for:"on_label"},"품목구분",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(u,{id:"on_label",modelValue:r.itemName,"onUpdate:modelValue":l[4]||(l[4]=d=>r.itemName=d),style:{width:"180px"}},null,8,["modelValue"]),l[15]||(l[15]=a("label",{for:"on_label"},"품목명",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(u,{id:"on_label1",modelValue:r.itemCd,"onUpdate:modelValue":l[5]||(l[5]=d=>r.itemCd=d),style:{width:"120px"}},null,8,["modelValue"]),l[16]||(l[16]=a("label",{for:"on_label1"},"품목코드",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(u,{id:"on_label1",modelValue:r.customerName,"onUpdate:modelValue":l[6]||(l[6]=d=>r.customerName=d),style:{width:"180px"}},null,8,["modelValue"]),l[17]||(l[17]=a("label",{for:"on_label1"},"거래처명",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(t,{modelValue:r.regYn,"onUpdate:modelValue":l[7]||(l[7]=d=>r.regYn=d),options:$.value,optionLabel:"codeNm",optionValue:"code",style:{width:"90px"}},null,8,["modelValue","options"]),l[18]||(l[18]=a("label",{for:"on_label"},"입고상태",-1))]),_:1}),e(n,{variant:"on"},{default:i(()=>[e(t,{modelValue:r.endYn,"onUpdate:modelValue":l[8]||(l[8]=d=>r.endYn=d),options:T.value,optionLabel:"codeNm",optionValue:"code",style:{width:"90px"}},null,8,["modelValue","options"]),l[19]||(l[19]=a("label",{for:"on_label"},"진행상태",-1))]),_:1}),e(p,{label:"검색",icon:"pi pi-search",type:"submit",class:"bg-blue-500 text-white hover:bg-blue-600"})])]),_:1})],32),a("div",Ee,[e(p,{label:"신규",icon:"pi pi-plus",severity:"secondary",onClick:l[9]||(l[9]=d=>h(""))}),e(p,{label:"엑셀",icon:"pi pi-file-excel",severity:"success",onClick:R}),e(p,{label:"복사",icon:"pi pi-file-excel",onClick:Y}),e(p,{label:"인쇄",icon:"pi pi-file-excel",onClick:s})]),a("div",null,[e(D,{ref_key:"dt",ref:S,selection:N.value,"onUpdate:selection":l[10]||(l[10]=d=>N.value=d),paginator:"",rows:20,rowsPerPageOptions:[20,30,40],scrollHeight:"700px",scrollable:"",showGridlines:"",selectionMode:"single",tableStyle:"min-width:120rem; table-layout: fixed;",class:"my-table"},{default:i(()=>[e(m,{selectionMode:"multiple",headerStyle:"width: 3rem",style:{"text-align":"center"}}),e(m,{field:"orderDateSeq",header:"일자",frozen:"",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"orderDate",header:"발주일",frozen:"",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"deliveryDate",header:"납기일",style:{width:"80px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"customerName",header:"거래처명",style:{width:"250px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"itemCd",header:"품목코드",style:{width:"120px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"itemName",header:"품목명",style:C([{width:"400px"},{"text-align":"left"}]),bodyClass:"break-words",pt:{columnHeaderContent:"justify-center"}},{body:i(d=>[a("div",{onClick:P=>h(d.data.itemCd),class:"clickable-cell"},I(d.data.itemName),9,qe)]),_:1}),e(m,{field:"srcStorageName",header:"입고창고",style:{width:"110px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"orderQty",header:"발주수량",pt:{columnHeaderContent:"justify-center"},style:C([{width:"90px"},{"text-align":"right"}])},{body:i(d=>[A(I(Number(d.data.orderQty).toLocaleString()),1)]),_:1}),e(m,{field:"inQty",header:"입고수량",pt:{columnHeaderContent:"justify-center"},style:C([{width:"90px"},{"text-align":"right"}])},{body:i(d=>[A(I(Number(d.data.inQty).toLocaleString()),1)]),_:1}),e(m,{field:"supplyPrice",header:"공급가액",pt:{columnHeaderContent:"justify-center"},style:C([{width:"90px"},{"text-align":"right"}])},{body:i(d=>[A(I(Number(d.data.supplyPrice).toLocaleString()),1)]),_:1}),e(m,{field:"regYn",header:"입고상태",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"endYn",header:"진행상태",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"mailYn",header:"발주서발송",style:{width:"100px"},pt:{columnHeaderContent:"justify-center"}}),e(m,{field:"managerName",header:"담당자",style:{width:"90px"},pt:{columnHeaderContent:"justify-center"}})]),_:1},8,["selection"])])],64)}}},vt=K(ze,[["__scopeId","data-v-ce62388d"]]);export{vt as default};
