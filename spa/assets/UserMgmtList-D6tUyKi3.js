import{_ as q,u as G,r as c,k as H,v as J,d as a,b as U,o as f,w as s,g as l,f as m,z as Y,c as W,F as R,j as K,h as S,t as p,m as Q}from"./index-CW10mm3L.js";import{A as w}from"./apiSystem-DiYNmOy2.js";import{e as X}from"./exportToExcel-BTkYpchh.js";const Z={__name:"UserDtlPop",props:{title:{type:String},id:{type:String},mode:{type:String}},emits:["saved","close-dialog"],setup(z,{emit:j}){const V=G(),_=j,b=c(),y=c(!1),d=z,n=H({userId:null,deptNm:null,jobPosition:null,memberNm:null,phone:null,email:null,password:null,confirmPassword:null,useYn:d.mode==="N"?"Y":"N"}),g=[{text:"재직",value:"Y"},{text:"퇴직",value:"N"}];J(()=>{d.mode==="U"&&(x(d.id),y.value=!0)});const x=o=>{w.getUserInfo(o).then(e=>{const N=e.data;Object.assign(n,N)})},i=[o=>!!o||"사용자 ID는 필수입니다.",o=>o.length>=2||"사용자 ID는 최소 2자 이상이어야 합니다."],D=[o=>!!o||"사용자 이름은 필수입니다.",o=>o.length>=2||"사용자 이름은 최소 2자 이상이어야 합니다."],I=[o=>!!o||"패스워드는 필수입니다.",o=>o.length>=4||"패스워드는 최소 4자 이상이어야 합니다."],k=[o=>!!o||"패스워드 확인은 필수입니다.",o=>o.length>=4||"패스워드 확인은 최소 4자 이상이어야 합니다."],h=async()=>await b.value.validate()?!0:(V.vWarning("필수 입력값을 확인하세요."),!1),E=async()=>{const o={...n};if(d.mode==="N"){if(!await h())return;if(n.password!==n.confirmPassword){V.vWarning("패스워드가 틀립니다. 다시 확인해주십시오!!");return}}else delete o.password;try{w.updateUserInfo(o).then(e=>{_("saved",e.data),_("close-dialog")})}catch(e){V.vError("저장에 실패했습니다."+e)}},L=()=>{w.passwordInit(n.userId).then(o=>{V.vSuccess(o.data)})},M=()=>{w.userCheck(n.userId).then(o=>{V.vInfo(o.data)})};return(o,e)=>{const N=a("v-card-item"),r=a("v-text-field"),u=a("v-col"),v=a("v-btn"),P=a("v-select"),C=a("v-row"),B=a("v-form"),F=a("v-card-text"),$=a("v-spacer"),A=a("v-card-actions"),O=a("v-card");return f(),U(O,null,{default:s(()=>[l(N,{title:d.title},null,8,["title"]),l(F,null,{default:s(()=>[l(B,{ref_key:"vform",ref:b},{default:s(()=>[l(C,{dense:"",class:"mt-1 ml-1 mr-1"},{default:s(()=>[l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.userId,"onUpdate:modelValue":e[0]||(e[0]=t=>n.userId=t),dense:"",label:"사용자 ID",placeholder:"사용자 ID 입력해주세요",variant:"underlined",readonly:y.value,rules:i},null,8,["modelValue","readonly"])]),_:1}),l(u,{cols:"12",sm:"6"},{default:s(()=>[d.mode==="N"?(f(),U(v,{key:0,class:"mt-2",text:"중복확인",onClick:M})):Y("",!0)]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.memberNm,"onUpdate:modelValue":e[1]||(e[1]=t=>n.memberNm=t),dense:"",label:"사용자 이름",placeholder:"사용자 이름 입력해주세요",variant:"underlined",readonly:y.value,rules:D},null,8,["modelValue","readonly"])]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.jobPosition,"onUpdate:modelValue":e[2]||(e[2]=t=>n.jobPosition=t),dense:"",label:"직급",placeholder:"직급을 입력해주세요",variant:"underlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.deptNm,"onUpdate:modelValue":e[3]||(e[3]=t=>n.deptNm=t),dense:"",label:"부서",placeholder:"부서를 입력해주세요",variant:"underlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>n.phone=t),dense:"",label:"연락처",placeholder:"전화번호를 입력해주세요",variant:"underlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.email,"onUpdate:modelValue":e[5]||(e[5]=t=>n.email=t),dense:"",label:"이메일",placeholder:"이메일을 입력해주세요",variant:"underlined"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"4",sm:"6"},{default:s(()=>[l(P,{modelValue:n.useYn,"onUpdate:modelValue":e[6]||(e[6]=t=>n.useYn=t),label:"재직여부",items:g,"item-title":"text","item-value":"value",variant:"underlined"},null,8,["modelValue"])]),_:1}),d.mode==="N"?(f(),U(u,{key:0,cols:"12",md:"4",sm:"6"},{default:s(()=>[l(r,{modelValue:n.password,"onUpdate:modelValue":e[7]||(e[7]=t=>n.password=t),dense:"",label:"패스워드",type:"password",placeholder:"패스워드를 입력해주세요",variant:"underlined",rules:I},null,8,["modelValue"])]),_:1})):Y("",!0),d.mode==="N"?(f(),U(u,{key:1,cols:"12",md:"4"},{default:s(()=>[l(r,{modelValue:n.confirmPassword,"onUpdate:modelValue":e[8]||(e[8]=t=>n.confirmPassword=t),dense:"",label:"패스워드 확인",type:"password",placeholder:"패스워드를 입력해주세요",variant:"underlined",rules:k},null,8,["modelValue"])]),_:1})):Y("",!0),l(u,{cols:"12"},{default:s(()=>[l(r,{modelValue:n.etc,"onUpdate:modelValue":e[9]||(e[9]=t=>n.etc=t),dense:"",label:"비고",placeholder:"기타정보를 입력하세요",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512),e[11]||(e[11]=m("small",{class:"text-caption text-medium-emphasis"},"* 이메일은 ID만 넣어주세요",-1))]),_:1}),l(A,null,{default:s(()=>[l($),d.mode==="U"?(f(),U(v,{key:0,color:"red-darken-3",text:"패스워드 초기화",depressed:"",variant:"tonal",onClick:L})):Y("",!0),l(v,{color:"indigo-darken-4",text:"저장",variant:"tonal",depressed:"",onClick:E}),l(v,{text:"닫기",variant:"tonal",onClick:e[10]||(e[10]=t=>_("close-dialog"))})]),_:1})]),_:1})}}},ee=q(Z,[["__scopeId","data-v-e6cd01d5"]]),le={class:"d-flex ga-4"},te={class:"d-flex ga-4 justify-end"},oe={style:{height:"40px"}},ne={class:"custom-th",style:{height:"40px"}},se=["onClick"],ae={__name:"UserMgmtList",setup(z){const{vError:j,vSuccess:V}=G(),_=c(!1),b=c(!1),y=c(null),d=c([]),n=c(""),g=c("N"),x=c(""),i=H({userId:"",deptNm:"",jobPosition:"",useYn:"Y"}),D=[{text:"재직",value:"Y"},{text:"퇴직",value:"N"}],I=c([{title:"사용자ID",key:"userId"},{title:"사용자명",key:"memberNm"},{title:"부서",key:"deptNm"},{title:"직급",key:"jobPosition"},{title:"전화번호",key:"phone"},{title:"이메일",key:"email"},{title:"재직여부",key:"useYn"},{title:"비고",key:"etc"}]),k=async()=>{b.value=!0;try{const o={...i};d.value=await w.getUserList(o)}catch(o){j(o)}finally{b.value=!1}},h=o=>{o==="N"?(g.value="N",x.value="사용자 등록",n.value=""):(g.value="U",n.value=o,x.value="사용자 상세정보"),_.value=!0},E=()=>{y.value.reset()},L=()=>{X(I,d.value,"사용자_목록")};J(k);const M=o=>{V(o),k()};return(o,e)=>{const N=a("v-breadcrumbs"),r=a("v-text-field"),u=a("v-select"),v=a("v-btn"),P=a("v-col"),C=a("v-row"),B=a("v-form"),F=a("v-card"),$=a("v-data-table"),A=a("v-sheet"),O=a("v-dialog");return f(),W(R,null,[l(N,{items:["MES","시스템관리","사용자 관리"]}),l(F,{class:"pa-3",style:{height:"80px"}},{default:s(()=>[l(B,{ref_key:"srhForm",ref:y,onSubmit:K(k,["prevent"])},{default:s(()=>[l(C,null,{default:s(()=>[l(P,null,{default:s(()=>[m("div",le,[l(r,{modelValue:i.userId,"onUpdate:modelValue":e[0]||(e[0]=t=>i.userId=t),dense:"",label:"사용자 이름",placeholder:"사용자 이름 입력해주세요",variant:"underlined"},null,8,["modelValue"]),l(r,{modelValue:i.jobPosition,"onUpdate:modelValue":e[1]||(e[1]=t=>i.jobPosition=t),dense:"",label:"직급",placeholder:"직급을 입력해주세요",variant:"underlined"},null,8,["modelValue"]),l(r,{modelValue:i.deptNm,"onUpdate:modelValue":e[2]||(e[2]=t=>i.deptNm=t),label:"부서",placeholder:"부서를 입력해주세요",variant:"underlined"},null,8,["modelValue"]),l(u,{modelValue:i.useYn,"onUpdate:modelValue":e[3]||(e[3]=t=>i.useYn=t),label:"재직여부",items:D,"item-title":"text","item-value":"value",variant:"underlined"},null,8,["modelValue"]),l(v,{color:"#EFEBE9",class:"mt-3",type:"submit"},{default:s(()=>e[7]||(e[7]=[S("조회")])),_:1}),l(v,{class:"mt-3",onClick:E},{default:s(()=>e[8]||(e[8]=[S("초기화")])),_:1})])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(C,{class:"mb-1"},{default:s(()=>[l(P,null,{default:s(()=>[m("div",te,[l(v,{color:"brown-lighten-4",class:"mt-3",onClick:e[4]||(e[4]=t=>h("N"))},{default:s(()=>e[9]||(e[9]=[S("신규")])),_:1}),l(v,{class:"mt-3 mr-3",onClick:L},{default:s(()=>e[10]||(e[10]=[S("엑셀")])),_:1})])]),_:1})]),_:1}),l(A,{border:"",rounded:""},{default:s(()=>[l($,{headers:I.value,items:d.value,loading:b.value,"no-data-text":"데이터가 없습니다.","loading-text":"조회중입니다 잠시만 기다려주세요","items-per-page":25},{headers:s(({columns:t})=>[m("tr",oe,[(f(!0),W(R,null,Q(t,T=>(f(),W("th",{key:T.key,class:"custom-header",style:{height:"40px"}},p(T.title),1))),128))])]),item:s(({item:t})=>[m("tr",ne,[m("td",{onClick:T=>h(t.userId)},p(t.userId),9,se),m("td",null,p(t.memberNm),1),m("td",null,p(t.deptNm),1),m("td",null,p(t.jobPosition),1),m("td",null,p(t.phone),1),m("td",null,p(t.email),1),m("td",null,p(t.useYn==="Y"?"재직":"퇴직"),1),m("td",null,p(t.etc),1)])]),_:1},8,["headers","items","loading"])]),_:1}),l(O,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=t=>_.value=t),"max-width":"800px",persistent:""},{default:s(()=>[l(ee,{mode:g.value,id:n.value,title:x.value,onSaved:M,onCloseDialog:e[5]||(e[5]=t=>_.value=!1)},null,8,["mode","id","title"])]),_:1},8,["modelValue"])],64)}}},me=q(ae,[["__scopeId","data-v-bc852f36"]]);export{me as default};
